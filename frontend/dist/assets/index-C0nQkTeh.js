const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-D9ZMLzc3.js","assets/react-vendor-DDicXdh7.js","assets/chart-vendor-Bvp7Egfc.js"])))=>i.map(i=>d[i]);
var M6=Object.defineProperty;var I6=(e,t,r)=>t in e?M6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var xr=(e,t,r)=>I6(e,typeof t!="symbol"?t+"":t,r);import{r as J,a as B6,N as bp,u as Cs,b as Px,L as vi,c as W0,g as Ds,d as Ce,e as Ns,f as R5,B as U6,h as W6,i as Hr}from"./react-vendor-DDicXdh7.js";import{R as Aa,P as M5,a as I5,C as t0,T as Ea,B as Ki,b as gs,X as xs,Y as vs,c as Ys,A as fv,d as wc,L as z6,e as yp,f as wp}from"./chart-vendor-Bvp7Egfc.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var B5={exports:{}},z0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H6=J,q6=Symbol.for("react.element"),Y6=Symbol.for("react.fragment"),V6=Object.prototype.hasOwnProperty,G6=H6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K6={key:!0,ref:!0,__self:!0,__source:!0};function U5(e,t,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)V6.call(t,n)&&!K6.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:q6,type:e,key:s,ref:o,props:a,_owner:G6.current}}z0.Fragment=Y6;z0.jsx=U5;z0.jsxs=U5;B5.exports=z0;var i=B5.exports,Eg={},hv=B6;Eg.createRoot=hv.createRoot,Eg.hydrateRoot=hv.hydrateRoot;function W5(e,t){return function(){return e.apply(t,arguments)}}const{toString:X6}=Object.prototype,{getPrototypeOf:Lx}=Object,{iterator:H0,toStringTag:z5}=Symbol,q0=(e=>t=>{const r=X6.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ri=e=>(e=e.toLowerCase(),t=>q0(t)===e),Y0=e=>t=>typeof t===e,{isArray:od}=Array,Xc=Y0("undefined");function Qu(e){return e!==null&&!Xc(e)&&e.constructor!==null&&!Xc(e.constructor)&&Oa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const H5=ri("ArrayBuffer");function J6(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&H5(e.buffer),t}const Z6=Y0("string"),Oa=Y0("function"),q5=Y0("number"),ef=e=>e!==null&&typeof e=="object",Q6=e=>e===!0||e===!1,Dh=e=>{if(q0(e)!=="object")return!1;const t=Lx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(z5 in e)&&!(H0 in e)},ej=e=>{if(!ef(e)||Qu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},tj=ri("Date"),rj=ri("File"),nj=ri("Blob"),aj=ri("FileList"),sj=e=>ef(e)&&Oa(e.pipe),ij=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Oa(e.append)&&((t=q0(e))==="formdata"||t==="object"&&Oa(e.toString)&&e.toString()==="[object FormData]"))},oj=ri("URLSearchParams"),[lj,cj,dj,uj]=["ReadableStream","Request","Response","Headers"].map(ri),fj=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tf(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),od(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Qu(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function Y5(e,t){if(Qu(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Ll=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,V5=e=>!Xc(e)&&e!==Ll;function Cg(){const{caseless:e,skipUndefined:t}=V5(this)&&this||{},r={},n=(a,s)=>{const o=e&&Y5(r,s)||s;Dh(r[o])&&Dh(a)?r[o]=Cg(r[o],a):Dh(a)?r[o]=Cg({},a):od(a)?r[o]=a.slice():(!t||!Xc(a))&&(r[o]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&tf(arguments[a],n);return r}const hj=(e,t,r,{allOwnKeys:n}={})=>(tf(t,(a,s)=>{r&&Oa(a)?e[s]=W5(a,r):e[s]=a},{allOwnKeys:n}),e),mj=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pj=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},gj=(e,t,r,n)=>{let a,s,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)o=a[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Lx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},xj=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},vj=e=>{if(!e)return null;if(od(e))return e;let t=e.length;if(!q5(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},bj=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Lx(Uint8Array)),yj=(e,t)=>{const n=(e&&e[H0]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},wj=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},_j=ri("HTMLFormElement"),Nj=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),mv=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),kj=ri("RegExp"),G5=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};tf(r,(a,s)=>{let o;(o=t(a,s,e))!==!1&&(n[s]=o||a)}),Object.defineProperties(e,n)},Sj=e=>{G5(e,(t,r)=>{if(Oa(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Oa(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},jj=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return od(e)?n(e):n(String(e).split(t)),r},Tj=()=>{},Aj=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Ej(e){return!!(e&&Oa(e.append)&&e[z5]==="FormData"&&e[H0])}const Cj=e=>{const t=new Array(10),r=(n,a)=>{if(ef(n)){if(t.indexOf(n)>=0)return;if(Qu(n))return n;if(!("toJSON"in n)){t[a]=n;const s=od(n)?[]:{};return tf(n,(o,l)=>{const c=r(o,a+1);!Xc(c)&&(s[l]=c)}),t[a]=void 0,s}}return n};return r(e,0)},Dj=ri("AsyncFunction"),Oj=e=>e&&(ef(e)||Oa(e))&&Oa(e.then)&&Oa(e.catch),K5=((e,t)=>e?setImmediate:t?((r,n)=>(Ll.addEventListener("message",({source:a,data:s})=>{a===Ll&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Ll.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Oa(Ll.postMessage)),Pj=typeof queueMicrotask<"u"?queueMicrotask.bind(Ll):typeof process<"u"&&process.nextTick||K5,Lj=e=>e!=null&&Oa(e[H0]),Ue={isArray:od,isArrayBuffer:H5,isBuffer:Qu,isFormData:ij,isArrayBufferView:J6,isString:Z6,isNumber:q5,isBoolean:Q6,isObject:ef,isPlainObject:Dh,isEmptyObject:ej,isReadableStream:lj,isRequest:cj,isResponse:dj,isHeaders:uj,isUndefined:Xc,isDate:tj,isFile:rj,isBlob:nj,isRegExp:kj,isFunction:Oa,isStream:sj,isURLSearchParams:oj,isTypedArray:bj,isFileList:aj,forEach:tf,merge:Cg,extend:hj,trim:fj,stripBOM:mj,inherits:pj,toFlatObject:gj,kindOf:q0,kindOfTest:ri,endsWith:xj,toArray:vj,forEachEntry:yj,matchAll:wj,isHTMLForm:_j,hasOwnProperty:mv,hasOwnProp:mv,reduceDescriptors:G5,freezeMethods:Sj,toObjectSet:jj,toCamelCase:Nj,noop:Tj,toFiniteNumber:Aj,findKey:Y5,global:Ll,isContextDefined:V5,isSpecCompliantForm:Ej,toJSONObject:Cj,isAsyncFn:Dj,isThenable:Oj,setImmediate:K5,asap:Pj,isIterable:Lj};function Yt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Ue.inherits(Yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ue.toJSONObject(this.config),code:this.code,status:this.status}}});const X5=Yt.prototype,J5={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{J5[e]={value:e}});Object.defineProperties(Yt,J5);Object.defineProperty(X5,"isAxiosError",{value:!0});Yt.from=(e,t,r,n,a,s)=>{const o=Object.create(X5);Ue.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Yt.call(o,l,c,r,n,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const Fj=null;function Dg(e){return Ue.isPlainObject(e)||Ue.isArray(e)}function Z5(e){return Ue.endsWith(e,"[]")?e.slice(0,-2):e}function pv(e,t,r){return e?e.concat(t).map(function(a,s){return a=Z5(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function $j(e){return Ue.isArray(e)&&!e.some(Dg)}const Rj=Ue.toFlatObject(Ue,{},null,function(t){return/^is[A-Z]/.test(t)});function V0(e,t,r){if(!Ue.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ue.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,b){return!Ue.isUndefined(b[g])});const n=r.metaTokens,a=r.visitor||u,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ue.isSpecCompliantForm(t);if(!Ue.isFunction(a))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(Ue.isDate(x))return x.toISOString();if(Ue.isBoolean(x))return x.toString();if(!c&&Ue.isBlob(x))throw new Yt("Blob is not supported. Use a Buffer instead.");return Ue.isArrayBuffer(x)||Ue.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function u(x,g,b){let y=x;if(x&&!b&&typeof x=="object"){if(Ue.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(Ue.isArray(x)&&$j(x)||(Ue.isFileList(x)||Ue.endsWith(g,"[]"))&&(y=Ue.toArray(x)))return g=Z5(g),y.forEach(function(S,_){!(Ue.isUndefined(S)||S===null)&&t.append(o===!0?pv([g],_,s):o===null?g:g+"[]",d(S))}),!1}return Dg(x)?!0:(t.append(pv(b,g,s),d(x)),!1)}const h=[],m=Object.assign(Rj,{defaultVisitor:u,convertValue:d,isVisitable:Dg});function f(x,g){if(!Ue.isUndefined(x)){if(h.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(x),Ue.forEach(x,function(y,N){(!(Ue.isUndefined(y)||y===null)&&a.call(t,y,Ue.isString(N)?N.trim():N,g,m))===!0&&f(y,g?g.concat(N):[N])}),h.pop()}}if(!Ue.isObject(e))throw new TypeError("data must be an object");return f(e),t}function gv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Fx(e,t){this._pairs=[],e&&V0(e,this,t)}const Q5=Fx.prototype;Q5.append=function(t,r){this._pairs.push([t,r])};Q5.toString=function(t){const r=t?function(n){return t.call(this,n,gv)}:gv;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Mj(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function e4(e,t,r){if(!t)return e;const n=r&&r.encode||Mj;Ue.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=Ue.isURLSearchParams(t)?t.toString():new Fx(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class xv{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ue.forEach(this.handlers,function(n){n!==null&&t(n)})}}const t4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ij=typeof URLSearchParams<"u"?URLSearchParams:Fx,Bj=typeof FormData<"u"?FormData:null,Uj=typeof Blob<"u"?Blob:null,Wj={isBrowser:!0,classes:{URLSearchParams:Ij,FormData:Bj,Blob:Uj},protocols:["http","https","file","blob","url","data"]},$x=typeof window<"u"&&typeof document<"u",Og=typeof navigator=="object"&&navigator||void 0,zj=$x&&(!Og||["ReactNative","NativeScript","NS"].indexOf(Og.product)<0),Hj=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qj=$x&&window.location.href||"http://localhost",Yj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$x,hasStandardBrowserEnv:zj,hasStandardBrowserWebWorkerEnv:Hj,navigator:Og,origin:qj},Symbol.toStringTag,{value:"Module"})),ca={...Yj,...Wj};function Vj(e,t){return V0(e,new ca.classes.URLSearchParams,{visitor:function(r,n,a,s){return ca.isNode&&Ue.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function Gj(e){return Ue.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Kj(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function r4(e){function t(r,n,a,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&Ue.isArray(a)?a.length:o,c?(Ue.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!Ue.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],s)&&Ue.isArray(a[o])&&(a[o]=Kj(a[o])),!l)}if(Ue.isFormData(e)&&Ue.isFunction(e.entries)){const r={};return Ue.forEachEntry(e,(n,a)=>{t(Gj(n),a,r,0)}),r}return null}function Xj(e,t,r){if(Ue.isString(e))try{return(t||JSON.parse)(e),Ue.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const rf={transitional:t4,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=Ue.isObject(t);if(s&&Ue.isHTMLForm(t)&&(t=new FormData(t)),Ue.isFormData(t))return a?JSON.stringify(r4(t)):t;if(Ue.isArrayBuffer(t)||Ue.isBuffer(t)||Ue.isStream(t)||Ue.isFile(t)||Ue.isBlob(t)||Ue.isReadableStream(t))return t;if(Ue.isArrayBufferView(t))return t.buffer;if(Ue.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Vj(t,this.formSerializer).toString();if((l=Ue.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return V0(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),Xj(t)):t}],transformResponse:[function(t){const r=this.transitional||rf.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Ue.isResponse(t)||Ue.isReadableStream(t))return t;if(t&&Ue.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Yt.from(l,Yt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ca.classes.FormData,Blob:ca.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ue.forEach(["delete","get","head","post","put","patch"],e=>{rf.headers[e]={}});const Jj=Ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Zj=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&Jj[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},vv=Symbol("internals");function Qd(e){return e&&String(e).trim().toLowerCase()}function Oh(e){return e===!1||e==null?e:Ue.isArray(e)?e.map(Oh):String(e)}function Qj(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const e8=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function _p(e,t,r,n,a){if(Ue.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!Ue.isString(t)){if(Ue.isString(n))return t.indexOf(n)!==-1;if(Ue.isRegExp(n))return n.test(t)}}function t8(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function r8(e,t){const r=Ue.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,o){return this[n].call(this,t,a,s,o)},configurable:!0})})}let Pa=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(l,c,d){const u=Qd(c);if(!u)throw new Error("header name must be a non-empty string");const h=Ue.findKey(a,u);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=Oh(l))}const o=(l,c)=>Ue.forEach(l,(d,u)=>s(d,u,c));if(Ue.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Ue.isString(t)&&(t=t.trim())&&!e8(t))o(Zj(t),r);else if(Ue.isObject(t)&&Ue.isIterable(t)){let l={},c,d;for(const u of t){if(!Ue.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?Ue.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=Qd(t),t){const n=Ue.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return Qj(a);if(Ue.isFunction(r))return r.call(this,a,n);if(Ue.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Qd(t),t){const n=Ue.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||_p(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(o){if(o=Qd(o),o){const l=Ue.findKey(n,o);l&&(!r||_p(n,n[l],l,r))&&(delete n[l],a=!0)}}return Ue.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||_p(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return Ue.forEach(this,(a,s)=>{const o=Ue.findKey(n,s);if(o){r[o]=Oh(a),delete r[s];return}const l=t?t8(s):String(s).trim();l!==s&&delete r[s],r[l]=Oh(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ue.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&Ue.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[vv]=this[vv]={accessors:{}}).accessors,a=this.prototype;function s(o){const l=Qd(o);n[l]||(r8(a,o),n[l]=!0)}return Ue.isArray(t)?t.forEach(s):s(t),this}};Pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ue.reduceDescriptors(Pa.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ue.freezeMethods(Pa);function Np(e,t){const r=this||rf,n=t||r,a=Pa.from(n.headers);let s=n.data;return Ue.forEach(e,function(l){s=l.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function n4(e){return!!(e&&e.__CANCEL__)}function ld(e,t,r){Yt.call(this,e??"canceled",Yt.ERR_CANCELED,t,r),this.name="CanceledError"}Ue.inherits(ld,Yt,{__CANCEL__:!0});function a4(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Yt("Request failed with status code "+r.status,[Yt.ERR_BAD_REQUEST,Yt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function n8(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function a8(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[s];o||(o=d),r[a]=c,n[a]=d;let h=s,m=0;for(;h!==a;)m+=r[h++],h=h%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),d-o<t)return;const f=u&&d-u;return f?Math.round(m*1e3/f):void 0}}function s8(e,t){let r=0,n=1e3/t,a,s;const o=(d,u=Date.now())=>{r=u,a=null,s&&(clearTimeout(s),s=null),e(...d)};return[(...d)=>{const u=Date.now(),h=u-r;h>=n?o(d,u):(a=d,s||(s=setTimeout(()=>{s=null,o(a)},n-h)))},()=>a&&o(a)]}const r0=(e,t,r=3)=>{let n=0;const a=a8(50,250);return s8(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,d=a(c),u=o<=l;n=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},r)},bv=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},yv=e=>(...t)=>Ue.asap(()=>e(...t)),i8=ca.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ca.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ca.origin),ca.navigator&&/(msie|trident)/i.test(ca.navigator.userAgent)):()=>!0,o8=ca.hasStandardBrowserEnv?{write(e,t,r,n,a,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];Ue.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),Ue.isString(n)&&l.push(`path=${n}`),Ue.isString(a)&&l.push(`domain=${a}`),s===!0&&l.push("secure"),Ue.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function l8(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function c8(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function s4(e,t,r){let n=!l8(t);return e&&(n||r==!1)?c8(e,t):t}const wv=e=>e instanceof Pa?{...e}:e;function Wl(e,t){t=t||{};const r={};function n(d,u,h,m){return Ue.isPlainObject(d)&&Ue.isPlainObject(u)?Ue.merge.call({caseless:m},d,u):Ue.isPlainObject(u)?Ue.merge({},u):Ue.isArray(u)?u.slice():u}function a(d,u,h,m){if(Ue.isUndefined(u)){if(!Ue.isUndefined(d))return n(void 0,d,h,m)}else return n(d,u,h,m)}function s(d,u){if(!Ue.isUndefined(u))return n(void 0,u)}function o(d,u){if(Ue.isUndefined(u)){if(!Ue.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,h){if(h in t)return n(d,u);if(h in e)return n(void 0,d)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,h)=>a(wv(d),wv(u),h,!0)};return Ue.forEach(Object.keys({...e,...t}),function(u){const h=c[u]||a,m=h(e[u],t[u],u);Ue.isUndefined(m)&&h!==l||(r[u]=m)}),r}const i4=e=>{const t=Wl({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=Pa.from(o),t.url=e4(s4(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Ue.isFormData(r)){if(ca.hasStandardBrowserEnv||ca.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Ue.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([u,h])=>{d.includes(u.toLowerCase())&&o.set(u,h)})}}if(ca.hasStandardBrowserEnv&&(n&&Ue.isFunction(n)&&(n=n(t)),n||n!==!1&&i8(t.url))){const c=a&&s&&o8.read(s);c&&o.set(a,c)}return t},d8=typeof XMLHttpRequest<"u",u8=d8&&function(e){return new Promise(function(r,n){const a=i4(e);let s=a.data;const o=Pa.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,h,m,f,x;function g(){f&&f(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function y(){if(!b)return;const S=Pa.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),D={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:S,config:e,request:b};a4(function(O){r(O),g()},function(O){n(O),g()},D),b=null}"onloadend"in b?b.onloadend=y:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(y)},b.onabort=function(){b&&(n(new Yt("Request aborted",Yt.ECONNABORTED,e,b)),b=null)},b.onerror=function(_){const D=_&&_.message?_.message:"Network Error",I=new Yt(D,Yt.ERR_NETWORK,e,b);I.event=_||null,n(I),b=null},b.ontimeout=function(){let _=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const D=a.transitional||t4;a.timeoutErrorMessage&&(_=a.timeoutErrorMessage),n(new Yt(_,D.clarifyTimeoutError?Yt.ETIMEDOUT:Yt.ECONNABORTED,e,b)),b=null},s===void 0&&o.setContentType(null),"setRequestHeader"in b&&Ue.forEach(o.toJSON(),function(_,D){b.setRequestHeader(D,_)}),Ue.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),l&&l!=="json"&&(b.responseType=a.responseType),d&&([m,x]=r0(d,!0),b.addEventListener("progress",m)),c&&b.upload&&([h,f]=r0(c),b.upload.addEventListener("progress",h),b.upload.addEventListener("loadend",f)),(a.cancelToken||a.signal)&&(u=S=>{b&&(n(!S||S.type?new ld(null,e,b):S),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const N=n8(a.url);if(N&&ca.protocols.indexOf(N)===-1){n(new Yt("Unsupported protocol "+N+":",Yt.ERR_BAD_REQUEST,e));return}b.send(s||null)})},f8=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof Yt?u:new ld(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,s(new Yt(`timeout ${t} of ms exceeded`,Yt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>Ue.asap(l),c}},h8=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},m8=async function*(e,t){for await(const r of p8(e))yield*h8(r,t)},p8=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},_v=(e,t,r,n)=>{const a=m8(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let h=u.byteLength;if(r){let m=s+=h;r(m)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},Nv=64*1024,{isFunction:nh}=Ue,g8=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ue.global),{ReadableStream:kv,TextEncoder:Sv}=Ue.global,jv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},x8=e=>{e=Ue.merge.call({skipUndefined:!0},g8,e);const{fetch:t,Request:r,Response:n}=e,a=t?nh(t):typeof fetch=="function",s=nh(r),o=nh(n);if(!a)return!1;const l=a&&nh(kv),c=a&&(typeof Sv=="function"?(x=>g=>x.encode(g))(new Sv):async x=>new Uint8Array(await new r(x).arrayBuffer())),d=s&&l&&jv(()=>{let x=!1;const g=new r(ca.origin,{body:new kv,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),u=o&&l&&jv(()=>Ue.isReadableStream(new n("").body)),h={stream:u&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!h[x]&&(h[x]=(g,b)=>{let y=g&&g[x];if(y)return y.call(g);throw new Yt(`Response type '${x}' is not supported`,Yt.ERR_NOT_SUPPORT,b)})});const m=async x=>{if(x==null)return 0;if(Ue.isBlob(x))return x.size;if(Ue.isSpecCompliantForm(x))return(await new r(ca.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Ue.isArrayBufferView(x)||Ue.isArrayBuffer(x))return x.byteLength;if(Ue.isURLSearchParams(x)&&(x=x+""),Ue.isString(x))return(await c(x)).byteLength},f=async(x,g)=>{const b=Ue.toFiniteNumber(x.getContentLength());return b??m(g)};return async x=>{let{url:g,method:b,data:y,signal:N,cancelToken:S,timeout:_,onDownloadProgress:D,onUploadProgress:I,responseType:O,headers:R,withCredentials:E="same-origin",fetchOptions:B}=i4(x),C=t||fetch;O=O?(O+"").toLowerCase():"text";let M=f8([N,S&&S.toAbortSignal()],_),U=null;const F=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let ne;try{if(I&&d&&b!=="get"&&b!=="head"&&(ne=await f(R,y))!==0){let xe=new r(g,{method:"POST",body:y,duplex:"half"}),w;if(Ue.isFormData(y)&&(w=xe.headers.get("content-type"))&&R.setContentType(w),xe.body){const[A,T]=bv(ne,r0(yv(I)));y=_v(xe.body,Nv,A,T)}}Ue.isString(E)||(E=E?"include":"omit");const V=s&&"credentials"in r.prototype,ee={...B,signal:M,method:b.toUpperCase(),headers:R.normalize().toJSON(),body:y,duplex:"half",credentials:V?E:void 0};U=s&&new r(g,ee);let me=await(s?C(U,B):C(g,ee));const ye=u&&(O==="stream"||O==="response");if(u&&(D||ye&&F)){const xe={};["status","statusText","headers"].forEach(L=>{xe[L]=me[L]});const w=Ue.toFiniteNumber(me.headers.get("content-length")),[A,T]=D&&bv(w,r0(yv(D),!0))||[];me=new n(_v(me.body,Nv,A,()=>{T&&T(),F&&F()}),xe)}O=O||"text";let Oe=await h[Ue.findKey(h,O)||"text"](me,x);return!ye&&F&&F(),await new Promise((xe,w)=>{a4(xe,w,{data:Oe,headers:Pa.from(me.headers),status:me.status,statusText:me.statusText,config:x,request:U})})}catch(V){throw F&&F(),V&&V.name==="TypeError"&&/Load failed|fetch/i.test(V.message)?Object.assign(new Yt("Network Error",Yt.ERR_NETWORK,x,U),{cause:V.cause||V}):Yt.from(V,V&&V.code,x,U)}}},v8=new Map,o4=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let o=s.length,l=o,c,d,u=v8;for(;l--;)c=s[l],d=u.get(c),d===void 0&&u.set(c,d=l?new Map:x8(t)),u=d;return d};o4();const Rx={http:Fj,xhr:u8,fetch:{get:o4}};Ue.forEach(Rx,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Tv=e=>`- ${e}`,b8=e=>Ue.isFunction(e)||e===null||e===!1;function y8(e,t){e=Ue.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(a=n,!b8(n)&&(a=Rx[(l=String(n)).toLowerCase()],a===void 0))throw new Yt(`Unknown adapter '${l}'`);if(a&&(Ue.isFunction(a)||(a=a.get(t))))break;s[l||"#"+o]=a}if(!a){const o=Object.entries(s).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(Tv).join(`
`):" "+Tv(o[0]):"as no adapter specified";throw new Yt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a}const l4={getAdapter:y8,adapters:Rx};function kp(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ld(null,e)}function Av(e){return kp(e),e.headers=Pa.from(e.headers),e.data=Np.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),l4.getAdapter(e.adapter||rf.adapter,e)(e).then(function(n){return kp(e),n.data=Np.call(e,e.transformResponse,n),n.headers=Pa.from(n.headers),n},function(n){return n4(n)||(kp(e),n&&n.response&&(n.response.data=Np.call(e,e.transformResponse,n.response),n.response.headers=Pa.from(n.response.headers))),Promise.reject(n)})}const c4="1.13.1",G0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{G0[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ev={};G0.transitional=function(t,r,n){function a(s,o){return"[Axios v"+c4+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new Yt(a(o," has been removed"+(r?" in "+r:"")),Yt.ERR_DEPRECATED);return r&&!Ev[o]&&(Ev[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};G0.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function w8(e,t,r){if(typeof e!="object")throw new Yt("options must be an object",Yt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new Yt("option "+s+" must be "+c,Yt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Yt("Unknown option "+s,Yt.ERR_BAD_OPTION)}}const Ph={assertOptions:w8,validators:G0},ui=Ph.validators;let $l=class{constructor(t){this.defaults=t||{},this.interceptors={request:new xv,response:new xv}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Wl(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&Ph.assertOptions(n,{silentJSONParsing:ui.transitional(ui.boolean),forcedJSONParsing:ui.transitional(ui.boolean),clarifyTimeoutError:ui.transitional(ui.boolean)},!1),a!=null&&(Ue.isFunction(a)?r.paramsSerializer={serialize:a}:Ph.assertOptions(a,{encode:ui.function,serialize:ui.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ph.assertOptions(r,{baseUrl:ui.spelling("baseURL"),withXsrfToken:ui.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&Ue.merge(s.common,s[r.method]);s&&Ue.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),r.headers=Pa.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let u,h=0,m;if(!c){const x=[Av.bind(this),void 0];for(x.unshift(...l),x.push(...d),m=x.length,u=Promise.resolve(r);h<m;)u=u.then(x[h++],x[h++]);return u}m=l.length;let f=r;for(;h<m;){const x=l[h++],g=l[h++];try{f=x(f)}catch(b){g.call(this,b);break}}try{u=Av.call(this,f)}catch(x){return Promise.reject(x)}for(h=0,m=d.length;h<m;)u=u.then(d[h++],d[h++]);return u}getUri(t){t=Wl(this.defaults,t);const r=s4(t.baseURL,t.url,t.allowAbsoluteUrls);return e4(r,t.params,t.paramsSerializer)}};Ue.forEach(["delete","get","head","options"],function(t){$l.prototype[t]=function(r,n){return this.request(Wl(n||{},{method:t,url:r,data:(n||{}).data}))}});Ue.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(Wl(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}$l.prototype[t]=r(),$l.prototype[t+"Form"]=r(!0)});let _8=class d4{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(a);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new ld(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new d4(function(a){t=a}),cancel:t}}};function N8(e){return function(r){return e.apply(null,r)}}function k8(e){return Ue.isObject(e)&&e.isAxiosError===!0}const Pg={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Pg).forEach(([e,t])=>{Pg[t]=e});function u4(e){const t=new $l(e),r=W5($l.prototype.request,t);return Ue.extend(r,$l.prototype,t,{allOwnKeys:!0}),Ue.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return u4(Wl(e,a))},r}const nn=u4(rf);nn.Axios=$l;nn.CanceledError=ld;nn.CancelToken=_8;nn.isCancel=n4;nn.VERSION=c4;nn.toFormData=V0;nn.AxiosError=Yt;nn.Cancel=nn.CanceledError;nn.all=function(t){return Promise.all(t)};nn.spread=N8;nn.isAxiosError=k8;nn.mergeConfig=Wl;nn.AxiosHeaders=Pa;nn.formToJSON=e=>r4(Ue.isHTMLForm(e)?new FormData(e):e);nn.getAdapter=l4.getAdapter;nn.HttpStatusCode=Pg;nn.default=nn;const{Axios:noe,AxiosError:aoe,CanceledError:soe,isCancel:ioe,CancelToken:ooe,VERSION:loe,all:coe,Cancel:doe,isAxiosError:uoe,spread:foe,toFormData:hoe,AxiosHeaders:moe,HttpStatusCode:poe,formToJSON:goe,getAdapter:xoe,mergeConfig:voe}=nn,f4="http://localhost:5000/api",it=nn.create({baseURL:f4,headers:{"Content-Type":"application/json"}});it.interceptors.request.use(e=>{const t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));it.interceptors.response.use(e=>e,async e=>{var r;const t=e.config;if(((r=e.response)==null?void 0:r.status)===401&&!t._retry){t._retry=!0;try{const n=localStorage.getItem("refreshToken");if(!n)return console.error("ðŸ” Authentication required. Redirecting to login..."),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("lastActivityTime"),window.dispatchEvent(new CustomEvent("auth:logout",{detail:{reason:"no-refresh-token"}})),window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject(e);const a=await nn.post(`${f4}/auth/refresh`,{refreshToken:n}),{accessToken:s,refreshToken:o}=a.data;return localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",o),localStorage.setItem("lastActivityTime",Date.now().toString()),t.headers.Authorization=`Bearer ${s}`,it(t)}catch(n){return console.error("ðŸ” Session expired. Please log in again."),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("lastActivityTime"),window.dispatchEvent(new CustomEvent("auth:logout",{detail:{reason:"refresh-failed"}})),window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject(n)}}return Promise.reject(e)});const ki=Object.create(null);ki.open="0";ki.close="1";ki.ping="2";ki.pong="3";ki.message="4";ki.upgrade="5";ki.noop="6";const Lh=Object.create(null);Object.keys(ki).forEach(e=>{Lh[ki[e]]=e});const Lg={type:"error",data:"parser error"},h4=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",m4=typeof ArrayBuffer=="function",p4=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Mx=({type:e,data:t},r,n)=>h4&&t instanceof Blob?r?n(t):Cv(t,n):m4&&(t instanceof ArrayBuffer||p4(t))?r?n(t):Cv(new Blob([t]),n):n(ki[e]+(t||"")),Cv=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function Dv(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Sp;function S8(e,t){if(h4&&e.data instanceof Blob)return e.data.arrayBuffer().then(Dv).then(t);if(m4&&(e.data instanceof ArrayBuffer||p4(e.data)))return t(Dv(e.data));Mx(e,!1,r=>{Sp||(Sp=new TextEncoder),t(Sp.encode(r))})}const Ov="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Ov.length;e++)cu[Ov.charCodeAt(e)]=e;const j8=e=>{let t=e.length*.75,r=e.length,n,a=0,s,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const d=new ArrayBuffer(t),u=new Uint8Array(d);for(n=0;n<r;n+=4)s=cu[e.charCodeAt(n)],o=cu[e.charCodeAt(n+1)],l=cu[e.charCodeAt(n+2)],c=cu[e.charCodeAt(n+3)],u[a++]=s<<2|o>>4,u[a++]=(o&15)<<4|l>>2,u[a++]=(l&3)<<6|c&63;return d},T8=typeof ArrayBuffer=="function",Ix=(e,t)=>{if(typeof e!="string")return{type:"message",data:g4(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:A8(e.substring(1),t)}:Lh[r]?e.length>1?{type:Lh[r],data:e.substring(1)}:{type:Lh[r]}:Lg},A8=(e,t)=>{if(T8){const r=j8(e);return g4(r,t)}else return{base64:!0,data:e}},g4=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},x4="",E8=(e,t)=>{const r=e.length,n=new Array(r);let a=0;e.forEach((s,o)=>{Mx(s,!1,l=>{n[o]=l,++a===r&&t(n.join(x4))})})},C8=(e,t)=>{const r=e.split(x4),n=[];for(let a=0;a<r.length;a++){const s=Ix(r[a],t);if(n.push(s),s.type==="error")break}return n};function D8(){return new TransformStream({transform(e,t){S8(e,r=>{const n=r.length;let a;if(n<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,n);else if(n<65536){a=new Uint8Array(3);const s=new DataView(a.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{a=new Uint8Array(9);const s=new DataView(a.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(r)})}})}let jp;function ah(e){return e.reduce((t,r)=>t+r.length,0)}function sh(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let a=0;a<t;a++)r[a]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function O8(e,t){jp||(jp=new TextDecoder);const r=[];let n=0,a=-1,s=!1;return new TransformStream({transform(o,l){for(r.push(o);;){if(n===0){if(ah(r)<1)break;const c=sh(r,1);s=(c[0]&128)===128,a=c[0]&127,a<126?n=3:a===126?n=1:n=2}else if(n===1){if(ah(r)<2)break;const c=sh(r,2);a=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(ah(r)<8)break;const c=sh(r,8),d=new DataView(c.buffer,c.byteOffset,c.length),u=d.getUint32(0);if(u>Math.pow(2,21)-1){l.enqueue(Lg);break}a=u*Math.pow(2,32)+d.getUint32(4),n=3}else{if(ah(r)<a)break;const c=sh(r,a);l.enqueue(Ix(s?c:jp.decode(c),t)),n=0}if(a===0||a>e){l.enqueue(Lg);break}}}})}const v4=4;function yn(e){if(e)return P8(e)}function P8(e){for(var t in yn.prototype)e[t]=yn.prototype[t];return e}yn.prototype.on=yn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};yn.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};yn.prototype.off=yn.prototype.removeListener=yn.prototype.removeAllListeners=yn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,a=0;a<r.length;a++)if(n=r[a],n===t||n.fn===t){r.splice(a,1);break}return r.length===0&&delete this._callbacks["$"+e],this};yn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,a=r.length;n<a;++n)r[n].apply(this,t)}return this};yn.prototype.emitReserved=yn.prototype.emit;yn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};yn.prototype.hasListeners=function(e){return!!this.listeners(e).length};const K0=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),ws=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),L8="arraybuffer";function b4(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const F8=ws.setTimeout,$8=ws.clearTimeout;function X0(e,t){t.useNativeTimers?(e.setTimeoutFn=F8.bind(ws),e.clearTimeoutFn=$8.bind(ws)):(e.setTimeoutFn=ws.setTimeout.bind(ws),e.clearTimeoutFn=ws.clearTimeout.bind(ws))}const R8=1.33;function M8(e){return typeof e=="string"?I8(e):Math.ceil((e.byteLength||e.size)*R8)}function I8(e){let t=0,r=0;for(let n=0,a=e.length;n<a;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function y4(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function B8(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function U8(e){let t={},r=e.split("&");for(let n=0,a=r.length;n<a;n++){let s=r[n].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}class W8 extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class Bx extends yn{constructor(t){super(),this.writable=!1,X0(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new W8(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Ix(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=B8(t);return r.length?"?"+r:""}}class z8 extends Bx{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};C8(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,E8(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=y4()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let w4=!1;try{w4=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const H8=w4;function q8(){}class Y8 extends z8{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(a,s)=>{this.onError("xhr post error",a,s)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class yi extends yn{constructor(t,r,n){super(),this.createRequest=t,X0(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=b4(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&n.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var a;n.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=yi.requestsCount++,yi.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=q8,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete yi.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}yi.requestsCount=0;yi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Pv);else if(typeof addEventListener=="function"){const e="onpagehide"in ws?"pagehide":"unload";addEventListener(e,Pv,!1)}}function Pv(){for(let e in yi.requests)yi.requests.hasOwnProperty(e)&&yi.requests[e].abort()}const V8=function(){const e=_4({xdomain:!1});return e&&e.responseType!==null}();class G8 extends Y8{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=V8&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new yi(_4,this.uri(),t)}}function _4(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||H8))return new XMLHttpRequest}catch{}if(!t)try{return new ws[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const N4=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class K8 extends Bx{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=N4?{}:b4(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],a=r===t.length-1;Mx(n,this.supportsBinary,s=>{try{this.doWrite(n,s)}catch{}a&&K0(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=y4()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const Tp=ws.WebSocket||ws.MozWebSocket;class X8 extends K8{createSocket(t,r,n){return N4?new Tp(t,r,n):r?new Tp(t,r):new Tp(t)}doWrite(t,r){this.ws.send(r)}}class J8 extends Bx{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=O8(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),a=D8();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const s=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),s())}).catch(l=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],a=r===t.length-1;this._writer.write(n).then(()=>{a&&K0(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Z8={websocket:X8,webtransport:J8,polling:G8},Q8=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eT=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Fg(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let a=Q8.exec(e||""),s={},o=14;for(;o--;)s[eT[o]]=a[o]||"";return r!=-1&&n!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=tT(s,s.path),s.queryKey=rT(s,s.query),s}function tT(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function rT(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,a,s){a&&(r[a]=s)}),r}const $g=typeof addEventListener=="function"&&typeof removeEventListener=="function",Fh=[];$g&&addEventListener("offline",()=>{Fh.forEach(e=>e())},!1);class qo extends yn{constructor(t,r){if(super(),this.binaryType=L8,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=Fg(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=Fg(r.host).host);X0(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const a=n.prototype.name;this.transports.push(a),this._transportsByName[a]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=U8(this.opts.query)),$g&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Fh.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=v4,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&qo.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",qo.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const a=this.writeBuffer[n].data;if(a&&(r+=M8(a)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,K0(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,a){if(typeof r=="function"&&(a=r,r=void 0),typeof n=="function"&&(a=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const s={type:t,data:r,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(qo.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),$g&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Fh.indexOf(this._offlineEventListener);n!==-1&&Fh.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}qo.protocol=v4;class nT extends qo{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;qo.priorWebsocketSuccess=!1;const a=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;qo.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=r.name,this.emitReserved("upgradeError",m)}}))};function s(){n||(n=!0,u(),r.close(),r=null)}const o=h=>{const m=new Error("probe error: "+h);m.transport=r.name,s(),this.emitReserved("upgradeError",m)};function l(){o("transport closed")}function c(){o("socket closed")}function d(h){r&&h.name!==r.name&&s()}const u=()=>{r.removeListener("open",a),r.removeListener("error",o),r.removeListener("close",l),this.off("close",c),this.off("upgrading",d)};r.once("open",a),r.once("error",o),r.once("close",l),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let aT=class extends nT{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(a=>Z8[a]).filter(a=>!!a)),super(t,n)}};function sT(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=Fg(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+t,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}const iT=typeof ArrayBuffer=="function",oT=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,k4=Object.prototype.toString,lT=typeof Blob=="function"||typeof Blob<"u"&&k4.call(Blob)==="[object BlobConstructor]",cT=typeof File=="function"||typeof File<"u"&&k4.call(File)==="[object FileConstructor]";function Ux(e){return iT&&(e instanceof ArrayBuffer||oT(e))||lT&&e instanceof Blob||cT&&e instanceof File}function $h(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if($h(e[r]))return!0;return!1}if(Ux(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return $h(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&$h(e[r]))return!0;return!1}function dT(e){const t=[],r=e.data,n=e;return n.data=Rg(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Rg(e,t){if(!e)return e;if(Ux(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Rg(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Rg(e[n],t));return r}return e}function uT(e,t){return e.data=Mg(e.data,t),delete e.attachments,e}function Mg(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Mg(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Mg(e[r],t));return e}const fT=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],hT=5;var rr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(rr||(rr={}));class mT{constructor(t){this.replacer=t}encode(t){return(t.type===rr.EVENT||t.type===rr.ACK)&&$h(t)?this.encodeAsBinary({type:t.type===rr.EVENT?rr.BINARY_EVENT:rr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===rr.BINARY_EVENT||t.type===rr.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=dT(t),n=this.encodeAsString(r.packet),a=r.buffers;return a.unshift(n),a}}function Lv(e){return Object.prototype.toString.call(e)==="[object Object]"}class Wx extends yn{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===rr.BINARY_EVENT;n||r.type===rr.BINARY_ACK?(r.type=n?rr.EVENT:rr.ACK,this.reconstructor=new pT(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Ux(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(rr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===rr.BINARY_EVENT||n.type===rr.BINARY_ACK){const s=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(s,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(t.charAt(r+1)==="/"){const s=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(s,r)}else n.nsp="/";const a=t.charAt(r+1);if(a!==""&&Number(a)==a){const s=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}n.id=Number(t.substring(s,r+1))}if(t.charAt(++r)){const s=this.tryParse(t.substr(r));if(Wx.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case rr.CONNECT:return Lv(r);case rr.DISCONNECT:return r===void 0;case rr.CONNECT_ERROR:return typeof r=="string"||Lv(r);case rr.EVENT:case rr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&fT.indexOf(r[0])===-1);case rr.ACK:case rr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class pT{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=uT(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const gT=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Wx,Encoder:mT,get PacketType(){return rr},protocol:hT},Symbol.toStringTag,{value:"Module"}));function Vs(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const xT=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class S4 extends yn{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Vs(t,"open",this.onopen.bind(this)),Vs(t,"packet",this.onpacket.bind(this)),Vs(t,"error",this.onerror.bind(this)),Vs(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,a,s;if(xT.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:rr.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,h=r.pop();this._registerAckCallback(u,h),o.id=u}const l=(a=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||a===void 0?void 0:a.writable,c=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var n;const a=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(a===void 0){this.acks[t]=r;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===t&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},a),o=(...l)=>{this.io.clearTimeoutFn(s),r.apply(this,l)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((n,a)=>{const s=(o,l)=>o?a(o):n(l);s.withError=!0,r.push(s),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...s)=>n!==this._queue[0]?void 0:(a!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(a)):(this._queue.shift(),r&&r(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:rr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case rr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case rr.EVENT:case rr.BINARY_EVENT:this.onevent(t);break;case rr.ACK:case rr.BINARY_ACK:this.onack(t);break;case rr.DISCONNECT:this.ondisconnect();break;case rr.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...a){n||(n=!0,r.packet({type:rr.ACK,id:t,data:a}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:rr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function cd(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}cd.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};cd.prototype.reset=function(){this.attempts=0};cd.prototype.setMin=function(e){this.ms=e};cd.prototype.setMax=function(e){this.max=e};cd.prototype.setJitter=function(e){this.jitter=e};class Ig extends yn{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,X0(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new cd({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const a=r.parser||gT;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new aT(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const a=Vs(r,"open",function(){n.onopen(),t&&t()}),s=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),t?t(l):this.maybeReconnectOnOpen()},o=Vs(r,"error",s);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{a(),s(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(a),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Vs(t,"ping",this.onping.bind(this)),Vs(t,"data",this.ondata.bind(this)),Vs(t,"error",this.onerror.bind(this)),Vs(t,"close",this.onclose.bind(this)),Vs(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){K0(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new S4(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const eu={};function Rh(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=sT(e,t.path||"/socket.io"),n=r.source,a=r.id,s=r.path,o=eu[a]&&s in eu[a].nsps,l=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return l?c=new Ig(n,t):(eu[a]||(eu[a]=new Ig(n,t)),c=eu[a]),r.query&&!t.query&&(t.query=r.queryKey),c.socket(r.path,t)}Object.assign(Rh,{Manager:Ig,Socket:S4,io:Rh,connect:Rh});class vT{constructor(){this.permission="default",this.isSupported="Notification"in window}isNotificationSupported(){return this.isSupported}getPermissionStatus(){return this.isSupported?Notification.permission:"unsupported"}async requestPermission(){if(!this.isSupported)return"unsupported";try{const t=await Notification.requestPermission();return this.permission=t,t==="granted"?(console.log("âœ… Notification permission granted"),await this.showNotification("ðŸŽ‰ Notifications Enabled!",{body:"You will now receive task updates and reminders.",icon:"/icons/pwa-192x192.png",badge:"/icons/pwa-64x64.png",tag:"welcome",requireInteraction:!1,vibrate:[200,100,200]})):t==="denied"?console.warn("âš ï¸ Notification permission denied"):console.log("â„¹ï¸ Notification permission dismissed"),t}catch(t){return console.error("âŒ Error requesting notification permission:",t),"error"}}async showNotification(t,r={}){if(!this.isSupported||Notification.permission!=="granted")return null;try{const a={...{icon:"/icons/pwa-192x192.png",badge:"/icons/pwa-64x64.png",vibrate:[200,100,200],requireInteraction:!1,silent:!1},...r};if("serviceWorker"in navigator&&navigator.serviceWorker.controller)try{return await(await navigator.serviceWorker.ready).showNotification(t,a)}catch{}const s=new Notification(t,a);return s.onclick=()=>{window.focus(),s.close()},s}catch(n){return console.error("Error showing notification:",n),null}}async showTaskNotification(t,r){const a={created:{title:"ðŸ“ New Task Created",body:`Task: ${r.title}`,icon:"/icons/pwa-192x192.png",tag:`task-${r._id}`,data:{type:"task",action:"created",taskId:r._id}},updated:{title:"ðŸ”„ Task Updated",body:`Task "${r.title}" has been updated`,icon:"/icons/pwa-192x192.png",tag:`task-${r._id}`,data:{type:"task",action:"updated",taskId:r._id}},assigned:{title:"ðŸ‘¤ Task Assigned to You",body:`You've been assigned: ${r.title}`,icon:"/icons/pwa-192x192.png",tag:`task-${r._id}`,requireInteraction:!0,data:{type:"task",action:"assigned",taskId:r._id}},due:{title:"â° Task Due Soon",body:`"${r.title}" is due soon`,icon:"/icons/pwa-192x192.png",tag:`task-due-${r._id}`,requireInteraction:!0,data:{type:"task",action:"due",taskId:r._id}},overdue:{title:"ðŸš¨ Task Overdue",body:`"${r.title}" is overdue!`,icon:"/icons/pwa-192x192.png",tag:`task-overdue-${r._id}`,requireInteraction:!0,vibrate:[200,100,200,100,200],data:{type:"task",action:"overdue",taskId:r._id}},comment:{title:"ðŸ’¬ New Comment",body:`New comment on "${r.title}"`,icon:"/icons/pwa-192x192.png",tag:`task-comment-${r._id}`,data:{type:"task",action:"comment",taskId:r._id}}}[t];a&&await this.showNotification(a.title,{body:a.body,icon:a.icon,badge:a.badge||"/icons/pwa-64x64.png",tag:a.tag,requireInteraction:a.requireInteraction,vibrate:a.vibrate,data:a.data,actions:[{action:"view",title:"View Task",icon:"/icons/pwa-64x64.png"},{action:"close",title:"Close",icon:"/icons/pwa-64x64.png"}]})}async closeNotification(t){"serviceWorker"in navigator&&navigator.serviceWorker.controller&&(await(await navigator.serviceWorker.ready).getNotifications({tag:t})).forEach(a=>a.close())}async closeAllNotifications(){"serviceWorker"in navigator&&navigator.serviceWorker.controller&&(await(await navigator.serviceWorker.ready).getNotifications()).forEach(n=>n.close())}scheduleNotification(t,r,n){return setTimeout(()=>{this.showNotification(t,r)},n)}checkOverdueTasks(t){const r=new Date;t.forEach(n=>{n.due_date&&n.status!=="done"&&n.status!=="archived"&&new Date(n.due_date)<r&&this.showTaskNotification("overdue",n)})}checkTasksDueSoon(t){const r=new Date,n=new Date(r.getTime()+24*60*60*1e3);t.forEach(a=>{if(a.due_date&&a.status!=="done"&&a.status!=="archived"){const s=new Date(a.due_date);s>r&&s<n&&this.showTaskNotification("due",a)}})}}const es=new vT,j4=J.createContext(null),bT=({children:e})=>{const[t,r]=J.useState(null),[n,a]=J.useState(!0),[s,o]=J.useState(null);J.useEffect(()=>{const f=localStorage.getItem("user"),x=localStorage.getItem("accessToken");f&&x&&(r(JSON.parse(f)),l(JSON.parse(f).id)),a(!1)},[]);const l=f=>{const g=Rh("http://localhost:5000");g.on("connect",()=>{g.emit("join",f)}),g.on("disconnect",()=>{}),o(g)},m={user:t,loading:n,socket:s,login:async(f,x)=>{var g;try{const b=await it.post("/auth/login",{email:f,password:x}),{user:y,workspace:N,accessToken:S,refreshToken:_}=b.data,D={...y,workspace:N};return localStorage.setItem("user",JSON.stringify(D)),localStorage.setItem("accessToken",S),localStorage.setItem("refreshToken",_),r(D),l(y.id),{success:!0}}catch(b){const y=(g=b.response)==null?void 0:g.data;return{success:!1,message:(y==null?void 0:y.message)||"Login failed",requiresVerification:(y==null?void 0:y.requiresVerification)||!1}}},register:async(f,x,g,b="member")=>{var y,N;try{const S=await it.post("/auth/register",{full_name:f,email:x,password:g,role:b}),{user:_,accessToken:D,refreshToken:I}=S.data;return localStorage.setItem("user",JSON.stringify(_)),localStorage.setItem("accessToken",D),localStorage.setItem("refreshToken",I),r(_),l(_.id),{success:!0}}catch(S){return{success:!1,message:((N=(y=S.response)==null?void 0:y.data)==null?void 0:N.message)||"Registration failed"}}},logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("lastActivityTime"),r(null),s&&(s.disconnect(),o(null))},updateUser:f=>{const x={...t,...f};r(x),localStorage.setItem("user",JSON.stringify(x))}};return i.jsx(j4.Provider,{value:m,children:e})},pn=()=>{const e=J.useContext(j4);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},T4=J.createContext(),Lr=()=>{const e=J.useContext(T4);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},yT=({children:e})=>{const[t,r]=J.useState(()=>localStorage.getItem("theme")||"light"),[n,a]=J.useState(()=>localStorage.getItem("colorScheme")||"blue"),s={blue:{name:"Blue",primary:"bg-blue-600",primaryHex:"#2563eb",primaryHover:"hover:bg-blue-700",primaryLight:"bg-blue-50",primaryText:"text-blue-600",accent:"bg-blue-500",accentHover:"hover:bg-blue-600",secondary:"bg-green-600",secondaryHover:"hover:bg-green-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-green-500"},purple:{name:"Purple",primary:"bg-purple-600",primaryHex:"#9333ea",primaryHover:"hover:bg-purple-700",primaryLight:"bg-purple-50",primaryText:"text-purple-600",accent:"bg-purple-500",accentHover:"hover:bg-purple-600",secondary:"bg-indigo-600",secondaryHover:"hover:bg-indigo-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-green-500"},green:{name:"Green",primary:"bg-green-600",primaryHex:"#16a34a",primaryHover:"hover:bg-green-700",primaryLight:"bg-green-50",primaryText:"text-green-600",accent:"bg-green-500",accentHover:"hover:bg-green-600",secondary:"bg-blue-600",secondaryHover:"hover:bg-blue-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-emerald-500"},orange:{name:"Orange",primary:"bg-orange-600",primaryHex:"#ea580c",primaryHover:"hover:bg-orange-700",primaryLight:"bg-orange-50",primaryText:"text-orange-600",accent:"bg-orange-500",accentHover:"hover:bg-orange-600",secondary:"bg-blue-600",secondaryHover:"hover:bg-blue-700",warning:"bg-amber-500",danger:"bg-red-500",success:"bg-green-500"},pink:{name:"Pink",primary:"bg-pink-600",primaryHex:"#db2777",primaryHover:"hover:bg-pink-700",primaryLight:"bg-pink-50",primaryText:"text-pink-600",accent:"bg-pink-500",accentHover:"hover:bg-pink-600",secondary:"bg-purple-600",secondaryHover:"hover:bg-purple-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-green-500"},teal:{name:"Teal",primary:"bg-teal-600",primaryHex:"#0d9488",primaryHover:"hover:bg-teal-700",primaryLight:"bg-teal-50",primaryText:"text-teal-600",accent:"bg-teal-500",accentHover:"hover:bg-teal-600",secondary:"bg-cyan-600",secondaryHover:"hover:bg-cyan-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-emerald-500"},indigo:{name:"Indigo",primary:"bg-indigo-600",primaryHex:"#4f46e5",primaryHover:"hover:bg-indigo-700",primaryLight:"bg-indigo-50",primaryText:"text-indigo-600",accent:"bg-indigo-500",accentHover:"hover:bg-indigo-600",secondary:"bg-blue-600",secondaryHover:"hover:bg-blue-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-green-500"},rose:{name:"Rose",primary:"bg-rose-600",primaryHex:"#e11d48",primaryHover:"hover:bg-rose-700",primaryLight:"bg-rose-50",primaryText:"text-rose-600",accent:"bg-rose-500",accentHover:"hover:bg-rose-600",secondary:"bg-pink-600",secondaryHover:"hover:bg-pink-700",warning:"bg-amber-500",danger:"bg-red-500",success:"bg-green-500"},cyan:{name:"Cyan",primary:"bg-cyan-600",primaryHex:"#0891b2",primaryHover:"hover:bg-cyan-700",primaryLight:"bg-cyan-50",primaryText:"text-cyan-600",accent:"bg-cyan-500",accentHover:"hover:bg-cyan-600",secondary:"bg-blue-600",secondaryHover:"hover:bg-blue-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-teal-500"},emerald:{name:"Emerald",primary:"bg-emerald-600",primaryHex:"#059669",primaryHover:"hover:bg-emerald-700",primaryLight:"bg-emerald-50",primaryText:"text-emerald-600",accent:"bg-emerald-500",accentHover:"hover:bg-emerald-600",secondary:"bg-teal-600",secondaryHover:"hover:bg-teal-700",warning:"bg-yellow-500",danger:"bg-red-500",success:"bg-green-500"}},l=(()=>{const f=s[n].primary.split("-")[1];return{light:{name:"Light",background:"bg-gray-50",surface:"bg-white",surfaceSecondary:"bg-gray-100",text:"text-gray-900",textSecondary:"text-gray-600",textMuted:"text-gray-500",border:"border-gray-300",borderSecondary:"border-gray-400",shadow:"shadow-md",hover:"hover:bg-gray-50",focus:`focus:ring-${f}-500`},dark:{name:"Dark",background:"bg-gray-900",surface:"bg-gray-800",surfaceSecondary:"bg-gray-700",text:"text-white",textSecondary:"text-gray-300",textMuted:"text-gray-400",border:"border-gray-700",borderSecondary:"border-gray-600",shadow:"shadow-lg shadow-gray-900/50",hover:"hover:bg-gray-700",focus:`focus:ring-${f}-400`},auto:{name:"Auto"}}})(),c=()=>t==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches?l.dark:l.light:l[t];J.useEffect(()=>{const f=c(),x=document.documentElement,g=s[n];f.name==="Dark"?x.classList.add("dark"):x.classList.remove("dark"),g.primaryHex&&x.style.setProperty("--color-primary",g.primaryHex),localStorage.setItem("theme",t)},[t,n]),J.useEffect(()=>{localStorage.setItem("colorScheme",n)},[n]),J.useEffect(()=>{if(t==="auto"){const f=window.matchMedia("(prefers-color-scheme: dark)"),x=()=>{const g=document.documentElement;f.matches?g.classList.add("dark"):g.classList.remove("dark")};return x(),f.addEventListener("change",x),()=>f.removeEventListener("change",x)}},[t]);const d=()=>{const f=["light","dark","auto"],g=(f.indexOf(t)+1)%f.length;r(f[g])},u=f=>{r(f)},h=f=>{a(f)},m={theme:t,colorScheme:n,currentTheme:c(),currentColorScheme:s[n],themes:l,colorSchemes:s,toggleTheme:d,setThemeMode:u,setColorSchemeMode:h};return i.jsx(T4.Provider,{value:m,children:e})},A4=J.createContext(),Mn=()=>{const e=J.useContext(A4);if(!e)throw new Error("useSidebar must be used within a SidebarProvider");return e},wT=({children:e})=>{const[t,r]=J.useState(!1),[n,a]=J.useState(!1),[s,o]=J.useState(!1);J.useEffect(()=>{const u=()=>{a(window.innerWidth<1024),window.innerWidth>=1024&&r(!1)},h=localStorage.getItem("sidebarCollapsed");return h!==null&&o(JSON.parse(h)),u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const l=()=>{r(!t)},c=()=>{r(!1)},d=()=>{const u=!s;o(u),localStorage.setItem("sidebarCollapsed",JSON.stringify(u))};return i.jsx(A4.Provider,{value:{isMobileOpen:t,isMobile:n,isCollapsed:s,toggleMobileSidebar:l,closeMobileSidebar:c,toggleCollapse:d},children:e})},na=({children:e,allowedRoles:t=[],requireSystemAdmin:r=!1})=>{const{user:n,loading:a}=pn();return a?i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsx("div",{className:"animate-spin-fast rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600"}),i.jsx("p",{className:"text-blue-600 font-medium",children:"Loading..."})]})}):n?t.length>0&&!t.includes(n.role)?i.jsx(bp,{to:"/dashboard",replace:!0}):r&&!(n.isSystemAdmin||!n.workspaceId&&n.role==="admin")?i.jsx(bp,{to:"/dashboard",replace:!0}):e:i.jsx(bp,{to:"/login",replace:!0})},_T=()=>{const{user:e,socket:t}=pn(),r=J.useRef(Date.now()),n=J.useRef([]),a=J.useRef(!1),s=async()=>{if(a.current||n.current.length===0)return;a.current=!0;const c=n.current.shift();c&&es.getPermissionStatus()==="granted"&&(await es.showTaskNotification(c.type,c.task),await new Promise(d=>setTimeout(d,1e3))),a.current=!1,n.current.length>0&&s()},o=(c,d)=>{const u=JSON.parse(localStorage.getItem("notificationSettings")||"{}"),h={created:"taskCreated",updated:"taskUpdated",assigned:"taskAssigned",comment:"newComment",due:"dueDateReminder",overdue:"dueDateReminder",status_changed:"statusChanged"}[c];if(h&&u[h]===!1)return;const m=Date.now();m-r.current<2e3&&n.current.some(x=>x.type===c&&x.task._id===d._id)||(r.current=m,n.current.push({type:c,task:d}),s())};return J.useEffect(()=>{if(!e)return;if(!es.isNotificationSupported()){console.warn("Notifications not supported in this browser");return}const c=es.getPermissionStatus();if(console.log("Notification permission status:",c),t){const d=g=>{console.log("Received notification:",g),g.type==="task_assigned"&&g.task?o("assigned",g.task):g.type==="status_changed"&&g.task&&o("updated",g.task)},u=g=>{console.log("Task created event:",g),o("created",g)},h=g=>{var N,S;console.log("Task updated event:",g);const b=(N=g.assigned_to)==null?void 0:N.some(_=>_._id===e.id||_===e.id),y=((S=g.created_by)==null?void 0:S._id)===e.id||g.created_by===e.id;(b||y)&&o("updated",g)},m=g=>{console.log("Task assigned event:",g);const b=g.task||g;(b.assigned_to||[]).some(S=>{const _=S._id||S;return _===e.id||_.toString()===e.id.toString()})&&o("assigned",b)},f=g=>{var D,I;console.log("Comment added event:",g);const b=g.task||g,y=(D=b.assigned_to)==null?void 0:D.some(O=>O._id===e.id||O===e.id),N=((I=b.created_by)==null?void 0:I._id)===e.id||b.created_by===e.id,S=g.comment_by||g.user_id,_=S===e.id||(S==null?void 0:S.toString())===e.id.toString();(y||N)&&!_&&o("comment",b)};t.on("notification:new",d),t.on("task:created",u),t.on("task:updated",h),t.on("task:assigned",m),t.on("comment:added",f);const x=setInterval(()=>{t.connected?console.log("Socket connected, notification system active"):console.warn("Socket disconnected, notifications may not work")},3e4);return()=>{t.off("notification:new",d),t.off("task:created",u),t.off("task:updated",h),t.off("task:assigned",m),t.off("comment:added",f),clearInterval(x)}}},[e,t]),J.useEffect(()=>{let c=null;const d=async()=>{try{"wakeLock"in navigator&&(c=await navigator.wakeLock.request("screen"),console.log("Wake lock acquired for better notifications"))}catch(u){console.log("Wake lock not available:",u)}};return document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&!c&&d()}),()=>{c&&c.release()}},[]),{testNotification:async()=>{es.getPermissionStatus()!=="granted"&&await es.requestPermission(),await es.showNotification("Test Notification",{body:"This is a test notification from TaskFlow! If you see this, notifications are working correctly.",icon:"/icons/pwa-192x192.png",tag:"test",requireInteraction:!0,vibrate:[200,100,200]})},isSupported:es.isNotificationSupported(),permission:es.getPermissionStatus()}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kT=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),xt=(e,t)=>{const r=J.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>J.createElement("svg",{ref:u,...NT,width:a,height:a,stroke:n,strokeWidth:o?Number(s)*24/Number(a):s,className:["lucide",`lucide-${kT(e)}`,l].join(" "),...d},[...t.map(([h,m])=>J.createElement(h,m)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ap=xt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=xt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=xt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=xt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=xt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=xt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zx=xt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=xt("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=xt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=xt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=xt("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=xt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AT=xt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=xt("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=xt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=xt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=xt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=xt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=xt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=xt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=xt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=xt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=xt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=xt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=xt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=xt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=xt("FileJson",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=xt("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=xt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=xt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=xt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=xt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PT=xt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LT=xt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=xt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=xt("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=xt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=xt("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=xt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=xt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=xt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=xt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=xt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=xt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=xt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=xt("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=xt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=xt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=xt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=xt("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=xt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=xt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IT=xt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=xt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=xt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=xt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=xt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=xt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=xt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=xt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=xt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=xt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=xt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=xt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=xt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=xt("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=xt("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=xt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=xt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=xt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),HT=()=>{var _,D;const e=Cs(),t=Px(),{login:r}=pn(),{theme:n}=Lr(),[a,s]=J.useState({email:((_=t.state)==null?void 0:_.email)||"",password:""}),[o,l]=J.useState(""),[c,d]=J.useState(((D=t.state)==null?void 0:D.message)||""),[u,h]=J.useState(!1),[m,f]=J.useState(!1),[x,g]=J.useState(!1),[b,y]=J.useState(!1);J.useEffect(()=>{if(c){const I=setTimeout(()=>d(""),5e3);return()=>clearTimeout(I)}},[c]);const N=async I=>{I.preventDefault(),l(""),h(!1),f(!0);const O=await r(a.email,a.password);O.success?e("/dashboard"):(l(O.message),O.requiresVerification&&h(!0)),f(!1)},S=I=>{s({...a,[I.target.name]:I.target.value})};return i.jsx("div",{className:`relative flex min-h-screen w-full flex-col ${n==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"flex h-full grow flex-col items-center justify-center p-4 sm:p-6",children:[i.jsxs("div",{className:`w-full max-w-[440px] flex flex-col rounded border ${n==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} shadow-lg overflow-hidden`,children:[i.jsx("div",{className:"px-8 pt-10 pb-6 flex flex-col gap-3",children:i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("h1",{className:`text-3xl font-bold tracking-tight ${n==="dark"?"text-white":"text-gray-900"}`,children:"TaskFlow"}),i.jsx("p",{className:`${n==="dark"?"text-[#9da8b9]":"text-gray-600"} text-sm font-normal`,children:"Welcome back. Please enter your details."})]})}),i.jsxs("form",{onSubmit:N,className:"px-8 pb-10 flex flex-col gap-5",children:[c&&i.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded-lg flex items-start gap-3",children:[i.jsx(da,{size:20,className:"flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-sm",children:c})]}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsx("label",{className:`${n==="dark"?"text-white":"text-gray-900"} text-sm font-medium`,children:"Work Email"}),i.jsx("input",{type:"email",name:"email",value:a.email,onChange:S,className:`flex w-full min-w-0 resize-none overflow-hidden rounded ${n==="dark"?"text-white border-[#282f39] bg-[#111418] placeholder:text-[#9da8b9]":"text-gray-900 border-gray-300 bg-white placeholder:text-gray-400"} focus:outline-0 focus:ring-2 focus:ring-[#136dec] border focus:border-[#136dec] h-12 px-4 text-base font-normal transition-colors`,placeholder:"name@company.com",required:!0,"data-testid":"login-email"})]}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsx("label",{className:`${n==="dark"?"text-white":"text-gray-900"} text-sm font-medium`,children:"Password"}),i.jsxs("div",{className:"relative flex w-full items-stretch rounded",children:[i.jsx("input",{type:x?"text":"password",name:"password",value:a.password,onChange:S,className:`flex w-full min-w-0 resize-none overflow-hidden rounded ${n==="dark"?"text-white border-[#282f39] bg-[#111418] placeholder:text-[#9da8b9]":"text-gray-900 border-gray-300 bg-white placeholder:text-gray-400"} focus:outline-0 focus:ring-2 focus:ring-[#136dec] border focus:border-[#136dec] h-12 px-4 pr-12 text-base font-normal transition-colors`,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,"data-testid":"login-password"}),i.jsx("div",{className:"absolute right-0 top-0 h-full flex items-center pr-3",children:i.jsx("button",{type:"button",onClick:()=>g(!x),className:`${n==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors focus:outline-none`,children:x?i.jsx(to,{className:"w-5 h-5"}):i.jsx(js,{className:"w-5 h-5"})})})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-y-2 mt-1",children:[i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[i.jsx("input",{type:"checkbox",checked:b,onChange:I=>y(I.target.checked),className:`h-4 w-4 rounded ${n==="dark"?"border-[#282f39]":"border-gray-300"} bg-transparent text-[#136dec] focus:ring-[#136dec] focus:ring-offset-0 transition-colors cursor-pointer`}),i.jsx("span",{className:`${n==="dark"?"text-[#9da8b9] group-hover:text-white":"text-gray-600 group-hover:text-gray-900"} text-sm font-normal transition-colors`,children:"Remember for 30 days"})]}),i.jsx(vi,{to:"/forgot-password",className:"text-[#136dec] text-sm font-medium hover:text-blue-400 hover:underline transition-colors",children:"Forgot password?"})]}),o&&i.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 p-3 rounded-lg text-sm flex items-start gap-3","data-testid":"login-error",children:[i.jsx(Ss,{size:20,className:"flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{children:o}),u&&i.jsx("button",{type:"button",onClick:()=>e("/verify-email",{state:{email:a.email}}),className:"mt-2 text-red-600 dark:text-red-400 underline hover:text-red-800 dark:hover:text-red-300 font-semibold",children:"Go to verification page â†’"})]})]}),i.jsx("button",{type:"submit",disabled:m,className:`flex w-full items-center justify-center rounded bg-[#136dec] h-12 px-5 text-white text-base font-bold hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-[#136dec] focus:ring-offset-2 ${n==="dark"?"focus:ring-offset-[#111418]":"focus:ring-offset-white"} transition-all mt-2 shadow-sm disabled:opacity-50 disabled:cursor-not-allowed`,"data-testid":"login-submit",children:m?"Signing in...":"Sign in"}),i.jsxs("div",{className:"pt-2 text-center space-y-2",children:[i.jsxs("p",{className:`${n==="dark"?"text-[#9da8b9]":"text-gray-600"} text-sm font-normal`,children:["Need a workspace?",i.jsx(vi,{to:"/register-community",className:"text-[#136dec] font-medium hover:underline ml-1",children:"Create Community Workspace"})]}),i.jsx("p",{className:`${n==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs font-normal`,children:"Already have an invitation? Contact your administrator"})]})]})]}),i.jsx("div",{className:"mt-8 flex flex-col items-center gap-4",children:i.jsx("p",{className:`text-xs ${n==="dark"?"text-[#9da8b9]":"text-gray-600"} font-normal`,children:"Â© 2025 TaskFlow. Enterprise Edition."})})]})})},Hv=()=>{const e=Cs(),{login:t}=pn(),[r,n]=J.useState({workspace_name:"",full_name:"",email:"",password:"",confirmPassword:""}),[a,s]=J.useState({}),[o,l]=J.useState(!1),[c,d]=J.useState(""),u=f=>{const{name:x,value:g}=f.target;n(b=>({...b,[x]:g})),a[x]&&s(b=>({...b,[x]:""}))},h=()=>{const f={};return r.workspace_name.trim()?r.workspace_name.length<3&&(f.workspace_name="Workspace name must be at least 3 characters"):f.workspace_name="Workspace name is required",r.full_name.trim()||(f.full_name="Full name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(f.email="Email is invalid"):f.email="Email is required",r.password?r.password.length<6&&(f.password="Password must be at least 6 characters"):f.password="Password is required",r.password!==r.confirmPassword&&(f.confirmPassword="Passwords do not match"),s(f),Object.keys(f).length===0},m=async f=>{var x,g,b,y;if(f.preventDefault(),d(""),!!h()){l(!0);try{const N=await it.post("/auth/register-community",{workspace_name:r.workspace_name,full_name:r.full_name,email:r.email,password:r.password});if(N.data.requiresVerification)e("/verify-email",{state:{email:r.email,message:N.data.message}});else{const{user:S,workspace:_,accessToken:D,refreshToken:I}=N.data;localStorage.setItem("accessToken",D),localStorage.setItem("refreshToken",I),localStorage.setItem("user",JSON.stringify(S)),localStorage.setItem("workspace",JSON.stringify(_)),e("/dashboard"),window.location.reload()}}catch(N){if(console.error("Community registration error:",N),(g=(x=N.response)==null?void 0:x.data)!=null&&g.message)d(N.response.data.message);else if((y=(b=N.response)==null?void 0:b.data)!=null&&y.errors){const S={};N.response.data.errors.forEach(_=>{S[_.path||_.param]=_.msg}),s(S)}else d("Failed to create workspace. Please try again.")}finally{l(!1)}}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-100 via-white to-blue-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-4xl font-bold text-purple-600 dark:text-purple-400 mb-2",children:"TaskFlow"}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create Your Free Community Workspace"})]}),i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[i.jsx("span",{className:"px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-sm font-medium rounded-full",children:"FREE"}),i.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"No credit card required"})]}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Get Started"}),i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:"Includes: Up to 10 users â€¢ 100 tasks â€¢ 3 teams"})]}),c&&i.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 rounded",children:c}),i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"workspace_name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Workspace Name *"}),i.jsx("input",{type:"text",id:"workspace_name",name:"workspace_name",value:r.workspace_name,onChange:u,placeholder:"e.g., Acme Inc",className:`w-full px-4 py-2 border ${a.workspace_name?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white`,disabled:o}),a.workspace_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.workspace_name})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Your Full Name *"}),i.jsx("input",{type:"text",id:"full_name",name:"full_name",value:r.full_name,onChange:u,placeholder:"John Doe",className:`w-full px-4 py-2 border ${a.full_name?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white`,disabled:o}),a.full_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.full_name})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address *"}),i.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:u,placeholder:"john@example.com",className:`w-full px-4 py-2 border ${a.email?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white`,disabled:o}),a.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.email})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password *"}),i.jsx("input",{type:"password",id:"password",name:"password",value:r.password,onChange:u,placeholder:"At least 6 characters",className:`w-full px-4 py-2 border ${a.password?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white`,disabled:o}),a.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.password})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirm Password *"}),i.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:r.confirmPassword,onChange:u,placeholder:"Re-enter password",className:`w-full px-4 py-2 border ${a.confirmPassword?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white`,disabled:o}),a.confirmPassword&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.confirmPassword})]}),i.jsx("button",{type:"submit",disabled:o,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-medium py-3 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:o?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Workspace..."]}):"Create Free Workspace"})]}),i.jsxs("div",{className:"mt-6 text-center space-y-2",children:[i.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",i.jsx(vi,{to:"/login",className:"text-purple-600 hover:text-purple-700 dark:text-purple-400 font-medium",children:"Sign in"})]}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"By signing up, you agree to our Terms of Service and Privacy Policy"})]})]}),i.jsxs("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3 text-center",children:"What's Included (Free Forever)"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Up to 10 team members"]}),i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"100 active tasks"]}),i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"3 teams"]}),i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Kanban board & Calendar view"]}),i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Real-time collaboration"]}),i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Basic analytics & reports"]})]})]})]})})},qT=()=>{const[e]=W0(),t=Cs(),[r,n]=J.useState(e.get("code")||""),[a,s]=J.useState(""),[o,l]=J.useState(!1),[c,d]=J.useState(!1),[u,h]=J.useState(""),[m,f]=J.useState(!1);J.useEffect(()=>{e.get("code")&&a&&x()},[]);const x=async b=>{var y,N;if(b&&b.preventDefault(),!a||!r){h("Please enter both email and verification code");return}l(!0),h("");try{const S=await it.post("/auth/verify-email",{email:a,code:r});d(!0),h(""),setTimeout(()=>{t("/login",{state:{message:"Email verified! Please login with your credentials.",email:a}})},3e3)}catch(S){console.error("Verification error:",S),h(((N=(y=S.response)==null?void 0:y.data)==null?void 0:N.message)||"Verification failed. Please check your code and try again."),d(!1)}finally{l(!1)}},g=async()=>{var b,y;if(!a){h("Please enter your email address");return}f(!0),h(""),d(!1);try{await it.post("/auth/resend-verification",{email:a}),h(""),d(!0),setMessage("Verification code resent! Please check your email inbox.")}catch(N){console.error("Resend error:",N),h(((y=(b=N.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to resend verification code. Please try again.")}finally{f(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full",children:[i.jsxs("button",{onClick:()=>t("/login"),className:"mb-4 flex items-center gap-2 text-white/90 hover:text-white transition-colors",children:[i.jsx(Bg,{size:20}),i.jsx("span",{children:"Back to Login"})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-500 p-8 text-center",children:[i.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:c?i.jsx(da,{size:40,className:"text-green-500"}):i.jsx(a0,{size:40,className:"text-purple-600"})}),i.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:c?"Verified!":"Verify Your Email"}),i.jsx("p",{className:"text-white/90 text-sm",children:c?"Your email has been verified successfully":"Enter the 6-digit code sent to your email"})]}),i.jsx("div",{className:"p-8",children:c?i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"mb-6",children:i.jsx(da,{size:80,className:"text-green-500 mx-auto"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Email Verified! ðŸŽ‰"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Redirecting you to login page..."}),i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})})]}):i.jsxs("form",{onSubmit:x,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",value:a,onChange:b=>s(b.target.value),placeholder:"your.email@example.com",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"code",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Verification Code"}),i.jsx("input",{id:"code",type:"text",value:r,onChange:b=>n(b.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-center text-2xl font-mono font-bold tracking-widest focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",maxLength:6,required:!0,disabled:o}),i.jsx("p",{className:"mt-2 text-sm text-gray-500 text-center",children:"Enter the 6-digit code from your email"})]}),u&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[i.jsx(Yo,{size:20,className:"flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-sm",children:u})]}),i.jsx("button",{type:"submit",disabled:o||!a||!r,className:"w-full bg-gradient-to-r from-purple-600 to-pink-500 text-white py-3 px-4 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),i.jsx("span",{children:"Verifying..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(da,{size:20}),i.jsx("span",{children:"Verify Email"})]})}),i.jsxs("div",{className:"text-center pt-4 border-t border-gray-200",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Didn't receive the code?"}),i.jsxs("button",{type:"button",onClick:g,disabled:m||!a,className:"text-purple-600 hover:text-purple-700 font-semibold text-sm flex items-center gap-2 mx-auto disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Ih,{size:16,className:m?"animate-spin":""}),i.jsx("span",{children:m?"Resending...":"Resend Code"})]})]})]})}),!c&&i.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center border-t border-gray-200",children:i.jsxs("p",{className:"text-sm text-gray-600",children:["Need help?"," ",i.jsx("a",{href:"mailto:support@taskflow.com",className:"text-purple-600 hover:text-purple-700 font-semibold",children:"Contact Support"})]})})]}),!c&&i.jsxs("div",{className:"mt-6 bg-white/10 backdrop-blur-sm rounded-lg p-4 text-white text-sm",children:[i.jsx("p",{className:"font-semibold mb-2",children:"ðŸ“§ Check your email inbox"}),i.jsxs("ul",{className:"space-y-1 ml-4 list-disc",children:[i.jsx("li",{children:"The code is valid for 24 hours"}),i.jsx("li",{children:"Check your spam folder if you don't see it"}),i.jsx("li",{children:"You can request a new code if it expired"})]})]})]})})},YT=()=>{const{theme:e}=Lr(),t=Cs(),[r,n]=J.useState(1),[a,s]=J.useState(""),[o,l]=J.useState(""),[c,d]=J.useState(""),[u,h]=J.useState(""),[m,f]=J.useState(!1),[x,g]=J.useState(!1),[b,y]=J.useState(!1),[N,S]=J.useState(""),_=async O=>{var R,E;O.preventDefault(),S(""),y(!0);try{console.log("ðŸ” Requesting password reset for:",a);const B=await it.post("/auth/forgot-password",{email:a});console.log("âœ… Password reset response:",B.data),n(2)}catch(B){console.error("âŒ Password reset error:",B),S(((E=(R=B.response)==null?void 0:R.data)==null?void 0:E.message)||"Failed to send reset code. Please try again.")}finally{y(!1)}},D=async O=>{var R,E;if(O.preventDefault(),S(""),c!==u){S("Passwords do not match");return}if(c.length<6){S("Password must be at least 6 characters");return}y(!0);try{console.log("ðŸ” Resetting password with token");const B=await it.post("/auth/reset-password",{email:a,token:o,newPassword:c});console.log("âœ… Password reset successful:",B.data),n(3),setTimeout(()=>{t("/login")},3e3)}catch(B){console.error("âŒ Reset password error:",B),S(((E=(R=B.response)==null?void 0:R.data)==null?void 0:E.message)||"Invalid or expired code. Please try again.")}finally{y(!1)}},I=async()=>{S(""),y(!0);try{await it.post("/auth/forgot-password",{email:a}),S(""),l("")}catch{S("Failed to resend code. Please try again.")}finally{y(!1)}};return i.jsx("div",{className:`min-h-screen flex items-center justify-center p-4 ${e==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsx("div",{className:"text-center mb-8",children:i.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[i.jsx("img",{src:"/logo.png",alt:"TaskFlow",className:"w-12 h-12"}),i.jsx("h1",{className:`text-3xl font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:"TaskFlow"})]})}),i.jsxs("div",{className:`${e==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg shadow-xl p-8`,children:[r===1&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 ${e==="dark"?"bg-[#136dec]/10":"bg-blue-50"}`,children:i.jsx(a0,{size:32,className:"text-[#136dec]"})}),i.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Forgot Password?"}),i.jsx("p",{className:`text-sm ${e==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Enter your email address and we'll send you a reset code."})]}),N&&i.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:i.jsx("p",{className:"text-red-500 text-sm",children:N})}),i.jsxs("form",{onSubmit:_,children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Email Address"}),i.jsx("input",{type:"email",value:a,onChange:O=>s(O.target.value),placeholder:"Enter your email",className:`w-full p-3 ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,autoFocus:!0})]}),i.jsx("button",{type:"submit",disabled:b,className:"w-full bg-[#136dec] text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Sending...":"Send Reset Code"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs(vi,{to:"/login",className:`inline-flex items-center gap-2 text-sm ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[i.jsx(Bg,{size:16}),"Back to Login"]})})]}),r===2&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 ${e==="dark"?"bg-[#136dec]/10":"bg-blue-50"}`,children:i.jsx(Gx,{size:32,className:"text-[#136dec]"})}),i.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Enter Reset Code"}),i.jsxs("p",{className:`text-sm ${e==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:["We sent a 6-digit code to ",i.jsx("span",{className:"font-semibold",children:a})]})]}),N&&i.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:i.jsx("p",{className:"text-red-500 text-sm",children:N})}),i.jsxs("form",{onSubmit:D,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Reset Code"}),i.jsx("input",{type:"text",value:o,onChange:O=>l(O.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",className:`w-full p-3 text-center text-2xl tracking-widest font-mono ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,maxLength:6,autoFocus:!0})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:m?"text":"password",value:c,onChange:O=>d(O.target.value),placeholder:"Enter new password (min 6 characters)",className:`w-full p-3 pr-10 ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,minLength:6}),i.jsx("button",{type:"button",onClick:()=>f(!m),className:`absolute right-3 top-1/2 -translate-y-1/2 ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:m?i.jsx(to,{size:18}):i.jsx(js,{size:18})})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Confirm Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:x?"text":"password",value:u,onChange:O=>h(O.target.value),placeholder:"Confirm new password",className:`w-full p-3 pr-10 ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0}),i.jsx("button",{type:"button",onClick:()=>g(!x),className:`absolute right-3 top-1/2 -translate-y-1/2 ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:x?i.jsx(to,{size:18}):i.jsx(js,{size:18})})]})]}),i.jsx("button",{type:"submit",disabled:b,className:"w-full bg-[#136dec] text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed mb-3",children:b?"Resetting Password...":"Reset Password"}),i.jsx("button",{type:"button",onClick:I,disabled:b,className:`w-full py-2 text-sm ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors disabled:opacity-50`,children:"Didn't receive code? Resend"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("button",{onClick:()=>{n(1),l(""),d(""),h(""),S("")},className:`inline-flex items-center gap-2 text-sm ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[i.jsx(Bg,{size:16}),"Change Email"]})})]}),r===3&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 bg-green-500/10",children:i.jsx(da,{size:32,className:"text-green-500"})}),i.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Password Reset Successful!"}),i.jsx("p",{className:`${e==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-6`,children:"Your password has been successfully reset. Redirecting to login..."}),i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0s"}}),i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})]})]}),i.jsx("div",{className:"text-center mt-6",children:i.jsx("p",{className:`text-xs ${e==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Â© 2026 TaskFlow. All rights reserved."})})]})})},VT=()=>{const{theme:e}=Lr(),t=Cs(),[r]=W0(),[n,a]=J.useState(""),[s,o]=J.useState(""),[l,c]=J.useState(""),[d,u]=J.useState(!1),[h,m]=J.useState(!1),[f,x]=J.useState(!1),[g,b]=J.useState(!1),[y,N]=J.useState("");J.useEffect(()=>{const _=r.get("token");console.log("ðŸ” Reset password page loaded"),console.log("   URL:",window.location.href),console.log("   Token from URL:",_),_?(a(_),console.log("âœ… Token set:",_)):N("Invalid reset link. Please request a new password reset.")},[r]);const S=async _=>{var D,I;if(_.preventDefault(),N(""),s!==l){N("Passwords do not match");return}if(s.length<6){N("Password must be at least 6 characters");return}x(!0);try{console.log("ðŸ” Resetting password with token:",n);const O=await it.post("/auth/reset-password",{token:n,newPassword:s});console.log("âœ… Password reset successful:",O.data),b(!0),setTimeout(()=>{t("/login")},3e3)}catch(O){console.error("âŒ Reset password error:",O),N(((I=(D=O.response)==null?void 0:D.data)==null?void 0:I.message)||"Failed to reset password. Please try again.")}finally{x(!1)}};return i.jsx("div",{className:`min-h-screen flex items-center justify-center p-4 ${e==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsx("div",{className:"text-center mb-8",children:i.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[i.jsx("img",{src:"/logo.png",alt:"TaskFlow",className:"w-12 h-12"}),i.jsx("h1",{className:`text-3xl font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:"TaskFlow"})]})}),i.jsx("div",{className:`${e==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg shadow-xl p-8`,children:g?i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 bg-green-500/10",children:i.jsx(da,{size:32,className:"text-green-500"})}),i.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Password Reset Successful!"}),i.jsx("p",{className:`${e==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-6`,children:"Your password has been successfully reset. Redirecting to login..."}),i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0s"}}),i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),i.jsx("div",{className:"w-2 h-2 bg-[#136dec] rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 ${e==="dark"?"bg-[#136dec]/10":"bg-blue-50"}`,children:i.jsx(Gx,{size:32,className:"text-[#136dec]"})}),i.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Reset Password"}),i.jsx("p",{className:`text-sm ${e==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Enter your new password below"})]}),y&&i.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-start gap-2",children:[i.jsx(Ss,{size:18,className:"text-red-500 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-red-500 text-sm",children:y})]}),n?i.jsxs("form",{onSubmit:S,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:d?"text":"password",value:s,onChange:_=>o(_.target.value),placeholder:"Enter new password (min 6 characters)",className:`w-full p-3 pr-10 ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,minLength:6,autoFocus:!0}),i.jsx("button",{type:"button",onClick:()=>u(!d),className:`absolute right-3 top-1/2 -translate-y-1/2 ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:d?i.jsx(to,{size:18}):i.jsx(js,{size:18})})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:`block text-sm font-medium ${e==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Confirm Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:h?"text":"password",value:l,onChange:_=>c(_.target.value),placeholder:"Confirm new password",className:`w-full p-3 pr-10 ${e==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0}),i.jsx("button",{type:"button",onClick:()=>m(!h),className:`absolute right-3 top-1/2 -translate-y-1/2 ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:h?i.jsx(to,{size:18}):i.jsx(js,{size:18})})]})]}),i.jsx("button",{type:"submit",disabled:f,className:"w-full bg-[#136dec] text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Resetting Password...":"Reset Password"})]}):i.jsxs("div",{className:"text-center py-4",children:[i.jsx("p",{className:`${e==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-4`,children:"Invalid or missing reset token."}),i.jsx(vi,{to:"/forgot-password",className:"text-[#136dec] hover:underline text-sm font-medium",children:"Request a new password reset"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsx(vi,{to:"/login",className:`text-sm ${e==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:"Back to Login"})})]})}),i.jsx("div",{className:"text-center mt-6",children:i.jsx("p",{className:`text-xs ${e==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Â© 2026 TaskFlow. All rights reserved."})})]})})},el=(e={})=>{const{socket:t}=pn(),{onTaskCreated:r,onTaskUpdated:n,onTaskDeleted:a,onTaskAssigned:s,onUserCreated:o,onUserUpdated:l,onUserDeleted:c,onTeamCreated:d,onTeamUpdated:u,onTeamDeleted:h,onCommentAdded:m,onStatusChanged:f}=e;return J.useEffect(()=>{if(t)return r&&t.on("task:created",r),n&&t.on("task:updated",n),a&&t.on("task:deleted",a),s&&t.on("task:assigned",s),f&&t.on("task:statusChanged",f),o&&t.on("user:created",o),l&&t.on("user:updated",l),c&&t.on("user:deleted",c),d&&t.on("team:created",d),u&&t.on("team:updated",u),h&&t.on("team:deleted",h),m&&t.on("comment:added",m),()=>{r&&t.off("task:created",r),n&&t.off("task:updated",n),a&&t.off("task:deleted",a),s&&t.off("task:assigned",s),f&&t.off("task:statusChanged",f),o&&t.off("user:created",o),l&&t.off("user:updated",l),c&&t.off("user:deleted",c),d&&t.off("team:created",d),u&&t.off("team:updated",u),h&&t.off("team:deleted",h),m&&t.off("comment:added",m)}},[t,r,n,a,s,f,o,l,c,d,u,h,m]),{refreshData:J.useCallback(()=>{t&&t.emit("request:refresh")},[t])}},qv=({size:e="w-10 h-10",className:t="",alt:r="User",src:n=null,name:a=""})=>{const s=`${e} rounded-full object-cover ${t}`.trim(),o=u=>{if(!u)return"U";const h=u.trim().split(" ");return h.length>=2?(h[0][0]+h[h.length-1][0]).toUpperCase():u.substring(0,2).toUpperCase()};if(n)return i.jsx("img",{src:n,alt:r,className:s,onError:u=>{var h;u.currentTarget.style.display="none",(h=u.currentTarget.nextElementSibling)==null||h.classList.remove("hidden")}});const l=o(a||r),d=(u=>{const h=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-cyan-500"];let m=0;for(let f=0;f<u.length;f++)m=u.charCodeAt(f)+((m<<5)-m);return h[Math.abs(m)%h.length]})(a||r||"User");return i.jsx("div",{className:`${e} rounded-full ${d} flex items-center justify-center text-white font-semibold ${t}`.trim(),style:{fontSize:"calc(0.4 * min(100%, 100%))"},children:i.jsx("span",{className:"text-xs",children:l})})},tl=()=>{const[e,t]=J.useState(!1),[r,n]=J.useState({title:"Confirm Action",message:"Are you sure you want to proceed?",confirmText:"Confirm",cancelText:"Cancel",variant:"danger"}),[a,s]=J.useState(!1),o=J.useRef(null),l=J.useCallback(({title:u,message:h,confirmText:m,cancelText:f,variant:x})=>new Promise(g=>{n({title:u||"Confirm Action",message:h||"Are you sure you want to proceed?",confirmText:m||"Confirm",cancelText:f||"Cancel",variant:x||"danger"}),o.current=g,t(!0)}),[]),c=J.useCallback(()=>{a||(t(!1),s(!1),o.current&&(o.current(!1),o.current=null))},[a]),d=J.useCallback(async()=>{s(!0);try{t(!1),o.current&&(o.current(!0),o.current=null)}finally{s(!1)}},[]);return{isOpen:e,onClose:c,onConfirm:d,title:r.title,message:r.message,confirmText:r.confirmText,cancelText:r.cancelText,variant:r.variant,isLoading:a,show:l,hide:c}},rl=({isOpen:e,onClose:t,onConfirm:r,title:n="Confirm Action",message:a="Are you sure you want to proceed?",confirmText:s="Confirm",cancelText:o="Cancel",variant:l="danger",isLoading:c=!1})=>{const{theme:d}=Lr(),u=d==="dark";if(J.useEffect(()=>{const x=g=>{g.key==="Escape"&&!c&&t()};return e&&(document.addEventListener("keydown",x),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",x),document.body.style.overflow="unset"}},[e,c,t]),!e)return null;const h={danger:{icon:ua,iconBg:u?"bg-red-500/10":"bg-red-50",iconColor:"text-red-500",buttonBg:"bg-red-600 hover:bg-red-700"},warning:{icon:ku,iconBg:u?"bg-yellow-500/10":"bg-yellow-50",iconColor:"text-yellow-500",buttonBg:"bg-yellow-600 hover:bg-yellow-700"},logout:{icon:D4,iconBg:u?"bg-orange-500/10":"bg-orange-50",iconColor:"text-orange-500",buttonBg:"bg-orange-600 hover:bg-orange-700"},info:{icon:C4,iconBg:u?"bg-blue-500/10":"bg-blue-50",iconColor:"text-blue-500",buttonBg:"bg-blue-600 hover:bg-blue-700"}},m=h[l]||h.info,f=m.icon;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",onClick:c?void 0:t,children:i.jsxs("div",{className:`relative w-full max-w-md rounded-lg shadow-xl animate-scale-in ${u?"bg-[#1c2027]":"bg-white"}`,onClick:x=>x.stopPropagation(),children:[i.jsx("button",{onClick:t,disabled:c,className:`absolute top-4 right-4 p-1 rounded transition-colors ${u?"text-[#9da8b9] hover:text-white hover:bg-[#282f39]":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"} disabled:opacity-50 disabled:cursor-not-allowed`,children:i.jsx(kr,{size:20})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:`p-3 rounded-full ${m.iconBg}`,children:i.jsx(f,{size:24,className:m.iconColor})}),i.jsx("h2",{className:`text-xl font-semibold ${u?"text-white":"text-gray-900"}`,children:n})]}),i.jsx("p",{className:`text-sm leading-relaxed mb-6 ${u?"text-[#9da8b9]":"text-gray-600"}`,children:a}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:t,disabled:c,className:`px-4 py-2 rounded font-medium text-sm transition-colors ${u?"bg-[#282f39] text-white hover:bg-[#333a47]":"bg-gray-100 text-gray-700 hover:bg-gray-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:o}),i.jsx("button",{onClick:r,disabled:c,className:`px-4 py-2 rounded font-medium text-sm text-white transition-colors ${m.buttonBg} disabled:opacity-50 disabled:cursor-not-allowed`,children:c?i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):s})]})]})]})})},Cn=()=>{const{user:e,logout:t}=pn(),{theme:r,currentTheme:n}=Lr(),{isMobileOpen:a,isMobile:s,closeMobileSidebar:o,isCollapsed:l,toggleCollapse:c}=Mn(),d=Cs(),u=Px(),h=tl(),[m,f]=J.useState({main:!0,hr:!1,management:!1}),x=O=>{f(R=>({...R,[O]:!R[O]}))},g=O=>{d(O),s&&o()},b=O=>{if(!O)return"U";const R=O.split(" ");return R.length>=2?(R[0][0]+R[1][0]).toUpperCase():O.substring(0,2).toUpperCase()},y=O=>u.pathname===O,N=[{path:(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="hr"?"/hr/dashboard":"/dashboard",icon:Rv,label:"Dashboard"},{path:"/tasks",icon:n0,label:"My Tasks"},{path:"/kanban",icon:OT,label:"Kanban Board"},{path:"/calendar",icon:Gn,label:"Calendar"},{path:"/analytics",icon:zx,label:"Analytics"}],S=[{path:"/hr/dashboard",icon:Rv,label:"HR Dashboard",roles:["admin","hr"]},{path:"/teams",icon:ks,label:"Teams",roles:["admin","hr","team_lead","community_admin"]},{path:"/users",icon:zv,label:"User Management",roles:["admin","hr"]}],_=[{path:"/community-users",icon:zv,label:"Community Users",roles:["community_admin"]},{path:"/workspaces",icon:Mh,label:"Workspaces",roles:["admin"]},{path:"/changelog",icon:Su,label:"Audit Logs",roles:["admin"]}],D=O=>O.roles?O.roles.includes(e==null?void 0:e.role)?O.systemAdminOnly?(e==null?void 0:e.isSystemAdmin)||!(e!=null&&e.workspaceId)&&(e==null?void 0:e.role)==="admin":!0:!1:!0,I=r==="dark";return i.jsxs(i.Fragment,{children:[s&&a&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:o}),i.jsxs("aside",{className:`
        ${l?"w-16":"w-64"}
        ${I?"bg-[#111418] border-[#282f39] shadow-xl":"bg-white border-gray-200 shadow-lg"}
        border-r flex flex-col shrink-0 transition-all duration-300
        ${s?"fixed":"relative"} inset-y-0 left-0 z-50
        ${s?a?"translate-x-0":"-translate-x-full":"translate-x-0"}
      `,children:[s&&a&&i.jsx("button",{onClick:o,className:`absolute top-4 right-4 z-10 ${I?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} lg:hidden`,children:i.jsx(kr,{size:24})}),i.jsx("div",{className:`${l?"p-3":"p-4"} border-b ${I?"border-[#282f39]/70":"border-gray-200/70"} flex items-center justify-center bg-gradient-to-r ${I?"from-[#111418] to-[#1a1d23]":"from-white to-gray-50/50"}`,children:l?i.jsx("img",{src:"/logo.png",alt:"TaskFlow Logo",className:"w-8 h-8 object-contain",title:"TaskFlow"}):i.jsxs("div",{className:"flex items-center gap-3 w-full px-2",children:[i.jsx("img",{src:"/logo.png",alt:"TaskFlow Logo",className:"w-8 h-8 object-contain"}),i.jsx("span",{className:`text-xl font-bold ${I?"text-white":"text-gray-900"}`,children:"TaskFlow"})]})}),i.jsxs("div",{className:"flex flex-col flex-1 overflow-y-auto max-h-full",children:[!l&&i.jsx("div",{className:`border-b ${I?"border-[#282f39]/50":"border-gray-200/50"} mx-2 mb-2`,children:i.jsxs("button",{onClick:()=>x("main"),className:`w-full flex items-center justify-between py-3 px-1 text-left transition-colors group hidden lg:flex ${I?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-800"}`,children:[i.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider",children:"Main"}),m.main?i.jsx(Ep,{size:12}):i.jsx(wi,{size:12})]})}),i.jsx("div",{className:`transition-all duration-200 overflow-hidden ${l||m.main?"max-h-64 opacity-100":"max-h-0 opacity-0"}`,children:i.jsx("div",{className:"max-h-60 overflow-y-auto",children:N.map(O=>{const R=O.icon,E=y(O.path);return i.jsxs("button",{onClick:()=>g(O.path),className:`w-full flex items-center gap-3 px-3 py-2.5 text-left rounded-md transition-colors group ${E?I?"bg-[#136dec]/10 text-[#136dec]":"bg-blue-50 text-blue-600":I?"text-[#9da8b9] hover:bg-[#1c2027] hover:text-white":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,title:l?O.label:"",children:[i.jsx(R,{size:18,className:E?"fill-current":""}),!l&&i.jsx("span",{className:"text-sm font-medium",children:O.label})]},O.path)})})}),S.some(D)&&i.jsxs(i.Fragment,{children:[!l&&i.jsx("div",{className:`border-b ${I?"border-[#282f39]/50":"border-gray-200/50"} mx-2 mb-2`,children:i.jsxs("button",{onClick:()=>x("hr"),className:`w-full flex items-center justify-between py-3 px-1 text-left transition-colors group hidden lg:flex ${I?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-800"}`,children:[i.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider",children:"HR Management"}),m.hr?i.jsx(Ep,{size:12}):i.jsx(wi,{size:12})]})}),i.jsx("div",{className:`transition-all duration-200 overflow-hidden ${l||m.hr?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:i.jsx("div",{className:"max-h-60 overflow-y-auto",children:S.filter(D).map(O=>{const R=O.icon,E=y(O.path);return i.jsxs("button",{onClick:()=>g(O.path),className:`w-full flex items-center gap-3 px-3 py-2.5 text-left rounded-md transition-colors group ${E?I?"bg-[#136dec]/10 text-[#136dec]":"bg-blue-50 text-blue-600":I?"text-[#9da8b9] hover:bg-[#1c2027] hover:text-white":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,title:l?O.label:"",children:[i.jsx(R,{size:18,className:E?"fill-current":""}),!l&&i.jsx("span",{className:"text-sm font-medium",children:O.label})]},O.path)})})})]}),_.some(D)&&i.jsxs(i.Fragment,{children:[!l&&i.jsx("div",{className:`border-b ${I?"border-[#282f39]/50":"border-gray-200/50"} mx-2 mb-2`,children:i.jsxs("button",{onClick:()=>x("management"),className:`w-full flex items-center justify-between py-3 px-1 text-left transition-colors group hidden lg:flex ${I?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-800"}`,children:[i.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider",children:"Management"}),m.management?i.jsx(Ep,{size:12}):i.jsx(wi,{size:12})]})}),i.jsx("div",{className:`transition-all duration-200 overflow-hidden ${l||m.management?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:i.jsx("div",{className:"max-h-60 overflow-y-auto",children:_.filter(D).map(O=>{const R=O.icon,E=y(O.path);return i.jsxs("button",{onClick:()=>g(O.path),className:`w-full flex items-center gap-3 px-3 py-2.5 text-left rounded-md transition-colors group ${E?I?"bg-[#136dec]/10 text-[#136dec]":"bg-blue-50 text-blue-600":I?"text-[#9da8b9] hover:bg-[#1c2027] hover:text-white":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,title:l?O.label:"",children:[i.jsx(R,{size:18,className:E?"fill-current":""}),!l&&i.jsx("span",{className:"text-sm font-medium",children:O.label})]},O.path)})})})]})]}),!l&&i.jsx("div",{className:`p-2 border-t hidden lg:block ${I?"border-[#282f39]":"border-gray-200"}`,children:i.jsxs("div",{className:"px-2 py-1.5",children:[i.jsx("p",{className:`text-xs font-bold uppercase tracking-wider mb-2 ${I?"text-[#9da8b9]":"text-gray-500"}`,children:"Workspace"}),(e==null?void 0:e.role)==="community_admin"&&(e!=null&&e.workspace)?i.jsxs("div",{className:`flex items-center gap-2 text-sm font-medium ${I?"text-white":"text-gray-900"}`,children:[i.jsx("div",{className:"size-6 rounded bg-gradient-to-br from-teal-500 to-emerald-500 flex items-center justify-center text-[10px] text-white font-bold",children:b(e.workspace.name)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"truncate block",children:e.workspace.name}),i.jsxs("span",{className:`text-[10px] ${I?"text-[#9da8b9]":"text-gray-500"}`,children:[e.workspace.type==="COMMUNITY"?"Community":"Core"," Workspace"]})]})]}):e!=null&&e.team_id?i.jsxs("div",{className:`flex items-center gap-2 text-sm font-medium ${I?"text-white":"text-gray-900"}`,children:[i.jsx("div",{className:"size-6 rounded bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center text-[10px] text-white font-bold",children:b(e.team_id.name)}),i.jsx("span",{className:"truncate",children:e.team_id.name})]}):i.jsx("div",{className:`flex items-center gap-2 text-sm ${I?"text-[#9da8b9]":"text-gray-600"}`,children:(e==null?void 0:e.role)==="admin"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"size-6 rounded bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-[10px] text-white font-bold",children:"A"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs font-medium",children:"Admin - All Teams"}),i.jsx("button",{onClick:()=>d("/teams"),className:"text-[10px] text-[#136dec] hover:underline mt-0.5",children:"Manage Teams â†’"})]})]}):e!=null&&e.workspace?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"size-6 rounded bg-gradient-to-br from-teal-500 to-emerald-500 flex items-center justify-center text-[10px] text-white font-bold",children:b(e.workspace.name)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:`truncate block text-xs font-medium ${I?"text-white":"text-gray-900"}`,children:e.workspace.name}),i.jsxs("span",{className:`text-[10px] ${I?"text-[#9da8b9]":"text-gray-500"}`,children:[e.workspace.type==="COMMUNITY"?"Community":"Core"," Workspace"]})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"size-6 rounded bg-gradient-to-br from-gray-400 to-gray-500 flex items-center justify-center text-[10px] text-white font-bold",children:"?"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs font-medium",children:"No Team Assigned"}),i.jsx("p",{className:"text-[10px] mt-0.5",children:"Contact your admin"})]})]})})]})}),i.jsxs("div",{className:`border-t ${I?"border-[#282f39]":"border-gray-200"}`,children:[!l&&e&&i.jsx("div",{className:`p-2 border-b ${I?"border-[#282f39]":"border-gray-200"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[e.profile_picture?i.jsx("img",{src:e.profile_picture,alt:e.full_name,className:"w-10 h-10 rounded-full object-cover"}):i.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-[#136dec] to-blue-600 flex items-center justify-center text-white font-semibold text-sm",children:b(e.full_name)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`text-sm font-semibold truncate ${I?"text-white":"text-gray-900"}`,children:e.full_name}),i.jsx("p",{className:`text-xs truncate ${I?"text-[#9da8b9]":"text-gray-600"}`,children:e.email})]})]})}),i.jsxs("div",{className:"p-2",children:[!l&&i.jsx("div",{className:`border-t pt-3 mb-2 hidden lg:block ${I?"border-[#282f39]/50":"border-gray-200/50"}`,children:i.jsx("p",{className:`text-xs font-semibold uppercase tracking-wider mb-2 ${I?"text-[#9da8b9]":"text-gray-600"}`,children:"Account"})}),i.jsxs("button",{onClick:()=>g("/settings"),className:`w-full flex items-center gap-3 px-3 py-2.5 text-left rounded-md transition-colors group mb-2 ${y("/settings")?I?"bg-[#136dec]/10 text-[#136dec]":"bg-blue-50 text-blue-600":I?"text-[#9da8b9] hover:bg-[#1c2027] hover:text-white":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,title:l?"Profile & Settings":"",children:[i.jsx(ji,{size:18}),!l&&i.jsx("span",{className:"text-sm font-medium",children:"Profile & Settings"})]}),i.jsxs("button",{onClick:async()=>{await h.show({title:"Logout",message:"Are you sure you want to logout? You will need to sign in again to access your account.",confirmText:"Logout",cancelText:"Stay Logged In",variant:"logout"})&&(t(),d("/login"))},className:`w-full flex items-center gap-3 px-3 py-2.5 text-left rounded-md transition-colors group ${I?"text-red-400 hover:bg-red-500/10 hover:text-red-300":"text-red-600 hover:bg-red-50 hover:text-red-700"}`,title:l?"Logout":"",children:[i.jsx(D4,{size:18}),!l&&i.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]})]}),i.jsx("button",{onClick:c,className:`p-3 border-t flex items-center justify-center transition-colors hidden md:flex ${I?"text-[#9da8b9] hover:text-white border-[#282f39] hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 border-gray-200 hover:bg-gray-100"}`,title:l?"Expand Sidebar":"Collapse Sidebar",children:l?i.jsx(qx,{size:20}):i.jsx(Hx,{size:20})}),i.jsx(rl,{isOpen:h.isOpen,onClose:h.onClose,onConfirm:h.onConfirm,title:h.title,message:h.message,confirmText:h.confirmText,cancelText:h.cancelText,variant:h.variant,isLoading:h.isLoading})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var s0={};s0.version="0.18.5";var F4=1252,GT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$4=function(e){GT.indexOf(e)!=-1&&(F4=e)};function KT(){$4(1252)}var ju=function(e){$4(e)};function XT(){ju(1200),KT()}var oh=function(t){return String.fromCharCode(t)},Yv=function(t){return String.fromCharCode(t)},i0,Bo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tu(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),s=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Bo.charAt(s)+Bo.charAt(o)+Bo.charAt(l)+Bo.charAt(c);return t}function lo(e){var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)s=Bo.indexOf(e.charAt(d++)),o=Bo.indexOf(e.charAt(d++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Bo.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Bo.indexOf(e.charAt(d++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var hr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),mo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ql(e){return hr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Vv(e){return hr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gs=function(t){return hr?mo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Z0(e){if(typeof ArrayBuffer>"u")return Gs(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function nf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function JT(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Yn=hr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:mo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ZT(e){for(var t=[],r=0,n=e.length+250,a=ql(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ql(65535),n=65530)}return t.push(a.slice(0,r)),Yn(t)}var fu=/\u0000/g,lh=/[\u0001-\u0006]/g;function Mc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ks(e,t){var r=""+e;return r.length>=t?r:Qr("0",t-r.length)+r}function Kx(e,t){var r=""+e;return r.length>=t?r:Qr(" ",t-r.length)+r}function o0(e,t){var r=""+e;return r.length>=t?r:r+Qr(" ",t-r.length)}function QT(e,t){var r=""+Math.round(e);return r.length>=t?r:Qr("0",t-r.length)+r}function eA(e,t){var r=""+e;return r.length>=t?r:Qr("0",t-r.length)+r}var Gv=Math.pow(2,32);function _c(e,t){if(e>Gv||e<-Gv)return QT(e,t);var r=Math.round(e);return eA(r,t)}function l0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Kv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Op=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var tn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Xv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function c0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,o=1,l=0,c=1,d=0,u=0,h=Math.floor(a);d<t&&(h=Math.floor(a),l=h*o+s,u=h*d+c,!(a-h<5e-8));)a=1/(a-h),s=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=s):(u=d,l=o)),!r)return[0,n*l,u];var m=Math.floor(n*l/u);return[m,n*l-m*u,u]}function ch(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=cA(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var R4=new Date(1899,11,31,0,0,0),nA=R4.getTime(),aA=new Date(1900,2,1,0,0,0);function M4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aA&&(r+=24*60*60*1e3),(r-(nA+(e.getTimezoneOffset()-R4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iA(e){var t=e<0?12:11,r=Xx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function oA(e){var t=Xx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function lA(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=iA(e):t===10?r=e.toFixed(10).substr(0,12):r=oA(e),Xx(sA(r.toUpperCase()))}function Hg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):lA(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Go(14,M4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function cA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function dA(e,t,r,n){var a="",s=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Op[r.m-1][1];case 5:return Op[r.m-1][0];default:return Op[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return Kv[r.q][0];default:return Kv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ks(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(a=Ks(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?Ks(c,d):"";return u}function Uo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var I4=/%/g;function uA(e,t,r){var n=t.replace(I4,""),a=t.length-n.length;return ro(e,n,r*Math.pow(10,2*a))+Qr("%",a)}function fA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ro(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function B4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+B4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var U4=/# (\?+)( ?)\/( ?)(\d+)/;function hA(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Qr(" ",e[1].length+1+e[4].length):Kx(o,e[1].length)+e[2]+"/"+e[3]+Ks(l,e[4].length))}function mA(e,t,r){return r+(t===0?"":""+t)+Qr(" ",e[1].length+2+e[4].length)}var W4=/^#*0*\.([0#]+)/,z4=/\).*[0#]/,H4=/\(###\) ###\\?-####/;function ya(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Jv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zv(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function pA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function gA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ps(e,t,r){if(e.charCodeAt(0)===40&&!t.match(z4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ps("n",n,r):"("+ps("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fA(e,t,r);if(t.indexOf("%")!==-1)return uA(e,t,r);if(t.indexOf("E")!==-1)return B4(t,r);if(t.charCodeAt(0)===36)return"$"+ps(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+_c(c,t.length);if(t.match(/^[#?]+$/))return a=_c(r,0),a==="0"&&(a=""),a.length>t.length?a:ya(t.substr(0,t.length-a.length))+a;if(s=t.match(U4))return hA(s,c,d);if(t.match(/^#+0+$/))return d+_c(c,t.length-t.indexOf("0"));if(s=t.match(W4))return a=Jv(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ya(s[1])).replace(/\.$/,"."+ya(s[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Qr("0",ya(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+Jv(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Uo(_c(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ps(e,t,-r):Uo(""+(Math.floor(r)+pA(r,s[1].length)))+"."+Ks(Zv(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ps(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mc(ps(e,t.replace(/[\\-]/g,""),r)),o=0,Mc(Mc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(H4))return a=ps(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=c0(c,Math.pow(10,o)-1,!1),a=""+d,u=ro("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=o0(l[2],o),u.length<s[4].length&&(u=ya(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=c0(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kx(l[1],o)+s[2]+"/"+s[3]+o0(l[2],o):Qr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=_c(r,0),t.length<=a.length?a:ya(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,m=t.length-a.length-h;return ya(t.substr(0,h)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Zv(r,s[1].length),r<0?"-"+ps(e,t,-r):Uo(gA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(o,s[1].length);switch(t){case"###,##0.00":return ps(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=Uo(_c(c,0));return f!=="0"?d+f:"";case"###,###.00":return ps(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ps(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function xA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ro(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function vA(e,t,r){var n=t.replace(I4,""),a=t.length-n.length;return ro(e,n,r*Math.pow(10,2*a))+Qr("%",a)}function q4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(z4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hi("n",n,r):"("+hi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xA(e,t,r);if(t.indexOf("%")!==-1)return vA(e,t,r);if(t.indexOf("E")!==-1)return q4(t,r);if(t.charCodeAt(0)===36)return"$"+hi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ks(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ya(t.substr(0,t.length-a.length))+a;if(s=t.match(U4))return mA(s,c,d);if(t.match(/^#+0+$/))return d+Ks(c,t.length-t.indexOf("0"));if(s=t.match(W4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ya(s[1])).replace(/\.$/,"."+ya(s[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+Qr("0",ya(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return d+Uo(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hi(e,t,-r):Uo(""+r)+"."+Qr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return hi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mc(hi(e,t.replace(/[\\-]/g,""),r)),o=0,Mc(Mc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(H4))return a=hi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=c0(c,Math.pow(10,o)-1,!1),a=""+d,u=ro("n",s[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=o0(l[2],o),u.length<s[4].length&&(u=ya(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=c0(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kx(l[1],o)+s[2]+"/"+s[3]+o0(l[2],o):Qr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ya(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,m=t.length-a.length-h;return ya(t.substr(0,h)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hi(e,t,-r):Uo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ks(0,3-x.length):"")+x})+"."+Ks(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Uo(""+c);return f!=="0"?d+f:"";default:if(t.match(/\.[0#?]*$/))return hi(e,t.slice(0,t.lastIndexOf(".")),r)+ya(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ro(e,t,r){return(r|0)===r?hi(e,t,r):ps(e,t,r)}function bA(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Y4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function V4(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":l0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Y4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yA(e,t,r,n){for(var a=[],s="",o=0,l="",c="t",d,u,h,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!l0(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(h);a[a.length]={t:"t",v:s},++o;break;case"\\":var f=e.charAt(++o),x=f==="("||f===")"?f:"t";a[a.length]={t:x,v:f},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ch(t,r,e.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ch(t,r),d==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"ä¸Š":var g={t:l,v:l};if(d==null&&(d=ch(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?"P":"A"),g.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(d!=null&&(g.v=d.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),g.t="T",o+=5,m="h"):(g.t="t",++o),d==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Y4)){if(d==null&&(d=ch(t,r),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",V4(e)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var b=0,y=0,N;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=m,c="h",b<1&&(b=1);break;case"s":(N=a[o].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[o].v.match(/[Hh]/)&&(b=1),b<2&&a[o].v.match(/[Mm]/)&&(b=2),b<3&&a[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var S="",_;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=dA(a[o].t.charCodeAt(0),a[o].v,d,y),a[o].t="t";break;case"n":case"?":for(_=o+1;a[_]!=null&&((l=a[_].t)==="?"||l==="D"||(l===" "||l==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[o].v+=a[_].v,a[_]={v:"",t:";"},++_;S+=a[o].v,o=_-1;break;case"G":a[o].t="t",a[o].v=Hg(t,r);break}var D="",I,O;if(S.length>0){S.charCodeAt(0)==40?(I=t<0&&S.charCodeAt(0)===45?-t:t,O=ro("n",S,I)):(I=t<0&&n>1?-t:t,O=ro("n",S,I),I<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),_=O.length-1;var R=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){R=o;break}var E=a.length;if(R===a.length&&O.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(_>=a[o].v.length-1?(_-=a[o].v.length,a[o].v=O.substr(_+1,a[o].v.length)):_<0?a[o].v="":(a[o].v=O.substr(0,_+1),_=-1),a[o].t="t",E=o);_>=0&&E<a.length&&(a[E].v=O.substr(0,_+1)+a[E].v)}else if(R!==a.length&&O.indexOf("E")===-1){for(_=O.indexOf(".")-1,o=R;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===R?a[o].v.indexOf(".")-1:a[o].v.length-1,D=a[o].v.substr(u+1);u>=0;--u)_>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(D=O.charAt(_--)+D);a[o].v=D,a[o].t="t",E=o}for(_>=0&&E<a.length&&(a[E].v=O.substr(0,_+1)+a[E].v),_=O.indexOf(".")+1,o=R;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==R)){for(u=a[o].v.indexOf(".")>-1&&o===R?a[o].v.indexOf(".")+1:0,D=a[o].v.substr(0,u);u<a[o].v.length;++u)_<O.length&&(D+=O.charAt(_++));a[o].v=D,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=ro(a[o].t,a[o].v,I),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var Qv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wA(e,t){var r=bA(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Qv),l=r[1].match(Qv);return eb(t,o)?[n,r[0]]:eb(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Go(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:tn)[e],n==null&&(n=r.table&&r.table[Xv[e]]||tn[Xv[e]]),n==null&&(n=rA[e]||"General");break}if(l0(n,0))return Hg(t,r);t instanceof Date&&(t=M4(t,r.date1904));var a=wA(n,t);if(l0(a[1]))return Hg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yA(a[1],t,r,a[0])}function G4(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(tn[r]==null){t<0&&(t=r);continue}if(tn[r]==e){t=r;break}}t<0&&(t=391)}return tn[t]=e,t}function Q0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&G4(e[t],t)}function em(){tn=tA()}var K4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _A(e){var t=typeof e=="number"?tn[e]:e;return t=t.replace(K4,"(\\d+)"),new RegExp("^"+t+"$")}function NA(e,t,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(t.match(K4)||[]).forEach(function(h,m){var f=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":s=f;break;case"h":o=f;break;case"s":c=f;break;case"m":o>=0?l=f:a=f;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&s==-1?u:d+"T"+u}var kA=function(){var e={};e.version="1.2.0";function t(){for(var O=0,R=new Array(256),E=0;E!=256;++E)O=E,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,R[E]=O;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(O){var R=0,E=0,B=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)C[B]=O[B];for(B=0;B!=256;++B)for(E=O[B],R=256+B;R<4096;R+=256)E=C[R]=E>>>8^O[E&255];var M=[];for(B=1;B!=16;++B)M[B-1]=typeof Int32Array<"u"?C.subarray(B*256,B*256+256):C.slice(B*256,B*256+256);return M}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],d=a[4],u=a[5],h=a[6],m=a[7],f=a[8],x=a[9],g=a[10],b=a[11],y=a[12],N=a[13],S=a[14];function _(O,R){for(var E=R^-1,B=0,C=O.length;B<C;)E=E>>>8^r[(E^O.charCodeAt(B++))&255];return~E}function D(O,R){for(var E=R^-1,B=O.length-15,C=0;C<B;)E=S[O[C++]^E&255]^N[O[C++]^E>>8&255]^y[O[C++]^E>>16&255]^b[O[C++]^E>>>24]^g[O[C++]]^x[O[C++]]^f[O[C++]]^m[O[C++]]^h[O[C++]]^u[O[C++]]^d[O[C++]]^c[O[C++]]^l[O[C++]]^o[O[C++]]^s[O[C++]]^r[O[C++]];for(B+=15;C<B;)E=E>>>8^r[(E^O[C++])&255];return~E}function I(O,R){for(var E=R^-1,B=0,C=O.length,M=0,U=0;B<C;)M=O.charCodeAt(B++),M<128?E=E>>>8^r[(E^M)&255]:M<2048?(E=E>>>8^r[(E^(192|M>>6&31))&255],E=E>>>8^r[(E^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,U=O.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|M>>8&7))&255],E=E>>>8^r[(E^(128|M>>2&63))&255],E=E>>>8^r[(E^(128|U>>6&15|(M&3)<<4))&255],E=E>>>8^r[(E^(128|U&63))&255]):(E=E>>>8^r[(E^(224|M>>12&15))&255],E=E>>>8^r[(E^(128|M>>6&63))&255],E=E>>>8^r[(E^(128|M&63))&255]);return~E}return e.table=r,e.bstr=_,e.buf=D,e.str=I,e}(),Nr=function(){var t={};t.version="1.2.1";function r(q,ce){for(var ae=q.split("/"),ie=ce.split("/"),de=0,pe=0,Pe=Math.min(ae.length,ie.length);de<Pe;++de){if(pe=ae[de].length-ie[de].length)return pe;if(ae[de]!=ie[de])return ae[de]<ie[de]?-1:1}return ae.length-ie.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var ce=q.lastIndexOf("/");return ce===-1?q:q.slice(0,ce+1)}function a(q){if(q.charAt(q.length-1)=="/")return a(q.slice(0,-1));var ce=q.lastIndexOf("/");return ce===-1?q:q.slice(ce+1)}function s(q,ce){typeof ce=="string"&&(ce=new Date(ce));var ae=ce.getHours();ae=ae<<6|ce.getMinutes(),ae=ae<<5|ce.getSeconds()>>>1,q.write_shift(2,ae);var ie=ce.getFullYear()-1980;ie=ie<<4|ce.getMonth()+1,ie=ie<<5|ce.getDate(),q.write_shift(2,ie)}function o(q){var ce=q.read_shift(2)&65535,ae=q.read_shift(2)&65535,ie=new Date,de=ae&31;ae>>>=5;var pe=ae&15;ae>>>=4,ie.setMilliseconds(0),ie.setFullYear(ae+1980),ie.setMonth(pe-1),ie.setDate(de);var Pe=ce&31;ce>>>=5;var ze=ce&63;return ce>>>=6,ie.setHours(ce),ie.setMinutes(ze),ie.setSeconds(Pe<<1),ie}function l(q){rs(q,0);for(var ce={},ae=0;q.l<=q.length-4;){var ie=q.read_shift(2),de=q.read_shift(2),pe=q.l+de,Pe={};switch(ie){case 21589:ae=q.read_shift(1),ae&1&&(Pe.mtime=q.read_shift(4)),de>5&&(ae&2&&(Pe.atime=q.read_shift(4)),ae&4&&(Pe.ctime=q.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}q.l=pe,ce[ie]=Pe}return ce}var c;function d(){return c||(c={})}function u(q,ce){if(q[0]==80&&q[1]==75)return _r(q,ce);if((q[0]|32)==109&&(q[1]|32)==105)return Lt(q,ce);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var ae=3,ie=512,de=0,pe=0,Pe=0,ze=0,Le=0,Fe=[],G=q.slice(0,512);rs(G,0);var ke=h(G);switch(ae=ke[0],ae){case 3:ie=512;break;case 4:ie=4096;break;case 0:if(ke[1]==0)return _r(q,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}ie!==512&&(G=q.slice(0,ie),rs(G,28));var Be=q.slice(0,ie);m(G,ae);var tt=G.read_shift(4,"i");if(ae===3&&tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tt);G.l+=4,Pe=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),ze=G.read_shift(4,"i"),de=G.read_shift(4,"i"),Le=G.read_shift(4,"i"),pe=G.read_shift(4,"i");for(var Xe=-1,rt=0;rt<109&&(Xe=G.read_shift(4,"i"),!(Xe<0));++rt)Fe[rt]=Xe;var Nt=f(q,ie);b(Le,pe,Nt,ie,Fe);var Zt=N(Nt,Pe,Fe,ie);Zt[Pe].name="!Directory",de>0&&ze!==U&&(Zt[ze].name="!MiniFAT"),Zt[Fe[0]].name="!FAT",Zt.fat_addrs=Fe,Zt.ssz=ie;var Ht={},$r=[],za=[],Ms=[];S(Pe,Zt,Nt,$r,de,Ht,za,ze),x(za,Ms,$r),$r.shift();var ii={FileIndex:za,FullPaths:Ms};return ce&&ce.raw&&(ii.raw={header:Be,sectors:Nt}),ii}function h(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(F,"Header Signature: "),q.l+=16;var ce=q.read_shift(2,"u");return[q.read_shift(2,"u"),ce]}function m(q,ce){var ae=9;switch(q.l+=2,ae=q.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function f(q,ce){for(var ae=Math.ceil(q.length/ce)-1,ie=[],de=1;de<ae;++de)ie[de-1]=q.slice(de*ce,(de+1)*ce);return ie[ae-1]=q.slice(ae*ce),ie}function x(q,ce,ae){for(var ie=0,de=0,pe=0,Pe=0,ze=0,Le=ae.length,Fe=[],G=[];ie<Le;++ie)Fe[ie]=G[ie]=ie,ce[ie]=ae[ie];for(;ze<G.length;++ze)ie=G[ze],de=q[ie].L,pe=q[ie].R,Pe=q[ie].C,Fe[ie]===ie&&(de!==-1&&Fe[de]!==de&&(Fe[ie]=Fe[de]),pe!==-1&&Fe[pe]!==pe&&(Fe[ie]=Fe[pe])),Pe!==-1&&(Fe[Pe]=ie),de!==-1&&ie!=Fe[ie]&&(Fe[de]=Fe[ie],G.lastIndexOf(de)<ze&&G.push(de)),pe!==-1&&ie!=Fe[ie]&&(Fe[pe]=Fe[ie],G.lastIndexOf(pe)<ze&&G.push(pe));for(ie=1;ie<Le;++ie)Fe[ie]===ie&&(pe!==-1&&Fe[pe]!==pe?Fe[ie]=Fe[pe]:de!==-1&&Fe[de]!==de&&(Fe[ie]=Fe[de]));for(ie=1;ie<Le;++ie)if(q[ie].type!==0){if(ze=ie,ze!=Fe[ze])do ze=Fe[ze],ce[ie]=ce[ze]+"/"+ce[ie];while(ze!==0&&Fe[ze]!==-1&&ze!=Fe[ze]);Fe[ie]=-1}for(ce[0]+="/",ie=1;ie<Le;++ie)q[ie].type!==2&&(ce[ie]+="/")}function g(q,ce,ae){for(var ie=q.start,de=q.size,pe=[],Pe=ie;ae&&de>0&&Pe>=0;)pe.push(ce.slice(Pe*M,Pe*M+M)),de-=M,Pe=Dl(ae,Pe*4);return pe.length===0?qe(0):Yn(pe).slice(0,q.size)}function b(q,ce,ae,ie,de){var pe=U;if(q===U){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Pe=ae[q],ze=(ie>>>2)-1;if(!Pe)return;for(var Le=0;Le<ze&&(pe=Dl(Pe,Le*4))!==U;++Le)de.push(pe);b(Dl(Pe,ie-4),ce-1,ae,ie,de)}}function y(q,ce,ae,ie,de){var pe=[],Pe=[];de||(de=[]);var ze=ie-1,Le=0,Fe=0;for(Le=ce;Le>=0;){de[Le]=!0,pe[pe.length]=Le,Pe.push(q[Le]);var G=ae[Math.floor(Le*4/ie)];if(Fe=Le*4&ze,ie<4+Fe)throw new Error("FAT boundary crossed: "+Le+" 4 "+ie);if(!q[G])break;Le=Dl(q[G],Fe)}return{nodes:pe,data:lb([Pe])}}function N(q,ce,ae,ie){var de=q.length,pe=[],Pe=[],ze=[],Le=[],Fe=ie-1,G=0,ke=0,Be=0,tt=0;for(G=0;G<de;++G)if(ze=[],Be=G+ce,Be>=de&&(Be-=de),!Pe[Be]){Le=[];var Xe=[];for(ke=Be;ke>=0;){Xe[ke]=!0,Pe[ke]=!0,ze[ze.length]=ke,Le.push(q[ke]);var rt=ae[Math.floor(ke*4/ie)];if(tt=ke*4&Fe,ie<4+tt)throw new Error("FAT boundary crossed: "+ke+" 4 "+ie);if(!q[rt]||(ke=Dl(q[rt],tt),Xe[ke]))break}pe[Be]={nodes:ze,data:lb([Le])}}return pe}function S(q,ce,ae,ie,de,pe,Pe,ze){for(var Le=0,Fe=ie.length?2:0,G=ce[q].data,ke=0,Be=0,tt;ke<G.length;ke+=128){var Xe=G.slice(ke,ke+128);rs(Xe,64),Be=Xe.read_shift(2),tt=t1(Xe,0,Be-Fe),ie.push(tt);var rt={name:tt,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},Nt=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);Nt!==0&&(rt.ct=_(Xe,Xe.l-8));var Zt=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);Zt!==0&&(rt.mt=_(Xe,Xe.l-8)),rt.start=Xe.read_shift(4,"i"),rt.size=Xe.read_shift(4,"i"),rt.size<0&&rt.start<0&&(rt.size=rt.type=0,rt.start=U,rt.name=""),rt.type===5?(Le=rt.start,de>0&&Le!==U&&(ce[Le].name="!StreamData")):rt.size>=4096?(rt.storage="fat",ce[rt.start]===void 0&&(ce[rt.start]=y(ae,rt.start,ce.fat_addrs,ce.ssz)),ce[rt.start].name=rt.name,rt.content=ce[rt.start].data.slice(0,rt.size)):(rt.storage="minifat",rt.size<0?rt.size=0:Le!==U&&rt.start!==U&&ce[Le]&&(rt.content=g(rt,ce[Le].data,(ce[ze]||{}).data))),rt.content&&rs(rt.content,0),pe[tt]=rt,Pe.push(rt)}}function _(q,ce){return new Date((as(q,ce+4)/1e7*Math.pow(2,32)+as(q,ce)/1e7-11644473600)*1e3)}function D(q,ce){return d(),u(c.readFileSync(q),ce)}function I(q,ce){var ae=ce&&ce.type;switch(ae||hr&&Buffer.isBuffer(q)&&(ae="buffer"),ae||"base64"){case"file":return D(q,ce);case"base64":return u(Gs(lo(q)),ce);case"binary":return u(Gs(q),ce)}return u(q,ce)}function O(q,ce){var ae=ce||{},ie=ae.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ie+"/",q.FileIndex[0]={name:ie,type:5}),ae.CLSID&&(q.FileIndex[0].clsid=ae.CLSID),R(q)}function R(q){var ce="Sh33tJ5";if(!Nr.find(q,"/"+ce)){var ae=qe(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,q.FileIndex.push({name:ce,type:2,content:ae,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+ce),E(q)}}function E(q,ce){O(q);for(var ae=!1,ie=!1,de=q.FullPaths.length-1;de>=0;--de){var pe=q.FileIndex[de];switch(pe.type){case 0:ie?ae=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ie=!0,isNaN(pe.R*pe.L*pe.C)&&(ae=!0),pe.R>-1&&pe.L>-1&&pe.R==pe.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!ce)){var Pe=new Date(1987,1,19),ze=0,Le=Object.create?Object.create(null):{},Fe=[];for(de=0;de<q.FullPaths.length;++de)Le[q.FullPaths[de]]=!0,q.FileIndex[de].type!==0&&Fe.push([q.FullPaths[de],q.FileIndex[de]]);for(de=0;de<Fe.length;++de){var G=n(Fe[de][0]);ie=Le[G],ie||(Fe.push([G,{name:a(G).replace("/",""),type:1,clsid:V,ct:Pe,mt:Pe,content:null}]),Le[G]=!0)}for(Fe.sort(function(tt,Xe){return r(tt[0],Xe[0])}),q.FullPaths=[],q.FileIndex=[],de=0;de<Fe.length;++de)q.FullPaths[de]=Fe[de][0],q.FileIndex[de]=Fe[de][1];for(de=0;de<Fe.length;++de){var ke=q.FileIndex[de],Be=q.FullPaths[de];if(ke.name=a(Be).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||V,de===0)ke.C=Fe.length>1?1:-1,ke.size=0,ke.type=5;else if(Be.slice(-1)=="/"){for(ze=de+1;ze<Fe.length&&n(q.FullPaths[ze])!=Be;++ze);for(ke.C=ze>=Fe.length?-1:ze,ze=de+1;ze<Fe.length&&n(q.FullPaths[ze])!=n(Be);++ze);ke.R=ze>=Fe.length?-1:ze,ke.type=1}else n(q.FullPaths[de+1]||"")==n(Be)&&(ke.R=de+1),ke.type=2}}}function B(q,ce){var ae=ce||{};if(ae.fileType=="mad")return Ua(q,ae);switch(E(q),ae.fileType){case"zip":return ur(q,ae)}var ie=function(tt){for(var Xe=0,rt=0,Nt=0;Nt<tt.FileIndex.length;++Nt){var Zt=tt.FileIndex[Nt];if(Zt.content){var Ht=Zt.content.length;Ht>0&&(Ht<4096?Xe+=Ht+63>>6:rt+=Ht+511>>9)}}for(var $r=tt.FullPaths.length+3>>2,za=Xe+7>>3,Ms=Xe+127>>7,ii=za+rt+$r+Ms,cs=ii+127>>7,vo=cs<=109?0:Math.ceil((cs-109)/127);ii+cs+vo+127>>7>cs;)vo=++cs<=109?0:Math.ceil((cs-109)/127);var ea=[1,vo,cs,Ms,$r,rt,Xe,0];return tt.FileIndex[0].size=Xe<<6,ea[7]=(tt.FileIndex[0].start=ea[0]+ea[1]+ea[2]+ea[3]+ea[4]+ea[5])+(ea[6]+7>>3),ea}(q),de=qe(ie[7]<<9),pe=0,Pe=0;{for(pe=0;pe<8;++pe)de.write_shift(1,ne[pe]);for(pe=0;pe<8;++pe)de.write_shift(2,0);for(de.write_shift(2,62),de.write_shift(2,3),de.write_shift(2,65534),de.write_shift(2,9),de.write_shift(2,6),pe=0;pe<3;++pe)de.write_shift(2,0);for(de.write_shift(4,0),de.write_shift(4,ie[2]),de.write_shift(4,ie[0]+ie[1]+ie[2]+ie[3]-1),de.write_shift(4,0),de.write_shift(4,4096),de.write_shift(4,ie[3]?ie[0]+ie[1]+ie[2]-1:U),de.write_shift(4,ie[3]),de.write_shift(-4,ie[1]?ie[0]-1:U),de.write_shift(4,ie[1]),pe=0;pe<109;++pe)de.write_shift(-4,pe<ie[2]?ie[1]+pe:-1)}if(ie[1])for(Pe=0;Pe<ie[1];++Pe){for(;pe<236+Pe*127;++pe)de.write_shift(-4,pe<ie[2]?ie[1]+pe:-1);de.write_shift(-4,Pe===ie[1]-1?U:Pe+1)}var ze=function(tt){for(Pe+=tt;pe<Pe-1;++pe)de.write_shift(-4,pe+1);tt&&(++pe,de.write_shift(-4,U))};for(Pe=pe=0,Pe+=ie[1];pe<Pe;++pe)de.write_shift(-4,ee.DIFSECT);for(Pe+=ie[2];pe<Pe;++pe)de.write_shift(-4,ee.FATSECT);ze(ie[3]),ze(ie[4]);for(var Le=0,Fe=0,G=q.FileIndex[0];Le<q.FileIndex.length;++Le)G=q.FileIndex[Le],G.content&&(Fe=G.content.length,!(Fe<4096)&&(G.start=Pe,ze(Fe+511>>9)));for(ze(ie[6]+7>>3);de.l&511;)de.write_shift(-4,ee.ENDOFCHAIN);for(Pe=pe=0,Le=0;Le<q.FileIndex.length;++Le)G=q.FileIndex[Le],G.content&&(Fe=G.content.length,!(!Fe||Fe>=4096)&&(G.start=Pe,ze(Fe+63>>6)));for(;de.l&511;)de.write_shift(-4,ee.ENDOFCHAIN);for(pe=0;pe<ie[4]<<2;++pe){var ke=q.FullPaths[pe];if(!ke||ke.length===0){for(Le=0;Le<17;++Le)de.write_shift(4,0);for(Le=0;Le<3;++Le)de.write_shift(4,-1);for(Le=0;Le<12;++Le)de.write_shift(4,0);continue}G=q.FileIndex[pe],pe===0&&(G.start=G.size?G.start-1:U);var Be=pe===0&&ae.root||G.name;if(Fe=2*(Be.length+1),de.write_shift(64,Be,"utf16le"),de.write_shift(2,Fe),de.write_shift(1,G.type),de.write_shift(1,G.color),de.write_shift(-4,G.L),de.write_shift(-4,G.R),de.write_shift(-4,G.C),G.clsid)de.write_shift(16,G.clsid,"hex");else for(Le=0;Le<4;++Le)de.write_shift(4,0);de.write_shift(4,G.state||0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,G.start),de.write_shift(4,G.size),de.write_shift(4,0)}for(pe=1;pe<q.FileIndex.length;++pe)if(G=q.FileIndex[pe],G.size>=4096)if(de.l=G.start+1<<9,hr&&Buffer.isBuffer(G.content))G.content.copy(de,de.l,0,G.size),de.l+=G.size+511&-512;else{for(Le=0;Le<G.size;++Le)de.write_shift(1,G.content[Le]);for(;Le&511;++Le)de.write_shift(1,0)}for(pe=1;pe<q.FileIndex.length;++pe)if(G=q.FileIndex[pe],G.size>0&&G.size<4096)if(hr&&Buffer.isBuffer(G.content))G.content.copy(de,de.l,0,G.size),de.l+=G.size+63&-64;else{for(Le=0;Le<G.size;++Le)de.write_shift(1,G.content[Le]);for(;Le&63;++Le)de.write_shift(1,0)}if(hr)de.l=de.length;else for(;de.l<de.length;)de.write_shift(1,0);return de}function C(q,ce){var ae=q.FullPaths.map(function(Le){return Le.toUpperCase()}),ie=ae.map(function(Le){var Fe=Le.split("/");return Fe[Fe.length-(Le.slice(-1)=="/"?2:1)]}),de=!1;ce.charCodeAt(0)===47?(de=!0,ce=ae[0].slice(0,-1)+ce):de=ce.indexOf("/")!==-1;var pe=ce.toUpperCase(),Pe=de===!0?ae.indexOf(pe):ie.indexOf(pe);if(Pe!==-1)return q.FileIndex[Pe];var ze=!pe.match(lh);for(pe=pe.replace(fu,""),ze&&(pe=pe.replace(lh,"!")),Pe=0;Pe<ae.length;++Pe)if((ze?ae[Pe].replace(lh,"!"):ae[Pe]).replace(fu,"")==pe||(ze?ie[Pe].replace(lh,"!"):ie[Pe]).replace(fu,"")==pe)return q.FileIndex[Pe];return null}var M=64,U=-2,F="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:F,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(q,ce,ae){d();var ie=B(q,ae);c.writeFileSync(ce,ie)}function ye(q){for(var ce=new Array(q.length),ae=0;ae<q.length;++ae)ce[ae]=String.fromCharCode(q[ae]);return ce.join("")}function Oe(q,ce){var ae=B(q,ce);switch(ce&&ce.type||"buffer"){case"file":return d(),c.writeFileSync(ce.filename,ae),ae;case"binary":return typeof ae=="string"?ae:ye(ae);case"base64":return Tu(typeof ae=="string"?ae:ye(ae));case"buffer":if(hr)return Buffer.isBuffer(ae)?ae:mo(ae);case"array":return typeof ae=="string"?Gs(ae):ae}return ae}var xe;function w(q){try{var ce=q.InflateRaw,ae=new ce;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)xe=q;else throw new Error("zlib does not expose bytesRead")}catch(ie){console.error("cannot use native zlib: "+(ie.message||ie))}}function A(q,ce){if(!xe)return Xt(q,ce);var ae=xe.InflateRaw,ie=new ae,de=ie._processChunk(q.slice(q.l),ie._finishFlushFlag);return q.l+=ie.bytesRead,de}function T(q){return xe?xe.deflateRawSync(q):pt(q)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(q){var ce=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var ge=typeof Uint8Array<"u",oe=ge?new Uint8Array(256):[],je=0;je<256;++je)oe[je]=re(je);function Ie(q,ce){var ae=oe[q&255];return ce<=8?ae>>>8-ce:(ae=ae<<8|oe[q>>8&255],ce<=16?ae>>>16-ce:(ae=ae<<8|oe[q>>16&255],ae>>>24-ce))}function et(q,ce){var ae=ce&7,ie=ce>>>3;return(q[ie]|(ae<=6?0:q[ie+1]<<8))>>>ae&3}function Te(q,ce){var ae=ce&7,ie=ce>>>3;return(q[ie]|(ae<=5?0:q[ie+1]<<8))>>>ae&7}function Y(q,ce){var ae=ce&7,ie=ce>>>3;return(q[ie]|(ae<=4?0:q[ie+1]<<8))>>>ae&15}function We(q,ce){var ae=ce&7,ie=ce>>>3;return(q[ie]|(ae<=3?0:q[ie+1]<<8))>>>ae&31}function Q(q,ce){var ae=ce&7,ie=ce>>>3;return(q[ie]|(ae<=1?0:q[ie+1]<<8))>>>ae&127}function ve(q,ce,ae){var ie=ce&7,de=ce>>>3,pe=(1<<ae)-1,Pe=q[de]>>>ie;return ae<8-ie||(Pe|=q[de+1]<<8-ie,ae<16-ie)||(Pe|=q[de+2]<<16-ie,ae<24-ie)||(Pe|=q[de+3]<<24-ie),Pe&pe}function we(q,ce,ae){var ie=ce&7,de=ce>>>3;return ie<=5?q[de]|=(ae&7)<<ie:(q[de]|=ae<<ie&255,q[de+1]=(ae&7)>>8-ie),ce+3}function Re(q,ce,ae){var ie=ce&7,de=ce>>>3;return ae=(ae&1)<<ie,q[de]|=ae,ce+1}function He(q,ce,ae){var ie=ce&7,de=ce>>>3;return ae<<=ie,q[de]|=ae&255,ae>>>=8,q[de+1]=ae,ce+8}function vt(q,ce,ae){var ie=ce&7,de=ce>>>3;return ae<<=ie,q[de]|=ae&255,ae>>>=8,q[de+1]=ae&255,q[de+2]=ae>>>8,ce+16}function le(q,ce){var ae=q.length,ie=2*ae>ce?2*ae:ce+5,de=0;if(ae>=ce)return q;if(hr){var pe=Vv(ie);if(q.copy)q.copy(pe);else for(;de<q.length;++de)pe[de]=q[de];return pe}else if(ge){var Pe=new Uint8Array(ie);if(Pe.set)Pe.set(q);else for(;de<ae;++de)Pe[de]=q[de];return Pe}return q.length=ie,q}function Ae(q){for(var ce=new Array(q),ae=0;ae<q;++ae)ce[ae]=0;return ce}function Qe(q,ce,ae){var ie=1,de=0,pe=0,Pe=0,ze=0,Le=q.length,Fe=ge?new Uint16Array(32):Ae(32);for(pe=0;pe<32;++pe)Fe[pe]=0;for(pe=Le;pe<ae;++pe)q[pe]=0;Le=q.length;var G=ge?new Uint16Array(Le):Ae(Le);for(pe=0;pe<Le;++pe)Fe[de=q[pe]]++,ie<de&&(ie=de),G[pe]=0;for(Fe[0]=0,pe=1;pe<=ie;++pe)Fe[pe+16]=ze=ze+Fe[pe-1]<<1;for(pe=0;pe<Le;++pe)ze=q[pe],ze!=0&&(G[pe]=Fe[ze+16]++);var ke=0;for(pe=0;pe<Le;++pe)if(ke=q[pe],ke!=0)for(ze=Ie(G[pe],ie)>>ie-ke,Pe=(1<<ie+4-ke)-1;Pe>=0;--Pe)ce[ze|Pe<<ke]=ke&15|pe<<4;return ie}var _e=ge?new Uint16Array(512):Ae(512),Ze=ge?new Uint16Array(32):Ae(32);if(!ge){for(var Ve=0;Ve<512;++Ve)_e[Ve]=0;for(Ve=0;Ve<32;++Ve)Ze[Ve]=0}(function(){for(var q=[],ce=0;ce<32;ce++)q.push(5);Qe(q,Ze,32);var ae=[];for(ce=0;ce<=143;ce++)ae.push(8);for(;ce<=255;ce++)ae.push(9);for(;ce<=279;ce++)ae.push(7);for(;ce<=287;ce++)ae.push(8);Qe(ae,_e,288)})();var ot=function(){for(var ce=ge?new Uint8Array(32768):[],ae=0,ie=0;ae<X.length-1;++ae)for(;ie<X[ae+1];++ie)ce[ie]=ae;for(;ie<32768;++ie)ce[ie]=29;var de=ge?new Uint8Array(259):[];for(ae=0,ie=0;ae<H.length-1;++ae)for(;ie<H[ae+1];++ie)de[ie]=ae;function pe(ze,Le){for(var Fe=0;Fe<ze.length;){var G=Math.min(65535,ze.length-Fe),ke=Fe+G==ze.length;for(Le.write_shift(1,+ke),Le.write_shift(2,G),Le.write_shift(2,~G&65535);G-- >0;)Le[Le.l++]=ze[Fe++]}return Le.l}function Pe(ze,Le){for(var Fe=0,G=0,ke=ge?new Uint16Array(32768):[];G<ze.length;){var Be=Math.min(65535,ze.length-G);if(Be<10){for(Fe=we(Le,Fe,+(G+Be==ze.length)),Fe&7&&(Fe+=8-(Fe&7)),Le.l=Fe/8|0,Le.write_shift(2,Be),Le.write_shift(2,~Be&65535);Be-- >0;)Le[Le.l++]=ze[G++];Fe=Le.l*8;continue}Fe=we(Le,Fe,+(G+Be==ze.length)+2);for(var tt=0;Be-- >0;){var Xe=ze[G];tt=(tt<<5^Xe)&32767;var rt=-1,Nt=0;if((rt=ke[tt])&&(rt|=G&-32768,rt>G&&(rt-=32768),rt<G))for(;ze[rt+Nt]==ze[G+Nt]&&Nt<250;)++Nt;if(Nt>2){Xe=de[Nt],Xe<=22?Fe=He(Le,Fe,oe[Xe+1]>>1)-1:(He(Le,Fe,3),Fe+=5,He(Le,Fe,oe[Xe-23]>>5),Fe+=3);var Zt=Xe<8?0:Xe-4>>2;Zt>0&&(vt(Le,Fe,Nt-H[Xe]),Fe+=Zt),Xe=ce[G-rt],Fe=He(Le,Fe,oe[Xe]>>3),Fe-=3;var Ht=Xe<4?0:Xe-2>>1;Ht>0&&(vt(Le,Fe,G-rt-X[Xe]),Fe+=Ht);for(var $r=0;$r<Nt;++$r)ke[tt]=G&32767,tt=(tt<<5^ze[G])&32767,++G;Be-=Nt-1}else Xe<=143?Xe=Xe+48:Fe=Re(Le,Fe,1),Fe=He(Le,Fe,oe[Xe]),ke[tt]=G&32767,++G}Fe=He(Le,Fe,0)-1}return Le.l=(Fe+7)/8|0,Le.l}return function(Le,Fe){return Le.length<8?pe(Le,Fe):Pe(Le,Fe)}}();function pt(q){var ce=qe(50+Math.floor(q.length*1.1)),ae=ot(q,ce);return ce.slice(0,ae)}var yt=ge?new Uint16Array(32768):Ae(32768),ir=ge?new Uint16Array(32768):Ae(32768),ct=ge?new Uint16Array(128):Ae(128),ut=1,Ot=1;function zt(q,ce){var ae=We(q,ce)+257;ce+=5;var ie=We(q,ce)+1;ce+=5;var de=Y(q,ce)+4;ce+=4;for(var pe=0,Pe=ge?new Uint8Array(19):Ae(19),ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Le=1,Fe=ge?new Uint8Array(8):Ae(8),G=ge?new Uint8Array(8):Ae(8),ke=Pe.length,Be=0;Be<de;++Be)Pe[L[Be]]=pe=Te(q,ce),Le<pe&&(Le=pe),Fe[pe]++,ce+=3;var tt=0;for(Fe[0]=0,Be=1;Be<=Le;++Be)G[Be]=tt=tt+Fe[Be-1]<<1;for(Be=0;Be<ke;++Be)(tt=Pe[Be])!=0&&(ze[Be]=G[tt]++);var Xe=0;for(Be=0;Be<ke;++Be)if(Xe=Pe[Be],Xe!=0){tt=oe[ze[Be]]>>8-Xe;for(var rt=(1<<7-Xe)-1;rt>=0;--rt)ct[tt|rt<<Xe]=Xe&7|Be<<3}var Nt=[];for(Le=1;Nt.length<ae+ie;)switch(tt=ct[Q(q,ce)],ce+=tt&7,tt>>>=3){case 16:for(pe=3+et(q,ce),ce+=2,tt=Nt[Nt.length-1];pe-- >0;)Nt.push(tt);break;case 17:for(pe=3+Te(q,ce),ce+=3;pe-- >0;)Nt.push(0);break;case 18:for(pe=11+Q(q,ce),ce+=7;pe-- >0;)Nt.push(0);break;default:Nt.push(tt),Le<tt&&(Le=tt);break}var Zt=Nt.slice(0,ae),Ht=Nt.slice(ae);for(Be=ae;Be<286;++Be)Zt[Be]=0;for(Be=ie;Be<30;++Be)Ht[Be]=0;return ut=Qe(Zt,yt,286),Ot=Qe(Ht,ir,30),ce}function Dt(q,ce){if(q[0]==3&&!(q[1]&3))return[ql(ce),2];for(var ae=0,ie=0,de=Vv(ce||1<<18),pe=0,Pe=de.length>>>0,ze=0,Le=0;!(ie&1);){if(ie=Te(q,ae),ae+=3,ie>>>1)ie>>1==1?(ze=9,Le=5):(ae=zt(q,ae),ze=ut,Le=Ot);else{ae&7&&(ae+=8-(ae&7));var Fe=q[ae>>>3]|q[(ae>>>3)+1]<<8;if(ae+=32,Fe>0)for(!ce&&Pe<pe+Fe&&(de=le(de,pe+Fe),Pe=de.length);Fe-- >0;)de[pe++]=q[ae>>>3],ae+=8;continue}for(;;){!ce&&Pe<pe+32767&&(de=le(de,pe+32767),Pe=de.length);var G=ve(q,ae,ze),ke=ie>>>1==1?_e[G]:yt[G];if(ae+=ke&15,ke>>>=4,!(ke>>>8&255))de[pe++]=ke;else{if(ke==256)break;ke-=257;var Be=ke<8?0:ke-4>>2;Be>5&&(Be=0);var tt=pe+H[ke];Be>0&&(tt+=ve(q,ae,Be),ae+=Be),G=ve(q,ae,Le),ke=ie>>>1==1?Ze[G]:ir[G],ae+=ke&15,ke>>>=4;var Xe=ke<4?0:ke-2>>1,rt=X[ke];for(Xe>0&&(rt+=ve(q,ae,Xe),ae+=Xe),!ce&&Pe<tt&&(de=le(de,tt+100),Pe=de.length);pe<tt;)de[pe]=de[pe-rt],++pe}}}return ce?[de,ae+7>>>3]:[de.slice(0,pe),ae+7>>>3]}function Xt(q,ce){var ae=q.slice(q.l||0),ie=Dt(ae,ce);return q.l+=ie[1],ie[0]}function $t(q,ce){if(q)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function _r(q,ce){var ae=q;rs(ae,0);var ie=[],de=[],pe={FileIndex:ie,FullPaths:de};O(pe,{root:ce.root});for(var Pe=ae.length-4;(ae[Pe]!=80||ae[Pe+1]!=75||ae[Pe+2]!=5||ae[Pe+3]!=6)&&Pe>=0;)--Pe;ae.l=Pe+4,ae.l+=4;var ze=ae.read_shift(2);ae.l+=6;var Le=ae.read_shift(4);for(ae.l=Le,Pe=0;Pe<ze;++Pe){ae.l+=20;var Fe=ae.read_shift(4),G=ae.read_shift(4),ke=ae.read_shift(2),Be=ae.read_shift(2),tt=ae.read_shift(2);ae.l+=8;var Xe=ae.read_shift(4),rt=l(ae.slice(ae.l+ke,ae.l+ke+Be));ae.l+=ke+Be+tt;var Nt=ae.l;ae.l=Xe+4,Fr(ae,Fe,G,pe,rt),ae.l=Nt}return pe}function Fr(q,ce,ae,ie,de){q.l+=2;var pe=q.read_shift(2),Pe=q.read_shift(2),ze=o(q);if(pe&8257)throw new Error("Unsupported ZIP encryption");for(var Le=q.read_shift(4),Fe=q.read_shift(4),G=q.read_shift(4),ke=q.read_shift(2),Be=q.read_shift(2),tt="",Xe=0;Xe<ke;++Xe)tt+=String.fromCharCode(q[q.l++]);if(Be){var rt=l(q.slice(q.l,q.l+Be));(rt[21589]||{}).mt&&(ze=rt[21589].mt),((de||{})[21589]||{}).mt&&(ze=de[21589].mt)}q.l+=Be;var Nt=q.slice(q.l,q.l+Fe);switch(Pe){case 8:Nt=A(q,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var Zt=!1;pe&8&&(Le=q.read_shift(4),Le==134695760&&(Le=q.read_shift(4),Zt=!0),Fe=q.read_shift(4),G=q.read_shift(4)),Fe!=ce&&$t(Zt,"Bad compressed size: "+ce+" != "+Fe),G!=ae&&$t(Zt,"Bad uncompressed size: "+ae+" != "+G),Pn(ie,tt,Nt,{unsafe:!0,mt:ze})}function ur(q,ce){var ae=ce||{},ie=[],de=[],pe=qe(1),Pe=ae.compression?8:0,ze=0,Le=0,Fe=0,G=0,ke=0,Be=q.FullPaths[0],tt=Be,Xe=q.FileIndex[0],rt=[],Nt=0;for(Le=1;Le<q.FullPaths.length;++Le)if(tt=q.FullPaths[Le].slice(Be.length),Xe=q.FileIndex[Le],!(!Xe.size||!Xe.content||tt=="Sh33tJ5")){var Zt=G,Ht=qe(tt.length);for(Fe=0;Fe<tt.length;++Fe)Ht.write_shift(1,tt.charCodeAt(Fe)&127);Ht=Ht.slice(0,Ht.l),rt[ke]=kA.buf(Xe.content,0);var $r=Xe.content;Pe==8&&($r=T($r)),pe=qe(30),pe.write_shift(4,67324752),pe.write_shift(2,20),pe.write_shift(2,ze),pe.write_shift(2,Pe),Xe.mt?s(pe,Xe.mt):pe.write_shift(4,0),pe.write_shift(-4,rt[ke]),pe.write_shift(4,$r.length),pe.write_shift(4,Xe.content.length),pe.write_shift(2,Ht.length),pe.write_shift(2,0),G+=pe.length,ie.push(pe),G+=Ht.length,ie.push(Ht),G+=$r.length,ie.push($r),pe=qe(46),pe.write_shift(4,33639248),pe.write_shift(2,0),pe.write_shift(2,20),pe.write_shift(2,ze),pe.write_shift(2,Pe),pe.write_shift(4,0),pe.write_shift(-4,rt[ke]),pe.write_shift(4,$r.length),pe.write_shift(4,Xe.content.length),pe.write_shift(2,Ht.length),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(4,0),pe.write_shift(4,Zt),Nt+=pe.l,de.push(pe),Nt+=Ht.length,de.push(Ht),++ke}return pe=qe(22),pe.write_shift(4,101010256),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,ke),pe.write_shift(2,ke),pe.write_shift(4,Nt),pe.write_shift(4,G),pe.write_shift(2,0),Yn([Yn(ie),Yn(de),pe])}var Ft={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nr(q,ce){if(q.ctype)return q.ctype;var ae=q.name||"",ie=ae.match(/\.([^\.]+)$/);return ie&&Ft[ie[1]]||ce&&(ie=(ae=ce).match(/[\.\\]([^\.\\])+$/),ie&&Ft[ie[1]])?Ft[ie[1]]:"application/octet-stream"}function Rs(q){for(var ce=Tu(q),ae=[],ie=0;ie<ce.length;ie+=76)ae.push(ce.slice(ie,ie+76));return ae.join(`\r
`)+`\r
`}function an(q){var ce=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Fe){var G=Fe.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],ie=ce.split(`\r
`),de=0;de<ie.length;++de){var pe=ie[de];if(pe.length==0){ae.push("");continue}for(var Pe=0;Pe<pe.length;){var ze=76,Le=pe.slice(Pe,Pe+ze);Le.charAt(ze-1)=="="?ze--:Le.charAt(ze-2)=="="?ze-=2:Le.charAt(ze-3)=="="&&(ze-=3),Le=pe.slice(Pe,Pe+ze),Pe+=ze,Pe<pe.length&&(Le+="="),ae.push(Le)}}return ae.join(`\r
`)}function Zn(q){for(var ce=[],ae=0;ae<q.length;++ae){for(var ie=q[ae];ae<=q.length&&ie.charAt(ie.length-1)=="=";)ie=ie.slice(0,ie.length-1)+q[++ae];ce.push(ie)}for(var de=0;de<ce.length;++de)ce[de]=ce[de].replace(/[=][0-9A-Fa-f]{2}/g,function(pe){return String.fromCharCode(parseInt(pe.slice(1),16))});return Gs(ce.join(`\r
`))}function ka(q,ce,ae){for(var ie="",de="",pe="",Pe,ze=0;ze<10;++ze){var Le=ce[ze];if(!Le||Le.match(/^\s*$/))break;var Fe=Le.match(/^(.*?):\s*([^\s].*)$/);if(Fe)switch(Fe[1].toLowerCase()){case"content-location":ie=Fe[2].trim();break;case"content-type":pe=Fe[2].trim();break;case"content-transfer-encoding":de=Fe[2].trim();break}}switch(++ze,de.toLowerCase()){case"base64":Pe=Gs(lo(ce.slice(ze).join("")));break;case"quoted-printable":Pe=Zn(ce.slice(ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+de)}var G=Pn(q,ie.slice(ae.length),Pe,{unsafe:!0});pe&&(G.ctype=pe)}function Lt(q,ce){if(ye(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=ce&&ce.root||"",ie=(hr&&Buffer.isBuffer(q)?q.toString("binary"):ye(q)).split(`\r
`),de=0,pe="";for(de=0;de<ie.length;++de)if(pe=ie[de],!!/^Content-Location:/i.test(pe)&&(pe=pe.slice(pe.indexOf("file")),ae||(ae=pe.slice(0,pe.lastIndexOf("/")+1)),pe.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),pe.slice(0,ae.length)!=ae););var Pe=(ie[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var ze="--"+(Pe[1]||""),Le=[],Fe=[],G={FileIndex:Le,FullPaths:Fe};O(G);var ke,Be=0;for(de=0;de<ie.length;++de){var tt=ie[de];tt!==ze&&tt!==ze+"--"||(Be++&&ka(G,ie.slice(ke,de),ae),ke=de)}return G}function Ua(q,ce){var ae=ce||{},ie=ae.boundary||"SheetJS";ie="------="+ie;for(var de=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ie.slice(2)+'"',"","",""],pe=q.FullPaths[0],Pe=pe,ze=q.FileIndex[0],Le=1;Le<q.FullPaths.length;++Le)if(Pe=q.FullPaths[Le].slice(pe.length),ze=q.FileIndex[Le],!(!ze.size||!ze.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nt){return"_x"+Nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nt){return"_u"+Nt.charCodeAt(0).toString(16)+"_"});for(var Fe=ze.content,G=hr&&Buffer.isBuffer(Fe)?Fe.toString("binary"):ye(Fe),ke=0,Be=Math.min(1024,G.length),tt=0,Xe=0;Xe<=Be;++Xe)(tt=G.charCodeAt(Xe))>=32&&tt<128&&++ke;var rt=ke>=Be*4/5;de.push(ie),de.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Pe),de.push("Content-Transfer-Encoding: "+(rt?"quoted-printable":"base64")),de.push("Content-Type: "+nr(ze,Pe)),de.push(""),de.push(rt?an(G):Rs(G))}return de.push(ie+`--\r
`),de.join(`\r
`)}function Wa(q){var ce={};return O(ce,q),ce}function Pn(q,ce,ae,ie){var de=ie&&ie.unsafe;de||O(q);var pe=!de&&Nr.find(q,ce);if(!pe){var Pe=q.FullPaths[0];ce.slice(0,Pe.length)==Pe?Pe=ce:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+ce).replace("//","/")),pe={name:a(ce),type:2},q.FileIndex.push(pe),q.FullPaths.push(Pe),de||Nr.utils.cfb_gc(q)}return pe.content=ae,pe.size=ae?ae.length:0,ie&&(ie.CLSID&&(pe.clsid=ie.CLSID),ie.mt&&(pe.mt=ie.mt),ie.ct&&(pe.ct=ie.ct)),pe}function Qn(q,ce){O(q);var ae=Nr.find(q,ce);if(ae){for(var ie=0;ie<q.FileIndex.length;++ie)if(q.FileIndex[ie]==ae)return q.FileIndex.splice(ie,1),q.FullPaths.splice(ie,1),!0}return!1}function Cr(q,ce,ae){O(q);var ie=Nr.find(q,ce);if(ie){for(var de=0;de<q.FileIndex.length;++de)if(q.FileIndex[de]==ie)return q.FileIndex[de].name=a(ae),q.FullPaths[de]=ae,!0}return!1}function Gr(q){E(q,!0)}return t.find=C,t.read=I,t.parse=u,t.write=Oe,t.writeFile=me,t.utils={cfb_new:Wa,cfb_add:Pn,cfb_del:Qn,cfb_mov:Cr,cfb_gc:Gr,ReadShift:mu,CheckField:h_,prep_blob:rs,bconcat:Yn,use_zlib:w,_deflateRaw:pt,_inflateRaw:Xt,consts:ee},t}();function SA(e){return typeof e=="string"?Z0(e):Array.isArray(e)?JT(e):e}function af(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Z0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Eu(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([SA(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=nf(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Xn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function tb(e,t){for(var r=[],n=Xn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Jx(e){for(var t=[],r=Xn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function tm(e){for(var t=[],r=Xn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function jA(e){for(var t=[],r=Xn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var d0=new Date(1899,11,30,0,0,0);function Ma(e,t){var r=e.getTime(),n=d0.getTime()+(e.getTimezoneOffset()-d0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var X4=new Date,TA=d0.getTime()+(X4.getTimezoneOffset()-d0.getTimezoneOffset())*6e4,rb=X4.getTimezoneOffset();function J4(e){var t=new Date;return t.setTime(e*24*60*60*1e3+TA),t.getTimezoneOffset()!==rb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-rb)*6e4),t}var nb=new Date("2017-02-19T19:06:09.000Z"),Z4=isNaN(nb.getFullYear())?new Date("2/19/17"):nb,AA=Z4.getFullYear()==2017;function Na(e,t){var r=new Date(e);if(AA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Z4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function rm(e,t){if(hr&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ia(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ia(e[r]));return t}function Qr(e,t){for(var r="";r.length<t;)r+=e;return r}function no(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var EA=["january","february","march","april","may","june","july","august","september","october","november","december"];function Au(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&EA.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Jt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return hr?n=mo(r):n=ZT(r),Nr.utils.cfb_add(e,t,n)}Nr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Zx(){return Nr.utils.cfb_new()}var _n=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,CA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Qx=Jx(CA),e1=/[&<>'"]/g,DA=/[\u0000-\u0008\u000b-\u001f]/g;function yr(e){var t=e+"";return t.replace(e1,function(r){return Qx[r]}).replace(DA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ab(e){return yr(e).replace(/ /g,"_x0020_")}var Q4=/[\u0000-\u001f]/g;function OA(e){var t=e+"";return t.replace(e1,function(r){return Qx[r]}).replace(/\n/g,"<br/>").replace(Q4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function PA(e){var t=e+"";return t.replace(e1,function(r){return Qx[r]}).replace(Q4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function LA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function FA(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pp(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function sb(e){var t=ql(2*e.length),r,n,a=1,s=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ib(e){return mo(e,"binary").toString("utf8")}var dh="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",hu=hr&&(ib(dh)==Pp(dh)&&ib||sb(dh)==Pp(dh)&&sb)||Pp,Eu=hr?function(e){return mo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$A=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),e_=/(^\s|\s$|\n)/;function Vn(e,t){return"<"+e+(t.match(e_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cu(e){return Xn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ht(e,t,r){return"<"+e+(r!=null?Cu(r):"")+(t!=null?(t.match(e_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function RA(e,t){switch(typeof e){case"string":var r=ht("vt:lpwstr",yr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ht((e|0)==e?"vt:i4":"vt:r8",yr(String(e)));case"boolean":return ht("vt:bool",e?"true":"false")}if(e instanceof Date)return ht("vt:filetime",qg(e));throw new Error("Unable to serialize "+e)}var Fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},dd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ns={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function MA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function IA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,o=n?-t:t;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var ob=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},lb=hr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:mo(t)})):ob(e)}:ob,cb=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(du(e,a)));return n.join("").replace(fu,"")},t1=hr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(fu,""):cb(e,t,r)}:cb,db=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},t_=hr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):db(e,t,r)}:db,ub=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Cc(e,a)));return n.join("")},sf=hr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ub(t,r,n)}:ub,r_=function(e,t){var r=as(e,t);return r>0?sf(e,t+4,t+4+r-1):""},n_=r_,a_=function(e,t){var r=as(e,t);return r>0?sf(e,t+4,t+4+r-1):""},s_=a_,i_=function(e,t){var r=2*as(e,t);return r>0?sf(e,t+4,t+4+r-1):""},o_=i_,l_=function(t,r){var n=as(t,r);return n>0?t1(t,r+4,r+4+n):""},c_=l_,d_=function(e,t){var r=as(e,t);return r>0?sf(e,t+4,t+4+r):""},u_=d_,f_=function(e,t){return MA(e,t)},u0=f_,r1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};hr&&(n_=function(t,r){if(!Buffer.isBuffer(t))return r_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},s_=function(t,r){if(!Buffer.isBuffer(t))return a_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},o_=function(t,r){if(!Buffer.isBuffer(t))return i_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},c_=function(t,r){if(!Buffer.isBuffer(t))return l_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},u_=function(t,r){if(!Buffer.isBuffer(t))return d_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},u0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):f_(t,r)},r1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Cc=function(e,t){return e[t]},du=function(e,t){return e[t+1]*256+e[t]},BA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},as=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Dl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},UA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function mu(e,t){var r="",n,a,s=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,hr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(du(this,d)),d+=2;e*=2;break;case"utf8":r=sf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=t1(this,this.l,this.l+e);break;case"wstr":return mu.call(this,e,"dbcs");case"lpstr-ansi":r=n_(this,this.l),e=4+as(this,this.l);break;case"lpstr-cp":r=s_(this,this.l),e=4+as(this,this.l);break;case"lpwstr":r=o_(this,this.l),e=4+2*as(this,this.l);break;case"lpp4":e=4+as(this,this.l),r=c_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+as(this,this.l),r=u_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Cc(this,this.l+e++))!==0;)s.push(oh(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=du(this,this.l+e))!==0;)s.push(oh(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Cc(this,d),this.l=d+1,l=mu.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(oh(du(this,d))),d+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Cc(this,d),this.l=d+1,l=mu.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(oh(Cc(this,d))),d+=1}r=s.join("");break;default:switch(e){case 1:return n=Cc(this,this.l),this.l++,n;case 2:return n=(t==="i"?BA:du)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Dl:UA)(this,this.l),this.l+=4,n):(a=as(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=u0(this,this.l):a=u0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=t_(this,this.l,e);break}}return this.l+=e,r}var WA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},zA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},HA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function qA(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)HA(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,WA(this,t,this.l);break;case 8:if(n=8,r==="f"){IA(this,t,this.l);break}case 16:break;case-4:n=4,zA(this,t,this.l);break}return this.l+=n,this}function h_(e,t){var r=t_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rs(e,t){e.l=t,e.read_shift=mu,e.chk=h_,e.write_shift=qA}function Ti(e,t){e.l+=t}function qe(e){var t=ql(e);return rs(t,0),t}function La(){var e=[],t=hr?256:2048,r=function(d){var u=qe(d);return rs(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},o=function(){return a(),Yn(e)},l=function(d){a(),n=d,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function nt(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=MO[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&r1(r)&&e.push(r)}}function pu(e,t,r){var n=Ia(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fb(e,t,r){var n=Ia(e);return n.s=pu(n.s,t.s,r),n.e=pu(n.e,t.s,r),n}function gu(e,t){if(e.cRel&&e.c<0)for(e=Ia(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ia(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=wr(e);return!e.cRel&&e.cRel!=null&&(r=GA(r)),!e.rRel&&e.rRel!=null&&(r=YA(r)),r}function Lp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fa(e.s.c)+":"+(e.e.cRel?"":"$")+fa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Kn(e.s.r)+":"+(e.e.rRel?"":"$")+Kn(e.e.r):gu(e.s,t.biff)+":"+gu(e.e,t.biff)}function n1(e){return parseInt(VA(e),10)-1}function Kn(e){return""+(e+1)}function YA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function VA(e){return e.replace(/\$(\d+)$/,"$1")}function a1(e){for(var t=KA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fa(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GA(e){return e.replace(/^([A-Z])/,"$$$1")}function KA(e){return e.replace(/^\$([A-Z])/,"$1")}function XA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $n(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function wr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function is(e){var t=e.indexOf(":");return t==-1?{s:$n(e),e:$n(e)}:{s:$n(e.slice(0,t)),e:$n(e.slice(t+1))}}function wn(e,t){return typeof t>"u"||typeof t=="number"?wn(e.s,e.e):(typeof e!="string"&&(e=wr(e)),typeof t!="string"&&(t=wr(t)),e==t?e:e+":"+t)}function Ur(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function hb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Go(e.z,r?Ma(t):t)}catch{}try{return e.w=Go((e.XF||{}).numFmtId||(r?14:0),r?Ma(t):t)}catch{return""+t}}function co(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?of[e.v]||e.v:t==null?hb(e,e.v):hb(e,t))}function nc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function m_(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?$n(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Ur(s["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(!(typeof t[h][m]>"u")){var f={v:t[h][m]},x=o+h,g=l+m;if(d.s.r>x&&(d.s.r=x),d.s.c>g&&(d.s.c=g),d.e.r<x&&(d.e.r=x),d.e.c<g&&(d.e.c=g),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))f=t[h][m];else if(Array.isArray(f.v)&&(f.f=t[h][m][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||tn[14],n.cellDates?(f.t="d",f.w=Go(f.z,Ma(f.v))):(f.t="n",f.v=Ma(f.v),f.w=Go(f.z,f.v))):f.t="s";if(a)s[x]||(s[x]=[]),s[x][g]&&s[x][g].z&&(f.z=s[x][g].z),s[x][g]=f;else{var b=wr({c:g,r:x});s[b]&&s[b].z&&(f.z=s[b].z),s[b]=f}}}return d.s.c<1e7&&(s["!ref"]=wn(d)),s}function ud(e,t){return m_(null,e,t)}function JA(e){return e.read_shift(4,"i")}function Js(e,t){return t||(t=qe(4)),t.write_shift(4,e),t}function ha(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Rn(e,t){var r=!1;return t==null&&(r=!0,t=qe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ZA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function QA(e,t){return t||(t=qe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function s1(e,t){var r=e.l,n=e.read_shift(1),a=ha(e),s=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(ZA(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function eE(e,t){var r=!1;return t==null&&(r=!0,t=qe(15+4*e.t.length)),t.write_shift(1,0),Rn(e.t,t),r?t.slice(0,t.l):t}var tE=s1;function rE(e,t){var r=!1;return t==null&&(r=!0,t=qe(23+4*e.t.length)),t.write_shift(1,1),Rn(e.t,t),t.write_shift(4,1),QA({},t),r?t.slice(0,t.l):t}function Ps(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ac(e,t){return t==null&&(t=qe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function sc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ic(e,t){return t==null&&(t=qe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var nE=ha,p_=Rn;function i1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function f0(e,t){var r=!1;return t==null&&(r=!0,t=qe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var aE=ha,Yg=i1,o1=f0;function g_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?u0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Dl(t,0)>>2;return r?a/100:a}function x_(e,t){t==null&&(t=qe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function v_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function sE(e,t){return t||(t=qe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var oc=v_,fd=sE;function hd(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Yl(e,t){return(t||qe(8)).write_shift(8,e,"f")}function iE(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=pE[a];d&&(t.rgb=kb(d));break;case 2:t.rgb=kb([o,l,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function h0(e,t){if(t||(t=qe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function oE(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function lE(e,t){t||(t=qe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var b_=2,ts=3,uh=11,m0=19,fh=64,cE=65,dE=71,uE=4108,fE=4126,qn=80,mb={1:{n:"CodePage",t:b_},2:{n:"Category",t:qn},3:{n:"PresentationFormat",t:qn},4:{n:"ByteCount",t:ts},5:{n:"LineCount",t:ts},6:{n:"ParagraphCount",t:ts},7:{n:"SlideCount",t:ts},8:{n:"NoteCount",t:ts},9:{n:"HiddenCount",t:ts},10:{n:"MultimediaClipCount",t:ts},11:{n:"ScaleCrop",t:uh},12:{n:"HeadingPairs",t:uE},13:{n:"TitlesOfParts",t:fE},14:{n:"Manager",t:qn},15:{n:"Company",t:qn},16:{n:"LinksUpToDate",t:uh},17:{n:"CharacterCount",t:ts},19:{n:"SharedDoc",t:uh},22:{n:"HyperlinksChanged",t:uh},23:{n:"AppVersion",t:ts,p:"version"},24:{n:"DigSig",t:cE},26:{n:"ContentType",t:qn},27:{n:"ContentStatus",t:qn},28:{n:"Language",t:qn},29:{n:"Version",t:qn},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},pb={1:{n:"CodePage",t:b_},2:{n:"Title",t:qn},3:{n:"Subject",t:qn},4:{n:"Author",t:qn},5:{n:"Keywords",t:qn},6:{n:"Comments",t:qn},7:{n:"Template",t:qn},8:{n:"LastAuthor",t:qn},9:{n:"RevNumber",t:qn},10:{n:"EditTime",t:fh},11:{n:"LastPrinted",t:fh},12:{n:"CreatedDate",t:fh},13:{n:"ModifiedDate",t:fh},14:{n:"PageCount",t:ts},15:{n:"WordCount",t:ts},16:{n:"CharCount",t:ts},17:{n:"Thumbnail",t:dE},18:{n:"Application",t:qn},19:{n:"DocSecurity",t:ts},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}};function hE(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var mE=hE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),pE=Ia(mE),of={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},gE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function y_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function w_(e,t){var r=jA(gE),n=[],a;n[n.length]=_n,n[n.length]=ht("Types",null,{xmlns:Fn.CT,"xmlns:xsd":Fn.xsd,"xmlns:xsi":Fn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ht("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ht("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hh[c][t.bookType]||hh[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=ht("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:hh[c][t.bookType]||hh[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=ht("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var lr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function __(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ic(e){var t=[_n,ht("Relationships",null,{xmlns:Fn.RELS})];return Xn(e["!id"]).forEach(function(r){t[t.length]=ht("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function br(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[lr.HLINK,lr.XPATH,lr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function xE(e){var t=[_n];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function gb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vE(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function bE(e){var t=[_n];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(gb(e[r][0],e[r][1])),t.push(vE("",e[r][0]));return t.push(gb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function N_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s0.version+"</meta:generator></office:meta></office:document-meta>"}var Rl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Fp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=yr(t),n[n.length]=r?ht(e,t,r):Vn(e,t))}function k_(e,t){var r=t||{},n=[_n,ht("cp:coreProperties",null,{"xmlns:cp":Fn.CORE_PROPS,"xmlns:dc":Fn.dc,"xmlns:dcterms":Fn.dcterms,"xmlns:dcmitype":Fn.dcmitype,"xmlns:xsi":Fn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Fp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Fp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Rl.length;++s){var o=Rl[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Fp(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Bc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],S_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function j_(e){var t=[],r=ht;return e||(e={}),e.Application="SheetJS",t[t.length]=_n,t[t.length]=ht("Properties",null,{xmlns:Fn.EXT_PROPS,"xmlns:vt":Fn.vt}),Bc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=yr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+yr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function T_(e){var t=[_n,ht("Properties",null,{xmlns:Fn.CUST_PROPS,"xmlns:vt":Fn.vt})];if(!e)return t.join("");var r=1;return Xn(e).forEach(function(a){++r,t[t.length]=ht("property",RA(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function yE(e,t){var r=[];return Xn(xb).map(function(n){for(var a=0;a<Rl.length;++a)if(Rl[a][1]==n)return Rl[a];for(a=0;a<Bc.length;++a)if(Bc[a][1]==n)return Bc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Vn(xb[n[1]]||n[1],a))}}),ht("DocumentProperties",r.join(""),{xmlns:ns.o})}function wE(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Xn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Rl.length;++o)if(s==Rl[o][1])return;for(o=0;o<Bc.length;++o)if(s==Bc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(ht(ab(s),l,{"dt:dt":c}))}}),t&&Xn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(ht(ab(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+ns.o+'">'+a.join("")+"</"+n+">"}function _E(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=qe(8);return o.write_shift(4,n),o.write_shift(4,a),o}function vb(e,t){var r=qe(4),n=qe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=qe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=_E(t);break;case 31:case 80:for(n=qe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yn([r,n])}var A_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bb(e,t,r){var n=qe(8),a=[],s=[],o=8,l=0,c=qe(8),d=qe(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),s.push(c),a.push(d),o+=8+c.length,!t){d=qe(8),d.write_shift(4,0),a.unshift(d);var u=[qe(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=qe(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Yn(u),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(A_.indexOf(e[l][0])>-1||S_.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],f=0;if(t){f=+t[e[l][0]];var x=r[f];if(x.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}c=vb(x.t,m)}else{var b=NE(m);b==-1&&(b=31,m=String(m)),c=vb(b,m)}s.push(c),d=qe(8),d.write_shift(4,t?f:2+l),a.push(d),o+=8+c.length}var y=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,y),y+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Yn([n].concat(a).concat(s))}function yb(e,t,r,n,a,s){var o=qe(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Nr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=bb(e,r,n);if(l.push(c),a){var d=bb(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Yn(l)}function kE(e,t){t||(t=qe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function SE(e,t){return e.read_shift(t)===1}function wa(e,t){return t||(t=qe(2)),t.write_shift(2,+!!e),t}function E_(e){return e.read_shift(2,"u")}function bs(e,t){return t||(t=qe(2)),t.write_shift(2,e),t}function C_(e,t,r){return r||(r=qe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function D_(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function jE(e){var t=e.t||"",r=qe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=qe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Yn(a)}function TE(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function AE(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):TE(e,n,r)}function EE(e,t,r){if(r.biff>5)return AE(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function O_(e,t,r){return r||(r=qe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function wb(e,t){t||(t=qe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function CE(e){var t=qe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),wb(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&wb(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Vl(e,t,r,n){return n||(n=qe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function DE(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function OE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function P_(e,t){return t||(t=qe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function l1(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=qe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function PE(e,t){var r=!t||t.biff==8,n=qe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function LE(e,t){var r=!t||t.biff>=8?2:1,n=qe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function FE(e,t){var r=qe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=jE(e[a]);var s=Yn([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function $E(){var e=qe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RE(e){var t=qe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ME(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=qe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function IE(e,t,r,n){var a=qe(10);return Vl(e,t,n,a),a.write_shift(4,r),a}function BE(e,t,r,n,a){var s=!a||a.biff==8,o=qe(8+ +s+(1+s)*r.length);return Vl(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function UE(e,t,r,n){var a=r&&r.biff==5;n||(n=qe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function WE(e,t){var r=t.biff==8||!t.biff?4:2,n=qe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function _b(e,t,r,n){var a=r&&r.biff==5;n||(n=qe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function zE(e){var t=qe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function HE(e,t,r,n,a,s){var o=qe(8);return Vl(e,t,n,o),C_(r,s,o),o}function qE(e,t,r,n){var a=qe(14);return Vl(e,t,n,a),Yl(r,a),a}function YE(e,t,r){if(r.biff<8)return VE(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(DE(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function VE(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=D_(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function GE(e){var t=qe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)P_(e[r],t);return t}function KE(e){var t=qe(24),r=$n(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Yn([t,CE(e[1])])}function XE(e){var t=e[1].Tooltip,r=qe(10+2*(t.length+1));r.write_shift(2,2048);var n=$n(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function JE(e){return e||(e=qe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ZE(e,t,r){if(!r.cellStyles)return Ti(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function QE(e,t){var r=qe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function eC(e){for(var t=qe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function tC(e,t,r){var n=qe(15);return cf(n,e,t),n.write_shift(8,r,"f"),n}function rC(e,t,r){var n=qe(9);return cf(n,e,t),n.write_shift(2,r),n}var nC=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Jx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=ql(1);switch(c.type){case"base64":u=Gs(lo(l));break;case"binary":u=Gs(l);break;case"buffer":case"array":u=l;break}rs(u,0);var h=u.read_shift(1),m=!!(h&136),f=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,m=!0;break;case 49:f=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,b=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(b=u.read_shift(2));var y=u.read_shift(2),N=c.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(N=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var S=[],_={},D=Math.min(u.length,h==2?521:b-10-(f?264:0)),I=x?32:11;u.l<D&&u[u.l]!=13;)switch(_={},_.name=i0.utils.decode(N,u.slice(u.l,u.l+I)).replace(/[\u0000\r\n].*$/g,""),u.l+=I,_.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(_.offset=u.read_shift(4)),_.len=u.read_shift(1),h==2&&(_.offset=u.read_shift(2)),_.dec=u.read_shift(1),_.name.length&&S.push(_),h!=2&&(u.l+=x?13:14),_.type){case"B":(!f||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var O=0,R=0;for(d[0]=[],R=0;R!=S.length;++R)d[0][R]=S[R].name;for(;g-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++O]=[],R=0,R=0;R!=S.length;++R){var E=u.slice(u.l,u.l+S[R].len);u.l+=S[R].len,rs(E,0);var B=i0.utils.decode(N,E);switch(S[R].type){case"C":B.trim().length&&(d[O][R]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[O][R]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[O][R]=B;break;case"F":d[O][R]=parseFloat(B.trim());break;case"+":case"I":d[O][R]=x?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[O][R]=!0;break;case"N":case"F":d[O][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));d[O][R]="##MEMO##"+(x?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[O][R]=+B||0);break;case"@":d[O][R]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":d[O][R]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":d[O][R]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[O][R]=-E.read_shift(-8,"f");break;case"B":if(f&&S[R].len==8){d[O][R]=E.read_shift(8,"f");break}case"G":case"P":E.l+=S[R].len;break;case"0":if(S[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[R].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=S,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=ud(r(l,d),d);return u["!cols"]=d.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete d.DBF,u}function a(l,c){try{return nc(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&ju(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=La(),h=b0(l,{header:1,raw:!0,cellDates:!0}),m=h[0],f=h.slice(1),x=l["!cols"]||[],g=0,b=0,y=0,N=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++y;continue}if(m[g]!=null){if(++y,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(b=0;b<1024;++b)if(m.indexOf(m[g]+"_"+b)==-1){m[g]+="_"+b;break}}}}var S=Ur(l["!ref"]),_=[],D=[],I=[];for(g=0;g<=S.e.c-S.s.c;++g){var O="",R="",E=0,B=[];for(b=0;b<f.length;++b)f[b][g]!=null&&B.push(f[b][g]);if(B.length==0||m[g]==null){_[g]="?";continue}for(b=0;b<B.length;++b){switch(typeof B[b]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=B[b]instanceof Date?"D":"C";break;default:R="C"}E=Math.max(E,String(B[b]).length),O=O&&O!=R?"C":R}E>250&&(E=250),R=((x[g]||{}).DBF||{}).type,R=="C"&&x[g].DBF.len>E&&(E=x[g].DBF.len),O=="B"&&R=="N"&&(O="N",I[g]=x[g].DBF.dec,E=x[g].DBF.len),D[g]=O=="C"||R=="N"?E:s[O]||0,N+=D[g],_[g]=O}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,f.length),C.write_shift(2,296+32*y),C.write_shift(2,N),g=0;g<4;++g)C.write_shift(4,0);for(C.write_shift(4,0|(+t[F4]||3)<<8),g=0,b=0;g<m.length;++g)if(m[g]!=null){var M=u.next(32),U=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,U,"sbcs"),M.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),M.write_shift(4,b),M.write_shift(1,D[g]||s[_[g]]||0),M.write_shift(1,I[g]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),b+=D[g]||s[_[g]]||0}var F=u.next(264);for(F.write_shift(4,13),g=0;g<65;++g)F.write_shift(4,0);for(g=0;g<f.length;++g){var ne=u.next(N);for(ne.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(_[b]){case"L":ne.write_shift(1,f[g][b]==null?63:f[g][b]?84:70);break;case"B":ne.write_shift(8,f[g][b]||0,"f");break;case"N":var V="0";for(typeof f[g][b]=="number"&&(V=f[g][b].toFixed(I[b]||0)),y=0;y<D[b]-V.length;++y)ne.write_shift(1,32);ne.write_shift(1,V,"sbcs");break;case"D":f[g][b]?(ne.write_shift(4,("0000"+f[g][b].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(f[g][b].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+f[g][b].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(f[g][b]!=null?f[g][b]:"").slice(0,D[b]);for(ne.write_shift(1,ee,"sbcs"),y=0;y<D[b]-ee.length;++y)ne.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),aC=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Xn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,f){var x=e[f];return typeof x=="number"?Yv(x):x},n=function(m,f,x){var g=f.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:Yv(g)};e["|"]=254;function a(m,f){switch(f.type){case"base64":return s(lo(m),f);case"binary":return s(m,f);case"buffer":return s(hr&&Buffer.isBuffer(m)?m.toString("binary"):nf(m),f);case"array":return s(rm(m),f)}throw new Error("Unrecognized type "+f.type)}function s(m,f){var x=m.split(/[\n\r]+/),g=-1,b=-1,y=0,N=0,S=[],_=[],D=null,I={},O=[],R=[],E=[],B=0,C;for(+f.codepage>=0&&ju(+f.codepage);y!==x.length;++y){B=0;var M=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=M.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),F=U[0],ne;if(M.length>0)switch(F){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&_.push(M.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,ee=!1,me=!1,ye=!1,Oe=-1,xe=-1;for(N=1;N<U.length;++N)switch(U[N].charAt(0)){case"A":break;case"X":b=parseInt(U[N].slice(1))-1,ee=!0;break;case"Y":for(g=parseInt(U[N].slice(1))-1,ee||(b=0),C=S.length;C<=g;++C)S[C]=[];break;case"K":ne=U[N].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(no(ne))?isNaN(Au(ne).getDate())||(ne=Na(ne)):(ne=no(ne),D!==null&&V4(D)&&(ne=J4(ne))),V=!0;break;case"E":ye=!0;var w=r9(U[N].slice(1),{r:g,c:b});S[g][b]=[S[g][b],w];break;case"S":me=!0,S[g][b]=[S[g][b],"S5S"];break;case"G":break;case"R":Oe=parseInt(U[N].slice(1))-1;break;case"C":xe=parseInt(U[N].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}if(V&&(S[g][b]&&S[g][b].length==2?S[g][b][0]=ne:S[g][b]=ne,D=null),me){if(ye)throw new Error("SYLK shared formula cannot have own formula");var A=Oe>-1&&S[Oe][xe];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");S[g][b][1]=n9(A[1],{r:g-Oe,c:b-xe})}break;case"F":var T=0;for(N=1;N<U.length;++N)switch(U[N].charAt(0)){case"X":b=parseInt(U[N].slice(1))-1,++T;break;case"Y":for(g=parseInt(U[N].slice(1))-1,C=S.length;C<=g;++C)S[C]=[];break;case"M":B=parseInt(U[N].slice(1))/20;break;case"F":break;case"G":break;case"P":D=_[parseInt(U[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=U[N].slice(1).split(" "),C=parseInt(E[0],10);C<=parseInt(E[1],10);++C)B=parseInt(E[2],10),R[C-1]=B===0?{hidden:!0}:{wch:B},c1(R[C-1]);break;case"C":b=parseInt(U[N].slice(1))-1,R[b]||(R[b]={});break;case"R":g=parseInt(U[N].slice(1))-1,O[g]||(O[g]={}),B>0?(O[g].hpt=B,O[g].hpx=M_(B)):B===0&&(O[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}T<1&&(D=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}}return O.length>0&&(I["!rows"]=O),R.length>0&&(I["!cols"]=R),f&&f.sheetRows&&(S=S.slice(0,f.sheetRows)),[S,I]}function o(m,f){var x=a(m,f),g=x[0],b=x[1],y=ud(g,f);return Xn(b).forEach(function(N){y[N]=b[N]}),y}function l(m,f){return nc(o(m,f),f)}function c(m,f,x,g){var b="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+u1(m.f,{r:x,c:g}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(m,f){f.forEach(function(x,g){var b="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?b+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=p0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=g0(x.wpx)),typeof x.wch=="number"&&(b+=Math.round(x.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function u(m,f){f.forEach(function(x,g){var b="F;";x.hidden?b+="M0;":x.hpt?b+="M"+20*x.hpt+";":x.hpx&&(b+="M"+20*x0(x.hpx)+";"),b.length>2&&m.push(b+"R"+(g+1))})}function h(m,f){var x=["ID;PWXL;N;E"],g=[],b=Ur(m["!ref"]),y,N=Array.isArray(m),S=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&d(x,m["!cols"]),m["!rows"]&&u(x,m["!rows"]),x.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var _=b.s.r;_<=b.e.r;++_)for(var D=b.s.c;D<=b.e.c;++D){var I=wr({r:_,c:D});y=N?(m[_]||[])[D]:m[I],!(!y||y.v==null&&(!y.f||y.F))&&g.push(c(y,m,_,D))}return x.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),sC=function(){function e(s,o){switch(o.type){case"base64":return t(lo(s),o);case"binary":return t(s,o);case"buffer":return t(hr&&Buffer.isBuffer(s)?s.toString("binary"):nf(s),o);case"array":return t(rm(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,d=-1,u=0,h=[];u!==l.length;++u){if(l[u].trim()==="BOT"){h[++c]=[],d=0;continue}if(!(c<0)){var m=l[u].trim().split(","),f=m[0],x=m[1];++u;for(var g=l[u]||"";(g.match(/["]/g)||[]).length&1&&u<l.length-1;)g+=`
`+l[++u];switch(g=g.trim(),+f){case-1:if(g==="BOT"){h[++c]=[],d=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[c][d]=!0:g==="FALSE"?h[c][d]=!1:isNaN(no(x))?isNaN(Au(x).getDate())?h[c][d]=x:h[c][d]=Na(x):h[c][d]=no(x),++d;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[c][d++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return ud(e(s,o),o)}function n(s,o){return nc(r(s,o),o)}var a=function(){var s=function(c,d,u,h,m){c.push(d),c.push(u+","+h),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,d,u,h){c.push(d+","+u),c.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var d=[],u=Ur(c["!ref"]),h,m=Array.isArray(c);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,u.e.r-u.s.r+1,""),s(d,"TUPLES",0,u.e.c-u.s.c+1,""),s(d,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var g=wr({r:f,c:x});if(h=m?(c[f]||[])[x]:c[g],!h){o(d,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?o(d,1,0,"="+h.f):o(d,1,0,""):o(d,0,b,"V");break;case"b":o(d,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Go(h.z||tn[14],Ma(Na(h.v)))),o(d,0,h.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,N=d.join(y);return N}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),L_=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var f=h.split(`
`),x=-1,g=-1,b=0,y=[];b!==f.length;++b){var N=f[b].trim().split(":");if(N[0]==="cell"){var S=$n(N[1]);if(y.length<=S.r)for(x=y.length;x<=S.r;++x)y[x]||(y[x]=[]);switch(x=S.r,g=S.c,N[2]){case"t":y[x][g]=e(N[3]);break;case"v":y[x][g]=+N[3];break;case"vtf":var _=N[N.length-1];case"vtc":switch(N[3]){case"nl":y[x][g]=!!+N[4];break;default:y[x][g]=+N[4];break}N[2]=="vtf"&&(y[x][g]=[y[x][g],_])}}}return m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}function n(h,m){return ud(r(h,m),m)}function a(h,m){return nc(n(h,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(h){if(!h||!h["!ref"])return"";for(var m=[],f=[],x,g="",b=is(h["!ref"]),y=Array.isArray(h),N=b.s.r;N<=b.e.r;++N)for(var S=b.s.c;S<=b.e.c;++S)if(g=wr({r:N,c:S}),x=y?(h[N]||[])[S]:h[g],!(!x||x.v==null||x.t==="z")){switch(f=["cell",g,"t"],x.t){case"s":case"str":f.push(t(x.v));break;case"n":x.f?(f[2]="vtf",f[3]="n",f[4]=x.v,f[5]=t(x.f)):(f[2]="v",f[3]=x.v);break;case"b":f[2]="vt"+(x.f?"f":"c"),f[3]="nl",f[4]=x.v?"1":"0",f[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var _=Ma(Na(x.v));f[2]="vtc",f[3]="nd",f[4]=""+_,f[5]=x.w||Go(x.z||tn[14],_);break;case"e":continue}m.push(f.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[s,o,l,o,d(h),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),iC=function(){function e(u,h,m,f,x){x.raw?h[m][f]=u:u===""||(u==="TRUE"?h[m][f]=!0:u==="FALSE"?h[m][f]=!1:isNaN(no(u))?isNaN(Au(u).getDate())?h[m][f]=u:h[m][f]=Na(u):h[m][f]=no(u))}function t(u,h){var m=h||{},f=[];if(!u||u.length===0)return f;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var b=10,y=0,N=0;N<=g;++N)y=x[N].indexOf(" "),y==-1?y=x[N].length:y++,b=Math.max(b,y);for(N=0;N<=g;++N){f[N]=[];var S=0;for(e(x[N].slice(0,b).trim(),f,N,S,m),S=1;S<=(x[N].length-b)/10+1;++S)e(x[N].slice(b+(S-1)*10,b+S*10).trim(),f,N,S,m)}return m.sheetRows&&(f=f.slice(0,m.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var h={},m=!1,f=0,x=0;f<u.length;++f)(x=u.charCodeAt(f))==34?m=!m:!m&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&x.push([h[f],f]);if(!x.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&x.push([h[f],f])}return x.sort(function(g,b){return g[0]-b[0]||n[g[1]]-n[b[1]]}),r[x.pop()[1]]||44}function s(u,h){var m=h||{},f="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=a(u.slice(0,1024)):m&&m.FS?f=m.FS:f=a(u.slice(0,1024));var b=0,y=0,N=0,S=0,_=0,D=f.charCodeAt(0),I=!1,O=0,R=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=m.dateNF!=null?_A(m.dateNF):null;function B(){var C=u.slice(S,_),M={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)M.t="z";else if(m.raw)M.t="s",M.v=C;else if(C.trim().length===0)M.t="s",M.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(M.t="s",M.v=C.slice(2,-1).replace(/""/g,'"')):a9(C)?(M.t="n",M.f=C.slice(1)):(M.t="s",M.v=C);else if(C=="TRUE")M.t="b",M.v=!0;else if(C=="FALSE")M.t="b",M.v=!1;else if(!isNaN(N=no(C)))M.t="n",m.cellText!==!1&&(M.w=C),M.v=N;else if(!isNaN(Au(C).getDate())||E&&C.match(E)){M.z=m.dateNF||tn[14];var U=0;E&&C.match(E)&&(C=NA(C,m.dateNF,C.match(E)||[]),U=1),m.cellDates?(M.t="d",M.v=Na(C,U)):(M.t="n",M.v=Ma(Na(C,U))),m.cellText!==!1&&(M.w=Go(M.z,M.v instanceof Date?Ma(M.v):M.v)),m.cellNF||delete M.z}else M.t="s",M.v=C;if(M.t=="z"||(m.dense?(x[b]||(x[b]=[]),x[b][y]=M):x[wr({c:y,r:b})]=M),S=_+1,R=u.charCodeAt(S),g.e.c<y&&(g.e.c=y),g.e.r<b&&(g.e.r=b),O==D)++y;else if(y=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;_<u.length;++_)switch(O=u.charCodeAt(_)){case 34:R===34&&(I=!I);break;case D:case 10:case 13:if(!I&&B())break e;break}return _-S>0&&B(),x["!ref"]=wn(g),x}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):ud(t(u,h),h)}function l(u,h){var m="",f=h.type=="string"?[0,0,0,0]:vP(u,h);switch(h.type){case"base64":m=lo(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof i0<"u"||(m=hr&&Buffer.isBuffer(u)?u.toString("binary"):nf(u));break;case"array":m=rm(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?m=hu(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=hu(m):h.type=="binary"&&typeof i0<"u",m.slice(0,19)=="socialcalc:version:"?L_.to_sheet(h.type=="string"?m:hu(m),h):o(m,h)}function c(u,h){return nc(l(u,h),h)}function d(u){for(var h=[],m=Ur(u["!ref"]),f,x=Array.isArray(u),g=m.s.r;g<=m.e.r;++g){for(var b=[],y=m.s.c;y<=m.e.c;++y){var N=wr({r:g,c:y});if(f=x?(u[g]||[])[y]:u[N],!f||f.v==null){b.push("          ");continue}for(var S=(f.w||(co(f),f.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(y===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}(),Nb=function(){function e(w,A,T){if(w){rs(w,w.l||0);for(var L=T.Enum||Oe;w.l<w.length;){var H=w.read_shift(2),X=L[H]||L[65535],re=w.read_shift(2),ge=w.l+re,oe=X.f&&X.f(w,re,T);if(w.l=ge,A(oe,X,H))return}}}function t(w,A){switch(A.type){case"base64":return r(Gs(lo(w)),A);case"binary":return r(Gs(w),A);case"buffer":case"array":return r(w,A)}throw"Unsupported type "+A.type}function r(w,A){if(!w)return w;var T=A||{},L=T.dense?[]:{},H="Sheet1",X="",re=0,ge={},oe=[],je=[],Ie={s:{r:0,c:0},e:{r:0,c:0}},et=T.sheetRows||0;if(w[2]==0&&(w[3]==8||w[3]==9)&&w.length>=16&&w[14]==5&&w[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(w[2]==2)T.Enum=Oe,e(w,function(Q,ve,we){switch(we){case 0:T.vers=Q,Q>=4096&&(T.qpro=!0);break;case 6:Ie=Q;break;case 204:Q&&(X=Q);break;case 222:X=Q;break;case 15:case 51:T.qpro||(Q[1].v=Q[1].v.slice(1));case 13:case 14:case 16:we==14&&(Q[2]&112)==112&&(Q[2]&15)>1&&(Q[2]&15)<15&&(Q[1].z=T.dateNF||tn[14],T.cellDates&&(Q[1].t="d",Q[1].v=J4(Q[1].v))),T.qpro&&Q[3]>re&&(L["!ref"]=wn(Ie),ge[H]=L,oe.push(H),L=T.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},re=Q[3],H=X||"Sheet"+(re+1),X="");var Re=T.dense?(L[Q[0].r]||[])[Q[0].c]:L[wr(Q[0])];if(Re){Re.t=Q[1].t,Re.v=Q[1].v,Q[1].z!=null&&(Re.z=Q[1].z),Q[1].f!=null&&(Re.f=Q[1].f);break}T.dense?(L[Q[0].r]||(L[Q[0].r]=[]),L[Q[0].r][Q[0].c]=Q[1]):L[wr(Q[0])]=Q[1];break}},T);else if(w[2]==26||w[2]==14)T.Enum=xe,w[2]==14&&(T.qpro=!0,w.l=0),e(w,function(Q,ve,we){switch(we){case 204:H=Q;break;case 22:Q[1].v=Q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Q[3]>re&&(L["!ref"]=wn(Ie),ge[H]=L,oe.push(H),L=T.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},re=Q[3],H="Sheet"+(re+1)),et>0&&Q[0].r>=et)break;T.dense?(L[Q[0].r]||(L[Q[0].r]=[]),L[Q[0].r][Q[0].c]=Q[1]):L[wr(Q[0])]=Q[1],Ie.e.c<Q[0].c&&(Ie.e.c=Q[0].c),Ie.e.r<Q[0].r&&(Ie.e.r=Q[0].r);break;case 27:Q[14e3]&&(je[Q[14e3][0]]=Q[14e3][1]);break;case 1537:je[Q[0]]=Q[1],Q[0]==re&&(H=Q[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+w[2]);if(L["!ref"]=wn(Ie),ge[X||H]=L,oe.push(X||H),!je.length)return{SheetNames:oe,Sheets:ge};for(var Te={},Y=[],We=0;We<je.length;++We)ge[oe[We]]?(Y.push(je[We]||oe[We]),Te[je[We]]=ge[je[We]]||ge[oe[We]]):(Y.push(je[We]),Te[je[We]]={"!ref":"A1"});return{SheetNames:Y,Sheets:Te}}function n(w,A){var T=A||{};if(+T.codepage>=0&&ju(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var L=La(),H=Ur(w["!ref"]),X=Array.isArray(w),re=[];mt(L,0,s(1030)),mt(L,6,c(H));for(var ge=Math.min(H.e.r,8191),oe=H.s.r;oe<=ge;++oe)for(var je=Kn(oe),Ie=H.s.c;Ie<=H.e.c;++Ie){oe===H.s.r&&(re[Ie]=fa(Ie));var et=re[Ie]+je,Te=X?(w[oe]||[])[Ie]:w[et];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?mt(L,13,f(oe,Ie,Te.v)):mt(L,14,g(oe,Ie,Te.v));else{var Y=co(Te);mt(L,15,h(oe,Ie,Y.slice(0,239)))}}return mt(L,1),L.end()}function a(w,A){var T=A||{};if(+T.codepage>=0&&ju(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var L=La();mt(L,0,o(w));for(var H=0,X=0;H<w.SheetNames.length;++H)(w.Sheets[w.SheetNames[H]]||{})["!ref"]&&mt(L,27,ye(w.SheetNames[H],X++));var re=0;for(H=0;H<w.SheetNames.length;++H){var ge=w.Sheets[w.SheetNames[H]];if(!(!ge||!ge["!ref"])){for(var oe=Ur(ge["!ref"]),je=Array.isArray(ge),Ie=[],et=Math.min(oe.e.r,8191),Te=oe.s.r;Te<=et;++Te)for(var Y=Kn(Te),We=oe.s.c;We<=oe.e.c;++We){Te===oe.s.r&&(Ie[We]=fa(We));var Q=Ie[We]+Y,ve=je?(ge[Te]||[])[We]:ge[Q];if(!(!ve||ve.t=="z"))if(ve.t=="n")mt(L,23,B(Te,We,re,ve.v));else{var we=co(ve);mt(L,22,O(Te,We,re,we.slice(0,239)))}}++re}}return mt(L,1),L.end()}function s(w){var A=qe(2);return A.write_shift(2,w),A}function o(w){var A=qe(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var T=0,L=0,H=0,X=0;X<w.SheetNames.length;++X){var re=w.SheetNames[X],ge=w.Sheets[re];if(!(!ge||!ge["!ref"])){++H;var oe=is(ge["!ref"]);T<oe.e.r&&(T=oe.e.r),L<oe.e.c&&(L=oe.e.c)}}return T>8191&&(T=8191),A.write_shift(2,T),A.write_shift(1,H),A.write_shift(1,L),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function l(w,A,T){var L={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&T.qpro?(L.s.c=w.read_shift(1),w.l++,L.s.r=w.read_shift(2),L.e.c=w.read_shift(1),w.l++,L.e.r=w.read_shift(2),L):(L.s.c=w.read_shift(2),L.s.r=w.read_shift(2),A==12&&T.qpro&&(w.l+=2),L.e.c=w.read_shift(2),L.e.r=w.read_shift(2),A==12&&T.qpro&&(w.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(w){var A=qe(8);return A.write_shift(2,w.s.c),A.write_shift(2,w.s.r),A.write_shift(2,w.e.c),A.write_shift(2,w.e.r),A}function d(w,A,T){var L=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(L[0].c=w.read_shift(1),L[3]=w.read_shift(1),L[0].r=w.read_shift(2),w.l+=2):(L[2]=w.read_shift(1),L[0].c=w.read_shift(2),L[0].r=w.read_shift(2)),L}function u(w,A,T){var L=w.l+A,H=d(w,A,T);if(H[1].t="s",T.vers==20768){w.l++;var X=w.read_shift(1);return H[1].v=w.read_shift(X,"utf8"),H}return T.qpro&&w.l++,H[1].v=w.read_shift(L-w.l,"cstr"),H}function h(w,A,T){var L=qe(7+T.length);L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,w),L.write_shift(1,39);for(var H=0;H<L.length;++H){var X=T.charCodeAt(H);L.write_shift(1,X>=128?95:X)}return L.write_shift(1,0),L}function m(w,A,T){var L=d(w,A,T);return L[1].v=w.read_shift(2,"i"),L}function f(w,A,T){var L=qe(7);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,w),L.write_shift(2,T,"i"),L}function x(w,A,T){var L=d(w,A,T);return L[1].v=w.read_shift(8,"f"),L}function g(w,A,T){var L=qe(13);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,w),L.write_shift(8,T,"f"),L}function b(w,A,T){var L=w.l+A,H=d(w,A,T);if(H[1].v=w.read_shift(8,"f"),T.qpro)w.l=L;else{var X=w.read_shift(2);_(w.slice(w.l,w.l+X),H),w.l+=X}return H}function y(w,A,T){var L=A&32768;return A&=-32769,A=(L?w:0)+(A>=8192?A-16384:A),(L?"":"$")+(T?fa(A):Kn(A))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(w,A){rs(w,0);for(var T=[],L=0,H="",X="",re="",ge="";w.l<w.length;){var oe=w[w.l++];switch(oe){case 0:T.push(w.read_shift(8,"f"));break;case 1:X=y(A[0].c,w.read_shift(2),!0),H=y(A[0].r,w.read_shift(2),!1),T.push(X+H);break;case 2:{var je=y(A[0].c,w.read_shift(2),!0),Ie=y(A[0].r,w.read_shift(2),!1);X=y(A[0].c,w.read_shift(2),!0),H=y(A[0].r,w.read_shift(2),!1),T.push(je+Ie+":"+X+H)}break;case 3:if(w.l<w.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(w.read_shift(2));break;case 6:{for(var et="";oe=w[w.l++];)et+=String.fromCharCode(oe);T.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:ge=T.pop(),re=T.pop(),T.push(["AND","OR"][oe-20]+"("+re+","+ge+")");break;default:if(oe<32&&S[oe])ge=T.pop(),re=T.pop(),T.push(re+S[oe]+ge);else if(N[oe]){if(L=N[oe][1],L==69&&(L=w[w.l++]),L>T.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+T.join("|")+"|");return}var Te=T.slice(-L);T.length-=L,T.push(N[oe][0]+"("+Te.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}T.length==1?A[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function D(w){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=w.read_shift(2),A[3]=w[w.l++],A[0].c=w[w.l++],A}function I(w,A){var T=D(w);return T[1].t="s",T[1].v=w.read_shift(A-4,"cstr"),T}function O(w,A,T,L){var H=qe(6+L.length);H.write_shift(2,w),H.write_shift(1,T),H.write_shift(1,A),H.write_shift(1,39);for(var X=0;X<L.length;++X){var re=L.charCodeAt(X);H.write_shift(1,re>=128?95:re)}return H.write_shift(1,0),H}function R(w,A){var T=D(w);T[1].v=w.read_shift(2);var L=T[1].v>>1;if(T[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return T[1].v=L,T}function E(w,A){var T=D(w),L=w.read_shift(4),H=w.read_shift(4),X=w.read_shift(2);if(X==65535)return L===0&&H===3221225472?(T[1].t="e",T[1].v=15):L===0&&H===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var re=X&32768;return X=(X&32767)-16446,T[1].v=(1-re*2)*(H*Math.pow(2,X+32)+L*Math.pow(2,X)),T}function B(w,A,T,L){var H=qe(14);if(H.write_shift(2,w),H.write_shift(1,T),H.write_shift(1,A),L==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var X=0,re=0,ge=0,oe=0;return L<0&&(X=1,L=-L),re=Math.log2(L)|0,L/=Math.pow(2,re-31),oe=L>>>0,oe&2147483648||(L/=2,++re,oe=L>>>0),L-=oe,oe|=2147483648,oe>>>=0,L*=Math.pow(2,32),ge=L>>>0,H.write_shift(4,ge),H.write_shift(4,oe),re+=16383+(X?32768:0),H.write_shift(2,re),H}function C(w,A){var T=E(w);return w.l+=A-14,T}function M(w,A){var T=D(w),L=w.read_shift(4);return T[1].v=L>>6,T}function U(w,A){var T=D(w),L=w.read_shift(8,"f");return T[1].v=L,T}function F(w,A){var T=U(w);return w.l+=A-10,T}function ne(w,A){return w[w.l+A-1]==0?w.read_shift(A,"cstr"):""}function V(w,A){var T=w[w.l++];T>A-1&&(T=A-1);for(var L="";L.length<T;)L+=String.fromCharCode(w[w.l++]);return L}function ee(w,A,T){if(!(!T.qpro||A<21)){var L=w.read_shift(1);w.l+=17,w.l+=1,w.l+=2;var H=w.read_shift(A-21,"cstr");return[L,H]}}function me(w,A){for(var T={},L=w.l+A;w.l<L;){var H=w.read_shift(2);if(H==14e3){for(T[H]=[0,""],T[H][0]=w.read_shift(2);w[w.l];)T[H][1]+=String.fromCharCode(w[w.l]),w.l++;w.l++}}return T}function ye(w,A){var T=qe(5+w.length);T.write_shift(2,14e3),T.write_shift(2,A);for(var L=0;L<w.length;++L){var H=w.charCodeAt(L);T[T.l++]=H>127?95:H}return T[T.l++]=0,T}var Oe={0:{n:"BOF",f:E_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:F},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),oC=/^\s|\s$|[\t\n\r]/;function F_(e,t){if(!t.bookSST)return"";var r=[_n];r[r.length]=ht("sst",null,{xmlns:dd[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(oC)&&(s+=' xml:space="preserve"'),s+=">"+yr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function lC(e){return[e.read_shift(4),e.read_shift(4)]}function cC(e,t){return t||(t=qe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var dC=eE;function uC(e){var t=La();nt(t,159,cC(e));for(var r=0;r<e.length;++r)nt(t,19,dC(e[r]));return nt(t,160),t.end()}function fC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function $_(e){var t=0,r,n=fC(e),a=n.length+1,s,o,l,c,d;for(r=ql(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var hC=function(){function e(a,s){switch(s.type){case"base64":return t(lo(a),s);case"binary":return t(a,s);case"buffer":return t(hr&&Buffer.isBuffer(a)?a.toString("binary"):nf(a),s);case"array":return t(rm(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,h){Array.isArray(l)&&(l[h]=[]);for(var m=/\\\w+\b/g,f=0,x,g=-1;x=m.exec(u);){switch(x[0]){case"\\cell":var b=u.slice(f,m.lastIndex-x[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var y={v:b,t:"s"};Array.isArray(l)?l[h][g]=y:l[wr({r:h,c:g})]=y}break}f=m.lastIndex}g>d.e.c&&(d.e.c=g)}),l["!ref"]=wn(d),l}function r(a,s){return nc(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Ur(a["!ref"]),l,c=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=wr({r:d,c:u});l=c?(a[d]||[])[u]:a[h],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(co(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function kb(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var mC=6,ao=mC;function p0(e){return Math.floor((e+Math.round(128/ao)/256)*ao)}function g0(e){return Math.floor((e-5)/ao*100+.5)/100}function Vg(e){return Math.round((e*ao+5)/ao*256)/256}function c1(e){e.width?(e.wpx=p0(e.width),e.wch=g0(e.wpx),e.MDW=ao):e.wpx?(e.wch=g0(e.wpx),e.width=Vg(e.wch),e.MDW=ao):typeof e.wch=="number"&&(e.width=Vg(e.wch),e.wpx=p0(e.width),e.MDW=ao),e.customWidth&&delete e.customWidth}var pC=96,R_=pC;function x0(e){return e*96/R_}function M_(e){return e*R_/96}function gC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ht("numFmt",null,{numFmtId:n,formatCode:yr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ht("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function xC(e){var t=[];return t[t.length]=ht("cellXfs",null),e.forEach(function(r){t[t.length]=ht("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ht("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function I_(e,t){var r=[_n,ht("styleSheet",null,{xmlns:dd[0],"xmlns:vt":Fn.vt})],n;return e.SSF&&(n=gC(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=xC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function vC(e,t){var r=e.read_shift(2),n=ha(e);return[r,n]}function bC(e,t,r){r||(r=qe(6+4*t.length)),r.write_shift(2,e),Rn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function yC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=oE(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=iE(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ha(e),n}function wC(e,t){t||(t=qe(25+4*32)),t.write_shift(2,e.sz*20),lE(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),h0(e.color,t);var n=0;return n=2,t.write_shift(1,n),Rn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _C=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$p,NC=Ti;function Sb(e,t){t||(t=qe(4*3+8*7+16*1)),$p||($p=Jx(_C));var r=$p[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(h0({auto:1},t),h0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function kC(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function B_(e,t,r){r||(r=qe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function tu(e,t){return t||(t=qe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var SC=Ti;function jC(e,t){return t||(t=qe(51)),t.write_shift(1,0),tu(null,t),tu(null,t),tu(null,t),tu(null,t),tu(null,t),t.length>t.l?t.slice(0,t.l):t}function TC(e,t){return t||(t=qe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),f0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function AC(e,t,r){var n=qe(2052);return n.write_shift(4,e),f0(t,n),f0(r,n),n.length>n.l?n.slice(0,n.l):n}function EC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(nt(e,615,Js(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&nt(e,44,bC(a,t[a]))}),nt(e,616))}}function CC(e){var t=1;nt(e,611,Js(t)),nt(e,43,wC({sz:12,color:{theme:1},name:"Calibri",family:2})),nt(e,612)}function DC(e){var t=2;nt(e,603,Js(t)),nt(e,45,Sb({patternType:"none"})),nt(e,45,Sb({patternType:"gray125"})),nt(e,604)}function OC(e){var t=1;nt(e,613,Js(t)),nt(e,46,jC()),nt(e,614)}function PC(e){var t=1;nt(e,626,Js(t)),nt(e,47,B_({numFmtId:0},65535)),nt(e,627)}function LC(e,t){nt(e,617,Js(t.length)),t.forEach(function(r){nt(e,47,B_(r,0))}),nt(e,618)}function FC(e){var t=1;nt(e,619,Js(t)),nt(e,48,TC({xfId:0,name:"Normal"})),nt(e,620)}function $C(e){var t=0;nt(e,505,Js(t)),nt(e,506)}function RC(e){var t=0;nt(e,508,AC(t,"TableStyleMedium9","PivotStyleMedium4")),nt(e,509)}function MC(e,t){var r=La();return nt(r,278),EC(r,e.SSF),CC(r),DC(r),OC(r),PC(r),LC(r,t.cellXfs),FC(r),$C(r),RC(r),nt(r,279),r.end()}function U_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_n];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function IC(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ha(e)}}function BC(e){var t=qe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Rn(e.name,t),t.slice(0,t.l)}function UC(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function WC(e){var t=qe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function zC(e,t){var r=qe(8+2*t.length);return r.write_shift(4,e),Rn(t,r),r.slice(0,r.l)}function HC(e){return e.l+=4,e.read_shift(4)!=0}function qC(e,t){var r=qe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function YC(){var e=La();return nt(e,332),nt(e,334,Js(1)),nt(e,335,BC({name:"XLDAPR",version:12e4,flags:3496657072})),nt(e,336),nt(e,339,zC(1,"XLDAPR")),nt(e,52),nt(e,35,Js(514)),nt(e,4096,Js(0)),nt(e,4097,bs(1)),nt(e,36),nt(e,53),nt(e,340),nt(e,337,qC(1)),nt(e,51,WC([[1,0]])),nt(e,338),nt(e,333),e.end()}function W_(){var e=[_n];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function VC(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=wr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Fc=1024;function z_(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ht("xml",null,{"xmlns:v":ns.v,"xmlns:o":ns.o,"xmlns:x":ns.x,"xmlns:mv":ns.mv}).replace(/\/>/,">"),ht("o:shapelayout",ht("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ht("v:shapetype",[ht("v:stroke",null,{joinstyle:"miter"}),ht("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Fc<e*1e3;)Fc+=1e3;return t.forEach(function(s){var o=$n(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ht("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ht("v:fill",c,l),u={on:"t",obscured:"t"};++Fc,a=a.concat(["<v:shape"+Cu({id:"_x0000_s"+Fc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ht("v:shadow",null,u),ht("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Vn("x:AutoFill","False"),Vn("x:Row",String(o.r)),Vn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function H_(e){var t=[_n,ht("comments",null,{xmlns:dd[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=yr(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(yr(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Vn("t",yr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(Vn("t",yr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function GC(e,t,r){var n=[_n,ht("ThreadedComments",null,{xmlns:Fn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ht("threadedComment",Vn("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function KC(e){var t=[_n,ht("personList",null,{xmlns:Fn.TCMNT,"xmlns:x":dd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ht("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function XC(e){var t={};t.iauthor=e.read_shift(4);var r=oc(e);return t.rfx=r.s,t.ref=wr(r.s),e.l+=16,t}function JC(e,t){return t==null&&(t=qe(36)),t.write_shift(4,e[1].iauthor),fd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ZC=ha;function QC(e){return Rn(e.slice(0,54))}function e9(e){var t=La(),r=[];return nt(t,628),nt(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),nt(t,632,QC(a.a)))})}),nt(t,631),nt(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:$n(n[0]),e:$n(n[0])};nt(t,635,JC([s,a])),a.t&&a.t.length>0&&nt(t,637,rE(a)),nt(t,636),delete a.iauthor})}),nt(t,634),nt(t,629),t.end()}function t9(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Nr.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var q_=["xlsb","xlsm","xlam","biff8","xla"],r9=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,a+(l?"":"$")+fa(u)+(c?"":"$")+Kn(d)}return function(a,s){return t=s,a.replace(e,r)}}(),d1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,u1=function(){return function(t,r){return t.replace(d1,function(n,a,s,o,l,c){var d=a1(o)-(s?0:r.c),u=n1(c)-(l?0:r.r),h=u==0?"":l?u+1:"["+u+"]",m=d==0?"":s?d+1:"["+d+"]";return a+"R"+h+"C"+m})}}();function n9(e,t){return e.replace(d1,function(r,n,a,s,o,l){return n+(a=="$"?a+s:fa(a1(s)+t.c))+(o=="$"?o+l:Kn(n1(l)+t.r))})}function a9(e){return e.length!=1}function bn(e){e.l+=1}function Ko(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Y_(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return V_(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=Ko(e),l=Ko(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function V_(e){var t=Ko(e),r=Ko(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function s9(e,t,r){if(r.biff<8)return V_(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Ko(e),o=Ko(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function G_(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return i9(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ko(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function i9(e){var t=Ko(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function o9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function l9(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return c9(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function c9(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function d9(e,t,r){var n=(e[e.l++]&96)>>5,a=Y_(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function u9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=Y_(e,s,r);return[n,a,o]}function f9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function h9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function m9(e,t,r){var n=(e[e.l++]&96)>>5,a=s9(e,t-1,r);return[n,a]}function p9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function g9(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function x9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function v9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function b9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function y9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function K_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function w9(e){return e.read_shift(2),K_(e)}function _9(e){return e.read_shift(2),K_(e)}function N9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=G_(e,0,r);return[n,a]}function k9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=l9(e,0,r);return[n,a]}function S9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=G_(e,0,r);return[n,a,s]}function j9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[jD[a],Z_[a],n]}function T9(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:A9(e);return[a,(s[0]===0?Z_:SD)[s[1]]]}function A9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function E9(e,t,r){e.l+=r&&r.biff==2?3:4}function C9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function D9(e){return e.l++,of[e.read_shift(1)]}function O9(e){return e.l++,e.read_shift(2)}function P9(e){return e.l++,e.read_shift(1)!==0}function L9(e){return e.l++,hd(e)}function F9(e,t,r){return e.l++,D_(e,t-1,r)}function $9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=SE(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=of[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=hd(e);break;case 2:r[1]=EE(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function R9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?oc:OE)(e));return a}function M9(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=$9(e,r.biff);return o}function I9(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function B9(e,t,r){if(r.biff==5)return U9(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function U9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function W9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function z9(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function H9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function q9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Y9=Ti,V9=Ti,G9=Ti;function lf(e,t,r){return e.l+=2,[o9(e)]}function f1(e){return e.l+=6,[]}var K9=lf,X9=f1,J9=f1,Z9=lf;function X_(e){return e.l+=2,[E_(e),e.read_shift(2)&1]}var Q9=lf,eD=X_,tD=f1,rD=lf,nD=lf,aD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function sD(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=aD[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:s}}function iD(e){return e.l+=2,[e.read_shift(4)]}function oD(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function lD(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function cD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uD(e){return e.l+=4,[0,0]}var Tb={1:{n:"PtgExp",f:C9},2:{n:"PtgTbl",f:G9},3:{n:"PtgAdd",f:bn},4:{n:"PtgSub",f:bn},5:{n:"PtgMul",f:bn},6:{n:"PtgDiv",f:bn},7:{n:"PtgPower",f:bn},8:{n:"PtgConcat",f:bn},9:{n:"PtgLt",f:bn},10:{n:"PtgLe",f:bn},11:{n:"PtgEq",f:bn},12:{n:"PtgGe",f:bn},13:{n:"PtgGt",f:bn},14:{n:"PtgNe",f:bn},15:{n:"PtgIsect",f:bn},16:{n:"PtgUnion",f:bn},17:{n:"PtgRange",f:bn},18:{n:"PtgUplus",f:bn},19:{n:"PtgUminus",f:bn},20:{n:"PtgPercent",f:bn},21:{n:"PtgParen",f:bn},22:{n:"PtgMissArg",f:bn},23:{n:"PtgStr",f:F9},26:{n:"PtgSheet",f:oD},27:{n:"PtgEndSheet",f:lD},28:{n:"PtgErr",f:D9},29:{n:"PtgBool",f:P9},30:{n:"PtgInt",f:O9},31:{n:"PtgNum",f:L9},32:{n:"PtgArray",f:p9},33:{n:"PtgFunc",f:j9},34:{n:"PtgFuncVar",f:T9},35:{n:"PtgName",f:I9},36:{n:"PtgRef",f:N9},37:{n:"PtgArea",f:d9},38:{n:"PtgMemArea",f:W9},39:{n:"PtgMemErr",f:Y9},40:{n:"PtgMemNoMem",f:V9},41:{n:"PtgMemFunc",f:z9},42:{n:"PtgRefErr",f:H9},43:{n:"PtgAreaErr",f:f9},44:{n:"PtgRefN",f:k9},45:{n:"PtgAreaN",f:m9},46:{n:"PtgMemAreaN",f:cD},47:{n:"PtgMemNoMemN",f:dD},57:{n:"PtgNameX",f:B9},58:{n:"PtgRef3d",f:S9},59:{n:"PtgArea3d",f:u9},60:{n:"PtgRefErr3d",f:q9},61:{n:"PtgAreaErr3d",f:h9},255:{}},fD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hD={1:{n:"PtgElfLel",f:X_},2:{n:"PtgElfRw",f:rD},3:{n:"PtgElfCol",f:K9},6:{n:"PtgElfRwV",f:nD},7:{n:"PtgElfColV",f:Z9},10:{n:"PtgElfRadical",f:Q9},11:{n:"PtgElfRadicalS",f:tD},13:{n:"PtgElfColS",f:X9},15:{n:"PtgElfColSV",f:J9},16:{n:"PtgElfRadicalLel",f:eD},25:{n:"PtgList",f:sD},29:{n:"PtgSxName",f:iD},255:{}},mD={0:{n:"PtgAttrNoop",f:uD},1:{n:"PtgAttrSemi",f:y9},2:{n:"PtgAttrIf",f:v9},4:{n:"PtgAttrChoose",f:g9},8:{n:"PtgAttrGoto",f:x9},16:{n:"PtgAttrSum",f:E9},32:{n:"PtgAttrBaxcel",f:jb},33:{n:"PtgAttrBaxcel",f:jb},64:{n:"PtgAttrSpace",f:w9},65:{n:"PtgAttrSpaceSemi",f:_9},128:{n:"PtgAttrIfError",f:b9},255:{}};function pD(e,t,r,n){if(n.biff<8)return Ti(e,t);for(var a=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=M9(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=R9(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&s.push(Ti(e,t)),s}function gD(e,t,r){for(var n=e.l+t,a,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Tb[s]||Tb[fD[s]],(s===24||s===25)&&(a=(s===24?hD:mD)[e[e.l+1]]),!a||!a.f?Ti(e,t):o.push([a.n,a.f(e,t,r)]);return o}function xD(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var vD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bD(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function J_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ab(e,t,r){var n=J_(e,t,r);return n=="#REF"?n:bD(n,r)}function ed(e,t,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,h=0,m=0,f,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",y=0,N=e[0].length;y<N;++y){var S=e[0][y];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=Qr(" ",e[0][g][1][1]);break;case 1:b=Qr("\r",e[0][g][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}d=d+b,g=-1}l.push(d+vD[S[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=pu(S[1][1],o,a),l.push(gu(u,s));break;case"PtgRefN":u=r?pu(S[1][1],r,a):S[1][1],l.push(gu(u,s));break;case"PtgRef3d":h=S[1][1],u=pu(S[1][2],o,a),x=Ab(n,h,a),l.push(x+"!"+gu(u,s));break;case"PtgFunc":case"PtgFuncVar":var _=S[1][0],D=S[1][1];_||(_=0),_&=127;var I=_==0?[]:l.slice(-_);l.length-=_,D==="User"&&(D=I.shift()),l.push(D+"("+I.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":f=fb(S[1][1],r?{s:r}:o,a),l.push(Lp(f,a));break;case"PtgArea":f=fb(S[1][1],o,a),l.push(Lp(f,a));break;case"PtgArea3d":h=S[1][1],f=S[1][2],x=Ab(n,h,a),l.push(x+"!"+Lp(f,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=S[1][2];var O=(n.names||[])[m-1]||(n[0]||[])[m],R=O?O.Name:"SH33TJSNAME"+String(m);R&&R.slice(0,6)=="_xlfn."&&!a.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var E=S[1][1];m=S[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][m]);else{var C="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][m]&&n[E][m].itab>0&&(C=n.SheetNames[n[E][m].itab-1]+"!"):C=n.SheetNames[m-1]+"!"),n[E]&&n[E][m])C+=n[E][m].Name;else if(n[0]&&n[0][m])C+=n[0][m].Name;else{var M=(J_(n,E,a)||"").split(";;");M[m-1]?C=M[m-1]:C+="SH33TJSERRX"}l.push(C);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var U="(",F=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:U=Qr(" ",e[0][g][1][1])+U;break;case 3:U=Qr("\r",e[0][g][1][1])+U;break;case 4:F=Qr(" ",e[0][g][1][1])+F;break;case 5:F=Qr("\r",e[0][g][1][1])+F;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(U+l.pop()+F);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:S[1][1],r:S[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[wr(u)]){var V=n.sharedf[wr(u)];l.push(ed(V,o,ne,n,a))}else{var ee=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(ed(d[1],o,ne,n,a)),ee=!0;break}ee||l.push(S[1])}break;case"PtgArray":l.push("{"+xD(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&me.indexOf(e[0][y][0])==-1){S=e[0][g];var ye=!0;switch(S[1][0]){case 4:ye=!1;case 0:b=Qr(" ",S[1][1]);break;case 5:ye=!1;case 1:b=Qr("\r",S[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((ye?b:"")+l.pop()+(ye?"":b)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function yD(e){if(e==null){var t=qe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Yl(e);return Yl(0)}function wD(e,t,r,n,a){var s=Vl(t,r,a),o=yD(e.v),l=qe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=qe(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var h=Yn([s,o,l,d]);return h}function nm(e,t,r){var n=e.read_shift(4),a=gD(e,n,r),s=e.read_shift(4),o=s>0?pD(e,s,a,r):null;return[a,o]}var _D=nm,am=nm,ND=nm,kD=nm,SD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Z_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TD(e){var t="of:="+e.replace(d1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function AD(e){return e.replace(/\./,"!")}var xu=typeof Map<"u";function h1(e,t,r){var n=0,a=e.length;if(r){if(xu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=xu?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(xu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function sm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ao=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=g0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Vg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Q_(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function nl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){G4(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ED(e,t,r){if(e&&e["!ref"]){var n=Ur(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function CD(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+wn(e[r])+'"/>';return t+"</mergeCells>"}function DD(e,t,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Eu(yr(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+ht("outlinePr",null,d)}!s&&!l||(a[a.length]=ht("sheetPr",l,o))}var OD=["objects","scenarios","selectLockedCells","selectUnlockedCells"],PD=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LD(e){var t={sheet:1};return OD.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),PD.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=$_(e.password).toString(16).toUpperCase()),ht("sheetProtection",null,t)}function FD(e){return Q_(e),ht("pageMargins",null,e)}function $D(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ht("col",null,sm(a,n)));return r[r.length]="</cols>",r.join("")}function RD(e,t,r,n){var a=typeof e.ref=="string"?e.ref:wn(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=is(a);o.s.r==o.e.r&&(o.e.r=is(t["!ref"]).e.r,a=wn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ht("autoFilter",null,{ref:a})}function MD(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ht("sheetViews",ht("sheetView",null,a),{})}function ID(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=of[e.v];break;case"d":n&&n.cellDates?a=Na(e.v,-1).toISOString():(e=Ia(e),e.t="n",a=""+(e.v=Ma(Na(e.v)))),typeof e.z>"u"&&(e.z=tn[14]);break;default:a=e.v;break}var l=Vn("v",yr(a)),c={r:t},d=nl(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Vn("v",""+h1(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ht("f",yr(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ht("c",l,c)}function BD(e,t,r,n){var a=[],s=[],o=Ur(e["!ref"]),l="",c,d="",u=[],h=0,m=0,f=e["!rows"],x=Array.isArray(e),g={r:d},b,y=-1;for(m=o.s.c;m<=o.e.c;++m)u[m]=fa(m);for(h=o.s.r;h<=o.e.r;++h){for(s=[],d=Kn(h),m=o.s.c;m<=o.e.c;++m){c=u[m]+d;var N=x?(e[h]||[])[m]:e[c];N!==void 0&&(l=ID(N,c,e,t))!=null&&s.push(l)}(s.length>0||f&&f[h])&&(g={r:d},f&&f[h]&&(b=f[h],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=x0(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),a[a.length]=ht("row",s.join(""),g))}if(f)for(;h<f.length;++h)f&&f[h]&&(g={r:h+1},b=f[h],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=x0(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level),a[a.length]=ht("row","",g));return a.join("")}function e3(e,t,r,n){var a=[_n,ht("worksheet",null,{xmlns:dd[0],"xmlns:r":Fn.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var d=c["!ref"]||"A1",u=Ur(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=wn(u)}n||(n={}),c["!comments"]=[];var h=[];DD(c,r,e,t,a),a[a.length]=ht("dimension",null,{ref:d}),a[a.length]=MD(c,t,e,r),t.sheetFormat&&(a[a.length]=ht("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=$D(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=BD(c,t),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=LD(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=RD(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=CD(c["!merges"]));var m=-1,f,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=br(n,-1,yr(g[1].Target).replace(/#.*$/,""),lr.HLINK),f["r:id"]="rId"+x),(m=g[1].Target.indexOf("#"))>-1&&(f.location=yr(g[1].Target.slice(m+1))),g[1].Tooltip&&(f.tooltip=yr(g[1].Tooltip)),a[a.length]=ht("hyperlink",null,f))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=FD(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Vn("ignoredErrors",ht("ignoredError",null,{numberStoredAsText:1,sqref:d}))),h.length>0&&(x=br(n,-1,"../drawings/drawing"+(e+1)+".xml",lr.DRAW),a[a.length]=ht("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=h),c["!comments"].length>0&&(x=br(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",lr.VML),a[a.length]=ht("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function UD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function WD(e,t,r){var n=qe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=x0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,m=-1,f=u<<10;f<u+1<<10;++f){d.c=f;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[wr(d)];x&&(h<0&&(h=f),m=f)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,m))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function zD(e,t,r,n){var a=WD(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&nt(e,0,a)}var HD=oc,qD=fd;function YD(){}function VD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=nE(e),r}function GD(e,t,r){r==null&&(r=qe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return h0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),p_(e,r),r.slice(0,r.l)}function KD(e){var t=Ps(e);return[t]}function XD(e,t,r){return r==null&&(r=qe(8)),ac(t,r)}function JD(e){var t=sc(e);return[t]}function ZD(e,t,r){return r==null&&(r=qe(4)),ic(t,r)}function QD(e){var t=Ps(e),r=e.read_shift(1);return[t,r,"b"]}function e7(e,t,r){return r==null&&(r=qe(9)),ac(t,r),r.write_shift(1,e.v?1:0),r}function t7(e){var t=sc(e),r=e.read_shift(1);return[t,r,"b"]}function r7(e,t,r){return r==null&&(r=qe(5)),ic(t,r),r.write_shift(1,e.v?1:0),r}function n7(e){var t=Ps(e),r=e.read_shift(1);return[t,r,"e"]}function a7(e,t,r){return r==null&&(r=qe(9)),ac(t,r),r.write_shift(1,e.v),r}function s7(e){var t=sc(e),r=e.read_shift(1);return[t,r,"e"]}function i7(e,t,r){return r==null&&(r=qe(8)),ic(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function o7(e){var t=Ps(e),r=e.read_shift(4);return[t,r,"s"]}function l7(e,t,r){return r==null&&(r=qe(12)),ac(t,r),r.write_shift(4,t.v),r}function c7(e){var t=sc(e),r=e.read_shift(4);return[t,r,"s"]}function d7(e,t,r){return r==null&&(r=qe(8)),ic(t,r),r.write_shift(4,t.v),r}function u7(e){var t=Ps(e),r=hd(e);return[t,r,"n"]}function f7(e,t,r){return r==null&&(r=qe(16)),ac(t,r),Yl(e.v,r),r}function h7(e){var t=sc(e),r=hd(e);return[t,r,"n"]}function m7(e,t,r){return r==null&&(r=qe(12)),ic(t,r),Yl(e.v,r),r}function p7(e){var t=Ps(e),r=g_(e);return[t,r,"n"]}function g7(e,t,r){return r==null&&(r=qe(12)),ac(t,r),x_(e.v,r),r}function x7(e){var t=sc(e),r=g_(e);return[t,r,"n"]}function v7(e,t,r){return r==null&&(r=qe(8)),ic(t,r),x_(e.v,r),r}function b7(e){var t=Ps(e),r=s1(e);return[t,r,"is"]}function y7(e){var t=Ps(e),r=ha(e);return[t,r,"str"]}function w7(e,t,r){return r==null&&(r=qe(12+4*e.v.length)),ac(t,r),Rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _7(e){var t=sc(e),r=ha(e);return[t,r,"str"]}function N7(e,t,r){return r==null&&(r=qe(8+4*e.v.length)),ic(t,r),Rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function k7(e,t,r){var n=e.l+t,a=Ps(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=am(e,n-e.l,r);o[3]=ed(l,null,a,r.supbooks,r)}else e.l=n;return o}function S7(e,t,r){var n=e.l+t,a=Ps(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=am(e,n-e.l,r);o[3]=ed(l,null,a,r.supbooks,r)}else e.l=n;return o}function j7(e,t,r){var n=e.l+t,a=Ps(e);a.r=r["!row"];var s=hd(e),o=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=am(e,n-e.l,r);o[3]=ed(l,null,a,r.supbooks,r)}else e.l=n;return o}function T7(e,t,r){var n=e.l+t,a=Ps(e);a.r=r["!row"];var s=ha(e),o=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=am(e,n-e.l,r);o[3]=ed(l,null,a,r.supbooks,r)}else e.l=n;return o}var A7=oc,E7=fd;function C7(e,t){return t==null&&(t=qe(4)),t.write_shift(4,e),t}function D7(e,t){var r=e.l+t,n=oc(e),a=i1(e),s=ha(e),o=ha(e),l=ha(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function O7(e,t){var r=qe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));fd({s:$n(e[0]),e:$n(e[0])},r),o1("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Rn(a||"",r),Rn(e[1].Tooltip||"",r),Rn("",r),r.slice(0,r.l)}function P7(){}function L7(e,t,r){var n=e.l+t,a=v_(e),s=e.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=_D(e,n-e.l,r);o[1]=l}else e.l=n;return o}function F7(e,t,r){var n=e.l+t,a=oc(e),s=[a];if(r.cellFormula){var o=kD(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function $7(e,t,r){r==null&&(r=qe(18));var n=sm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var t3=["left","right","top","bottom","header","footer"];function R7(e){var t={};return t3.forEach(function(r){t[r]=hd(e)}),t}function M7(e,t){return t==null&&(t=qe(6*8)),Q_(e),t3.forEach(function(r){Yl(e[r],t)}),t}function I7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function B7(e,t,r){r==null&&(r=qe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function U7(e){var t=qe(24);return t.write_shift(4,4),t.write_shift(4,1),fd(e,t),t}function W7(e,t){return t==null&&(t=qe(16*4+2)),t.write_shift(2,e.password?$_(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function z7(){}function H7(){}function q7(e,t,r,n,a,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Ia(t),t.z=t.z||tn[14],t.v=Ma(Na(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=nl(a.cellXfs,t,a),t.l&&s["!links"].push([wr(c),t.l]),t.c&&s["!comments"].push([wr(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=h1(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,o?nt(e,18,d7(t,c)):nt(e,7,l7(t,c))):(c.t="str",o?nt(e,17,N7(t,c)):nt(e,6,w7(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?nt(e,13,v7(t,c)):nt(e,2,g7(t,c)):o?nt(e,16,m7(t,c)):nt(e,5,f7(t,c)),!0;case"b":return c.t="b",o?nt(e,15,r7(t,c)):nt(e,4,e7(t,c)),!0;case"e":return c.t="e",o?nt(e,14,i7(t,c)):nt(e,3,a7(t,c)),!0}return o?nt(e,12,ZD(t,c)):nt(e,1,XD(t,c)),!0}function Y7(e,t,r,n){var a=Ur(t["!ref"]||"A1"),s,o="",l=[];nt(e,145);var c=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=d;++u){o=Kn(u),zD(e,t,a,u);var h=!1;if(u<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){u===a.s.r&&(l[m]=fa(m)),s=l[m]+o;var f=c?(t[u]||[])[m]:t[s];if(!f){h=!1;continue}h=q7(e,f,u,m,n,t,h)}}nt(e,146)}function V7(e,t){!t||!t["!merges"]||(nt(e,177,C7(t["!merges"].length)),t["!merges"].forEach(function(r){nt(e,176,E7(r))}),nt(e,178))}function G7(e,t){!t||!t["!cols"]||(nt(e,390),t["!cols"].forEach(function(r,n){r&&nt(e,60,$7(n,r))}),nt(e,391))}function K7(e,t){!t||!t["!ref"]||(nt(e,648),nt(e,649,U7(Ur(t["!ref"]))),nt(e,650))}function X7(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=br(r,-1,n[1].Target.replace(/#.*$/,""),lr.HLINK);nt(e,494,O7(n,a))}}),delete t["!links"]}function J7(e,t,r,n){if(t["!comments"].length>0){var a=br(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",lr.VML);nt(e,551,o1("rId"+a)),t["!legacy"]=a}}function Z7(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:wn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=is(s);l.s.r==l.e.r&&(l.e.r=is(t["!ref"]).e.r,s=wn(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),nt(e,161,fd(Ur(s))),nt(e,162)}}function Q7(e,t,r){nt(e,133),nt(e,137,B7(t,r)),nt(e,138),nt(e,134)}function eO(e,t){t["!protect"]&&nt(e,535,W7(t["!protect"]))}function tO(e,t,r,n){var a=La(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Ur(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],nt(a,129),(r.vbaraw||o["!outline"])&&nt(a,147,GD(l,o["!outline"])),nt(a,148,qD(c)),Q7(a,o,r.Workbook),G7(a,o),Y7(a,o,e,t),eO(a,o),Z7(a,o,r,e),V7(a,o),X7(a,o,n),o["!margins"]&&nt(a,476,M7(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&K7(a,o),J7(a,o,e,n),nt(a,130),a.end()}function rO(e,t){e.l+=10;var r=ha(e);return{name:r}}var nO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function aO(e){return!e.Workbook||!e.Workbook.WBProps?"false":FA(e.Workbook.WBProps.date1904)?"true":"false"}var sO="][*?/\\".split("");function r3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return sO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iO(e,t,r){e.forEach(function(n,a){r3(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function oO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];iO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)ED(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function n3(e){var t=[_n];t[t.length]=ht("workbook",null,{xmlns:dd[0],"xmlns:r":Fn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(nO.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ht("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:yr(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ht("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ht("definedName",yr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function lO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Yg(e),r.name=ha(e),r}function cO(e,t){return t||(t=qe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),o1(e.strRelID,t),Rn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function dO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ha(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function uO(e,t){t||(t=qe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),p_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=aE(e),o=ND(e,0,r),l=i1(e);e.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function hO(e,t){nt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};nt(e,156,cO(a))}nt(e,144)}function mO(e,t){t||(t=qe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Rn("SheetJS",t),Rn(s0.version,t),Rn(s0.version,t),Rn("7262",t),t.length>t.l?t.slice(0,t.l):t}function pO(e,t){t||(t=qe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function gO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(nt(e,135),nt(e,158,pO(a)),nt(e,136))}}function xO(e,t){var r=La();return nt(r,131),nt(r,128,mO()),nt(r,153,uO(e.Workbook&&e.Workbook.WBProps||null)),gO(r,e),hO(r,e),nt(r,132),r.end()}function vO(e,t,r){return(t.slice(-4)===".bin"?xO:n3)(e)}function bO(e,t,r,n,a){return(t.slice(-4)===".bin"?tO:e3)(e,r,n,a)}function yO(e,t,r){return(t.slice(-4)===".bin"?MC:I_)(e,r)}function wO(e,t,r){return(t.slice(-4)===".bin"?uC:F_)(e,r)}function _O(e,t,r){return(t.slice(-4)===".bin"?e9:H_)(e)}function NO(e){return(e.slice(-4)===".bin"?YC:W_)()}function kO(e,t){var r=[];return e.Props&&r.push(yE(e.Props,t)),e.Custprops&&r.push(wE(e.Props,e.Custprops)),r.join("")}function SO(){return""}function jO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(ht("NumberFormat",null,{"ss:Format":yr(tn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(ht("Style",s.join(""),o))}),ht("Styles",r.join(""))}function a3(e){return ht("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+u1(e.Ref,{r:0,c:0})})}function TO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(a3(a)))}return ht("Names",r.join(""))}function AO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(a3(l)))}return s.join("")}function EO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ht("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ht("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ht("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ht("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Vn("ProtectContents","True")),e["!protect"].objects&&a.push(Vn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Vn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Vn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Vn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":ht("WorksheetOptions",a.join(""),{xmlns:ns.x})}function CO(e){return e.map(function(t){var r=LA(t.t||""),n=ht("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ht("Comment",n,{"ss:Author":t.a})}).join("")}function DO(e,t,r,n,a,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+yr(u1(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=$n(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=yr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=yr(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var h="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",m=String(e.v);break;case"b":h="Boolean",m=e.v?"1":"0";break;case"e":h="Error",m=of[e.v];break;case"d":h="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||tn[14]);break;case"s":h="String",m=PA(e.v||"");break}var f=nl(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+f),l["ss:Index"]=o.c+1;var x=e.v!=null?m:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=CO(e.c)),ht("Cell",g,l)}function OO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=M_(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function PO(e,t,r,n){if(!e["!ref"])return"";var a=Ur(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,y){c1(b);var N=!!b.width,S=sm(y,b),_={"ss:Index":y+1};N&&(_["ss:Width"]=p0(S.width)),b.hidden&&(_["ss:Hidden"]="1"),l.push(ht("Column",null,_))});for(var c=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var u=[OO(d,(e["!rows"]||[])[d])],h=a.s.c;h<=a.e.c;++h){var m=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>d)&&!(s[o].e.c<h)&&!(s[o].e.r<d)){(s[o].s.c!=h||s[o].s.r!=d)&&(m=!0);break}if(!m){var f={r:d,c:h},x=wr(f),g=c?(e[d]||[])[h]:e[x];u.push(DO(g,x,e,t,r,n,f))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function LO(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],o=s?AO(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?PO(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(EO(s,t,e,r)),n.join("")}function FO(e,t){t||(t={}),e.SSF||(e.SSF=Ia(tn)),e.SSF&&(em(),Q0(e.SSF),t.revssf=tm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],nl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kO(e,t)),r.push(SO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ht("Worksheet",LO(n,t,e),{"ss:Name":yr(e.SheetNames[n])}));return r[2]=jO(e,t),r[3]=TO(e),_n+ht("Workbook",r.join(""),{xmlns:ns.ss,"xmlns:o":ns.o,"xmlns:x":ns.x,"xmlns:ss":ns.ss,"xmlns:dt":ns.dt,"xmlns:html":ns.html})}var Rp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $O(e,t){var r=[],n=[],a=[],s=0,o,l=tb(mb,"n"),c=tb(pb,"n");if(e.Props)for(o=Xn(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Xn(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Custprops[o[s]]]);var d=[];for(s=0;s<a.length;++s)A_.indexOf(a[s][0])>-1||S_.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);n.length&&Nr.utils.cfb_add(t,"/SummaryInformation",yb(n,Rp.SI,c,pb)),(r.length||d.length)&&Nr.utils.cfb_add(t,"/DocumentSummaryInformation",yb(r,Rp.DSI,l,mb,d.length?d:null,Rp.UDI))}function RO(e,t){var r=t||{},n=Nr.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Nr.utils.cfb_add(n,a,s3(e,r)),r.biff==8&&(e.Props||e.Custprops)&&$O(e,n),r.biff==8&&e.vbaraw&&t9(n,Nr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var MO={0:{f:UD},1:{f:KD},2:{f:p7},3:{f:n7},4:{f:QD},5:{f:u7},6:{f:y7},7:{f:o7},8:{f:T7},9:{f:j7},10:{f:k7},11:{f:S7},12:{f:JD},13:{f:x7},14:{f:s7},15:{f:t7},16:{f:h7},17:{f:_7},18:{f:c7},19:{f:s1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fO},40:{},42:{},43:{f:yC},44:{f:vC},45:{f:NC},46:{f:SC},47:{f:kC},48:{},49:{f:JA},50:{},51:{f:UC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZE},62:{f:b7},63:{f:VC},64:{f:z7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ti,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:I7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:VD},148:{f:HD,p:16},151:{f:P7},152:{},153:{f:dO},154:{},155:{},156:{f:lO},157:{},158:{},159:{T:1,f:lC},160:{T:-1},161:{T:1,f:oc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:A7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:IC},336:{T:-1},337:{f:HC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:L7},427:{f:F7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:YD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:D7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ZC},633:{T:1},634:{T:-1},635:{T:1,f:XC},636:{T:-1},637:{f:tE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:rO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:H7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function mt(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&r1(r)&&e.push(r)}}function IO(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return mt(e,t,r,a);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function cf(e,t,r){return e||(e=qe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function BO(e,t,r,n){var a=qe(9);return cf(a,e,t),C_(r,n||"b",a),a}function UO(e,t,r){var n=qe(8+2*r.length);return cf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function WO(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Ma(Na(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?mt(e,2,rC(r,n,a)):mt(e,3,tC(r,n,a));return;case"b":case"e":mt(e,5,BO(r,n,t.v,t.t));return;case"s":case"str":mt(e,4,UO(r,n,(t.v||"").slice(0,255)));return}mt(e,1,cf(null,r,n))}function zO(e,t,r,n){var a=Array.isArray(t),s=Ur(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=wn(s)}for(var d=s.s.r;d<=s.e.r;++d){l=Kn(d);for(var u=s.s.c;u<=s.e.c;++u){d===s.s.r&&(c[u]=fa(u)),o=c[u]+l;var h=a?(t[d]||[])[u]:t[o];h&&WO(e,h,d,u)}}}function HO(e,t){for(var r=t||{},n=La(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return mt(n,r.biff==4?1033:r.biff==3?521:9,l1(e,16,r)),zO(n,e.Sheets[e.SheetNames[a]],a,r),mt(n,10),n.end()}function qO(e,t,r){mt(e,49,ME({sz:12,name:"Arial"},r))}function YO(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&mt(e,1054,UE(a,t[a],r))})}function VO(e,t){var r=qe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),mt(e,2151,r),r=qe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),P_(Ur(t["!ref"]||"A1"),r),r.write_shift(4,4),mt(e,2152,r)}function GO(e,t){for(var r=0;r<16;++r)mt(e,224,_b({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){mt(e,224,_b(n,0,t))})}function KO(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];mt(e,440,KE(n)),n[1].Tooltip&&mt(e,2048,XE(n))}delete t["!links"]}function XO(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&mt(e,125,QE(sm(a,n),a))})}}function JO(e,t,r,n,a){var s=16+nl(a.cellXfs,t,a);if(t.v==null&&!t.bf){mt(e,513,Vl(r,n,s));return}if(t.bf)mt(e,6,wD(t,r,n,a,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ma(Na(t.v)):t.v;mt(e,515,qE(r,n,o,s));break;case"b":case"e":mt(e,517,HE(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=h1(a.Strings,t.v,a.revStrings);mt(e,253,IE(r,n,l,s))}else mt(e,516,BE(r,n,(t.v||"").slice(0,255),s,a));break;default:mt(e,513,Vl(r,n,s))}}function ZO(e,t,r){var n=La(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),d=t.biff==8,u,h="",m=[],f=Ur(s["!ref"]||"A1"),x=d?65536:16384;if(f.e.c>255||f.e.r>=x){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,x-1)}mt(n,2057,l1(r,16,t)),mt(n,13,bs(1)),mt(n,12,bs(100)),mt(n,15,wa(!0)),mt(n,17,wa(!1)),mt(n,16,Yl(.001)),mt(n,95,wa(!0)),mt(n,42,wa(!1)),mt(n,43,wa(!1)),mt(n,130,bs(1)),mt(n,128,zE()),mt(n,131,wa(!1)),mt(n,132,wa(!1)),d&&XO(n,s["!cols"]),mt(n,512,WE(f,t)),d&&(s["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){h=Kn(g);for(var b=f.s.c;b<=f.e.c;++b){g===f.s.r&&(m[b]=fa(b)),u=m[b]+h;var y=c?(s[g]||[])[b]:s[u];y&&(JO(n,y,g,b,t),d&&y.l&&s["!links"].push([u,y.l]))}}var N=l.CodeName||l.name||a;return d&&mt(n,574,RE((o.Views||[])[0])),d&&(s["!merges"]||[]).length&&mt(n,229,GE(s["!merges"])),d&&KO(n,s),mt(n,442,O_(N)),d&&VO(n,s),mt(n,10),n.end()}function QO(e,t,r){var n=La(),a=(e||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(mt(n,2057,l1(e,5,r)),r.bookType=="xla"&&mt(n,135),mt(n,225,l?bs(1200):null),mt(n,193,kE(2)),c&&mt(n,191),c&&mt(n,192),mt(n,226),mt(n,92,PE("SheetJS",r)),mt(n,66,bs(l?1200:1252)),l&&mt(n,353,bs(0)),l&&mt(n,448),mt(n,317,eC(e.SheetNames.length)),l&&e.vbaraw&&mt(n,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";mt(n,442,O_(d))}mt(n,156,bs(17)),mt(n,25,wa(!1)),mt(n,18,wa(!1)),mt(n,19,bs(0)),l&&mt(n,431,wa(!1)),l&&mt(n,444,bs(0)),mt(n,61,$E()),mt(n,64,wa(!1)),mt(n,141,bs(0)),mt(n,34,wa(aO(e)=="true")),mt(n,14,wa(!0)),l&&mt(n,439,wa(!1)),mt(n,218,bs(0)),qO(n,e,r),YO(n,e.SSF,r),GO(n,r),l&&mt(n,352,wa(!1));var u=n.end(),h=La();l&&mt(h,140,JE()),l&&r.Strings&&IO(h,252,FE(r.Strings)),mt(h,10);var m=h.end(),f=La(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var b=u.length+x+m.length;for(g=0;g<e.SheetNames.length;++g){var y=s[g]||{};mt(f,133,LE({pos:b,hs:y.Hidden||0,dt:0,name:e.SheetNames[g]},r)),b+=t[g].length}var N=f.end();if(x!=N.length)throw new Error("BS8 "+x+" != "+N.length);var S=[];return u.length&&S.push(u),N.length&&S.push(N),m.length&&S.push(m),Yn(S)}function eP(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ia(tn)),e&&e.SSF&&(em(),Q0(e.SSF),r.revssf=tm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,m1(r),r.cellXfs=[],nl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=ZO(a,r,e);return n.unshift(QO(e,n,r)),Yn(n)}function s3(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=is(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return eP(e,t);case 4:case 3:case 2:return HO(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function tP(e,t,r,n){for(var a=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var u=wr({r,c:o}),h=n.dense?(e[r]||[])[o]:e[u],m=h&&h.v!=null&&(h.h||OA(h.w||(co(h),h.w)||""))||"",f={};l>1&&(f.rowspan=l),c>1&&(f.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),f.id=(n.id||"sjs")+"-"+u,s.push(ht("td",m,f))}}var x="<tr>";return x+s.join("")+"</tr>"}var rP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nP="</body></html>";function aP(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function i3(e,t){var r=t||{},n=r.header!=null?r.header:rP,a=r.footer!=null?r.footer:nP,s=[n],o=is(e["!ref"]);r.dense=Array.isArray(e),s.push(aP(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(tP(e,o,l,r));return s.push("</table>"+a),s.join("")}function o3(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?$n(n.origin):n.origin;a=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=is(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),a==-1&&(d.e.r=a=u.e.r+1)}var h=[],m=0,f=e["!rows"]||(e["!rows"]=[]),x=0,g=0,b=0,y=0,N=0,S=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&g<c;++x){var _=l[x];if(Eb(_)){if(n.display)continue;f[g]={hidden:!0}}var D=_.children;for(b=y=0;b<D.length;++b){var I=D[b];if(!(n.display&&Eb(I))){var O=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):$A(I.innerHTML),R=I.getAttribute("data-z")||I.getAttribute("z");for(m=0;m<h.length;++m){var E=h[m];E.s.c==y+s&&E.s.r<g+a&&g+a<=E.e.r&&(y=E.e.c+1-s,m=-1)}S=+I.getAttribute("colspan")||1,((N=+I.getAttribute("rowspan")||1)>1||S>1)&&h.push({s:{r:g+a,c:y+s},e:{r:g+a+(N||1)-1,c:y+s+(S||1)-1}});var B={t:"s",v:O},C=I.getAttribute("data-t")||I.getAttribute("t")||"";O!=null&&(O.length==0?B.t=C||"z":n.raw||O.trim().length==0||C=="s"||(O==="TRUE"?B={t:"b",v:!0}:O==="FALSE"?B={t:"b",v:!1}:isNaN(no(O))?isNaN(Au(O).getDate())||(B={t:"d",v:Na(O)},n.cellDates||(B={t:"n",v:Ma(B.v)}),B.z=n.dateNF||tn[14]):B={t:"n",v:no(O)})),B.z===void 0&&R!=null&&(B.z=R);var M="",U=I.getElementsByTagName("A");if(U&&U.length)for(var F=0;F<U.length&&!(U[F].hasAttribute("href")&&(M=U[F].getAttribute("href"),M.charAt(0)!="#"));++F);M&&M.charAt(0)!="#"&&(B.l={Target:M}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][y+s]=B):e[wr({c:y+s,r:g+a})]=B,d.e.c<y+s&&(d.e.c=y+s),y+=S}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,g-1+a),e["!ref"]=wn(d),g>=c&&(e["!fullref"]=wn((d.e.r=l.length-x+g-1+a,d))),e}function l3(e,t){var r=t||{},n=r.dense?[]:{};return o3(n,e,t)}function sP(e,t){return nc(l3(e,t),t)}function Eb(e){var t="",r=iP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var oP=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _n+t}}(),Cb=function(){var e=function(s){return yr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+yr(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,h=is(s["!ref"]||"A1"),m=s["!merges"]||[],f=0,x=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",b=s["!rows"]||[];for(d=0;d<h.s.r;++d)g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;d<=h.e.r;++d){for(g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)c.push(t);for(;u<=h.e.c;++u){var y=!1,N={},S="";for(f=0;f!=m.length;++f)if(!(m[f].s.c>u)&&!(m[f].s.r>d)&&!(m[f].e.c<u)&&!(m[f].e.r<d)){(m[f].s.c!=u||m[f].s.r!=d)&&(y=!0),N["table:number-columns-spanned"]=m[f].e.c-m[f].s.c+1,N["table:number-rows-spanned"]=m[f].e.r-m[f].s.r+1;break}if(y){c.push(r);continue}var _=wr({r:d,c:u}),D=x?(s[d]||[])[u]:s[_];if(D&&D.f&&(N["table:formula"]=yr(TD(D.f)),D.F&&D.F.slice(0,_.length)==_)){var I=is(D.F);N["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,N["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!D){c.push(t);continue}switch(D.t){case"b":S=D.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=D.v?"true":"false";break;case"n":S=D.w||String(D.v||0),N["office:value-type"]="float",N["office:value"]=D.v||0;break;case"s":case"str":S=D.v==null?"":D.v,N["office:value-type"]="string";break;case"d":S=D.w||Na(D.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Na(D.v).toISOString(),N["table:style-name"]="ce1";break;default:c.push(t);continue}var O=e(S);if(D.l&&D.l.Target){var R=D.l.Target;R=R.charAt(0)=="#"?"#"+AD(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),O=ht("text:a",O,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+ht("table:table-cell",ht("text:p",O,{}),N)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var h=d["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;c1(h),h.ods=l;var m=d["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var h=d["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[_n],d=Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Cu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(N_().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)c.push(n(o.Sheets[o.SheetNames[h]],o,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function c3(e,t){if(t.bookType=="fods")return Cb(e,t);var r=Zx(),n="",a=[],s=[];return n="mimetype",Jt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Jt(r,n,Cb(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Jt(r,n,oP(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Jt(r,n,_n+N_()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Jt(r,n,bE(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Jt(r,n,xE(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function v0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lP(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Gs(Eu(e))}function cP(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Xo(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function dP(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Du(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function vr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Uc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function An(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Du(e,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Du(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var d={data:l,type:s};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function Hn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(vr(n*8+a.type)),a.type==2&&t.push(vr(a.data.length)),t.push(a.data))})}),Xo(t)}function zs(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Du(e,n),s=An(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Uc(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=An(l.data),d=Uc(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=s[3])!=null&&t[0]&&(o.merge=Uc(s[3][0].data)>>>0>0),r.push(o)}return r}function Nc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:vr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:vr(o.data.length)}],n[2].push({data:Hn(o.meta),type:2})});var s=Hn(n);t.push(vr(s.length)),t.push(s),a.forEach(function(o){return t.push(o)})}),Xo(t)}function uP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Du(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(s==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Xo(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var u=Xo(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Hs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uP(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Xo(t)}function kc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=vr(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Xo(t)}function Mp(e,t){var r=new Uint8Array(32),n=v0(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,dP(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Ip(e,t){var r=new Uint8Array(32),n=v0(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Fo(e){var t=An(e);return Du(t[1][0].data)}function fP(e,t,r){var n,a,s,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Uc(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=v0(e[7][0].data),u=0,h=[],m=v0(e[4][0].data),f=0,x=[],g=0;g<t.length;++g){if(t[g]==null){d.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}d.setUint16(g*2,u,!0),m.setUint16(g*2,f,!0);var b,y;switch(typeof t[g]){case"string":b=Mp({t:"s",v:t[g]},r),y=Ip({t:"s",v:t[g]},r);break;case"number":b=Mp({t:"n",v:t[g]},r),y=Ip({t:"n",v:t[g]},r);break;case"boolean":b=Mp({t:"b",v:t[g]},r),y=Ip({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(b),u+=b.length,x.push(y),f+=y.length,++c}for(e[2][0].data=vr(c);g<e[7][0].data.length/2;++g)d.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return e[6][0].data=Xo(h),e[3][0].data=Xo(x),c}function hP(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=is(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(wn(n)));var s=b0(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(A){return A.forEach(function(T){typeof T=="string"&&o.push(T)})});var l={},c=[],d=Nr.read(t.numbers,{type:"base64"});d.FileIndex.map(function(A,T){return[A,d.FullPaths[T]]}).forEach(function(A){var T=A[0],L=A[1];if(T.type==2&&T.name.match(/\.iwa/)){var H=T.content,X=Hs(H),re=zs(X);re.forEach(function(ge){c.push(ge.id),l[ge.id]={deps:[],location:L,type:Uc(ge.messages[0].meta[1][0].data)}})}}),c.sort(function(A,T){return A-T});var u=c.filter(function(A){return A>1}).map(function(A){return[A,vr(A)]});d.FileIndex.map(function(A,T){return[A,d.FullPaths[T]]}).forEach(function(A){var T=A[0];if(A[1],!!T.name.match(/\.iwa/)){var L=zs(Hs(T.content));L.forEach(function(H){H.messages.forEach(function(X){u.forEach(function(re){H.messages.some(function(ge){return Uc(ge.meta[1][0].data)!=11006&&cP(ge.data,re[1])})&&l[re[0]].deps.push(H.id)})})})}});for(var h=Nr.find(d,l[1].location),m=zs(Hs(h.content)),f,x=0;x<m.length;++x){var g=m[x];g.id==1&&(f=g)}var b=Fo(An(f.messages[0].data)[1][0].data);for(h=Nr.find(d,l[b].location),m=zs(Hs(h.content)),x=0;x<m.length;++x)g=m[x],g.id==b&&(f=g);for(b=Fo(An(f.messages[0].data)[2][0].data),h=Nr.find(d,l[b].location),m=zs(Hs(h.content)),x=0;x<m.length;++x)g=m[x],g.id==b&&(f=g);for(b=Fo(An(f.messages[0].data)[2][0].data),h=Nr.find(d,l[b].location),m=zs(Hs(h.content)),x=0;x<m.length;++x)g=m[x],g.id==b&&(f=g);var y=An(f.messages[0].data);{y[6][0].data=vr(n.e.r+1),y[7][0].data=vr(n.e.c+1);var N=Fo(y[46][0].data),S=Nr.find(d,l[N].location),_=zs(Hs(S.content));{for(var D=0;D<_.length&&_[D].id!=N;++D);if(_[D].id!=N)throw"Bad ColumnRowUIDMapArchive";var I=An(_[D].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var O=0;O<=n.e.c;++O){var R=[];R[1]=R[2]=[{type:0,data:vr(O+420690)}],I[1].push({type:2,data:Hn(R)}),I[2].push({type:0,data:vr(O)}),I[3].push({type:0,data:vr(O)})}I[4]=[],I[5]=[],I[6]=[];for(var E=0;E<=n.e.r;++E)R=[],R[1]=R[2]=[{type:0,data:vr(E+726270)}],I[4].push({type:2,data:Hn(R)}),I[5].push({type:0,data:vr(E)}),I[6].push({type:0,data:vr(E)});_[D].messages[0].data=Hn(I)}S.content=kc(Nc(_)),S.size=S.content.length,delete y[46];var B=An(y[4][0].data);{B[7][0].data=vr(n.e.r+1);var C=An(B[1][0].data),M=Fo(C[2][0].data);S=Nr.find(d,l[M].location),_=zs(Hs(S.content));{if(_[0].id!=M)throw"Bad HeaderStorageBucket";var U=An(_[0].messages[0].data);for(E=0;E<s.length;++E){var F=An(U[2][0].data);F[1][0].data=vr(E),F[4][0].data=vr(s[E].length),U[2][E]={type:U[2][0].type,data:Hn(F)}}_[0].messages[0].data=Hn(U)}S.content=kc(Nc(_)),S.size=S.content.length;var ne=Fo(B[2][0].data);S=Nr.find(d,l[ne].location),_=zs(Hs(S.content));{if(_[0].id!=ne)throw"Bad HeaderStorageBucket";for(U=An(_[0].messages[0].data),O=0;O<=n.e.c;++O)F=An(U[2][0].data),F[1][0].data=vr(O),F[4][0].data=vr(n.e.r+1),U[2][O]={type:U[2][0].type,data:Hn(F)};_[0].messages[0].data=Hn(U)}S.content=kc(Nc(_)),S.size=S.content.length;var V=Fo(B[4][0].data);(function(){for(var A=Nr.find(d,l[V].location),T=zs(Hs(A.content)),L,H=0;H<T.length;++H){var X=T[H];X.id==V&&(L=X)}var re=An(L.messages[0].data);{re[3]=[];var ge=[];o.forEach(function(Ie,et){ge[1]=[{type:0,data:vr(et)}],ge[2]=[{type:0,data:vr(1)}],ge[3]=[{type:2,data:lP(Ie)}],re[3].push({type:2,data:Hn(ge)})})}L.messages[0].data=Hn(re);var oe=Nc(T),je=kc(oe);A.content=je,A.size=A.content.length})();var ee=An(B[3][0].data);{var me=ee[1][0];delete ee[2];var ye=An(me.data);{var Oe=Fo(ye[2][0].data);(function(){for(var A=Nr.find(d,l[Oe].location),T=zs(Hs(A.content)),L,H=0;H<T.length;++H){var X=T[H];X.id==Oe&&(L=X)}var re=An(L.messages[0].data);{delete re[6],delete ee[7];var ge=new Uint8Array(re[5][0].data);re[5]=[];for(var oe=0,je=0;je<=n.e.r;++je){var Ie=An(ge);oe+=fP(Ie,s[je],o),Ie[1][0].data=vr(je),re[5].push({data:Hn(Ie),type:2})}re[1]=[{type:0,data:vr(n.e.c+1)}],re[2]=[{type:0,data:vr(n.e.r+1)}],re[3]=[{type:0,data:vr(oe)}],re[4]=[{type:0,data:vr(n.e.r+1)}]}L.messages[0].data=Hn(re);var et=Nc(T),Te=kc(et);A.content=Te,A.size=A.content.length})()}me.data=Hn(ye)}B[3][0].data=Hn(ee)}y[4][0].data=Hn(B)}f.messages[0].data=Hn(y);var xe=Nc(m),w=kc(xe);return h.content=w,h.size=h.content.length,d}function mP(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function m1(e){mP([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function pP(e,t){return t.bookType=="ods"?c3(e,t):t.bookType=="numbers"?hP(e,t):t.bookType=="xlsb"?gP(e,t):xP(e,t)}function gP(e,t){Fc=1024,e&&!e.SSF&&(e.SSF=Ia(tn)),e&&e.SSF&&(em(),Q0(e.SSF),t.revssf=tm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=q_.indexOf(t.bookType)>-1,a=y_();m1(t=t||{});var s=Zx(),o="",l=0;if(t.cellXfs=[],nl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Jt(s,o,k_(e.Props,t)),a.coreprops.push(o),br(t.rels,2,o,lr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Jt(s,o,j_(e.Props)),a.extprops.push(o),br(t.rels,3,o,lr.EXT_PROPS),e.Custprops!==e.Props&&Xn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Jt(s,o,T_(e.Custprops)),a.custprops.push(o),br(t.rels,4,o,lr.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jt(s,o,bO(l-1,o,t,e,u)),a.sheets.push(o),br(t.wbrels,-1,"worksheets/sheet"+l+"."+r,lr.WS[0])}if(h){var f=h["!comments"],x=!1,g="";f&&f.length>0&&(g="xl/comments"+l+"."+r,Jt(s,g,_O(f,g)),a.comments.push(g),br(u,-1,"../comments"+l+"."+r,lr.CMNT),x=!0),h["!legacy"]&&x&&Jt(s,"xl/drawings/vmlDrawing"+l+".vml",z_(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Jt(s,__(o),Ic(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Jt(s,o,wO(t.Strings,o,t)),a.strs.push(o),br(t.wbrels,-1,"sharedStrings."+r,lr.SST)),o="xl/workbook."+r,Jt(s,o,vO(e,o)),a.workbooks.push(o),br(t.rels,1,o,lr.WB),o="xl/theme/theme1.xml",Jt(s,o,U_(e.Themes,t)),a.themes.push(o),br(t.wbrels,-1,"theme/theme1.xml",lr.THEME),o="xl/styles."+r,Jt(s,o,yO(e,o,t)),a.styles.push(o),br(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Jt(s,o,e.vbaraw),a.vba.push(o),br(t.wbrels,-1,"vbaProject.bin",lr.VBA)),o="xl/metadata."+r,Jt(s,o,NO(o)),a.metadata.push(o),br(t.wbrels,-1,"metadata."+r,lr.XLMETA),Jt(s,"[Content_Types].xml",w_(a,t)),Jt(s,"_rels/.rels",Ic(t.rels)),Jt(s,"xl/_rels/workbook."+r+".rels",Ic(t.wbrels)),delete t.revssf,delete t.ssf,s}function xP(e,t){Fc=1024,e&&!e.SSF&&(e.SSF=Ia(tn)),e&&e.SSF&&(em(),Q0(e.SSF),t.revssf=tm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,xu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=q_.indexOf(t.bookType)>-1,a=y_();m1(t=t||{});var s=Zx(),o="",l=0;if(t.cellXfs=[],nl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Jt(s,o,k_(e.Props,t)),a.coreprops.push(o),br(t.rels,2,o,lr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Jt(s,o,j_(e.Props)),a.extprops.push(o),br(t.rels,3,o,lr.EXT_PROPS),e.Custprops!==e.Props&&Xn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Jt(s,o,T_(e.Custprops)),a.custprops.push(o),br(t.rels,4,o,lr.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],f=(m||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jt(s,o,e3(l-1,t,e,h)),a.sheets.push(o),br(t.wbrels,-1,"worksheets/sheet"+l+"."+r,lr.WS[0])}if(m){var x=m["!comments"],g=!1,b="";if(x&&x.length>0){var y=!1;x.forEach(function(N){N[1].forEach(function(S){S.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+l+"."+r,Jt(s,b,GC(x,u,t)),a.threadedcomments.push(b),br(h,-1,"../threadedComments/threadedComment"+l+"."+r,lr.TCMNT)),b="xl/comments"+l+"."+r,Jt(s,b,H_(x)),a.comments.push(b),br(h,-1,"../comments"+l+"."+r,lr.CMNT),g=!0}m["!legacy"]&&g&&Jt(s,"xl/drawings/vmlDrawing"+l+".vml",z_(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}h["!id"].rId1&&Jt(s,__(o),Ic(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Jt(s,o,F_(t.Strings,t)),a.strs.push(o),br(t.wbrels,-1,"sharedStrings."+r,lr.SST)),o="xl/workbook."+r,Jt(s,o,n3(e)),a.workbooks.push(o),br(t.rels,1,o,lr.WB),o="xl/theme/theme1.xml",Jt(s,o,U_(e.Themes,t)),a.themes.push(o),br(t.wbrels,-1,"theme/theme1.xml",lr.THEME),o="xl/styles."+r,Jt(s,o,I_(e,t)),a.styles.push(o),br(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Jt(s,o,e.vbaraw),a.vba.push(o),br(t.wbrels,-1,"vbaProject.bin",lr.VBA)),o="xl/metadata."+r,Jt(s,o,W_()),a.metadata.push(o),br(t.wbrels,-1,"metadata."+r,lr.XLMETA),u.length>1&&(o="xl/persons/person.xml",Jt(s,o,KC(u)),a.people.push(o),br(t.wbrels,-1,"persons/person.xml",lr.PEOPLE)),Jt(s,"[Content_Types].xml",w_(a,t)),Jt(s,"_rels/.rels",Ic(t.rels)),Jt(s,"xl/_rels/workbook."+r+".rels",Ic(t.wbrels)),delete t.revssf,delete t.ssf,s}function vP(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=lo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function d3(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return af(t.file,Nr.write(e,{type:hr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Nr.write(e,t)}function bP(e,t){var r=Ia(t||{}),n=pP(e,r);return yP(n,r)}function yP(e,t){var r={},n=hr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Nr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Z0(a))}return t.password&&typeof encrypt_agile<"u"?d3(encrypt_agile(a,t.password),t):t.type==="file"?af(t.file,a):t.type=="string"?hu(a):a}function wP(e,t){var r=t||{},n=RO(e,r);return d3(n,r)}function mi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Tu(Eu(n));case"binary":return Eu(n);case"string":return e;case"file":return af(t.file,n,"utf8");case"buffer":return hr?mo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):mi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _P(e,t){switch(t.type){case"base64":return Tu(e);case"binary":return e;case"string":return e;case"file":return af(t.file,e,"binary");case"buffer":return hr?mo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Tu(r):t.type=="string"?hu(r):r;case"file":return af(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function u3(e,t){XT(),oO(e);var r=Ia(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=u3(e,r);return r.type="array",Z0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return mi(FO(e,r),r);case"slk":case"sylk":return mi(aC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return mi(i3(e.Sheets[e.SheetNames[a]],r),r);case"txt":return _P(f3(e.Sheets[e.SheetNames[a]],r),r);case"csv":return mi(p1(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return mi(sC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return mh(nC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return mi(iC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return mi(hC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return mi(L_.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return mi(c3(e,r),r);case"wk1":return mh(Nb.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return mh(Nb.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),mh(s3(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),wP(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bP(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function NP(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function kP(e,t,r){var n={};return n.type="file",n.file=t,NP(n),u3(e,n)}function SP(e,t,r,n,a,s,o,l){var c=Kn(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var x=o?e[r][f]:e[n[f]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;s[f]!=null&&(m[s[f]]=d);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[f]!=null){if(g==null)if(x.t=="e"&&g===null)m[s[f]]=null;else if(d!==void 0)m[s[f]]=d;else if(u&&g===null)m[s[f]]=null;else continue;else m[s[f]]=u&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?g:co(x,g,l);g!=null&&(h=!1)}}return{row:m,isempty:h}}function b0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Ur(u);break;case"number":c=Ur(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var h=Kn(c.s.r),m=[],f=[],x=0,g=0,b=Array.isArray(e),y=c.s.r,N=0,S={};b&&!e[y]&&(e[y]=[]);var _=d.skipHidden&&e["!cols"]||[],D=d.skipHidden&&e["!rows"]||[];for(N=c.s.c;N<=c.e.c;++N)if(!(_[N]||{}).hidden)switch(m[N]=fa(N),r=b?e[y][N]:e[m[N]+h],n){case 1:s[N]=N-c.s.c;break;case 2:s[N]=m[N];break;case 3:s[N]=d.header[N-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=co(r,null,d),g=S[o]||0,!g)S[o]=1;else{do l=o+"_"+g++;while(S[l]);S[o]=g,S[l]=1}s[N]=l}for(y=c.s.r+a;y<=c.e.r;++y)if(!(D[y]||{}).hidden){var I=SP(e,c,y,m,n,s,b,d);(I.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(f[x++]=I.row)}return f.length=x,f}var Db=/"/g;function jP(e,t,r,n,a,s,o,l){for(var c=!0,d=[],u="",h=Kn(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var f=l.dense?(e[r]||[])[m]:e[n[m]+h];if(f==null)u="";else if(f.v!=null){c=!1,u=""+(l.rawNumbers&&f.t=="n"?f.v:co(f,null,l));for(var x=0,g=0;x!==u.length;++x)if((g=u.charCodeAt(x))===a||g===s||g===34||l.forceQuotes){u='"'+u.replace(Db,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(c=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(Db,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function p1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ur(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(m[x]||{}).hidden||(h[x]=fa(x));for(var g=0,b=a.s.r;b<=a.e.r;++b)(f[b]||{}).hidden||(u=jP(e,a,b,h,o,c,s,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((g++?l:"")+u)));return delete n.dense,r.join("")}function f3(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=p1(e,t);return r}function TP(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ur(e["!ref"]),s="",o=[],l,c=[],d=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=fa(l);for(var u=a.s.r;u<=a.e.r;++u)for(s=Kn(u),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+s,r=d?(e[u]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function h3(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?$n(n.origin):n.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var h=Ur(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+a)}else o==-1&&(o=0,u.e.r=t.length-1+a);var m=n.header||[],f=0;t.forEach(function(g,b){Xn(g).forEach(function(y){(f=m.indexOf(y))==-1&&(m[f=m.length]=y);var N=g[y],S="z",_="",D=wr({c:l+f,r:o+b+a});d=Ou(s,D),N&&typeof N=="object"&&!(N instanceof Date)?s[D]=N:(typeof N=="number"?S="n":typeof N=="boolean"?S="b":typeof N=="string"?S="s":N instanceof Date?(S="d",n.cellDates||(S="n",N=Ma(N)),_=n.dateNF||tn[14]):N===null&&n.nullError&&(S="e",N=0),d?(d.t=S,d.v=N,delete d.w,delete d.R,_&&(d.z=_)):s[D]=d={t:S,v:N},_&&(d.z=_))})}),u.e.c=Math.max(u.e.c,l+m.length-1);var x=Kn(o);if(a)for(f=0;f<m.length;++f)s[fa(f+l)+x]={t:"s",v:m[f]};return s["!ref"]=wn(u),s}function AP(e,t){return h3(null,e,t)}function Ou(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=$n(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ou(e,wr(t)):Ou(e,wr({r:t,c:r||0}))}function EP(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function CP(){return{SheetNames:[],Sheets:{}}}function DP(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(r3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function OP(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=EP(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function PP(e,t){return e.z=t,e}function m3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function LP(e,t,r){return m3(e,"#"+t,r)}function FP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function $P(e,t,r,n){for(var a=typeof t!="string"?t:Ur(t),s=typeof t=="string"?t:wn(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Ou(e,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var zn={encode_col:fa,encode_row:Kn,encode_cell:wr,encode_range:wn,decode_col:a1,decode_row:n1,split_cell:XA,decode_cell:$n,decode_range:is,format_cell:co,sheet_add_aoa:m_,sheet_add_json:h3,sheet_add_dom:o3,aoa_to_sheet:ud,json_to_sheet:AP,table_to_sheet:l3,table_to_book:sP,sheet_to_csv:p1,sheet_to_txt:f3,sheet_to_json:b0,sheet_to_html:i3,sheet_to_formulae:TP,sheet_to_row_object_array:b0,sheet_get_cell:Ou,book_new:CP,book_append_sheet:DP,book_set_sheet_visibility:OP,cell_set_number_format:PP,cell_set_hyperlink:m3,cell_set_internal_link:LP,cell_add_comment:FP,sheet_set_array_formula:$P,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const RP="modulepreload",MP=function(e){return"/"+e},Ob={},Bh=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=MP(c),c in Ob)return;Ob[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":RP,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,f)=>{h.addEventListener("load",m),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};function Qt(e){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(e)}var Zs=Uint8Array,ss=Uint16Array,g1=Int32Array,x1=new Zs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),v1=new Zs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pb=new Zs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p3=function(e,t){for(var r=new ss(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new g1(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},g3=p3(x1,2),IP=g3.b,Gg=g3.r;IP[28]=258,Gg[258]=28;var BP=p3(v1,0),Lb=BP.r,Kg=new ss(32768);for(var Br=0;Br<32768;++Br){var $o=(Br&43690)>>1|(Br&21845)<<1;$o=($o&52428)>>2|($o&13107)<<2,$o=($o&61680)>>4|($o&3855)<<4,Kg[Br]=(($o&65280)>>8|($o&255)<<8)>>1}var vu=function(e,t,r){for(var n=e.length,a=0,s=new ss(t);a<n;++a)e[a]&&++s[e[a]-1];var o=new ss(t);for(a=1;a<t;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new ss(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var d=a<<4|e[a],u=t-e[a],h=o[e[a]-1]++<<u,m=h|(1<<u)-1;h<=m;++h)l[Kg[h]>>c]=d}else for(l=new ss(n),a=0;a<n;++a)e[a]&&(l[a]=Kg[o[e[a]-1]++]>>15-e[a]);return l},Gl=new Zs(288);for(var Br=0;Br<144;++Br)Gl[Br]=8;for(var Br=144;Br<256;++Br)Gl[Br]=9;for(var Br=256;Br<280;++Br)Gl[Br]=7;for(var Br=280;Br<288;++Br)Gl[Br]=8;var y0=new Zs(32);for(var Br=0;Br<32;++Br)y0[Br]=5;var UP=vu(Gl,9,0),WP=vu(y0,5,0),x3=function(e){return(e+7)/8|0},zP=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Zs(e.subarray(t,r))},qi=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},ru=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Bp=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,s=r.slice();if(!a)return{t:b3,l:0};if(a==1){var o=new Zs(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(D,I){return D.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=r[r[d].f<r[h].f?d++:h++],c=r[d!=u&&r[d].f<r[h].f?d++:h++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var m=s[0].s,n=1;n<a;++n)s[n].s>m&&(m=s[n].s);var f=new ss(m+1),x=Xg(r[u-1],f,0);if(x>t){var n=0,g=0,b=x-t,y=1<<b;for(s.sort(function(I,O){return f[O.s]-f[I.s]||I.f-O.f});n<a;++n){var N=s[n].s;if(f[N]>t)g+=y-(1<<x-f[N]),f[N]=t;else break}for(g>>=b;g>0;){var S=s[n].s;f[S]<t?g-=1<<t-f[S]++-1:++n}for(;n>=0&&g;--n){var _=s[n].s;f[_]==t&&(--f[_],++g)}x=t}return{t:new Zs(f),l:x}},Xg=function(e,t,r){return e.s==-1?Math.max(Xg(e.l,t,r+1),Xg(e.r,t,r+1)):t[e.s]=r},Fb=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ss(++t),n=0,a=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==a&&l!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=e[l]}return{c:r.subarray(0,n),n:t}},nu=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},v3=function(e,t,r){var n=r.length,a=x3(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var s=0;s<n;++s)e[a+s+4]=r[s];return(a+4+n)*8},$b=function(e,t,r,n,a,s,o,l,c,d,u){qi(t,u++,r),++a[256];for(var h=Bp(a,15),m=h.t,f=h.l,x=Bp(s,15),g=x.t,b=x.l,y=Fb(m),N=y.c,S=y.n,_=Fb(g),D=_.c,I=_.n,O=new ss(19),R=0;R<N.length;++R)++O[N[R]&31];for(var R=0;R<D.length;++R)++O[D[R]&31];for(var E=Bp(O,7),B=E.t,C=E.l,M=19;M>4&&!B[Pb[M-1]];--M);var U=d+5<<3,F=nu(a,Gl)+nu(s,y0)+o,ne=nu(a,m)+nu(s,g)+o+14+3*M+nu(O,B)+2*O[16]+3*O[17]+7*O[18];if(c>=0&&U<=F&&U<=ne)return v3(t,u,e.subarray(c,c+d));var V,ee,me,ye;if(qi(t,u,1+(ne<F)),u+=2,ne<F){V=vu(m,f,0),ee=m,me=vu(g,b,0),ye=g;var Oe=vu(B,C,0);qi(t,u,S-257),qi(t,u+5,I-1),qi(t,u+10,M-4),u+=14;for(var R=0;R<M;++R)qi(t,u+3*R,B[Pb[R]]);u+=3*M;for(var xe=[N,D],w=0;w<2;++w)for(var A=xe[w],R=0;R<A.length;++R){var T=A[R]&31;qi(t,u,Oe[T]),u+=B[T],T>15&&(qi(t,u,A[R]>>5&127),u+=A[R]>>12)}}else V=UP,ee=Gl,me=WP,ye=y0;for(var R=0;R<l;++R){var L=n[R];if(L>255){var T=L>>18&31;ru(t,u,V[T+257]),u+=ee[T+257],T>7&&(qi(t,u,L>>23&31),u+=x1[T]);var H=L&31;ru(t,u,me[H]),u+=ye[H],H>3&&(ru(t,u,L>>5&8191),u+=v1[H])}else ru(t,u,V[L]),u+=ee[L]}return ru(t,u,V[256]),u+ee[256]},HP=new g1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),b3=new Zs(0),qP=function(e,t,r,n,a,s){var o=s.z||e.length,l=new Zs(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),d=s.l,u=(s.r||0)&7;if(t){u&&(c[0]=s.r>>3);for(var h=HP[t-1],m=h>>13,f=h&8191,x=(1<<r)-1,g=s.p||new ss(32768),b=s.h||new ss(x+1),y=Math.ceil(r/3),N=2*y,S=function(Te){return(e[Te]^e[Te+1]<<y^e[Te+2]<<N)&x},_=new g1(25e3),D=new ss(288),I=new ss(32),O=0,R=0,E=s.i||0,B=0,C=s.w||0,M=0;E+2<o;++E){var U=S(E),F=E&32767,ne=b[U];if(g[F]=ne,b[U]=F,C<=E){var V=o-E;if((O>7e3||B>24576)&&(V>423||!d)){u=$b(e,c,0,_,D,I,R,B,M,E-M,u),B=O=R=0,M=E;for(var ee=0;ee<286;++ee)D[ee]=0;for(var ee=0;ee<30;++ee)I[ee]=0}var me=2,ye=0,Oe=f,xe=F-ne&32767;if(V>2&&U==S(E-xe))for(var w=Math.min(m,V)-1,A=Math.min(32767,E),T=Math.min(258,V);xe<=A&&--Oe&&F!=ne;){if(e[E+me]==e[E+me-xe]){for(var L=0;L<T&&e[E+L]==e[E+L-xe];++L);if(L>me){if(me=L,ye=xe,L>w)break;for(var H=Math.min(xe,L-2),X=0,ee=0;ee<H;++ee){var re=E-xe+ee&32767,ge=g[re],oe=re-ge&32767;oe>X&&(X=oe,ne=re)}}}F=ne,ne=g[F],xe+=F-ne&32767}if(ye){_[B++]=268435456|Gg[me]<<18|Lb[ye];var je=Gg[me]&31,Ie=Lb[ye]&31;R+=x1[je]+v1[Ie],++D[257+je],++I[Ie],C=E+me,++O}else _[B++]=e[E],++D[e[E]]}}for(E=Math.max(E,C);E<o;++E)_[B++]=e[E],++D[e[E]];u=$b(e,c,d,_,D,I,R,B,M,E-M,u),d||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=b,s.p=g,s.i=E,s.w=C)}else{for(var E=s.w||0;E<o+d;E+=65535){var et=E+65535;et>=o&&(c[u/8|0]=d,et=o),u=v3(c,u+1,e.subarray(E,et))}s.i=o}return zP(l,0,n+x3(u)+a)},y3=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},YP=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new Zs(s.length+e.length);o.set(s),o.set(e,s.length),e=o,a.w=s.length}return qP(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},w3=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},VP=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=y3();a.p(t.dictionary),w3(e,2,a.d())}};function Jg(e,t){t||(t={});var r=y3();r.p(e);var n=YP(e,t,t.dictionary?6:2,4);return VP(n,t),w3(n,n.length-4,r.d()),n}var GP=typeof TextDecoder<"u"&&new TextDecoder,KP=0;try{GP.decode(b3,{stream:!0}),KP=1}catch{}function _3(e){if(Array.isArray(e))return e}function XP(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,d=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function Zg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function b1(e,t){if(e){if(typeof e=="string")return Zg(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zg(e,t):void 0}}function N3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Da(e,t){return _3(e)||XP(e,t)||b1(e,t)||N3()}function Rb(e,t="utf8"){return new TextDecoder(t).decode(e)}const JP=new TextEncoder;function ZP(e){return JP.encode(e)}const QP=1024*8,eL=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Up={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class y1{constructor(t=QP,r={}){xr(this,"buffer");xr(this,"byteLength");xr(this,"byteOffset");xr(this,"length");xr(this,"offset");xr(this,"lastWrittenByte");xr(this,"littleEndian");xr(this,"_data");xr(this,"_mark");xr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,s=t.byteLength-a;let o=a;(ArrayBuffer.isView(t)||t instanceof y1)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Up[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===eL&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new Up[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new Up[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return Rb(this.readBytes(t))}decodeText(t=1,r="utf8"){return Rb(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(ZP(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function md(e){let t=e.length;for(;--t>=0;)e[t]=0}const tL=3,rL=258,k3=29,nL=256,aL=nL+1+k3,S3=30,sL=512,iL=new Array((aL+2)*2);md(iL);const oL=new Array(S3*2);md(oL);const lL=new Array(sL);md(lL);const cL=new Array(rL-tL+1);md(cL);const dL=new Array(k3);md(dL);const uL=new Array(S3);md(uL);const fL=(e,t,r,n)=>{let a=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+t[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Qg=fL;const hL=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},mL=new Uint32Array(hL()),pL=(e,t,r,n)=>{const a=mL,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^a[(e^t[o])&255];return e^-1};var fi=pL,ex={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},j3={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const gL=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var xL=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)gL(r,n)&&(e[n]=r[n])}}return e},vL=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,s=e.length;n<s;n++){let o=e[n];r.set(o,a),a+=o.length}return r},T3={assign:xL,flattenChunks:vL};let A3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{A3=!1}const Pu=new Uint8Array(256);for(let e=0;e<256;e++)Pu[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Pu[254]=Pu[254]=1;var bL=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,s,o=e.length,l=0;for(a=0;a<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,a=0;s<l;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const yL=(e,t)=>{if(t<65534&&e.subarray&&A3)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var wL=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=e[n++];if(o<128){s[a++]=o;continue}let l=Pu[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return yL(s,a)},_L=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Pu[e[r]]>t?r:t},tx={string2buf:bL,buf2string:wL,utf8border:_L};function NL(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kL=NL;const ph=16209,SL=16191;var jL=function(t,r){let n,a,s,o,l,c,d,u,h,m,f,x,g,b,y,N,S,_,D,I,O,R,E,B;const C=t.state;n=t.next_in,E=t.input,a=n+(t.avail_in-5),s=t.next_out,B=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=C.dmax,d=C.wsize,u=C.whave,h=C.wnext,m=C.window,f=C.hold,x=C.bits,g=C.lencode,b=C.distcode,y=(1<<C.lenbits)-1,N=(1<<C.distbits)-1;e:do{x<15&&(f+=E[n++]<<x,x+=8,f+=E[n++]<<x,x+=8),S=g[f&y];t:for(;;){if(_=S>>>24,f>>>=_,x-=_,_=S>>>16&255,_===0)B[s++]=S&65535;else if(_&16){D=S&65535,_&=15,_&&(x<_&&(f+=E[n++]<<x,x+=8),D+=f&(1<<_)-1,f>>>=_,x-=_),x<15&&(f+=E[n++]<<x,x+=8,f+=E[n++]<<x,x+=8),S=b[f&N];r:for(;;){if(_=S>>>24,f>>>=_,x-=_,_=S>>>16&255,_&16){if(I=S&65535,_&=15,x<_&&(f+=E[n++]<<x,x+=8,x<_&&(f+=E[n++]<<x,x+=8)),I+=f&(1<<_)-1,I>c){t.msg="invalid distance too far back",C.mode=ph;break e}if(f>>>=_,x-=_,_=s-o,I>_){if(_=I-_,_>u&&C.sane){t.msg="invalid distance too far back",C.mode=ph;break e}if(O=0,R=m,h===0){if(O+=d-_,_<D){D-=_;do B[s++]=m[O++];while(--_);O=s-I,R=B}}else if(h<_){if(O+=d+h-_,_-=h,_<D){D-=_;do B[s++]=m[O++];while(--_);if(O=0,h<D){_=h,D-=_;do B[s++]=m[O++];while(--_);O=s-I,R=B}}}else if(O+=h-_,_<D){D-=_;do B[s++]=m[O++];while(--_);O=s-I,R=B}for(;D>2;)B[s++]=R[O++],B[s++]=R[O++],B[s++]=R[O++],D-=3;D&&(B[s++]=R[O++],D>1&&(B[s++]=R[O++]))}else{O=s-I;do B[s++]=B[O++],B[s++]=B[O++],B[s++]=B[O++],D-=3;while(D>2);D&&(B[s++]=B[O++],D>1&&(B[s++]=B[O++]))}}else if(_&64){t.msg="invalid distance code",C.mode=ph;break e}else{S=b[(S&65535)+(f&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){C.mode=SL;break e}else{t.msg="invalid literal/length code",C.mode=ph;break e}else{S=g[(S&65535)+(f&(1<<_)-1)];continue t}break}}while(n<a&&s<l);D=x>>3,n-=D,x-=D<<3,f&=(1<<x)-1,t.next_in=n,t.next_out=s,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=s<l?257+(l-s):257-(s-l),C.hold=f,C.bits=x};const Sc=15,Mb=852,Ib=592,Bb=0,Wp=1,Ub=2,TL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),AL=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),EL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),DL=(e,t,r,n,a,s,o,l)=>{const c=l.bits;let d=0,u=0,h=0,m=0,f=0,x=0,g=0,b=0,y=0,N=0,S,_,D,I,O,R=null,E;const B=new Uint16Array(Sc+1),C=new Uint16Array(Sc+1);let M=null,U,F,ne;for(d=0;d<=Sc;d++)B[d]=0;for(u=0;u<n;u++)B[t[r+u]]++;for(f=c,m=Sc;m>=1&&B[m]===0;m--);if(f>m&&(f=m),m===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<m&&B[h]===0;h++);for(f<h&&(f=h),b=1,d=1;d<=Sc;d++)if(b<<=1,b-=B[d],b<0)return-1;if(b>0&&(e===Bb||m!==1))return-1;for(C[1]=0,d=1;d<Sc;d++)C[d+1]=C[d]+B[d];for(u=0;u<n;u++)t[r+u]!==0&&(o[C[t[r+u]]++]=u);if(e===Bb?(R=M=o,E=20):e===Wp?(R=TL,M=AL,E=257):(R=EL,M=CL,E=0),N=0,u=0,d=h,O=s,x=f,g=0,D=-1,y=1<<f,I=y-1,e===Wp&&y>Mb||e===Ub&&y>Ib)return 1;for(;;){U=d-g,o[u]+1<E?(F=0,ne=o[u]):o[u]>=E?(F=M[o[u]-E],ne=R[o[u]-E]):(F=96,ne=0),S=1<<d-g,_=1<<x,h=_;do _-=S,a[O+(N>>g)+_]=U<<24|F<<16|ne|0;while(_!==0);for(S=1<<d-1;N&S;)S>>=1;if(S!==0?(N&=S-1,N+=S):N=0,u++,--B[d]===0){if(d===m)break;d=t[r+o[u]]}if(d>f&&(N&I)!==D){for(g===0&&(g=f),O+=h,x=d-g,b=1<<x;x+g<m&&(b-=B[x+g],!(b<=0));)x++,b<<=1;if(y+=1<<x,e===Wp&&y>Mb||e===Ub&&y>Ib)return 1;D=N&I,a[D]=f<<24|x<<16|O-s|0}}return N!==0&&(a[O+N]=d-g<<24|64<<16|0),l.bits=f,0};var bu=DL;const OL=0,E3=1,C3=2,{Z_FINISH:Wb,Z_BLOCK:PL,Z_TREES:gh,Z_OK:Kl,Z_STREAM_END:LL,Z_NEED_DICT:FL,Z_STREAM_ERROR:Ts,Z_DATA_ERROR:D3,Z_MEM_ERROR:O3,Z_BUF_ERROR:$L,Z_DEFLATED:zb}=j3,im=16180,Hb=16181,qb=16182,Yb=16183,Vb=16184,Gb=16185,Kb=16186,Xb=16187,Jb=16188,Zb=16189,w0=16190,Yi=16191,zp=16192,Qb=16193,Hp=16194,ey=16195,ty=16196,ry=16197,ny=16198,xh=16199,vh=16200,ay=16201,sy=16202,iy=16203,oy=16204,ly=16205,qp=16206,cy=16207,dy=16208,qr=16209,P3=16210,L3=16211,RL=852,ML=592,IL=15,BL=IL,uy=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function UL(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const lc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<im||t.mode>L3?1:0},F3=e=>{if(lc(e))return Ts;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=im,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(RL),t.distcode=t.distdyn=new Int32Array(ML),t.sane=1,t.back=-1,Kl},$3=e=>{if(lc(e))return Ts;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,F3(e)},R3=(e,t)=>{let r;if(lc(e))return Ts;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ts:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,$3(e))},M3=(e,t)=>{if(!e)return Ts;const r=new UL;e.state=r,r.strm=e,r.window=null,r.mode=im;const n=R3(e,t);return n!==Kl&&(e.state=null),n},WL=e=>M3(e,BL);let fy=!0,Yp,Vp;const zL=e=>{if(fy){Yp=new Int32Array(512),Vp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(bu(E3,e.lens,0,288,Yp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;bu(C3,e.lens,0,32,Vp,0,e.work,{bits:5}),fy=!1}e.lencode=Yp,e.lenbits=9,e.distcode=Vp,e.distbits=5},I3=(e,t,r,n)=>{let a;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(t.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},HL=(e,t)=>{let r,n,a,s,o,l,c,d,u,h,m,f,x,g,b=0,y,N,S,_,D,I,O,R;const E=new Uint8Array(4);let B,C;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(lc(e)||!e.output||!e.input&&e.avail_in!==0)return Ts;r=e.state,r.mode===Yi&&(r.mode=zp),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,h=l,m=c,R=Kl;e:for(;;)switch(r.mode){case im:if(r.wrap===0){r.mode=zp;break}for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=d&255,E[1]=d>>>8&255,r.check=fi(r.check,E,2,0),d=0,u=0,r.mode=Hb;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=qr;break}if((d&15)!==zb){e.msg="unknown compression method",r.mode=qr;break}if(d>>>=4,u-=4,O=(d&15)+8,r.wbits===0&&(r.wbits=O),O>15||O>r.wbits){e.msg="invalid window size",r.mode=qr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?Zb:Yi,d=0,u=0;break;case Hb:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==zb){e.msg="unknown compression method",r.mode=qr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=qr;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=fi(r.check,E,2,0)),d=0,u=0,r.mode=qb;case qb:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,E[2]=d>>>16&255,E[3]=d>>>24&255,r.check=fi(r.check,E,4,0)),d=0,u=0,r.mode=Yb;case Yb:for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=fi(r.check,E,2,0)),d=0,u=0,r.mode=Vb;case Vb:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=fi(r.check,E,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=Gb;case Gb:if(r.flags&1024&&(f=r.length,f>l&&(f=l),f&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+f),O)),r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,f,s)),l-=f,s+=f,r.length-=f),r.length))break e;r.length=0,r.mode=Kb;case Kb:if(r.flags&2048){if(l===0)break e;f=0;do O=n[s+f++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O));while(O&&f<l);if(r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,f,s)),l-=f,s+=f,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Xb;case Xb:if(r.flags&4096){if(l===0)break e;f=0;do O=n[s+f++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O));while(O&&f<l);if(r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,f,s)),l-=f,s+=f,O)break e}else r.head&&(r.head.comment=null);r.mode=Jb;case Jb:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=qr;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Yi;break;case Zb:for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}e.adler=r.check=uy(d),d=0,u=0,r.mode=w0;case w0:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,FL;e.adler=r.check=1,r.mode=Yi;case Yi:if(t===PL||t===gh)break e;case zp:if(r.last){d>>>=u&7,u-=u&7,r.mode=qp;break}for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=Qb;break;case 1:if(zL(r),r.mode=xh,t===gh){d>>>=2,u-=2;break e}break;case 2:r.mode=ty;break;case 3:e.msg="invalid block type",r.mode=qr}d>>>=2,u-=2;break;case Qb:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=qr;break}if(r.length=d&65535,d=0,u=0,r.mode=Hp,t===gh)break e;case Hp:r.mode=ey;case ey:if(f=r.length,f){if(f>l&&(f=l),f>c&&(f=c),f===0)break e;a.set(n.subarray(s,s+f),o),l-=f,s+=f,c-=f,o+=f,r.length-=f;break}r.mode=Yi;break;case ty:for(;u<14;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=qr;break}r.have=0,r.mode=ry;case ry:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.lens[M[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[M[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},R=bu(OL,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid code lengths set",r.mode=qr;break}r.have=0,r.mode=ny;case ny:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[d&(1<<r.lenbits)-1],y=b>>>24,N=b>>>16&255,S=b&65535,!(y<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(S<16)d>>>=y,u-=y,r.lens[r.have++]=S;else{if(S===16){for(C=y+2;u<C;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(d>>>=y,u-=y,r.have===0){e.msg="invalid bit length repeat",r.mode=qr;break}O=r.lens[r.have-1],f=3+(d&3),d>>>=2,u-=2}else if(S===17){for(C=y+3;u<C;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=y,u-=y,O=0,f=3+(d&7),d>>>=3,u-=3}else{for(C=y+7;u<C;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=y,u-=y,O=0,f=11+(d&127),d>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=qr;break}for(;f--;)r.lens[r.have++]=O}}if(r.mode===qr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=qr;break}if(r.lenbits=9,B={bits:r.lenbits},R=bu(E3,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid literal/lengths set",r.mode=qr;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},R=bu(C3,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,R){e.msg="invalid distances set",r.mode=qr;break}if(r.mode=xh,t===gh)break e;case xh:r.mode=vh;case vh:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,jL(e,m),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===Yi&&(r.back=-1);break}for(r.back=0;b=r.lencode[d&(1<<r.lenbits)-1],y=b>>>24,N=b>>>16&255,S=b&65535,!(y<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(N&&!(N&240)){for(_=y,D=N,I=S;b=r.lencode[I+((d&(1<<_+D)-1)>>_)],y=b>>>24,N=b>>>16&255,S=b&65535,!(_+y<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=_,u-=_,r.back+=_}if(d>>>=y,u-=y,r.back+=y,r.length=S,N===0){r.mode=ly;break}if(N&32){r.back=-1,r.mode=Yi;break}if(N&64){e.msg="invalid literal/length code",r.mode=qr;break}r.extra=N&15,r.mode=ay;case ay:if(r.extra){for(C=r.extra;u<C;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=sy;case sy:for(;b=r.distcode[d&(1<<r.distbits)-1],y=b>>>24,N=b>>>16&255,S=b&65535,!(y<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(!(N&240)){for(_=y,D=N,I=S;b=r.distcode[I+((d&(1<<_+D)-1)>>_)],y=b>>>24,N=b>>>16&255,S=b&65535,!(_+y<=u);){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}d>>>=_,u-=_,r.back+=_}if(d>>>=y,u-=y,r.back+=y,N&64){e.msg="invalid distance code",r.mode=qr;break}r.offset=S,r.extra=N&15,r.mode=iy;case iy:if(r.extra){for(C=r.extra;u<C;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=qr;break}r.mode=oy;case oy:if(c===0)break e;if(f=m-c,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=qr;break}f>r.wnext?(f-=r.wnext,x=r.wsize-f):x=r.wnext-f,f>r.length&&(f=r.length),g=r.window}else g=a,x=o-r.offset,f=r.length;f>c&&(f=c),c-=f,r.length-=f;do a[o++]=g[x++];while(--f);r.length===0&&(r.mode=vh);break;case ly:if(c===0)break e;a[o++]=r.length,c--,r.mode=vh;break;case qp:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[s++]<<u,u+=8}if(m-=c,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?fi(r.check,a,m,o-m):Qg(r.check,a,m,o-m)),m=c,r.wrap&4&&(r.flags?d:uy(d))!==r.check){e.msg="incorrect data check",r.mode=qr;break}d=0,u=0}r.mode=cy;case cy:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[s++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=qr;break}d=0,u=0}r.mode=dy;case dy:R=LL;break e;case qr:R=D3;break e;case P3:return O3;case L3:default:return Ts}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||m!==e.avail_out&&r.mode<qr&&(r.mode<qp||t!==Wb))&&I3(e,e.output,e.next_out,m-e.avail_out),h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?fi(r.check,a,m,e.next_out-m):Qg(r.check,a,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Yi?128:0)+(r.mode===xh||r.mode===Hp?256:0),(h===0&&m===0||t===Wb)&&R===Kl&&(R=$L),R},qL=e=>{if(lc(e))return Ts;let t=e.state;return t.window&&(t.window=null),e.state=null,Kl},YL=(e,t)=>{if(lc(e))return Ts;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Kl):Ts},VL=(e,t)=>{const r=t.length;let n,a,s;return lc(e)||(n=e.state,n.wrap!==0&&n.mode!==w0)?Ts:n.mode===w0&&(a=1,a=Qg(a,t,r,0),a!==n.check)?D3:(s=I3(e,t,r,r),s?(n.mode=P3,O3):(n.havedict=1,Kl))};var GL=$3,KL=R3,XL=F3,JL=WL,ZL=M3,QL=HL,eF=qL,tF=YL,rF=VL,nF="pako inflate (from Nodeca project)",Ji={inflateReset:GL,inflateReset2:KL,inflateResetKeep:XL,inflateInit:JL,inflateInit2:ZL,inflate:QL,inflateEnd:eF,inflateGetHeader:tF,inflateSetDictionary:rF,inflateInfo:nF};function aF(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var sF=aF;const B3=Object.prototype.toString,{Z_NO_FLUSH:iF,Z_FINISH:oF,Z_OK:Lu,Z_STREAM_END:Gp,Z_NEED_DICT:Kp,Z_STREAM_ERROR:lF,Z_DATA_ERROR:hy,Z_MEM_ERROR:cF}=j3;function df(e){this.options=T3.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kL,this.strm.avail_out=0;let r=Ji.inflateInit2(this.strm,t.windowBits);if(r!==Lu)throw new Error(ex[r]);if(this.header=new sF,Ji.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=tx.string2buf(t.dictionary):B3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ji.inflateSetDictionary(this.strm,t.dictionary),r!==Lu)))throw new Error(ex[r])}df.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?oF:iF,B3.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Ji.inflate(r,o),s===Kp&&a&&(s=Ji.inflateSetDictionary(r,a),s===Lu?s=Ji.inflate(r,o):s===hy&&(s=Kp));r.avail_in>0&&s===Gp&&r.state.wrap>0&&e[r.next_in]!==0;)Ji.inflateReset(r),s=Ji.inflate(r,o);switch(s){case lF:case hy:case Kp:case cF:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===Gp))if(this.options.to==="string"){let c=tx.utf8border(r.output,r.next_out),d=r.next_out-c,u=tx.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===Lu&&l===0)){if(s===Gp)return s=Ji.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};df.prototype.onData=function(e){this.chunks.push(e)};df.prototype.onEnd=function(e){e===Lu&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=T3.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function dF(e,t){const r=new df(t);if(r.push(e),r.err)throw r.msg||ex[r.err];return r.result}var uF=df,fF=dF,hF={Inflate:uF,inflate:fF};const{Inflate:mF,inflate:pF}=hF;var my=mF,gF=pF;const U3=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;U3[e]=t}const py=4294967295;function xF(e,t,r){let n=e;for(let a=0;a<r;a++)n=U3[(n^t[a])&255]^n>>>8;return n}function vF(e,t){return(xF(py,e,t)^py)>>>0}function gy(e,t,r){const n=e.readUint32(),a=vF(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function W3(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function z3(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function H3(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function q3(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-a]>>1)&255}else{for(;s<a;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-a]+r[s]>>1)&255}}function Y3(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-a]&255}else{for(;s<a;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+bF(t[s-a],r[s],r[s-a])&255}}function bF(e,t,r){const n=e+t-r,a=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return a<=s&&a<=o?e:s<=o?t:r}function yF(e,t,r,n,a,s){switch(e){case 0:W3(t,r,a);break;case 1:z3(t,r,a,s);break;case 2:H3(t,r,n,a);break;case 3:q3(t,r,n,a,s);break;case 4:Y3(t,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const wF=new Uint16Array([255]),_F=new Uint8Array(wF.buffer),NF=_F[0]===255;function kF(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const h=o[u],m=Math.ceil((r-h.x)/h.xStep),f=Math.ceil((n-h.y)/h.yStep);if(m<=0||f<=0)continue;const x=m*l,g=new Uint8Array(x);for(let b=0;b<f;b++){const y=t[d++],N=t.subarray(d,d+x);d+=x;const S=new Uint8Array(x);yF(y,N,S,g,x,l),g.set(S);for(let _=0;_<m;_++){const D=h.x+_*h.xStep,I=h.y+b*h.yStep;if(!(D>=r||I>=n))for(let O=0;O<l;O++)c[(I*r+D)*l+O]=S[_*l+O]}}}if(s===16){const u=new Uint16Array(c.buffer);if(NF)for(let h=0;h<u.length;h++)u[h]=SF(u[h]);return u}else return c}function SF(e){return(e&255)<<8|e>>8&255}const jF=new Uint16Array([255]),TF=new Uint8Array(jF.buffer),AF=TF[0]===255,EF=new Uint8Array(0);function xy(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let d=EF,u=0,h,m;for(let f=0;f<n;f++){switch(h=t.subarray(u+1,u+1+l),m=c.subarray(f*l,(f+1)*l),t[u]){case 0:W3(h,m,l);break;case 1:z3(h,m,l,o);break;case 2:H3(h,m,d,l);break;case 3:q3(h,m,d,l,o);break;case 4:Y3(h,m,d,l,o);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=m,u+=l+1}if(s===16){const f=new Uint16Array(c.buffer);if(AF)for(let x=0;x<f.length;x++)f[x]=CF(f[x]);return f}else return c}function CF(e){return(e&255)<<8|e>>8&255}const Uh=Uint8Array.of(137,80,78,71,13,10,26,10);function vy(e){if(!DF(e.readBytes(Uh.length)))throw new Error("wrong PNG signature")}function DF(e){if(e.length<Uh.length)return!1;for(let t=0;t<Uh.length;t++)if(e[t]!==Uh[t])return!1;return!0}const OF="tEXt",PF=0,V3=new TextDecoder("latin1");function LF(e){if($F(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const FF=/^[\u0000-\u00FF]*$/;function $F(e){if(!FF.test(e))throw new Error("invalid latin1 text")}function RF(e,t,r){const n=G3(t);e[n]=MF(t,r-n.length-1)}function G3(e){for(e.mark();e.readByte()!==PF;);const t=e.offset;e.reset();const r=V3.decode(e.readBytes(t-e.offset-1));return e.skip(1),LF(r),r}function MF(e,t){return V3.decode(e.readBytes(t))}const Za={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Xp={UNKNOWN:-1,DEFLATE:0},by={UNKNOWN:-1,ADAPTIVE:0},Jp={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},bh={NONE:0,BACKGROUND:1,PREVIOUS:2},Zp={SOURCE:0,OVER:1};class IF extends y1{constructor(r,n={}){super(r);xr(this,"_checkCrc");xr(this,"_inflator");xr(this,"_png");xr(this,"_apng");xr(this,"_end");xr(this,"_hasPalette");xr(this,"_palette");xr(this,"_hasTransparency");xr(this,"_transparency");xr(this,"_compressionMethod");xr(this,"_filterMethod");xr(this,"_interlaceMethod");xr(this,"_colorType");xr(this,"_isAnimated");xr(this,"_numberOfFrames");xr(this,"_numberOfPlays");xr(this,"_frames");xr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new my,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Xp.UNKNOWN,this._filterMethod=by.UNKNOWN,this._interlaceMethod=Jp.UNKNOWN,this._colorType=Za.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(vy(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(vy(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case OF:RF(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?gy(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?gy(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=BF(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Za.GREYSCALE:a=1;break;case Za.TRUECOLOUR:a=3;break;case Za.INDEXED_COLOUR:a=1;break;case Za.GREYSCALE_ALPHA:a=2;break;case Za.TRUECOLOUR_ALPHA:a=4;break;case Za.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Xp.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Za.GREYSCALE:case Za.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Za.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Za.UNKNOWN:case Za.GREYSCALE_ALPHA:case Za.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=G3(this),a=this.readUint8();if(a!==Xp.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:gF(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=xy({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case bh.NONE:break;case bh.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case bh.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case Zp.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case Zp.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=s(o,l);for(let u=0;u<this._png.channels;u++){const h=n.data[d+this._png.channels-1]/a,m=u%(this._png.channels-1)===0?1:n.data[d+u],f=Math.floor(h*m+(1-h)*r.data[c+u]);r.data[c+u]+=f}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==by.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Jp.NO_INTERLACE)this._png.data=xy({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Jp.ADAM7)this._png.data=kF({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:bh.NONE,blendOp:Zp.SOURCE,data:r}),this._inflator=new my,this._writingDataChunks=!1}}function BF(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var yy;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(yy||(yy={}));function UF(e,t){return new IF(e,t).decode()}var Rt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Qp(){Rt.console&&typeof Rt.console.log=="function"&&Rt.console.log.apply(Rt.console,arguments)}var Ar={log:Qp,warn:function(e){Rt.console&&(typeof Rt.console.warn=="function"?Rt.console.warn.apply(Rt.console,arguments):Qp.call(null,arguments))},error:function(e){Rt.console&&(typeof Rt.console.error=="function"?Rt.console.error.apply(Rt.console,arguments):Qp(e))}};function eg(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){El(n.response,t,r)},n.onerror=function(){Ar.error("could not download file")},n.send()}function wy(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function yh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var El=Rt.saveAs||((typeof window>"u"?"undefined":Qt(window))!=="object"||window!==Rt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Rt.URL||Rt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?wy(a.href)?eg(e,t,r):yh(a,a.target="_blank"):yh(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){yh(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(wy(e))eg(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){yh(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:Qt(s)!=="object"&&(Ar.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return eg(e,t,r);var a=e.type==="application/octet-stream",s=/constructor/i.test(Rt.HTMLElement)||Rt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":Qt(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=Rt.URL||Rt.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function K3(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var Wh=Rt.atob.bind(Rt),_y=Rt.btoa.bind(Rt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function tg(e,t){var r=e[0],n=e[1],a=e[2],s=e[3];r=aa(r,n,a,s,t[0],7,-680876936),s=aa(s,r,n,a,t[1],12,-389564586),a=aa(a,s,r,n,t[2],17,606105819),n=aa(n,a,s,r,t[3],22,-1044525330),r=aa(r,n,a,s,t[4],7,-176418897),s=aa(s,r,n,a,t[5],12,1200080426),a=aa(a,s,r,n,t[6],17,-1473231341),n=aa(n,a,s,r,t[7],22,-45705983),r=aa(r,n,a,s,t[8],7,1770035416),s=aa(s,r,n,a,t[9],12,-1958414417),a=aa(a,s,r,n,t[10],17,-42063),n=aa(n,a,s,r,t[11],22,-1990404162),r=aa(r,n,a,s,t[12],7,1804603682),s=aa(s,r,n,a,t[13],12,-40341101),a=aa(a,s,r,n,t[14],17,-1502002290),r=sa(r,n=aa(n,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=sa(s,r,n,a,t[6],9,-1069501632),a=sa(a,s,r,n,t[11],14,643717713),n=sa(n,a,s,r,t[0],20,-373897302),r=sa(r,n,a,s,t[5],5,-701558691),s=sa(s,r,n,a,t[10],9,38016083),a=sa(a,s,r,n,t[15],14,-660478335),n=sa(n,a,s,r,t[4],20,-405537848),r=sa(r,n,a,s,t[9],5,568446438),s=sa(s,r,n,a,t[14],9,-1019803690),a=sa(a,s,r,n,t[3],14,-187363961),n=sa(n,a,s,r,t[8],20,1163531501),r=sa(r,n,a,s,t[13],5,-1444681467),s=sa(s,r,n,a,t[2],9,-51403784),a=sa(a,s,r,n,t[7],14,1735328473),r=ia(r,n=sa(n,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=ia(s,r,n,a,t[8],11,-2022574463),a=ia(a,s,r,n,t[11],16,1839030562),n=ia(n,a,s,r,t[14],23,-35309556),r=ia(r,n,a,s,t[1],4,-1530992060),s=ia(s,r,n,a,t[4],11,1272893353),a=ia(a,s,r,n,t[7],16,-155497632),n=ia(n,a,s,r,t[10],23,-1094730640),r=ia(r,n,a,s,t[13],4,681279174),s=ia(s,r,n,a,t[0],11,-358537222),a=ia(a,s,r,n,t[3],16,-722521979),n=ia(n,a,s,r,t[6],23,76029189),r=ia(r,n,a,s,t[9],4,-640364487),s=ia(s,r,n,a,t[12],11,-421815835),a=ia(a,s,r,n,t[15],16,530742520),r=oa(r,n=ia(n,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=oa(s,r,n,a,t[7],10,1126891415),a=oa(a,s,r,n,t[14],15,-1416354905),n=oa(n,a,s,r,t[5],21,-57434055),r=oa(r,n,a,s,t[12],6,1700485571),s=oa(s,r,n,a,t[3],10,-1894986606),a=oa(a,s,r,n,t[10],15,-1051523),n=oa(n,a,s,r,t[1],21,-2054922799),r=oa(r,n,a,s,t[8],6,1873313359),s=oa(s,r,n,a,t[15],10,-30611744),a=oa(a,s,r,n,t[6],15,-1560198380),n=oa(n,a,s,r,t[13],21,1309151649),r=oa(r,n,a,s,t[4],6,-145523070),s=oa(s,r,n,a,t[11],10,-1120210379),a=oa(a,s,r,n,t[2],15,718787259),n=oa(n,a,s,r,t[9],21,-343485551),e[0]=Wo(r,e[0]),e[1]=Wo(n,e[1]),e[2]=Wo(a,e[2]),e[3]=Wo(s,e[3])}function om(e,t,r,n,a,s){return t=Wo(Wo(t,e),Wo(n,s)),Wo(t<<a|t>>>32-a,r)}function aa(e,t,r,n,a,s,o){return om(t&r|~t&n,e,t,a,s,o)}function sa(e,t,r,n,a,s,o){return om(t&n|r&~n,e,t,a,s,o)}function ia(e,t,r,n,a,s,o){return om(t^r^n,e,t,a,s,o)}function oa(e,t,r,n,a,s,o){return om(r^(t|~n),e,t,a,s,o)}function X3(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)tg(n,WF(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(tg(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,tg(n,a),n}function WF(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var Ny="0123456789abcdef".split("");function zF(e){for(var t="",r=0;r<4;r++)t+=Ny[e>>8*r+4&15]+Ny[e>>8*r&15];return t}function HF(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function rx(e){return X3(e).map(HF).join("")}var qF=function(e){for(var t=0;t<e.length;t++)e[t]=zF(e[t]);return e.join("")}(X3("hello"))!="5d41402abc4b2a76b9719d911017c592";function Wo(e,t){if(qF){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function nx(e,t){var r,n,a,s;if(e!==r){for(var o=(a=e,s=1+(256/e.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var h=t.length,m=0,f=0,x="";for(c=0;c<h;c++)f=(f+(u=l[m=(m+1)%256]))%256,l[m]=l[f],l[f]=u,o=l[(l[m]+l[f])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ky={print:4,modify:8,copy:16,"annot-forms":32};function Dc(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(ky.perm!==void 0)throw new Error("Invalid permission: "+l);a+=ky[l]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=rx(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=nx(this.encryptionKey,this.padding)}function Oc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function Sy(e){if(Qt(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Rt.console&&Ar.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function _0(e){if(!(this instanceof _0))return new _0(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function J3(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Ol(e,t,r,n,a){if(!(this instanceof Ol))return new Ol(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,J3.call(this,n,a)}function $c(e,t,r,n,a){if(!(this instanceof $c))return new $c(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,J3.call(this,n,a)}function Ct(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,d="S",u=null;Qt(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,m={},f={internal:{},__private__:{}};f.__private__.PubSub=Sy;var x="1.3",g=f.__private__.getPdfVersion=function(){return x};f.__private__.setPdfVersion=function(k){x=k};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return b};var y=f.__private__.getPageFormat=function(k){return b[k]};a=a||"a4";var N="compat",S="advanced",_=N;function D(){this.saveGraphicsState(),Y(new Lt(pt,0,0,-pt,0,pl()*pt).toString()+" cm"),this.setFontSize(this.getFontSize()/pt),d="n",_=S}function I(){this.restoreGraphicsState(),d="S",_=N}var O=f.__private__.combineFontStyleAndFontWeight=function(k,W){if(k=="bold"&&W=="normal"||k=="bold"&&W==400||k=="normal"&&W=="italic"||k=="bold"&&W=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return W&&(k=W==400||W==="normal"?k==="italic"?"italic":"normal":W!=700&&W!=="bold"||k!=="normal"?(W==700?"bold":W)+""+k:"bold"),k};f.advancedAPI=function(k){var W=_===N;return W&&D.call(this),typeof k!="function"||(k(this),W&&I.call(this)),this},f.compatAPI=function(k){var W=_===S;return W&&I.call(this),typeof k!="function"||(k(this),W&&D.call(this)),this},f.isAdvancedAPI=function(){return _===S};var R,E=function(k){if(_!==S)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=f.roundToPrecision=f.__private__.roundToPrecision=function(k,W){var he=t||W;if(isNaN(k)||isNaN(he))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(he).replace(/0+$/,"")};R=f.hpf=f.__private__.hpf=typeof c=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return B(k,c)}:c==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return B(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return B(k,16)};var C=f.f2=f.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return B(k,2)},M=f.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return B(k,3)},U=f.scale=f.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return _===N?k*pt:_===S?k:void 0},F=function(k){return U(function(W){return _===N?pl()-W:_===S?W:void 0}(k))};f.__private__.setPrecision=f.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var ne,V="00000000000000000000000000000000",ee=f.__private__.getFileId=function(){return V},me=f.__private__.setFileId=function(k){return V=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(sn=new Dc(u.userPermissions,u.userPassword,u.ownerPassword,V)),V};f.setFileId=function(k){return me(k),this},f.getFileId=function(){return ee()};var ye=f.__private__.convertDateToPDFDate=function(k){var W=k.getTimezoneOffset(),he=W<0?"+":"-",be=Math.floor(Math.abs(W/60)),Ee=Math.abs(W%60),Ke=[he,T(be),"'",T(Ee),"'"].join("");return["D:",k.getFullYear(),T(k.getMonth()+1),T(k.getDate()),T(k.getHours()),T(k.getMinutes()),T(k.getSeconds()),Ke].join("")},Oe=f.__private__.convertPDFDateToDate=function(k){var W=parseInt(k.substr(2,4),10),he=parseInt(k.substr(6,2),10)-1,be=parseInt(k.substr(8,2),10),Ee=parseInt(k.substr(10,2),10),Ke=parseInt(k.substr(12,2),10),st=parseInt(k.substr(14,2),10);return new Date(W,he,be,Ee,Ke,st,0)},xe=f.__private__.setCreationDate=function(k){var W;if(k===void 0&&(k=new Date),k instanceof Date)W=ye(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");W=k}return ne=W},w=f.__private__.getCreationDate=function(k){var W=ne;return k==="jsDate"&&(W=Oe(ne)),W};f.setCreationDate=function(k){return xe(k),this},f.getCreationDate=function(k){return w(k)};var A,T=f.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},L=f.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},H=0,X=[],re=[],ge=0,oe=[],je=[],Ie=!1,et=re;f.__private__.setCustomOutputDestination=function(k){Ie=!0,et=k};var Te=function(k){Ie||(et=k)};f.__private__.resetCustomOutputDestination=function(){Ie=!1,et=re};var Y=f.__private__.out=function(k){return k=k.toString(),ge+=k.length+1,et.push(k),et},We=f.__private__.write=function(k){return Y(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},Q=f.__private__.getArrayBuffer=function(k){for(var W=k.length,he=new ArrayBuffer(W),be=new Uint8Array(he);W--;)be[W]=k.charCodeAt(W);return he},ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ve};var we=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(k){return we=_===S?k/pt:k,this};var Re,He=f.__private__.getFontSize=f.getFontSize=function(){return _===N?we:we*pt},vt=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(k){return vt=k,this},f.__private__.getR2L=f.getR2L=function(){return vt};var le,Ae=f.__private__.setZoomMode=function(k){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))Re=k;else if(isNaN(k)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');Re=k}else Re=parseInt(k,10)};f.__private__.getZoomMode=function(){return Re};var Qe,_e=f.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');le=k};f.__private__.getPageMode=function(){return le};var Ze=f.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Qe=k};f.__private__.getLayoutMode=function(){return Qe},f.__private__.setDisplayMode=f.setDisplayMode=function(k,W,he){return Ae(k),Ze(W),_e(he),this};var Ve={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(k){if(Object.keys(Ve).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ve[k]},f.__private__.getDocumentProperties=function(){return Ve},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(k){for(var W in Ve)Ve.hasOwnProperty(W)&&k[W]&&(Ve[W]=k[W]);return this},f.__private__.setDocumentProperty=function(k,W){if(Object.keys(Ve).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ve[k]=W};var ot,pt,yt,ir,ct,ut={},Ot={},zt=[],Dt={},Xt={},$t={},_r={},Fr=null,ur=0,Ft=[],nr=new Sy(f),Rs=e.hotfixes||[],an={},Zn={},ka=[],Lt=function k(W,he,be,Ee,Ke,st){if(!(this instanceof k))return new k(W,he,be,Ee,Ke,st);isNaN(W)&&(W=1),isNaN(he)&&(he=0),isNaN(be)&&(be=0),isNaN(Ee)&&(Ee=1),isNaN(Ke)&&(Ke=0),isNaN(st)&&(st=0),this._matrix=[W,he,be,Ee,Ke,st]};Object.defineProperty(Lt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Lt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Lt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Lt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Lt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Lt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Lt.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Lt.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Lt.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Lt.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Lt.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Lt.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Lt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Lt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Lt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Lt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Lt.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(k)},Lt.prototype.multiply=function(k){var W=k.sx*this.sx+k.shy*this.shx,he=k.sx*this.shy+k.shy*this.sy,be=k.shx*this.sx+k.sy*this.shx,Ee=k.shx*this.shy+k.sy*this.sy,Ke=k.tx*this.sx+k.ty*this.shx+this.tx,st=k.tx*this.shy+k.ty*this.sy+this.ty;return new Lt(W,he,be,Ee,Ke,st)},Lt.prototype.decompose=function(){var k=this.sx,W=this.shy,he=this.shx,be=this.sy,Ee=this.tx,Ke=this.ty,st=Math.sqrt(k*k+W*W),St=(k/=st)*he+(W/=st)*be;he-=k*St,be-=W*St;var At=Math.sqrt(he*he+be*be);return St/=At,k*(be/=At)<W*(he/=At)&&(k=-k,W=-W,St=-St,st=-st),{scale:new Lt(st,0,0,At,0,0),translate:new Lt(1,0,0,1,Ee,Ke),rotate:new Lt(k,W,-W,k,0,0),skew:new Lt(1,0,St,1,0,0)}},Lt.prototype.toString=function(k){return this.join(" ")},Lt.prototype.inversed=function(){var k=this.sx,W=this.shy,he=this.shx,be=this.sy,Ee=this.tx,Ke=this.ty,st=1/(k*be-W*he),St=be*st,At=-W*st,Mt=-he*st,Ut=k*st;return new Lt(St,At,Mt,Ut,-St*Ee-Mt*Ke,-At*Ee-Ut*Ke)},Lt.prototype.applyToPoint=function(k){var W=k.x*this.sx+k.y*this.shx+this.tx,he=k.x*this.shy+k.y*this.sy+this.ty;return new hl(W,he)},Lt.prototype.applyToRectangle=function(k){var W=this.applyToPoint(k),he=this.applyToPoint(new hl(k.x+k.w,k.y+k.h));return new Fd(W.x,W.y,he.x-W.x,he.y-W.y)},Lt.prototype.clone=function(){var k=this.sx,W=this.shy,he=this.shx,be=this.sy,Ee=this.tx,Ke=this.ty;return new Lt(k,W,he,be,Ee,Ke)},f.Matrix=Lt;var Ua=f.matrixMult=function(k,W){return W.multiply(k)},Wa=new Lt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Wa;var Pn=function(k,W){if(!Xt[k]){var he=(W instanceof Ol?"Sh":"P")+(Object.keys(Dt).length+1).toString(10);W.id=he,Xt[k]=he,Dt[he]=W,nr.publish("addPattern",W)}};f.ShadingPattern=Ol,f.TilingPattern=$c,f.addShadingPattern=function(k,W){return E("addShadingPattern()"),Pn(k,W),this},f.beginTilingPattern=function(k){E("beginTilingPattern()"),$d(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},f.endTilingPattern=function(k,W){E("endTilingPattern()"),W.stream=je[A].join(`
`),Pn(k,W),nr.publish("endTilingPattern",W),ka.pop().restore()};var Qn,Cr=f.__private__.newObject=function(){var k=Gr();return q(k,!0),k},Gr=f.__private__.newObjectDeferred=function(){return H++,X[H]=function(){return ge},H},q=function(k,W){return W=typeof W=="boolean"&&W,X[k]=ge,W&&Y(k+" 0 obj"),k},ce=f.__private__.newAdditionalObject=function(){var k={objId:Gr(),content:""};return oe.push(k),k},ae=Gr(),ie=Gr(),de=f.__private__.decodeColorString=function(k){var W=k.split(" ");if(W.length!==2||W[1]!=="g"&&W[1]!=="G")W.length!==5||W[4]!=="k"&&W[4]!=="K"||(W=[(1-W[0])*(1-W[3]),(1-W[1])*(1-W[3]),(1-W[2])*(1-W[3]),"r"]);else{var he=parseFloat(W[0]);W=[he,he,he,"r"]}for(var be="#",Ee=0;Ee<3;Ee++)be+=("0"+Math.floor(255*parseFloat(W[Ee])).toString(16)).slice(-2);return be},pe=f.__private__.encodeColorString=function(k){var W;typeof k=="string"&&(k={ch1:k});var he=k.ch1,be=k.ch2,Ee=k.ch3,Ke=k.ch4,st=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof he=="string"&&he.charAt(0)!=="#"){var St=new K3(he);if(St.ok)he=St.toHex();else if(!/^\d*\.?\d*$/.test(he))throw new Error('Invalid color "'+he+'" passed to jsPDF.encodeColorString.')}if(typeof he=="string"&&/^#[0-9A-Fa-f]{3}$/.test(he)&&(he="#"+he[1]+he[1]+he[2]+he[2]+he[3]+he[3]),typeof he=="string"&&/^#[0-9A-Fa-f]{6}$/.test(he)){var At=parseInt(he.substr(1),16);he=At>>16&255,be=At>>8&255,Ee=255&At}if(be===void 0||Ke===void 0&&he===be&&be===Ee)W=typeof he=="string"?he+" "+st[0]:k.precision===2?C(he/255)+" "+st[0]:M(he/255)+" "+st[0];else if(Ke===void 0||Qt(Ke)==="object"){if(Ke&&!isNaN(Ke.a)&&Ke.a===0)return["1.","1.","1.",st[1]].join(" ");W=typeof he=="string"?[he,be,Ee,st[1]].join(" "):k.precision===2?[C(he/255),C(be/255),C(Ee/255),st[1]].join(" "):[M(he/255),M(be/255),M(Ee/255),st[1]].join(" ")}else W=typeof he=="string"?[he,be,Ee,Ke,st[2]].join(" "):k.precision===2?[C(he),C(be),C(Ee),C(Ke),st[2]].join(" "):[M(he),M(be),M(Ee),M(Ke),st[2]].join(" ");return W},Pe=f.__private__.getFilters=function(){return o},ze=f.__private__.putStream=function(k){var W=(k=k||{}).data||"",he=k.filters||Pe(),be=k.alreadyAppliedFilters||[],Ee=k.addLength1||!1,Ke=W.length,st=k.objectId,St=function(Nn){return Nn};if(u!==null&&st===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(St=sn.encryptor(st,0));var At={};he===!0&&(he=["FlateEncode"]);var Mt=k.additionalKeyValues||[],Ut=(At=Ct.API.processDataByFilters!==void 0?Ct.API.processDataByFilters(W,he):{data:W,reverseChain:[]}).reverseChain+(Array.isArray(be)?be.join(" "):be.toString());if(At.data.length!==0&&(Mt.push({key:"Length",value:At.data.length}),Ee===!0&&Mt.push({key:"Length1",value:Ke})),Ut.length!=0)if(Ut.split("/").length-1==1)Mt.push({key:"Filter",value:Ut});else{Mt.push({key:"Filter",value:"["+Ut+"]"});for(var fr=0;fr<Mt.length;fr+=1)if(Mt[fr].key==="DecodeParms"){for(var Vr=[],xn=0;xn<At.reverseChain.split("/").length-1;xn+=1)Vr.push("null");Vr.push(Mt[fr].value),Mt[fr].value="["+Vr.join(" ")+"]"}}Y("<<");for(var Dr=0;Dr<Mt.length;Dr++)Y("/"+Mt[Dr].key+" "+Mt[Dr].value);Y(">>"),At.data.length!==0&&(Y("stream"),Y(St(At.data)),Y("endstream"))},Le=f.__private__.putPage=function(k){var W=k.number,he=k.data,be=k.objId,Ee=k.contentsObjId;q(be,!0),Y("<</Type /Page"),Y("/Parent "+k.rootDictionaryObjId+" 0 R"),Y("/Resources "+k.resourceDictionaryObjId+" 0 R"),Y("/MediaBox ["+parseFloat(R(k.mediaBox.bottomLeftX))+" "+parseFloat(R(k.mediaBox.bottomLeftY))+" "+R(k.mediaBox.topRightX)+" "+R(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&Y("/CropBox ["+R(k.cropBox.bottomLeftX)+" "+R(k.cropBox.bottomLeftY)+" "+R(k.cropBox.topRightX)+" "+R(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&Y("/BleedBox ["+R(k.bleedBox.bottomLeftX)+" "+R(k.bleedBox.bottomLeftY)+" "+R(k.bleedBox.topRightX)+" "+R(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&Y("/TrimBox ["+R(k.trimBox.bottomLeftX)+" "+R(k.trimBox.bottomLeftY)+" "+R(k.trimBox.topRightX)+" "+R(k.trimBox.topRightY)+"]"),k.artBox!==null&&Y("/ArtBox ["+R(k.artBox.bottomLeftX)+" "+R(k.artBox.bottomLeftY)+" "+R(k.artBox.topRightX)+" "+R(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&Y("/UserUnit "+k.userUnit),nr.publish("putPage",{objId:be,pageContext:Ft[W],pageNumber:W,page:he}),Y("/Contents "+Ee+" 0 R"),Y(">>"),Y("endobj");var Ke=he.join(`
`);return _===S&&(Ke+=`
Q`),q(Ee,!0),ze({data:Ke,filters:Pe(),objectId:Ee}),Y("endobj"),be},Fe=f.__private__.putPages=function(){var k,W,he=[];for(k=1;k<=ur;k++)Ft[k].objId=Gr(),Ft[k].contentsObjId=Gr();for(k=1;k<=ur;k++)he.push(Le({number:k,data:je[k],objId:Ft[k].objId,contentsObjId:Ft[k].contentsObjId,mediaBox:Ft[k].mediaBox,cropBox:Ft[k].cropBox,bleedBox:Ft[k].bleedBox,trimBox:Ft[k].trimBox,artBox:Ft[k].artBox,userUnit:Ft[k].userUnit,rootDictionaryObjId:ae,resourceDictionaryObjId:ie}));q(ae,!0),Y("<</Type /Pages");var be="/Kids [";for(W=0;W<ur;W++)be+=he[W]+" 0 R ";Y(be+"]"),Y("/Count "+ur),Y(">>"),Y("endobj"),nr.publish("postPutPages")},G=function(k){nr.publish("putFont",{font:k,out:Y,newObject:Cr,putStream:ze}),k.isAlreadyPutted!==!0&&(k.objectNumber=Cr(),Y("<<"),Y("/Type /Font"),Y("/BaseFont /"+Oc(k.postScriptName)),Y("/Subtype /Type1"),typeof k.encoding=="string"&&Y("/Encoding /"+k.encoding),Y("/FirstChar 32"),Y("/LastChar 255"),Y(">>"),Y("endobj"))},ke=function(k){k.objectNumber=Cr();var W=[];W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Form"}),W.push({key:"BBox",value:"["+[R(k.x),R(k.y),R(k.x+k.width),R(k.y+k.height)].join(" ")+"]"}),W.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var he=k.pages[1].join(`
`);ze({data:he,additionalKeyValues:W,objectId:k.objectNumber}),Y("endobj")},Be=function(k,W){W||(W=21);var he=Cr(),be=function(st,St){var At,Mt=[],Ut=1/(St-1);for(At=0;At<1;At+=Ut)Mt.push(At);if(Mt.push(1),st[0].offset!=0){var fr={offset:0,color:st[0].color};st.unshift(fr)}if(st[st.length-1].offset!=1){var Vr={offset:1,color:st[st.length-1].color};st.push(Vr)}for(var xn="",Dr=0,Nn=0;Nn<Mt.length;Nn++){for(At=Mt[Nn];At>st[Dr+1].offset;)Dr++;var vn=st[Dr].offset,In=(At-vn)/(st[Dr+1].offset-vn),ds=st[Dr].color,Sa=st[Dr+1].color;xn+=L(Math.round((1-In)*ds[0]+In*Sa[0]).toString(16))+L(Math.round((1-In)*ds[1]+In*Sa[1]).toString(16))+L(Math.round((1-In)*ds[2]+In*Sa[2]).toString(16))}return xn.trim()}(k.colors,W),Ee=[];Ee.push({key:"FunctionType",value:"0"}),Ee.push({key:"Domain",value:"[0.0 1.0]"}),Ee.push({key:"Size",value:"["+W+"]"}),Ee.push({key:"BitsPerSample",value:"8"}),Ee.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze({data:be,additionalKeyValues:Ee,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:he}),Y("endobj"),k.objectNumber=Cr(),Y("<< /ShadingType "+k.type),Y("/ColorSpace /DeviceRGB");var Ke="/Coords ["+R(parseFloat(k.coords[0]))+" "+R(parseFloat(k.coords[1]))+" ";k.type===2?Ke+=R(parseFloat(k.coords[2]))+" "+R(parseFloat(k.coords[3])):Ke+=R(parseFloat(k.coords[2]))+" "+R(parseFloat(k.coords[3]))+" "+R(parseFloat(k.coords[4]))+" "+R(parseFloat(k.coords[5])),Y(Ke+="]"),k.matrix&&Y("/Matrix ["+k.matrix.toString()+"]"),Y("/Function "+he+" 0 R"),Y("/Extend [true true]"),Y(">>"),Y("endobj")},tt=function(k,W){var he=Gr(),be=Cr();W.push({resourcesOid:he,objectOid:be}),k.objectNumber=be;var Ee=[];Ee.push({key:"Type",value:"/Pattern"}),Ee.push({key:"PatternType",value:"1"}),Ee.push({key:"PaintType",value:"1"}),Ee.push({key:"TilingType",value:"1"}),Ee.push({key:"BBox",value:"["+k.boundingBox.map(R).join(" ")+"]"}),Ee.push({key:"XStep",value:R(k.xStep)}),Ee.push({key:"YStep",value:R(k.yStep)}),Ee.push({key:"Resources",value:he+" 0 R"}),k.matrix&&Ee.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),ze({data:k.stream,additionalKeyValues:Ee,objectId:k.objectNumber}),Y("endobj")},Xe=function(k){for(var W in k.objectNumber=Cr(),Y("<<"),k)switch(W){case"opacity":Y("/ca "+C(k[W]));break;case"stroke-opacity":Y("/CA "+C(k[W]))}Y(">>"),Y("endobj")},rt=function(k){q(k.resourcesOid,!0),Y("<<"),Y("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var W in Y("/Font <<"),ut)ut.hasOwnProperty(W)&&(h===!1||h===!0&&m.hasOwnProperty(W))&&Y("/"+W+" "+ut[W].objectNumber+" 0 R");Y(">>")}(),function(){if(Object.keys(Dt).length>0){for(var W in Y("/Shading <<"),Dt)Dt.hasOwnProperty(W)&&Dt[W]instanceof Ol&&Dt[W].objectNumber>=0&&Y("/"+W+" "+Dt[W].objectNumber+" 0 R");nr.publish("putShadingPatternDict"),Y(">>")}}(),function(W){if(Object.keys(Dt).length>0){for(var he in Y("/Pattern <<"),Dt)Dt.hasOwnProperty(he)&&Dt[he]instanceof f.TilingPattern&&Dt[he].objectNumber>=0&&Dt[he].objectNumber<W&&Y("/"+he+" "+Dt[he].objectNumber+" 0 R");nr.publish("putTilingPatternDict"),Y(">>")}}(k.objectOid),function(){if(Object.keys($t).length>0){var W;for(W in Y("/ExtGState <<"),$t)$t.hasOwnProperty(W)&&$t[W].objectNumber>=0&&Y("/"+W+" "+$t[W].objectNumber+" 0 R");nr.publish("putGStateDict"),Y(">>")}}(),function(){for(var W in Y("/XObject <<"),an)an.hasOwnProperty(W)&&an[W].objectNumber>=0&&Y("/"+W+" "+an[W].objectNumber+" 0 R");nr.publish("putXobjectDict"),Y(">>")}(),Y(">>"),Y("endobj")},Nt=function(k){Ot[k.fontName]=Ot[k.fontName]||{},Ot[k.fontName][k.fontStyle]=k.id},Zt=function(k,W,he,be,Ee){var Ke={id:"F"+(Object.keys(ut).length+1).toString(10),postScriptName:k,fontName:W,fontStyle:he,encoding:be,isStandardFont:Ee||!1,metadata:{}};return nr.publish("addFont",{font:Ke,instance:this}),ut[Ke.id]=Ke,Nt(Ke),Ke.id},Ht=f.__private__.pdfEscape=f.pdfEscape=function(k,W){return function(he,be){var Ee,Ke,st,St,At,Mt,Ut,fr,Vr;if(st=(be=be||{}).sourceEncoding||"Unicode",At=be.outputEncoding,(be.autoencode||At)&&ut[ot].metadata&&ut[ot].metadata[st]&&ut[ot].metadata[st].encoding&&(St=ut[ot].metadata[st].encoding,!At&&ut[ot].encoding&&(At=ut[ot].encoding),!At&&St.codePages&&(At=St.codePages[0]),typeof At=="string"&&(At=St[At]),At)){for(Ut=!1,Mt=[],Ee=0,Ke=he.length;Ee<Ke;Ee++)(fr=At[he.charCodeAt(Ee)])?Mt.push(String.fromCharCode(fr)):Mt.push(he[Ee]),Mt[Ee].charCodeAt(0)>>8&&(Ut=!0);he=Mt.join("")}for(Ee=he.length;Ut===void 0&&Ee!==0;)he.charCodeAt(Ee-1)>>8&&(Ut=!0),Ee--;if(!Ut)return he;for(Mt=be.noBOM?[]:[254,255],Ee=0,Ke=he.length;Ee<Ke;Ee++){if((Vr=(fr=he.charCodeAt(Ee))>>8)>>8)throw new Error("Character at position "+Ee+" of string '"+he+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Mt.push(Vr),Mt.push(fr-(Vr<<8))}return String.fromCharCode.apply(void 0,Mt)}(k,W).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$r=f.__private__.beginPage=function(k){je[++ur]=[],Ft[ur]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},ii(ur),Te(je[A])},za=function(k,W){var he,be,Ee;switch(r=W||r,typeof k=="string"&&(he=y(k.toLowerCase()),Array.isArray(he)&&(be=he[0],Ee=he[1])),Array.isArray(k)&&(be=k[0]*pt,Ee=k[1]*pt),isNaN(be)&&(be=a[0],Ee=a[1]),(be>14400||Ee>14400)&&(Ar.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),be=Math.min(14400,be),Ee=Math.min(14400,Ee)),a=[be,Ee],r.substr(0,1)){case"l":Ee>be&&(a=[Ee,be]);break;case"p":be>Ee&&(a=[Ee,be])}$r(a),Xm(Dd),Y(fc),Pd!==0&&Y(Pd+" J"),Ld!==0&&Y(Ld+" j"),nr.publish("addPage",{pageNumber:ur})},Ms=function(k){k>0&&k<=ur&&(je.splice(k,1),Ft.splice(k,1),ur--,A>ur&&(A=ur),this.setPage(A))},ii=function(k){k>0&&k<=ur&&(A=k)},cs=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return je.length-1},vo=function(k,W,he){var be,Ee=void 0;return he=he||{},k=k!==void 0?k:ut[ot].fontName,W=W!==void 0?W:ut[ot].fontStyle,be=k.toLowerCase(),Ot[be]!==void 0&&Ot[be][W]!==void 0?Ee=Ot[be][W]:Ot[k]!==void 0&&Ot[k][W]!==void 0?Ee=Ot[k][W]:he.disableWarning===!1&&Ar.warn("Unable to look up font label for font '"+k+"', '"+W+"'. Refer to getFontList() for available fonts."),Ee||he.noFallback||(Ee=Ot.times[W])==null&&(Ee=Ot.times.normal),Ee},ea=f.__private__.putInfo=function(){var k=Cr(),W=function(be){return be};for(var he in u!==null&&(W=sn.encryptor(k,0)),Y("<<"),Y("/Producer ("+Ht(W("jsPDF "+Ct.version))+")"),Ve)Ve.hasOwnProperty(he)&&Ve[he]&&Y("/"+he.substr(0,1).toUpperCase()+he.substr(1)+" ("+Ht(W(Ve[he]))+")");Y("/CreationDate ("+Ht(W(ne))+")"),Y(">>"),Y("endobj")},Wm=f.__private__.putCatalog=function(k){var W=(k=k||{}).rootDictionaryObjId||ae;switch(Cr(),Y("<<"),Y("/Type /Catalog"),Y("/Pages "+W+" 0 R"),Re||(Re="fullwidth"),Re){case"fullwidth":Y("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Y("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Y("/OpenAction [3 0 R /Fit]");break;case"original":Y("/OpenAction [3 0 R /XYZ null null 1]");break;default:var he=""+Re;he.substr(he.length-1)==="%"&&(Re=parseInt(Re)/100),typeof Re=="number"&&Y("/OpenAction [3 0 R /XYZ null null "+C(Re)+"]")}switch(Qe||(Qe="continuous"),Qe){case"continuous":Y("/PageLayout /OneColumn");break;case"single":Y("/PageLayout /SinglePage");break;case"two":case"twoleft":Y("/PageLayout /TwoColumnLeft");break;case"tworight":Y("/PageLayout /TwoColumnRight")}le&&Y("/PageMode /"+le),nr.publish("putCatalog"),Y(">>"),Y("endobj")},gn=f.__private__.putTrailer=function(){Y("trailer"),Y("<<"),Y("/Size "+(H+1)),Y("/Root "+H+" 0 R"),Y("/Info "+(H-1)+" 0 R"),u!==null&&Y("/Encrypt "+sn.oid+" 0 R"),Y("/ID [ <"+V+"> <"+V+"> ]"),Y(">>")},Af=f.__private__.putHeader=function(){Y("%PDF-"+x),Y("%ÂºÃŸÂ¬Ã ")},Ef=f.__private__.putXRef=function(){var k="0000000000";Y("xref"),Y("0 "+(H+1)),Y("0000000000 65535 f ");for(var W=1;W<=H;W++)typeof X[W]=="function"?Y((k+X[W]()).slice(-10)+" 00000 n "):X[W]!==void 0?Y((k+X[W]).slice(-10)+" 00000 n "):Y("0000000000 00000 n ")},Li=f.__private__.buildDocument=function(){var k;H=0,ge=0,re=[],X=[],oe=[],ae=Gr(),ie=Gr(),Te(re),nr.publish("buildDocument"),Af(),Fe(),function(){nr.publish("putAdditionalObjects");for(var he=0;he<oe.length;he++){var be=oe[he];q(be.objId,!0),Y(be.content),Y("endobj")}nr.publish("postPutAdditionalObjects")}(),k=[],function(){for(var he in ut)ut.hasOwnProperty(he)&&(h===!1||h===!0&&m.hasOwnProperty(he))&&G(ut[he])}(),function(){var he;for(he in $t)$t.hasOwnProperty(he)&&Xe($t[he])}(),function(){for(var he in an)an.hasOwnProperty(he)&&ke(an[he])}(),function(he){var be;for(be in Dt)Dt.hasOwnProperty(be)&&(Dt[be]instanceof Ol?Be(Dt[be]):Dt[be]instanceof $c&&tt(Dt[be],he))}(k),nr.publish("putResources"),k.forEach(rt),rt({resourcesOid:ie,objectOid:Number.MAX_SAFE_INTEGER}),nr.publish("postPutResources"),u!==null&&(sn.oid=Cr(),Y("<<"),Y("/Filter /Standard"),Y("/V "+sn.v),Y("/R "+sn.r),Y("/U <"+sn.toHexString(sn.U)+">"),Y("/O <"+sn.toHexString(sn.O)+">"),Y("/P "+sn.P),Y(">>"),Y("endobj")),ea(),Wm();var W=ge;return Ef(),gn(),Y("startxref"),Y(""+W),Y("%%EOF"),Te(je[A]),re.join(`
`)},ol=f.__private__.getBlob=function(k){return new Blob([Q(k)],{type:"application/pdf"})},Is=f.output=f.__private__.output=(Qn=function(k,W){switch(typeof(W=W||{})=="string"?W={filename:W}:W.filename=W.filename||"generated.pdf",k){case void 0:return Li();case"save":f.save(W.filename);break;case"arraybuffer":return Q(Li());case"blob":return ol(Li());case"bloburi":case"bloburl":if(Rt.URL!==void 0&&typeof Rt.URL.createObjectURL=="function")return Rt.URL&&Rt.URL.createObjectURL(ol(Li()))||void 0;Ar.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var he="",be=Li();try{he=_y(be)}catch{he=_y(unescape(encodeURIComponent(be)))}return"data:application/pdf;filename="+W.filename+";base64,"+he;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Rt)==="[object Window]"){var Ee="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';W.pdfObjectUrl&&(Ee=W.pdfObjectUrl,Ke="");var st='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ee+'"'+Ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(W)+");<\/script></body></html>",St=Rt.open();return St!==null&&St.document.write(st),St}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Rt)==="[object Window]"){var At='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(W.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+W.filename+'" width="500px" height="400px" /></body></html>',Mt=Rt.open();if(Mt!==null){Mt.document.write(At);var Ut=this;Mt.document.documentElement.querySelector("#pdfViewer").onload=function(){Mt.document.title=W.filename,Mt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ut.output("bloburl"))}}return Mt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Rt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var fr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",W)+'"></iframe></body></html>',Vr=Rt.open();if(Vr!==null&&(Vr.document.write(fr),Vr.document.title=W.filename),Vr||typeof safari>"u")return Vr;break;case"datauri":case"dataurl":return Rt.document.location.href=this.output("datauristring",W);default:return null}},Qn.foo=function(){try{return Qn.apply(this,arguments)}catch(he){var k=he.stack||"";~k.indexOf(" at ")&&(k=k.split(" at ")[1]);var W="Error in function "+k.split(`
`)[0].split("<")[0]+": "+he.message;if(!Rt.console)throw new Error(W);Rt.console.error(W,he),Rt.alert&&alert(W)}},Qn.foo.bar=Qn,Qn.foo),ll=function(k){return Array.isArray(Rs)===!0&&Rs.indexOf(k)>-1};switch(n){case"pt":pt=1;break;case"mm":pt=72/25.4;break;case"cm":pt=72/2.54;break;case"in":pt=72;break;case"px":pt=ll("px_scaling")==1?.75:96/72;break;case"pc":case"em":pt=12;break;case"ex":pt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);pt=n}var sn=null;xe(),me();var Ad=f.__private__.getPageInfo=f.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ft[k].objId,pageNumber:k,pageContext:Ft[k]}},zm=f.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var W in Ft)if(Ft[W].objId===k)break;return Ad(W)},Hm=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Ft[A].objId,pageNumber:A,pageContext:Ft[A]}};f.addPage=function(){return za.apply(this,arguments),this},f.setPage=function(){return ii.apply(this,arguments),Te.call(this,je[A]),this},f.insertPage=function(k){return this.addPage(),this.movePage(A,k),this},f.movePage=function(k,W){var he,be;if(k>W){he=je[k],be=Ft[k];for(var Ee=k;Ee>W;Ee--)je[Ee]=je[Ee-1],Ft[Ee]=Ft[Ee-1];je[W]=he,Ft[W]=be,this.setPage(W)}else if(k<W){he=je[k],be=Ft[k];for(var Ke=k;Ke<W;Ke++)je[Ke]=je[Ke+1],Ft[Ke]=Ft[Ke+1];je[W]=he,Ft[W]=be,this.setPage(W)}return this},f.deletePage=function(){return Ms.apply(this,arguments),this},f.__private__.text=f.text=function(k,W,he,be,Ee){var Ke,st,St,At,Mt,Ut,fr,Vr,xn,Dr=(be=be||{}).scope||this;if(typeof k=="number"&&typeof W=="number"&&(typeof he=="string"||Array.isArray(he))){var Nn=he;he=W,W=k,k=Nn}if(arguments[3]instanceof Lt==0?(St=arguments[4],At=arguments[5],Qt(fr=arguments[3])==="object"&&fr!==null||(typeof St=="string"&&(At=St,St=null),typeof fr=="string"&&(At=fr,fr=null),typeof fr=="number"&&(St=fr,fr=null),be={flags:fr,angle:St,align:At})):(E("The transform parameter of text() with a Matrix value"),xn=Ee),isNaN(W)||isNaN(he)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Dr;var vn,In="",ds=typeof be.lineHeightFactor=="number"?be.lineHeightFactor:dl,Sa=Dr.internal.scaleFactor;function Rf(mr){return mr=mr.split("	").join(Array(be.TabLen||9).join(" ")),Ht(mr,fr)}function gc(mr){for(var jr,ln=mr.concat(),kn=[],Ui=ln.length;Ui--;)typeof(jr=ln.shift())=="string"?kn.push(jr):Array.isArray(mr)&&(jr.length===1||jr[1]===void 0&&jr[2]===void 0)?kn.push(jr[0]):kn.push([jr[0],jr[1],jr[2]]);return kn}function gl(mr,jr){var ln;if(typeof mr=="string")ln=jr(mr)[0];else if(Array.isArray(mr)){for(var kn,Ui,Yd=mr.concat(),bc=[],Bf=Yd.length;Bf--;)typeof(kn=Yd.shift())=="string"?bc.push(jr(kn)[0]):Array.isArray(kn)&&typeof kn[0]=="string"&&(Ui=jr(kn[0],kn[1],kn[2]),bc.push([Ui[0],Ui[1],Ui[2]]));ln=bc}return ln}var wo=!1,xl=!0;if(typeof k=="string")wo=!0;else if(Array.isArray(k)){var vl=k.concat();st=[];for(var bl,ta=vl.length;ta--;)(typeof(bl=vl.shift())!="string"||Array.isArray(bl)&&typeof bl[0]!="string")&&(xl=!1);wo=xl}if(wo===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var yl=we/Dr.internal.scaleFactor,wl=yl*(ds-1);switch(be.baseline){case"bottom":he-=wl;break;case"top":he+=yl-wl;break;case"hanging":he+=yl-2*wl;break;case"middle":he+=yl/2-wl}if((Ut=be.maxWidth||0)>0&&(typeof k=="string"?k=Dr.splitTextToSize(k,Ut):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(mr,jr){return mr.concat(Dr.splitTextToSize(jr,Ut))},[]))),Ke={text:k,x:W,y:he,options:be,mutex:{pdfEscape:Ht,activeFontKey:ot,fonts:ut,activeFontSize:we}},nr.publish("preProcessText",Ke),k=Ke.text,St=(be=Ke.options).angle,xn instanceof Lt==0&&St&&typeof St=="number"){St*=Math.PI/180,be.rotationDirection===0&&(St=-St),_===S&&(St=-St);var Rd=Math.cos(St),Md=Math.sin(St);xn=new Lt(Rd,Md,-Md,Rd,0,0)}else St&&St instanceof Lt&&(xn=St);_!==S||xn||(xn=Wa),(Mt=be.charSpace||mc)!==void 0&&(In+=R(U(Mt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Vr=be.horizontalScale)!==void 0&&(In+=R(100*Vr)+` Tz
`),be.lang;var Kr=-1,Ii=be.renderingMode!==void 0?be.renderingMode:be.stroke,xc=Dr.internal.getCurrentPageInfo().pageContext;switch(Ii){case 0:case!1:case"fill":Kr=0;break;case 1:case!0:case"stroke":Kr=1;break;case 2:case"fillThenStroke":Kr=2;break;case 3:case"invisible":Kr=3;break;case 4:case"fillAndAddForClipping":Kr=4;break;case 5:case"strokeAndAddPathForClipping":Kr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Kr=6;break;case 7:case"addToPathForClipping":Kr=7}var Mf=xc.usedRenderingMode!==void 0?xc.usedRenderingMode:-1;Kr!==-1?In+=Kr+` Tr
`:Mf!==-1&&(In+=`0 Tr
`),Kr!==-1&&(xc.usedRenderingMode=Kr),At=be.align||"left";var us,_l=we*ds,Id=Dr.internal.pageSize.getWidth(),Bd=ut[ot];Mt=be.charSpace||mc,Ut=be.maxWidth||0,fr=Object.assign({autoencode:!0,noBOM:!0},be.flags);var _o=[],Nl=function(mr){return Dr.getStringUnitWidth(mr,{font:Bd,charSpace:Mt,fontSize:we,doKerning:!1})*we/Sa};if(Object.prototype.toString.call(k)==="[object Array]"){var Ha;st=gc(k),At!=="left"&&(us=st.map(Nl));var qa,No=0;if(At==="right"){W-=us[0],k=[],ta=st.length;for(var Bi=0;Bi<ta;Bi++)Bi===0?(qa=Fi(W),Ha=$i(he)):(qa=U(No-us[Bi]),Ha=-_l),k.push([st[Bi],qa,Ha]),No=us[Bi]}else if(At==="center"){W-=us[0]/2,k=[],ta=st.length;for(var ko=0;ko<ta;ko++)ko===0?(qa=Fi(W),Ha=$i(he)):(qa=U((No-us[ko])/2),Ha=-_l),k.push([st[ko],qa,Ha]),No=us[ko]}else if(At==="left"){k=[],ta=st.length;for(var Ud=0;Ud<ta;Ud++)k.push(st[Ud])}else if(At==="justify"&&Bd.encoding==="Identity-H"){k=[],ta=st.length,Ut=Ut!==0?Ut:Id;for(var vc=0,on=0;on<ta;on++)if(Ha=on===0?$i(he):-_l,qa=on===0?Fi(W):vc,on<ta-1){var If=U((Ut-us[on])/(st[on].split(" ").length-1)),li=st[on].split(" ");k.push([li[0]+" ",qa,Ha]),vc=0;for(var ci=1;ci<li.length;ci++){var Wd=(Nl(li[ci-1]+" "+li[ci])-Nl(li[ci]))*Sa+If;ci==li.length-1?k.push([li[ci],Wd,0]):k.push([li[ci]+" ",Wd,0]),vc-=Wd}}else k.push([st[on],qa,Ha]);k.push(["",vc,0])}else{if(At!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],ta=st.length,Ut=Ut!==0?Ut:Id,on=0;on<ta;on++){Ha=on===0?$i(he):-_l,qa=on===0?Fi(W):0;var zd=st[on].split(" ").length-1,Hd=zd>0?(Ut-us[on])/zd:0;on<ta-1?_o.push(R(U(Hd))):_o.push(0),k.push([st[on],qa,Ha])}}}(typeof be.R2L=="boolean"?be.R2L:vt)===!0&&(k=gl(k,function(mr,jr,ln){return[mr.split("").reverse().join(""),jr,ln]})),Ke={text:k,x:W,y:he,options:be,mutex:{pdfEscape:Ht,activeFontKey:ot,fonts:ut,activeFontSize:we}},nr.publish("postProcessText",Ke),k=Ke.text,vn=Ke.mutex.isHex||!1;var qd=ut[ot].encoding;qd!=="WinAnsiEncoding"&&qd!=="StandardEncoding"||(k=gl(k,function(mr,jr,ln){return[Rf(mr),jr,ln]})),st=gc(k),k=[];for(var So,jo,To,kl=Array.isArray(st[0])?1:0,Ao="",Sl=function(mr,jr,ln){var kn="";return ln instanceof Lt?(ln=typeof be.angle=="number"?Ua(ln,new Lt(1,0,0,1,mr,jr)):Ua(new Lt(1,0,0,1,mr,jr),ln),_===S&&(ln=Ua(new Lt(1,0,0,-1,0,0),ln)),kn=ln.join(" ")+` Tm
`):kn=R(mr)+" "+R(jr)+` Td
`,kn},fs=0;fs<st.length;fs++){switch(Ao="",kl){case 1:To=(vn?"<":"(")+st[fs][0]+(vn?">":")"),So=parseFloat(st[fs][1]),jo=parseFloat(st[fs][2]);break;case 0:To=(vn?"<":"(")+st[fs]+(vn?">":")"),So=Fi(W),jo=$i(he)}_o!==void 0&&_o[fs]!==void 0&&(Ao=_o[fs]+` Tw
`),fs===0?k.push(Ao+Sl(So,jo,xn)+To):kl===0?k.push(Ao+To):kl===1&&k.push(Ao+Sl(So,jo,xn)+To)}k=kl===0?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var di=`BT
/`;return di+=ot+" "+we+` Tf
`,di+=R(we*ds)+` TL
`,di+=ul+`
`,di+=In,di+=k,Y(di+="ET"),m[ot]=!0,Dr};var qm=f.__private__.clip=f.clip=function(k){return Y(k==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return qm("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Y("n"),this};var oi=f.__private__.isValidStyle=function(k){var W=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(W=!0),W};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(k){return oi(k)&&(d=k),this};var Cf=f.__private__.getStyle=f.getStyle=function(k){var W=d;switch(k){case"D":case"S":W="S";break;case"F":W="f";break;case"FD":case"DF":W="B";break;case"f":case"f*":case"B":case"B*":W=k}return W},Df=f.close=function(){return Y("h"),this};f.stroke=function(){return Y("S"),this},f.fill=function(k){return bo("f",k),this},f.fillEvenOdd=function(k){return bo("f*",k),this},f.fillStroke=function(k){return bo("B",k),this},f.fillStrokeEvenOdd=function(k){return bo("B*",k),this};var bo=function(k,W){Qt(W)==="object"?Vm(W,k):Y(k)},Ed=function(k){k===null||_===S&&k===void 0||(k=Cf(k),Y(k))};function Ym(k,W,he,be,Ee){var Ke=new $c(W||this.boundingBox,he||this.xStep,be||this.yStep,this.gState,Ee||this.matrix);Ke.stream=this.stream;var st=k+"$$"+this.cloneIndex+++"$$";return Pn(st,Ke),Ke}var Vm=function(k,W){var he=Xt[k.key],be=Dt[he];if(be instanceof Ol)Y("q"),Y(Gm(W)),be.gState&&f.setGState(be.gState),Y(k.matrix.toString()+" cm"),Y("/"+he+" sh"),Y("Q");else if(be instanceof $c){var Ee=new Lt(1,0,0,-1,0,pl());k.matrix&&(Ee=Ee.multiply(k.matrix||Wa),he=Ym.call(be,k.key,k.boundingBox,k.xStep,k.yStep,Ee).id),Y("q"),Y("/Pattern cs"),Y("/"+he+" scn"),be.gState&&f.setGState(be.gState),Y(W),Y("Q")}},Gm=function(k){switch(k){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Cd=f.moveTo=function(k,W){return Y(R(U(k))+" "+R(F(W))+" m"),this},cl=f.lineTo=function(k,W){return Y(R(U(k))+" "+R(F(W))+" l"),this},yo=f.curveTo=function(k,W,he,be,Ee,Ke){return Y([R(U(k)),R(F(W)),R(U(he)),R(F(be)),R(U(Ee)),R(F(Ke)),"c"].join(" ")),this};f.__private__.line=f.line=function(k,W,he,be,Ee){if(isNaN(k)||isNaN(W)||isNaN(he)||isNaN(be)||!oi(Ee))throw new Error("Invalid arguments passed to jsPDF.line");return _===N?this.lines([[he-k,be-W]],k,W,[1,1],Ee||"S"):this.lines([[he-k,be-W]],k,W,[1,1]).stroke()},f.__private__.lines=f.lines=function(k,W,he,be,Ee,Ke){var st,St,At,Mt,Ut,fr,Vr,xn,Dr,Nn,vn,In;if(typeof k=="number"&&(In=he,he=W,W=k,k=In),be=be||[1,1],Ke=Ke||!1,isNaN(W)||isNaN(he)||!Array.isArray(k)||!Array.isArray(be)||!oi(Ee)||typeof Ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Cd(W,he),st=be[0],St=be[1],Mt=k.length,Nn=W,vn=he,At=0;At<Mt;At++)(Ut=k[At]).length===2?(Nn=Ut[0]*st+Nn,vn=Ut[1]*St+vn,cl(Nn,vn)):(fr=Ut[0]*st+Nn,Vr=Ut[1]*St+vn,xn=Ut[2]*st+Nn,Dr=Ut[3]*St+vn,Nn=Ut[4]*st+Nn,vn=Ut[5]*St+vn,yo(fr,Vr,xn,Dr,Nn,vn));return Ke&&Df(),Ed(Ee),this},f.path=function(k){for(var W=0;W<k.length;W++){var he=k[W],be=he.c;switch(he.op){case"m":Cd(be[0],be[1]);break;case"l":cl(be[0],be[1]);break;case"c":yo.apply(this,be);break;case"h":Df()}}return this},f.__private__.rect=f.rect=function(k,W,he,be,Ee){if(isNaN(k)||isNaN(W)||isNaN(he)||isNaN(be)||!oi(Ee))throw new Error("Invalid arguments passed to jsPDF.rect");return _===N&&(be=-be),Y([R(U(k)),R(F(W)),R(U(he)),R(U(be)),"re"].join(" ")),Ed(Ee),this},f.__private__.triangle=f.triangle=function(k,W,he,be,Ee,Ke,st){if(isNaN(k)||isNaN(W)||isNaN(he)||isNaN(be)||isNaN(Ee)||isNaN(Ke)||!oi(st))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[he-k,be-W],[Ee-he,Ke-be],[k-Ee,W-Ke]],k,W,[1,1],st,!0),this},f.__private__.roundedRect=f.roundedRect=function(k,W,he,be,Ee,Ke,st){if(isNaN(k)||isNaN(W)||isNaN(he)||isNaN(be)||isNaN(Ee)||isNaN(Ke)||!oi(st))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var St=4/3*(Math.SQRT2-1);return Ee=Math.min(Ee,.5*he),Ke=Math.min(Ke,.5*be),this.lines([[he-2*Ee,0],[Ee*St,0,Ee,Ke-Ke*St,Ee,Ke],[0,be-2*Ke],[0,Ke*St,-Ee*St,Ke,-Ee,Ke],[2*Ee-he,0],[-Ee*St,0,-Ee,-Ke*St,-Ee,-Ke],[0,2*Ke-be],[0,-Ke*St,Ee*St,-Ke,Ee,-Ke]],k+Ee,W,[1,1],st,!0),this},f.__private__.ellipse=f.ellipse=function(k,W,he,be,Ee){if(isNaN(k)||isNaN(W)||isNaN(he)||isNaN(be)||!oi(Ee))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ke=4/3*(Math.SQRT2-1)*he,st=4/3*(Math.SQRT2-1)*be;return Cd(k+he,W),yo(k+he,W-st,k+Ke,W-be,k,W-be),yo(k-Ke,W-be,k-he,W-st,k-he,W),yo(k-he,W+st,k-Ke,W+be,k,W+be),yo(k+Ke,W+be,k+he,W+st,k+he,W),Ed(Ee),this},f.__private__.circle=f.circle=function(k,W,he,be){if(isNaN(k)||isNaN(W)||isNaN(he)||!oi(be))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,W,he,he,be)},f.setFont=function(k,W,he){return he&&(W=O(W,he)),ot=vo(k,W,{disableWarning:!1}),this};var Km=f.__private__.getFont=f.getFont=function(){return ut[vo.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var k,W,he={};for(k in Ot)if(Ot.hasOwnProperty(k))for(W in he[k]=[],Ot[k])Ot[k].hasOwnProperty(W)&&he[k].push(W);return he},f.addFont=function(k,W,he,be,Ee){var Ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ke.indexOf(arguments[3])!==-1?Ee=arguments[3]:arguments[3]&&Ke.indexOf(arguments[3])==-1&&(he=O(he,be)),Zt.call(this,k,W,he,Ee=Ee||"Identity-H")};var dl,Dd=e.lineWidth||.200025,Bt=f.__private__.getLineWidth=f.getLineWidth=function(){return Dd},Xm=f.__private__.setLineWidth=f.setLineWidth=function(k){return Dd=k,Y(R(U(k))+" w"),this};f.__private__.setLineDash=Ct.API.setLineDash=Ct.API.setLineDashPattern=function(k,W){if(k=k||[],W=W||0,isNaN(W)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(he){return R(U(he))}).join(" "),W=R(U(W)),Y("["+k+"] "+W+" d"),this};var Jm=f.__private__.getLineHeight=f.getLineHeight=function(){return we*dl};f.__private__.getLineHeight=f.getLineHeight=function(){return we*dl};var Zm=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(dl=k),this},Qm=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return dl};Zm(e.lineHeight);var Fi=f.__private__.getHorizontalCoordinate=function(k){return U(k)},$i=f.__private__.getVerticalCoordinate=function(k){return _===S?k:Ft[A].mediaBox.topRightY-Ft[A].mediaBox.bottomLeftY-U(k)},ep=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(k){return R(Fi(k))},tp=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(k){return R($i(k))},fc=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return de(fc)},f.__private__.setStrokeColor=f.setDrawColor=function(k,W,he,be){return fc=pe({ch1:k,ch2:W,ch3:he,ch4:be,pdfColorType:"draw",precision:2}),Y(fc),this};var Od=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return de(Od)},f.__private__.setFillColor=f.setFillColor=function(k,W,he,be){return Od=pe({ch1:k,ch2:W,ch3:he,ch4:be,pdfColorType:"fill",precision:2}),Y(Od),this};var ul=e.textColor||"0 g",hc=f.__private__.getTextColor=f.getTextColor=function(){return de(ul)};f.__private__.setTextColor=f.setTextColor=function(k,W,he,be){return ul=pe({ch1:k,ch2:W,ch3:he,ch4:be,pdfColorType:"text",precision:3}),this};var mc=e.charSpace,rp=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(mc||0)};f.__private__.setCharSpace=f.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return mc=k,this};var Pd=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(k){var W=f.CapJoinStyles[k];if(W===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pd=W,Y(W+" J"),this};var Ld=0;f.__private__.setLineJoin=f.setLineJoin=function(k){var W=f.CapJoinStyles[k];if(W===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ld=W,Y(W+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Y(R(U(k))+" M"),this},f.GState=_0,f.setGState=function(k){(k=typeof k=="string"?$t[_r[k]]:fl(null,k)).equals(Fr)||(Y("/"+k.id+" gs"),Fr=k)};var fl=function(k,W){if(!k||!_r[k]){var he=!1;for(var be in $t)if($t.hasOwnProperty(be)&&$t[be].equals(W)){he=!0;break}if(he)W=$t[be];else{var Ee="GS"+(Object.keys($t).length+1).toString(10);$t[Ee]=W,W.id=Ee}return k&&(_r[k]=W.id),nr.publish("addGState",W),W}};f.addGState=function(k,W){return fl(k,W),this},f.saveGraphicsState=function(){return Y("q"),zt.push({key:ot,size:we,color:ul}),this},f.restoreGraphicsState=function(){Y("Q");var k=zt.pop();return ot=k.key,we=k.size,ul=k.color,Fr=null,this},f.setCurrentTransformationMatrix=function(k){return Y(k.toString()+" cm"),this},f.comment=function(k){return Y("#"+k),this};var hl=function(k,W){var he=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return he},set:function(Ke){isNaN(Ke)||(he=parseFloat(Ke))}});var be=W||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return be},set:function(Ke){isNaN(Ke)||(be=parseFloat(Ke))}});var Ee="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ee},set:function(Ke){Ee=Ke.toString()}}),this},Fd=function(k,W,he,be){hl.call(this,k,W),this.type="rect";var Ee=he||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ee},set:function(st){isNaN(st)||(Ee=parseFloat(st))}});var Ke=be||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ke},set:function(st){isNaN(st)||(Ke=parseFloat(st))}}),this},pc=function(){this.page=ur,this.currentPage=A,this.pages=je.slice(0),this.pagesContext=Ft.slice(0),this.x=yt,this.y=ir,this.matrix=ct,this.width=Of(A),this.height=Ri(A),this.outputDestination=et,this.id="",this.objectNumber=-1};pc.prototype.restore=function(){ur=this.page,A=this.currentPage,Ft=this.pagesContext,je=this.pages,yt=this.x,ir=this.y,ct=this.matrix,Pf(A,this.width),Mi(A,this.height),et=this.outputDestination};var $d=function(k,W,he,be,Ee){ka.push(new pc),ur=A=0,je=[],yt=k,ir=W,ct=Ee,$r([he,be])};for(var ml in f.beginFormObject=function(k,W,he,be,Ee){return $d(k,W,he,be,Ee),this},f.endFormObject=function(k){return function(W){if(Zn[W])ka.pop().restore();else{var he=new pc,be="Xo"+(Object.keys(an).length+1).toString(10);he.id=be,Zn[W]=be,an[be]=he,nr.publish("addFormObject",he),ka.pop().restore()}}(k),this},f.doFormObject=function(k,W){var he=an[Zn[k]];return Y("q"),Y(W.toString()+" cm"),Y("/"+he.id+" Do"),Y("Q"),this},f.getFormObject=function(k){var W=an[Zn[k]];return{x:W.x,y:W.y,width:W.width,height:W.height,matrix:W.matrix}},f.save=function(k,W){return k=k||"generated.pdf",(W=W||{}).returnPromise=W.returnPromise||!1,W.returnPromise===!1?(El(ol(Li()),k),typeof El.unload=="function"&&Rt.setTimeout&&setTimeout(El.unload,911),this):new Promise(function(he,be){try{var Ee=El(ol(Li()),k);typeof El.unload=="function"&&Rt.setTimeout&&setTimeout(El.unload,911),he(Ee)}catch(Ke){be(Ke.message)}})},Ct.API)Ct.API.hasOwnProperty(ml)&&(ml==="events"&&Ct.API.events.length?function(k,W){var he,be,Ee;for(Ee=W.length-1;Ee!==-1;Ee--)he=W[Ee][0],be=W[Ee][1],k.subscribe.apply(k,[he].concat(typeof be=="function"?[be]:be))}(nr,Ct.API.events):f[ml]=Ct.API[ml]);function Of(k){return Ft[k].mediaBox.topRightX-Ft[k].mediaBox.bottomLeftX}function Pf(k,W){Ft[k].mediaBox.topRightX=W+Ft[k].mediaBox.bottomLeftX}function Ri(k){return Ft[k].mediaBox.topRightY-Ft[k].mediaBox.bottomLeftY}function Mi(k,W){Ft[k].mediaBox.topRightY=W+Ft[k].mediaBox.bottomLeftY}var Lf=f.getPageWidth=function(k){return Of(k=k||A)/pt},Ff=f.setPageWidth=function(k,W){Pf(k,W*pt)},pl=f.getPageHeight=function(k){return Ri(k=k||A)/pt},$f=f.setPageHeight=function(k,W){Mi(k,W*pt)};return f.internal={pdfEscape:Ht,getStyle:Cf,getFont:Km,getFontSize:He,getCharSpace:rp,getTextColor:hc,getLineHeight:Jm,getLineHeightFactor:Qm,getLineWidth:Bt,write:We,getHorizontalCoordinate:Fi,getVerticalCoordinate:$i,getCoordinateString:ep,getVerticalCoordinateString:tp,collections:{},newObject:Cr,newAdditionalObject:ce,newObjectDeferred:Gr,newObjectDeferredBegin:q,getFilters:Pe,putStream:ze,events:nr,scaleFactor:pt,pageSize:{getWidth:function(){return Lf(A)},setWidth:function(k){Ff(A,k)},getHeight:function(){return pl(A)},setHeight:function(k){$f(A,k)}},encryptionOptions:u,encryption:sn,getEncryptor:function(k){return u!==null?sn.encryptor(k,0):function(W){return W}},output:Is,getNumberOfPages:cs,pages:je,out:Y,f2:C,f3:M,getPageInfo:Ad,getPageInfoByObjId:zm,getCurrentPageInfo:Hm,getPDFVersion:g,Point:hl,Rectangle:Fd,Matrix:Lt,hasHotfix:ll},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Lf(A)},set:function(k){Ff(A,k)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return pl(A)},set:function(k){$f(A,k)},enumerable:!0,configurable:!0}),(function(k){for(var W=0,he=ve.length;W<he;W++){var be=Zt.call(this,k[W][0],k[W][1],k[W][2],ve[W][3],!0);h===!1&&(m[be]=!0);var Ee=k[W][0].split("-");Nt({id:be,fontName:Ee[0],fontStyle:Ee[1]||""})}nr.publish("addFonts",{fonts:ut,dictionary:Ot})}).call(f,ve),ot="F1",za(a,r),nr.publish("initialized"),f}Dc.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Dc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Dc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Dc.prototype.processOwnerPassword=function(e,t){return nx(rx(t).substr(0,5),e)},Dc.prototype.encryptor=function(e,t){var r=rx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return nx(r,n)}},_0.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Qt(e)!==Qt(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ct.API={events:[]},Ct.version="3.0.3";var Zr=Ct.API,w1=1,cc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Wt=function(e){return e.toFixed(2)},Ro=function(e){return e.toFixed(5)};Zr.__acroform__={};var Ba=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},jy=function(e){return e*w1},pi=function(e){var t=new Q3,r=kt.internal.getHeight(e)||0,n=kt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Wt(n)),Number(Wt(r))],t},YF=Zr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},VF=Zr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},GF=Zr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},fn=Zr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return GF(e,t-1)},hn=Zr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return YF(e,t-1)},mn=Zr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return VF(e,t-1)},KF=Zr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Wt(c.lowerLeft_X)),Number(Wt(c.lowerLeft_Y)),Number(Wt(c.upperRight_X)),Number(Wt(c.upperRight_Y))]},XF=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=ax(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Wt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=pi(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},ax=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(C){return C.split(`
`)}):a.map(function(C){return[C]});var s=r,o=kt.internal.getHeight(e)||0;o=o<0?-o:o;var l=kt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(C,M,U){if(C+1<a.length){var F=M+" "+a[C+1][0];return wh(F,e,U).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var d,u,h=wh("3",e,s).height,m=e.multiline?o-s:(o-h)/2,f=m+=2,x=0,g=0,b=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+wh(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var y="",N=0,S=0;S<a.length;S++)if(a.hasOwnProperty(S)){var _=!1;if(a[S].length!==1&&b!==a[S].length-1){if((h+2)*(N+2)+2>o)continue e;y+=a[S][b],_=!0,g=S,S--}else{y=(y+=a[S][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var D=parseInt(S),I=c(D,y,s),O=S>=a.length-1;if(I&&!O){y+=" ",b=0;continue}if(I||O){if(O)g=D;else if(e.multiline&&(h+2)*(N+2)+2>o)continue e}else{if(!e.multiline||(h+2)*(N+2)+2>o)continue e;g=D}}for(var R="",E=x;E<=g;E++){var B=a[E];if(e.multiline){if(E===g){R+=B[b]+" ",b=(b+1)%B.length;continue}if(E===x){R+=B[B.length-1]+" ";continue}}R+=B[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,u=wh(R,e,s).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=Wt(d)+" "+Wt(f)+` Td
`,t+="("+cc(R)+`) Tj
`,t+=-Wt(d)+` 0 Td
`,f=-(s+2),u=0,x=_?g:g+1,N++,y=""}break}return n.text=t,n.fontSize=s,n},wh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},JF={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ZF=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},QF=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ni.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(JF)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");w1=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new eN,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&ZF(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=KF(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=kt.createDefaultAppearanceStream(l),Qt(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=XF(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var h="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var f=l.appearanceStreamContent[m];if(h+="/"+m+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var o in f)if(f.hasOwnProperty(o)){var x=f[o];typeof x=="function"&&(x=x.call(a,l)),h+="/"+o+" "+x+" ",a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x)}}else typeof(x=f)=="function"&&(x=x.call(a,l)),h+="/"+o+" "+x,a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(g,b){for(var y in g)if(g.hasOwnProperty(y)){var N=y,S=g[y];b.internal.newObjectDeferredBegin(S.objId,!0),Qt(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete g[N]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Z3=Zr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(s!==0&&(a+=" "),Qt(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+cc(n(e[s].toString()))+")"):a+=e[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},rg=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+cc(n(e))+")"},bi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};bi.prototype.toString=function(){return this.objId+" 0 R"},bi.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},bi.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:Z3(a,this.objId,this.scope)}):a instanceof bi?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var Q3=function(){bi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ba(Q3,bi);var eN=function(){bi.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+cc(r(e))+")"}},set:function(r){e=r}})};Ba(eN,bi);var ni=function e(){bi.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fn(t,3)},set:function(y){y?this.F=hn(t,3):this.F=mn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof N0)return;s="FieldObject"+e.FieldNum++}var y=function(N){return N};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+cc(y(s))+")"},set:function(y){s=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(y){s=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/w1:d},set:function(y){d=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof N0||this instanceof Ml))return rg(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=y}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Ln==0?rg(m,this.objId,this.scope):m},set:function(y){y=y.toString(),m=this instanceof Ln==0?y.substr(0,1)==="("?jc(y.substr(1,y.length-2)):jc(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ln==1?jc(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof Ln==1?"/"+y:y}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Ln==0?rg(f,this.objId,this.scope):f},set:function(y){y=y.toString(),f=this instanceof Ln==0?y.substr(0,1)==="("?jc(y.substr(1,y.length-2)):jc(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ln==1?jc(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof Ln==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(y){x=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,1)},set:function(y){y?this.Ff=hn(this.Ff,1):this.Ff=mn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,2)},set:function(y){y?this.Ff=hn(this.Ff,2):this.Ff=mn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,3)},set:function(y){y?this.Ff=hn(this.Ff,3):this.Ff=mn(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;default:b=0}}})};Ba(ni,bi);var Wc=function(){ni.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Z3(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,d=[];c=o.exec(s);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,18)},set:function(r){r?this.Ff=hn(this.Ff,18):this.Ff=mn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=hn(this.Ff,19):this.Ff=mn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,20)},set:function(r){r?(this.Ff=hn(this.Ff,20),t.sort()):this.Ff=mn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,22)},set:function(r){r?this.Ff=hn(this.Ff,22):this.Ff=mn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(r){r?this.Ff=hn(this.Ff,23):this.Ff=mn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,27)},set:function(r){r?this.Ff=hn(this.Ff,27):this.Ff=mn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ba(Wc,ni);var zc=function(){Wc.call(this),this.fontName="helvetica",this.combo=!1};Ba(zc,Wc);var Hc=function(){zc.call(this),this.combo=!0};Ba(Hc,zc);var zh=function(){Hc.call(this),this.edit=!0};Ba(zh,Hc);var Ln=function(){ni.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,15)},set:function(r){r?this.Ff=hn(this.Ff,15):this.Ff=mn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,16)},set:function(r){r?this.Ff=hn(this.Ff,16):this.Ff=mn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,17)},set:function(r){r?this.Ff=hn(this.Ff,17):this.Ff=mn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(r){r?this.Ff=hn(this.Ff,26):this.Ff=mn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+cc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Qt(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ba(Ln,ni);var Hh=function(){Ln.call(this),this.pushButton=!0};Ba(Hh,Ln);var qc=function(){Ln.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ba(qc,Ln);var N0=function(){var e,t;ni.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+cc(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Qt(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=kt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ba(N0,ni),qc.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},qc.prototype.createOption=function(e){var t=new N0;return t.Parent=this,t.optionName=e,this.Kids.push(t),e$.call(this.scope,t),t};var qh=function(){Ln.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=kt.CheckBox.createAppearanceStream()};Ba(qh,Ln);var Ml=function(){ni.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,13)},set:function(t){t?this.Ff=hn(this.Ff,13):this.Ff=mn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,21)},set:function(t){t?this.Ff=hn(this.Ff,21):this.Ff=mn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(t){t?this.Ff=hn(this.Ff,23):this.Ff=mn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,24)},set:function(t){t?this.Ff=hn(this.Ff,24):this.Ff=mn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,25)},set:function(t){t?this.Ff=hn(this.Ff,25):this.Ff=mn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(t){t?this.Ff=hn(this.Ff,26):this.Ff=mn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ba(Ml,ni);var Yh=function(){Ml.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,14)},set:function(e){e?this.Ff=hn(this.Ff,14):this.Ff=mn(this.Ff,14)}}),this.password=!0};Ba(Yh,Ml);var kt={CheckBox:{createAppearanceStream:function(){return{N:{On:kt.CheckBox.YesNormal},D:{On:kt.CheckBox.YesPushDown,Off:kt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=ax(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Wt(kt.internal.getWidth(e))+" "+Wt(kt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Wt(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=pi(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=kt.internal.getHeight(e),o=kt.internal.getWidth(e),l=ax(e,e.caption);return a.push("1 g"),a.push("0 0 "+Wt(o)+" "+Wt(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Wt(o-1)+" "+Wt(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Wt(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Wt(kt.internal.getWidth(e))+" "+Wt(kt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:kt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=kt.RadioButton.Circle.YesNormal,t.D[e]=kt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=pi(e);t.scope=e.scope;var r=[],n=kt.internal.getWidth(e)<=kt.internal.getHeight(e)?kt.internal.getWidth(e)/4:kt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=kt.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ro(kt.internal.getWidth(e)/2)+" "+Ro(kt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=[],n=kt.internal.getWidth(e)<=kt.internal.getHeight(e)?kt.internal.getWidth(e)/4:kt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*kt.internal.Bezier_C).toFixed(5)),o=Number((n*kt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ro(kt.internal.getWidth(e)/2)+" "+Ro(kt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ro(kt.internal.getWidth(e)/2)+" "+Ro(kt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=[],n=kt.internal.getWidth(e)<=kt.internal.getHeight(e)?kt.internal.getWidth(e)/4:kt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*kt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ro(kt.internal.getWidth(e)/2)+" "+Ro(kt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:kt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=kt.RadioButton.Cross.YesNormal,t.D[e]=kt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=pi(e);t.scope=e.scope;var r=[],n=kt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Wt(kt.internal.getWidth(e)-2)+" "+Wt(kt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Wt(n.x1.x)+" "+Wt(n.x1.y)+" m"),r.push(Wt(n.x2.x)+" "+Wt(n.x2.y)+" l"),r.push(Wt(n.x4.x)+" "+Wt(n.x4.y)+" m"),r.push(Wt(n.x3.x)+" "+Wt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=kt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Wt(kt.internal.getWidth(e))+" "+Wt(kt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Wt(kt.internal.getWidth(e)-2)+" "+Wt(kt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Wt(r.x1.x)+" "+Wt(r.x1.y)+" m"),n.push(Wt(r.x2.x)+" "+Wt(r.x2.y)+" l"),n.push(Wt(r.x4.x)+" "+Wt(r.x4.y)+" m"),n.push(Wt(r.x3.x)+" "+Wt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=pi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Wt(kt.internal.getWidth(e))+" "+Wt(kt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};kt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=kt.internal.getWidth(e),r=kt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},kt.internal.getWidth=function(e){var t=0;return Qt(e)==="object"&&(t=jy(e.Rect[2])),t},kt.internal.getHeight=function(e){var t=0;return Qt(e)==="object"&&(t=jy(e.Rect[3])),t};var e$=Zr.addField=function(e){if(QF(this,e),!(e instanceof ni))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Zr.AcroFormChoiceField=Wc,Zr.AcroFormListBox=zc,Zr.AcroFormComboBox=Hc,Zr.AcroFormEditBox=zh,Zr.AcroFormButton=Ln,Zr.AcroFormPushButton=Hh,Zr.AcroFormRadioButton=qc,Zr.AcroFormCheckBox=qh,Zr.AcroFormTextField=Ml,Zr.AcroFormPasswordField=Yh,Zr.AcroFormAppearance=kt,Zr.AcroForm={ChoiceField:Wc,ListBox:zc,ComboBox:Hc,EditBox:zh,Button:Ln,PushButton:Hh,RadioButton:qc,CheckBox:qh,TextField:Ml,PasswordField:Yh,Appearance:kt},Ct.AcroForm={ChoiceField:Wc,ListBox:zc,ComboBox:Hc,EditBox:zh,Button:Ln,PushButton:Hh,RadioButton:qc,CheckBox:qh,TextField:Ml,PasswordField:Yh,Appearance:kt};Ct.AcroForm;function tN(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(C,M){var U,F,ne,V,ee,me=r;if((M=M||r)==="RGBA"||C.data!==void 0&&C.data instanceof Uint8ClampedArray&&"height"in C&&"width"in C)return"RGBA";if(I(C))for(ee in n)for(ne=n[ee],U=0;U<ne.length;U+=1){for(V=!0,F=0;F<ne[U].length;F+=1)if(ne[U][F]!==void 0&&ne[U][F]!==C[F]){V=!1;break}if(V===!0){me=ee;break}}else for(ee in n)for(ne=n[ee],U=0;U<ne.length;U+=1){for(V=!0,F=0;F<ne[U].length;F+=1)if(ne[U][F]!==void 0&&ne[U][F]!==C.charCodeAt(F)){V=!1;break}if(V===!0){me=ee;break}}return me===r&&M!==r&&(me=M),me},s=function C(M){for(var U=this.internal.write,F=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:M.width}),V.push({key:"Height",value:M.height}),M.colorSpace===y.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===y.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)&&M.transparency.length>0){for(var ee="",me=0,ye=M.transparency.length;me<ye;me++)ee+=M.transparency[me]+" "+M.transparency[me]+" ";V.push({key:"Mask",value:"["+ee+"]"})}M.sMask!==void 0&&V.push({key:"SMask",value:M.objectId+1+" 0 R"});var Oe=M.filter!==void 0?["/"+M.filter]:void 0;if(F({data:M.data,additionalKeyValues:V,alreadyAppliedFilters:Oe,objectId:M.objectId}),U("endobj"),"sMask"in M&&M.sMask!==void 0){var xe,w=(xe=M.sMaskBitsPerComponent)!==null&&xe!==void 0?xe:M.bitsPerComponent,A={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:w,data:M.sMask};"filter"in M&&(A.decodeParameters="/Predictor ".concat(M.predictor," /Colors 1 /BitsPerComponent ").concat(w," /Columns ").concat(M.width),A.filter=M.filter),C.call(this,A)}if(M.colorSpace===y.INDEXED){var T=this.internal.newObject();F({data:R(new Uint8Array(M.palette)),objectId:T}),U("endobj")}},o=function(){var C=this.internal.collections[t+"images"];for(var M in C)s.call(this,C[M])},l=function(){var C,M=this.internal.collections[t+"images"],U=this.internal.write;for(var F in M)U("/I"+(C=M[F]).index,C.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var C=this.internal.collections[t+"images"];return c.call(this),C},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(C){return typeof e["process"+C.toUpperCase()]=="function"},m=function(C){return Qt(C)==="object"&&C.nodeType===1},f=function(C,M){if(C.nodeName==="IMG"&&C.hasAttribute("src")){var U=""+C.getAttribute("src");if(U.indexOf("data:image/")===0)return Wh(unescape(U).split("base64,").pop());var F=e.loadFile(U,!0);if(F!==void 0)return F}if(C.nodeName==="CANVAS"){if(C.width===0||C.height===0)throw new Error("Given canvas must have data. Canvas width: "+C.width+", height: "+C.height);var ne;switch(M){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;default:ne="image/jpeg"}return Wh(C.toDataURL(ne,1).split("base64,").pop())}},x=function(C){var M=this.internal.collections[t+"images"];if(M){for(var U in M)if(C===M[U].alias)return M[U]}},g=function(C,M,U){return C||M||(C=-96,M=-96),C<0&&(C=-1*U.width*72/C/this.internal.scaleFactor),M<0&&(M=-1*U.height*72/M/this.internal.scaleFactor),C===0&&(C=M*U.width/U.height),M===0&&(M=C*U.height/U.width),[C,M]},b=function(C,M,U,F,ne,V){var ee=g.call(this,U,F,ne),me=this.internal.getCoordinateString,ye=this.internal.getVerticalCoordinateString,Oe=d.call(this);if(U=ee[0],F=ee[1],Oe[ne.index]=ne,V){V*=Math.PI/180;var xe=Math.cos(V),w=Math.sin(V),A=function(L){return L.toFixed(4)},T=[A(xe),A(w),A(-1*w),A(xe),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,me(C),ye(M+F),"cm"].join(" ")),this.internal.write(T.join(" ")),this.internal.write([me(U),"0","0",me(F),"0","0","cm"].join(" "))):this.internal.write([me(U),"0","0",me(F),me(C),ye(M+F),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var N=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(C){var M,U,F=0;if(typeof C=="string")for(U=C.length,M=0;M<U;M++)F=(F<<5)-F+C.charCodeAt(M),F|=0;else if(I(C))for(U=C.byteLength/2,M=0;M<U;M++)F=(F<<5)-F+C[M],F|=0;return F},_=e.__addimage__.validateStringAsBase64=function(C){(C=C||"").toString().trim();var M=!0;return C.length===0&&(M=!1),C.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(C.substr(0,C.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(C.substr(-2))===!1&&(M=!1),M},D=e.__addimage__.extractImageFromDataUrl=function(C){if(C==null||!(C=C.trim()).startsWith("data:"))return null;var M=C.indexOf(",");return M<0?null:C.substring(0,M).trim().endsWith("base64")?C.substring(M+1):null};e.__addimage__.isArrayBuffer=function(C){return C instanceof ArrayBuffer};var I=e.__addimage__.isArrayBufferView=function(C){return C instanceof Int8Array||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array},O=e.__addimage__.binaryStringToUint8Array=function(C){for(var M=C.length,U=new Uint8Array(M),F=0;F<M;F++)U[F]=C.charCodeAt(F);return U},R=e.__addimage__.arrayBufferToBinaryString=function(C){for(var M="",U=I(C)?C:new Uint8Array(C),F=0;F<U.length;F+=8192)M+=String.fromCharCode.apply(null,U.subarray(F,F+8192));return M};e.addImage=function(){var C,M,U,F,ne,V,ee,me,ye;if(typeof arguments[1]=="number"?(M=r,U=arguments[1],F=arguments[2],ne=arguments[3],V=arguments[4],ee=arguments[5],me=arguments[6],ye=arguments[7]):(M=arguments[1],U=arguments[2],F=arguments[3],ne=arguments[4],V=arguments[5],ee=arguments[6],me=arguments[7],ye=arguments[8]),Qt(C=arguments[0])==="object"&&!m(C)&&"imageData"in C){var Oe=C;C=Oe.imageData,M=Oe.format||M||r,U=Oe.x||U||0,F=Oe.y||F||0,ne=Oe.w||Oe.width||ne,V=Oe.h||Oe.height||V,ee=Oe.alias||ee,me=Oe.compression||me,ye=Oe.rotation||Oe.angle||ye}var xe=this.internal.getFilters();if(me===void 0&&xe.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(U)||isNaN(F))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var w=E.call(this,C,M,ee,me);return b.call(this,U,F,ne,V,w,ye),this};var E=function(C,M,U,F){var ne,V,ee;if(typeof C=="string"&&a(C)===r){C=unescape(C);var me=B(C,!1);(me!==""||(me=e.loadFile(C,!0))!==void 0)&&(C=me)}if(m(C)&&(C=f(C,M)),M=a(C,M),!h(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((ee=U)==null||ee.length===0)&&(U=function(ye){return typeof ye=="string"||I(ye)?S(ye):I(ye.data)?S(ye.data):null}(C)),(ne=x.call(this,U))||(C instanceof Uint8Array||M==="RGBA"||(V=C,C=O(C)),ne=this["process"+M.toUpperCase()](C,u.call(this),U,function(ye){return ye&&typeof ye=="string"&&(ye=ye.toUpperCase()),ye in e.image_compression?ye:N.NONE}(F),V)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},B=e.__addimage__.convertBase64ToBinaryString=function(C,M){M=typeof M!="boolean"||M;var U,F="";if(typeof C=="string"){var ne;U=(ne=D(C))!==null&&ne!==void 0?ne:C;try{F=Wh(U)}catch(V){if(M)throw _(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return F};e.getImageProperties=function(C){var M,U,F="";if(m(C)&&(C=f(C)),typeof C=="string"&&a(C)===r&&((F=B(C,!1))===""&&(F=e.loadFile(C)||""),C=F),U=a(C),!h(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(C instanceof Uint8Array||(C=O(C)),!(M=this["process"+U.toUpperCase()](C)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=U,M}})(Ct.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ct.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,h=0;h<d.length&&!u;h++)switch((n=d[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<d.length;m++){n=d[m];var f=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),N=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+f(y(n.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+f(y(N))+") >>",g.content=s;var S=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(g.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var _=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+f(x(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var D=this.annotations._nameMap[n.options.name];n.options.pageNumber=D.page,n.options.top=D.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+f(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+a),h:d(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(r,n,a,s),a+=.2*d,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-d,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Ct.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(g){var b=0,y=r,N="",S=0;for(b=0;b<g.length;b+=1)y[g.charCodeAt(b)]!==void 0?(S++,typeof(y=y[g.charCodeAt(b)])=="number"&&(N+=String.fromCharCode(y),y=r,S=0),b===g.length-1&&(y=r,N+=g.charAt(b-(S-1)),b-=S-1,S=0)):(y=r,N+=g.charAt(b-S),b-=S,S=0);return N};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(g,b,y){return o(g)?s(g)===!1?-1:!d(g)||!o(b)&&!o(y)||!o(y)&&l(b)||l(g)&&!o(b)||l(g)&&c(b)||l(g)&&l(b)?0:u(g)&&o(b)&&!l(b)&&o(y)&&d(y)?3:l(g)||!o(y)?1:2:-1},f=function(g){var b=0,y=0,N=0,S="",_="",D="",I=(g=g||"").split("\\s+"),O=[];for(b=0;b<I.length;b+=1){for(O.push(""),y=0;y<I[b].length;y+=1)S=I[b][y],_=I[b][y-1],D=I[b][y+1],o(S)?(N=m(S,_,D),O[b]+=N!==-1?String.fromCharCode(t[S.charCodeAt(0)][N]):S):O[b]+=S;O[b]=h(O[b])}return O.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var g,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var N=0;for(y=[],N=0;N<b.length;N+=1)Array.isArray(b[N])?y.push([f(b[N][0]),b[N][1],b[N][2]]):y.push([f(b[N])]);g=y}else g=f(b);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",x])}(Ct.API),Ct.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ct.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(g){x=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),m=d.scaleFactor||this.internal.scaleFactor,f=0,x=0,g=0,b=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(S,_){return S.concat(b.splitTextToSize(_,y))},[])):c=Array.isArray(c)?c:[c];for(var N=0;N<c.length;N++)f<(g=this.getStringUnitWidth(c[N],{font:h})*u)&&(f=g);return f!==0&&(x=c.length),{w:f/=m,h:Math.max((x*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,f&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,h,m){if(n.call(this),!u)throw new Error("No data for PDF table.");var f,x,g,b,y=[],N=[],S=[],_={},D={},I=[],O=[],R=(m=m||{}).autoSize||!1,E=m.printHeaders!==!1,B=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,C=m.margins||Object.assign({width:this.getPageWidth()},t),M=typeof m.padding=="number"?m.padding:3,U=m.headerBackgroundColor||"#c8c8c8",F=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=F,this.setFontSize(B),h==null)N=y=Object.keys(u[0]),S=y.map(function(){return"left"});else if(Array.isArray(h)&&Qt(h[0])==="object")for(y=h.map(function(Oe){return Oe.name}),N=h.map(function(Oe){return Oe.prompt||Oe.name||""}),S=h.map(function(Oe){return Oe.align||"left"}),f=0;f<h.length;f+=1)D[h[f].name]=.7499990551181103*h[f].width;else Array.isArray(h)&&typeof h[0]=="string"&&(N=y=h,S=y.map(function(){return"left"}));if(R||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<y.length;f+=1){for(_[b=y[f]]=u.map(function(Oe){return Oe[b]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(N[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=_[b],this.setFont(void 0,"normal"),g=0;g<x.length;g+=1)I.push(this.getTextDimensions(x[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[b]=Math.max.apply(null,I)+M+M,I=[]}if(E){var ne={};for(f=0;f<y.length;f+=1)ne[y[f]]={},ne[y[f]].text=N[f],ne[y[f]].align=S[f];var V=l.call(this,ne,D);O=y.map(function(Oe){return new s(c,d,D[Oe],V,ne[Oe].text,void 0,ne[Oe].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var ee=h.reduce(function(Oe,xe){return Oe[xe.name]=xe.align,Oe},{});for(f=0;f<u.length;f+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:f,data:u[f]},this);var me=l.call(this,u[f],D);for(g=0;g<y.length;g+=1){var ye=u[f][y[g]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:f,col:g,data:ye},this),o.call(this,new s(c,d,D[y[g]],me,ye,f+2,ee[y[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(f){var x=c[f];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,d[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*h/m+u+u},this).reduce(function(f,x){return Math.max(f,x)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(x)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(Ct.API);var rN={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},nN=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],sx=tN(nN),aN=[100,200,300,400,500,600,700,800,900],t$=tN(aN);function ng(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return rN[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),a=function(s){return typeof sx[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function Ty(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var r$={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ay={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ey(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Cy(e){return e.trimLeft()}function n$(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function a$(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var _h,Dy,Oy,Tc,Nh,Py,Ly,Fy,ag=["times"];function $y(e,t,r,n,a){var s=4,o=My;switch(a){case Ct.API.image_compression.FAST:s=1,o=Ry;break;case Ct.API.image_compression.MEDIUM:s=6,o=Iy;break;case Ct.API.image_compression.SLOW:s=9,o=By}e=function(c,d,u,h){for(var m,f=c.length/d,x=new Uint8Array(c.length+f),g=[s$,Ry,My,Iy,By],b=0;b<f;b+=1){var y=b*d,N=c.subarray(y,y+d);if(h)x.set(h(N,u,m),y+b);else{for(var S=g.length,_=[],D=0;D<S;D+=1)_[D]=g[D](N,u,m);var I=o$(_.concat());x.set(_[I],y+b)}m=N}return x}(e,t,Math.ceil(r*n/8),o);var l=Jg(e,{level:s});return Ct.API.__addimage__.arrayBufferToBinaryString(l)}function s$(e){var t=Array.apply([],e);return t.unshift(0),t}function Ry(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=e[a-t]||0;n[a+1]=e[a]-s+256&255}return n}function My(e,t,r){var n=e.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=e[s]-o+256&255}return a}function Iy(e,t,r){var n=e.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;a[s+1]=e[s]+256-(o+l>>>1)&255}return a}function By(e,t,r){var n=e.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=i$(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);a[s+1]=e[s]-o+256&255}return a}function i$(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=a&&n<=s?e:a<=s?t:r}function o$(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function sg(e,t,r){var n=t*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return sN(e,a)>>s&o}function Uy(e,t,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(d,u,h){if(u+1<d.byteLength)d.setUint16(u,h,!1);else{var m=h>>8&255;d.setUint8(u,m)}})(e,s,sN(e,s)&~(l<<o)&65535|c)}function sN(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function l$(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,o=1<<1+(7&a);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var d=!0,u=[],h=0,m=null,f=0,x=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,m=e[t++],1&g||(m=null),f=g>>2&7,t++;break;case 254:for(;;){if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,N=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,_=e[t++],D=_>>6&1,I=1<<1+(7&_),O=l,R=c,E=!1;_>>7&&(E=!0,O=t,R=I,t+=3*I);var B=t;for(t++;;){var C;if(!((C=e[t++])>=0))throw Error("Invalid block size");if(C===0)break;t+=C}u.push({x:b,y,width:N,height:S,has_local_palette:E,palette_offset:O,palette_size:R,data_offset:B,data_length:t-B,transparent_index:m,interlaced:!!D,delay:h,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return x},this.frameInfo=function(M){if(M<0||M>=u.length)throw new Error("Frame index out of range.");return u[M]},this.decodeAndBlitFrameBGRA=function(M,U){var F=this.frameInfo(M),ne=F.width*F.height,V=new Uint8Array(ne);Wy(e,F.data_offset,V,ne);var ee=F.palette_offset,me=F.transparent_index;me===null&&(me=256);var ye=F.width,Oe=r-ye,xe=ye,w=4*(F.y*r+F.x),A=4*((F.y+F.height)*r+F.x),T=w,L=4*Oe;F.interlaced===!0&&(L+=4*r*7);for(var H=8,X=0,re=V.length;X<re;++X){var ge=V[X];if(xe===0&&(xe=ye,(T+=L)>=A&&(L=4*Oe+4*r*(H-1),T=w+(ye+Oe)*(H<<1),H>>=1)),ge===me)T+=4;else{var oe=e[ee+3*ge],je=e[ee+3*ge+1],Ie=e[ee+3*ge+2];U[T++]=Ie,U[T++]=je,U[T++]=oe,U[T++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(M,U){var F=this.frameInfo(M),ne=F.width*F.height,V=new Uint8Array(ne);Wy(e,F.data_offset,V,ne);var ee=F.palette_offset,me=F.transparent_index;me===null&&(me=256);var ye=F.width,Oe=r-ye,xe=ye,w=4*(F.y*r+F.x),A=4*((F.y+F.height)*r+F.x),T=w,L=4*Oe;F.interlaced===!0&&(L+=4*r*7);for(var H=8,X=0,re=V.length;X<re;++X){var ge=V[X];if(xe===0&&(xe=ye,(T+=L)>=A&&(L=4*Oe+4*r*(H-1),T=w+(ye+Oe)*(H<<1),H>>=1)),ge===me)T+=4;else{var oe=e[ee+3*ge],je=e[ee+3*ge+1],Ie=e[ee+3*ge+2];U[T++]=oe,U[T++]=je,U[T++]=Ie,U[T++]=255}--xe}}}function Wy(e,t,r,n){for(var a=e[t++],s=1<<a,o=s+1,l=o+1,c=a+1,d=(1<<c)-1,u=0,h=0,m=0,f=e[t++],x=new Int32Array(4096),g=null;;){for(;u<16&&f!==0;)h|=e[t++]<<u,u+=8,f===1?f=e[t++]:--f;if(u<c)break;var b=h&d;if(h>>=c,u-=c,b!==s){if(b===o)break;for(var y=b<l?b:g,N=0,S=y;S>s;)S=x[S]>>8,++N;var _=S;if(m+N+(y!==b?1:0)>n)return void Ar.log("Warning, gif stream longer than expected.");r[m++]=_;var D=m+=N;for(y!==b&&(r[m++]=_),S=y;N--;)S=x[S],r[--D]=255&S,S>>=8;g!==null&&l<4096&&(x[l++]=g<<8|_,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=b}else l=o+1,d=(1<<(c=a+1))-1,g=null}return m!==n&&Ar.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ig(e){var t,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),h=new Array(65535),m=new Array(65535),f=new Array(64),x=new Array(64),g=[],b=0,y=7,N=new Array(64),S=new Array(64),_=new Array(64),D=new Array(256),I=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(w,A){for(var T=0,L=0,H=new Array,X=1;X<=16;X++){for(var re=1;re<=w[X];re++)H[A[L]]=[],H[A[L]][0]=T,H[A[L]][1]=X,L++,T++;T*=2}return H}function ee(w){for(var A=w[0],T=w[1]-1;T>=0;)A&1<<T&&(b|=1<<y),T--,--y<0&&(b==255?(me(255),me(0)):me(b),y=7,b=0)}function me(w){g.push(w)}function ye(w){me(w>>8&255),me(255&w)}function Oe(w,A,T,L,H){for(var X,re=H[0],ge=H[240],oe=function(we,Re){var He,vt,le,Ae,Qe,_e,Ze,Ve,ot,pt,yt=0;for(ot=0;ot<8;++ot){He=we[yt],vt=we[yt+1],le=we[yt+2],Ae=we[yt+3],Qe=we[yt+4],_e=we[yt+5],Ze=we[yt+6];var ir=He+(Ve=we[yt+7]),ct=He-Ve,ut=vt+Ze,Ot=vt-Ze,zt=le+_e,Dt=le-_e,Xt=Ae+Qe,$t=Ae-Qe,_r=ir+Xt,Fr=ir-Xt,ur=ut+zt,Ft=ut-zt;we[yt]=_r+ur,we[yt+4]=_r-ur;var nr=.707106781*(Ft+Fr);we[yt+2]=Fr+nr,we[yt+6]=Fr-nr;var Rs=.382683433*((_r=$t+Dt)-(Ft=Ot+ct)),an=.5411961*_r+Rs,Zn=1.306562965*Ft+Rs,ka=.707106781*(ur=Dt+Ot),Lt=ct+ka,Ua=ct-ka;we[yt+5]=Ua+an,we[yt+3]=Ua-an,we[yt+1]=Lt+Zn,we[yt+7]=Lt-Zn,yt+=8}for(yt=0,ot=0;ot<8;++ot){He=we[yt],vt=we[yt+8],le=we[yt+16],Ae=we[yt+24],Qe=we[yt+32],_e=we[yt+40],Ze=we[yt+48];var Wa=He+(Ve=we[yt+56]),Pn=He-Ve,Qn=vt+Ze,Cr=vt-Ze,Gr=le+_e,q=le-_e,ce=Ae+Qe,ae=Ae-Qe,ie=Wa+ce,de=Wa-ce,pe=Qn+Gr,Pe=Qn-Gr;we[yt]=ie+pe,we[yt+32]=ie-pe;var ze=.707106781*(Pe+de);we[yt+16]=de+ze,we[yt+48]=de-ze;var Le=.382683433*((ie=ae+q)-(Pe=Cr+Pn)),Fe=.5411961*ie+Le,G=1.306562965*Pe+Le,ke=.707106781*(pe=q+Cr),Be=Pn+ke,tt=Pn-ke;we[yt+40]=tt+Fe,we[yt+24]=tt-Fe,we[yt+8]=Be+G,we[yt+56]=Be-G,yt++}for(ot=0;ot<64;++ot)pt=we[ot]*Re[ot],f[ot]=pt>0?pt+.5|0:pt-.5|0;return f}(w,A),je=0;je<64;++je)x[O[je]]=oe[je];var Ie=x[0]-T;T=x[0],Ie==0?ee(L[0]):(ee(L[m[X=32767+Ie]]),ee(h[X]));for(var et=63;et>0&&x[et]==0;)et--;if(et==0)return ee(re),T;for(var Te,Y=1;Y<=et;){for(var We=Y;x[Y]==0&&Y<=et;)++Y;var Q=Y-We;if(Q>=16){Te=Q>>4;for(var ve=1;ve<=Te;++ve)ee(ge);Q&=15}X=32767+x[Y],ee(H[(Q<<4)+m[X]]),ee(h[X]),Y++}return et!=63&&ee(re),T}function xe(w){w=Math.min(Math.max(w,1),100),s!=w&&(function(A){for(var T=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var H=o((T[L]*A+50)/100);H=Math.min(Math.max(H,1),255),l[O[L]]=H}for(var X=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var ge=o((X[re]*A+50)/100);ge=Math.min(Math.max(ge,1),255),c[O[re]]=ge}for(var oe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],je=0,Ie=0;Ie<8;Ie++)for(var et=0;et<8;et++)d[je]=1/(l[O[je]]*oe[Ie]*oe[et]*8),u[je]=1/(c[O[je]]*oe[Ie]*oe[et]*8),je++}(w<50?Math.floor(5e3/w):Math.floor(200-2*w)),s=w)}this.encode=function(w,A){A&&xe(A),g=new Array,b=0,y=7,ye(65496),ye(65504),ye(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),ye(1),ye(1),me(0),me(0),function(){ye(65499),ye(132),me(0);for(var vt=0;vt<64;vt++)me(l[vt]);me(1);for(var le=0;le<64;le++)me(c[le])}(),function(vt,le){ye(65472),ye(17),me(8),ye(le),ye(vt),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)}(w.width,w.height),function(){ye(65476),ye(418),me(0);for(var vt=0;vt<16;vt++)me(R[vt+1]);for(var le=0;le<=11;le++)me(E[le]);me(16);for(var Ae=0;Ae<16;Ae++)me(B[Ae+1]);for(var Qe=0;Qe<=161;Qe++)me(C[Qe]);me(1);for(var _e=0;_e<16;_e++)me(M[_e+1]);for(var Ze=0;Ze<=11;Ze++)me(U[Ze]);me(17);for(var Ve=0;Ve<16;Ve++)me(F[Ve+1]);for(var ot=0;ot<=161;ot++)me(ne[ot])}(),ye(65498),ye(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var T=0,L=0,H=0;b=0,y=7,this.encode.displayName="_encode_";for(var X,re,ge,oe,je,Ie,et,Te,Y,We=w.data,Q=w.width,ve=w.height,we=4*Q,Re=0;Re<ve;){for(X=0;X<we;){for(je=we*Re+X,et=-1,Te=0,Y=0;Y<64;Y++)Ie=je+(Te=Y>>3)*we+(et=4*(7&Y)),Re+Te>=ve&&(Ie-=we*(Re+1+Te-ve)),X+et>=we&&(Ie-=X+et-we+4),re=We[Ie++],ge=We[Ie++],oe=We[Ie++],N[Y]=(I[re]+I[ge+256|0]+I[oe+512|0]>>16)-128,S[Y]=(I[re+768|0]+I[ge+1024|0]+I[oe+1280|0]>>16)-128,_[Y]=(I[re+1280|0]+I[ge+1536|0]+I[oe+1792|0]>>16)-128;T=Oe(N,d,T,t,n),L=Oe(S,u,L,r,a),H=Oe(_,u,H,r,a),X+=32}Re+=8}if(y>=0){var He=[];He[1]=y+1,He[0]=(1<<y+1)-1,ee(He)}return ye(65497),new Uint8Array(g)},e=e||50,function(){for(var w=String.fromCharCode,A=0;A<256;A++)D[A]=w(A)}(),t=V(R,E),r=V(M,U),n=V(B,C),a=V(F,ne),function(){for(var w=1,A=2,T=1;T<=15;T++){for(var L=w;L<A;L++)m[32767+L]=T,h[32767+L]=[],h[32767+L][1]=T,h[32767+L][0]=L;for(var H=-(A-1);H<=-w;H++)m[32767+H]=T,h[32767+H]=[],h[32767+H][1]=T,h[32767+H][0]=A-1+H;w<<=1,A<<=1}}(),function(){for(var w=0;w<256;w++)I[w]=19595*w,I[w+256|0]=38470*w,I[w+512|0]=7471*w+32768,I[w+768|0]=-11059*w,I[w+1024|0]=-21709*w,I[w+1280|0]=32768*w+8421375,I[w+1536|0]=-27439*w,I[w+1792|0]=-5329*w}(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function qs(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zy(e){function t(E){if(!E)throw Error("assert :P")}function r(E,B,C){for(var M=0;4>M;M++)if(E[B+M]!=C.charCodeAt(M))return!0;return!1}function n(E,B,C,M,U){for(var F=0;F<U;F++)E[B+F]=C[M+F]}function a(E,B,C,M){for(var U=0;U<M;U++)E[B+U]=C}function s(E){return new Int32Array(E)}function o(E,B){for(var C=[],M=0;M<E;M++)C.push(new B);return C}function l(E,B){var C=[];return function M(U,F,ne){for(var V=ne[F],ee=0;ee<V&&(U.push(ne.length>F+1?[]:new B),!(ne.length<F+1));ee++)M(U[ee],F+1,ne)}(C,0,E),C}var c=function(){var E=this;function B(p,v){for(var j=1<<v-1>>>0;p&j;)j>>>=1;return j?(p&j-1)+j:p}function C(p,v,j,P,z){t(!(P%j));do p[v+(P-=j)]=z;while(0<P)}function M(p,v,j,P,z){if(t(2328>=z),512>=z)var K=s(512);else if((K=s(z))==null)return 0;return function(Z,te,se,ue,Ne,Me){var fe,Se,De=te,Ye=1<<se,$e=s(16),Ge=s(16);for(t(Ne!=0),t(ue!=null),t(Z!=null),t(0<se),Se=0;Se<Ne;++Se){if(15<ue[Se])return 0;++$e[ue[Se]]}if($e[0]==Ne)return 0;for(Ge[1]=0,fe=1;15>fe;++fe){if($e[fe]>1<<fe)return 0;Ge[fe+1]=Ge[fe]+$e[fe]}for(Se=0;Se<Ne;++Se)fe=ue[Se],0<ue[Se]&&(Me[Ge[fe]++]=Se);if(Ge[15]==1)return(ue=new U).g=0,ue.value=Me[0],C(Z,De,1,Ye,ue),Ye;var Je,lt=-1,at=Ye-1,Et=0,_t=1,Vt=1,jt=1<<se;for(Se=0,fe=1,Ne=2;fe<=se;++fe,Ne<<=1){if(_t+=Vt<<=1,0>(Vt-=$e[fe]))return 0;for(;0<$e[fe];--$e[fe])(ue=new U).g=fe,ue.value=Me[Se++],C(Z,De+Et,Ne,jt,ue),Et=B(Et,fe)}for(fe=se+1,Ne=2;15>=fe;++fe,Ne<<=1){if(_t+=Vt<<=1,0>(Vt-=$e[fe]))return 0;for(;0<$e[fe];--$e[fe]){if(ue=new U,(Et&at)!=lt){for(De+=jt,Je=1<<(lt=fe)-se;15>lt&&!(0>=(Je-=$e[lt]));)++lt,Je<<=1;Ye+=jt=1<<(Je=lt-se),Z[te+(lt=Et&at)].g=Je+se,Z[te+lt].value=De-te-lt}ue.g=fe-se,ue.value=Me[Se++],C(Z,De+(Et>>se),Ne,jt,ue),Et=B(Et,fe)}}return _t!=2*Ge[15]-1?0:Ye}(p,v,j,P,z,K)}function U(){this.value=this.g=0}function F(){this.value=this.g=0}function ne(){this.G=o(5,U),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Nl,F)}function V(p,v,j,P){t(p!=null),t(v!=null),t(2147483648>P),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=v,p.pa=j,p.Jd=v,p.Yc=j+P,p.Zc=4<=P?j+P-4+1:j,re(p)}function ee(p,v){for(var j=0;0<v--;)j|=oe(p,128)<<v;return j}function me(p,v){var j=ee(p,v);return ge(p)?-j:j}function ye(p,v,j,P){var z,K=0;for(t(p!=null),t(v!=null),t(4294967288>P),p.Sb=P,p.Ra=0,p.u=0,p.h=0,4<P&&(P=4),z=0;z<P;++z)K+=v[j+z]<<8*z;p.Ra=K,p.bb=P,p.oa=v,p.pa=j}function Oe(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<No-8>>>0,++p.bb,p.u-=8;L(p)&&(p.h=1,p.u=0)}function xe(p,v){if(t(0<=v),!p.h&&v<=qa){var j=T(p)&Ha[v];return p.u+=v,Oe(p),j}return p.h=1,p.u=0}function w(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function T(p){return p.Ra>>>(p.u&No-1)>>>0}function L(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>No}function H(p,v){p.u=v,p.h=L(p)}function X(p){p.u>=Bi&&(t(p.u>=Bi),Oe(p))}function re(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function ge(p){return ee(p,1)}function oe(p,v){var j=p.Ca;0>p.b&&re(p);var P=p.b,z=j*v>>>8,K=(p.I>>>P>z)+0;for(K?(j-=z,p.I-=z+1<<P>>>0):j=z+1,P=j,z=0;256<=P;)z+=8,P>>=8;return P=7^z+ko[P],p.b-=P,p.Ca=(j<<P)-1,K}function je(p,v,j){p[v+0]=j>>24&255,p[v+1]=j>>16&255,p[v+2]=j>>8&255,p[v+3]=255&j}function Ie(p,v){return p[v+0]|p[v+1]<<8}function et(p,v){return Ie(p,v)|p[v+2]<<16}function Te(p,v){return Ie(p,v)|Ie(p,v+2)<<16}function Y(p,v){var j=1<<v;return t(p!=null),t(0<v),p.X=s(j),p.X==null?0:(p.Mb=32-v,p.Xa=v,1)}function We(p,v){t(p!=null),t(v!=null),t(p.Xa==v.Xa),n(v.X,0,p.X,0,1<<v.Xa)}function Q(){this.X=[],this.Xa=this.Mb=0}function ve(p,v,j,P){t(j!=null),t(P!=null);var z=j[0],K=P[0];return z==0&&(z=(p*K+v/2)/v),K==0&&(K=(v*z+p/2)/p),0>=z||0>=K?0:(j[0]=z,P[0]=K,1)}function we(p,v){return p+(1<<v)-1>>>v}function Re(p,v){return((4278255360&p)+(4278255360&v)>>>0&4278255360)+((16711935&p)+(16711935&v)>>>0&16711935)>>>0}function He(p,v){E[v]=function(j,P,z,K,Z,te,se){var ue;for(ue=0;ue<Z;++ue){var Ne=E[p](te[se+ue-1],z,K+ue);te[se+ue]=Re(j[P+ue],Ne)}}}function vt(){this.ud=this.hd=this.jd=0}function le(p,v){return((4278124286&(p^v))>>>1)+(p&v)>>>0}function Ae(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function Qe(p,v){return Ae(p+(p-v+.5>>1))}function _e(p,v,j){return Math.abs(v-j)-Math.abs(p-j)}function Ze(p,v,j,P,z,K,Z){for(P=K[Z-1],j=0;j<z;++j)K[Z+j]=P=Re(p[v+j],P)}function Ve(p,v,j,P,z){var K;for(K=0;K<j;++K){var Z=p[v+K],te=Z>>8&255,se=16711935&(se=(se=16711935&Z)+((te<<16)+te));P[z+K]=(4278255360&Z)+se>>>0}}function ot(p,v){v.jd=255&p,v.hd=p>>8&255,v.ud=p>>16&255}function pt(p,v,j,P,z,K){var Z;for(Z=0;Z<P;++Z){var te=v[j+Z],se=te>>>8,ue=te,Ne=255&(Ne=(Ne=te>>>16)+((p.jd<<24>>24)*(se<<24>>24)>>>5));ue=255&(ue=(ue+=(p.hd<<24>>24)*(se<<24>>24)>>>5)+((p.ud<<24>>24)*(Ne<<24>>24)>>>5)),z[K+Z]=(4278255360&te)+(Ne<<16)+ue}}function yt(p,v,j,P,z){E[v]=function(K,Z,te,se,ue,Ne,Me,fe,Se){for(se=Me;se<fe;++se)for(Me=0;Me<Se;++Me)ue[Ne++]=z(te[P(K[Z++])])},E[p]=function(K,Z,te,se,ue,Ne,Me){var fe=8>>K.b,Se=K.Ea,De=K.K[0],Ye=K.w;if(8>fe)for(K=(1<<K.b)-1,Ye=(1<<fe)-1;Z<te;++Z){var $e,Ge=0;for($e=0;$e<Se;++$e)$e&K||(Ge=P(se[ue++])),Ne[Me++]=z(De[Ge&Ye]),Ge>>=fe}else E["VP8LMapColor"+j](se,ue,De,Ye,Ne,Me,Z,te,Se)}}function ir(p,v,j,P,z){for(j=v+j;v<j;){var K=p[v++];P[z++]=K>>16&255,P[z++]=K>>8&255,P[z++]=255&K}}function ct(p,v,j,P,z){for(j=v+j;v<j;){var K=p[v++];P[z++]=K>>16&255,P[z++]=K>>8&255,P[z++]=255&K,P[z++]=K>>24&255}}function ut(p,v,j,P,z){for(j=v+j;v<j;){var K=(Z=p[v++])>>16&240|Z>>12&15,Z=240&Z|Z>>28&15;P[z++]=K,P[z++]=Z}}function Ot(p,v,j,P,z){for(j=v+j;v<j;){var K=(Z=p[v++])>>16&248|Z>>13&7,Z=Z>>5&224|Z>>3&31;P[z++]=K,P[z++]=Z}}function zt(p,v,j,P,z){for(j=v+j;v<j;){var K=p[v++];P[z++]=255&K,P[z++]=K>>8&255,P[z++]=K>>16&255}}function Dt(p,v,j,P,z,K){if(K==0)for(j=v+j;v<j;)je(P,((K=p[v++])[0]>>24|K[1]>>8&65280|K[2]<<8&16711680|K[3]<<24)>>>0),z+=32;else n(P,z,p,v,j)}function Xt(p,v){E[v][0]=E[p+"0"],E[v][1]=E[p+"1"],E[v][2]=E[p+"2"],E[v][3]=E[p+"3"],E[v][4]=E[p+"4"],E[v][5]=E[p+"5"],E[v][6]=E[p+"6"],E[v][7]=E[p+"7"],E[v][8]=E[p+"8"],E[v][9]=E[p+"9"],E[v][10]=E[p+"10"],E[v][11]=E[p+"11"],E[v][12]=E[p+"12"],E[v][13]=E[p+"13"],E[v][14]=E[p+"0"],E[v][15]=E[p+"0"]}function $t(p){return p==sp||p==ip||p==Yf||p==op}function _r(){this.eb=[],this.size=this.A=this.fb=0}function Fr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ur(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _r,this.f.kb=new Fr,this.sd=null}function Ft(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function nr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Rs(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function an(p,v){var j=p.T,P=v.ba.f.RGBA,z=P.eb,K=P.fb+p.ka*P.A,Z=ms[v.ba.S],te=p.y,se=p.O,ue=p.f,Ne=p.N,Me=p.ea,fe=p.W,Se=v.cc,De=v.dc,Ye=v.Mc,$e=v.Nc,Ge=p.ka,Je=p.ka+p.T,lt=p.U,at=lt+1>>1;for(Ge==0?Z(te,se,null,null,ue,Ne,Me,fe,ue,Ne,Me,fe,z,K,null,null,lt):(Z(v.ec,v.fc,te,se,Se,De,Ye,$e,ue,Ne,Me,fe,z,K-P.A,z,K,lt),++j);Ge+2<Je;Ge+=2)Se=ue,De=Ne,Ye=Me,$e=fe,Ne+=p.Rc,fe+=p.Rc,K+=2*P.A,Z(te,(se+=2*p.fa)-p.fa,te,se,Se,De,Ye,$e,ue,Ne,Me,fe,z,K-P.A,z,K,lt);return se+=p.fa,p.j+Je<p.o?(n(v.ec,v.fc,te,se,lt),n(v.cc,v.dc,ue,Ne,at),n(v.Mc,v.Nc,Me,fe,at),j--):1&Je||Z(te,se,null,null,ue,Ne,Me,fe,ue,Ne,Me,fe,z,K+P.A,null,null,lt),j}function Zn(p,v,j){var P=p.F,z=[p.J];if(P!=null){var K=p.U,Z=v.ba.S,te=Z==qf||Z==Yf;v=v.ba.f.RGBA;var se=[0],ue=p.ka;se[0]=p.T,p.Kb&&(ue==0?--se[0]:(--ue,z[0]-=p.width),p.j+p.ka+p.T==p.o&&(se[0]=p.o-p.j-ue));var Ne=v.eb;ue=v.fb+ue*v.A,p=$2(P,z[0],p.width,K,se,Ne,ue+(te?0:3),v.A),t(j==se),p&&$t(Z)&&Vd(Ne,ue,te,K,se,v.A)}return 0}function ka(p){var v=p.ma,j=v.ba.S,P=11>j,z=j==zf||j==Hf||j==qf||j==ap||j==12||$t(j);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Id(v.Oa,p,z?11:12))return 0;if(z&&$t(j)&&Rf(),p.da)alert("todo:use_scaling");else{if(P){if(v.Ib=Rs,p.Kb){if(j=p.U+1>>1,v.memory=s(p.U+2*j),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+p.U,v.Mc=v.cc,v.Nc=v.dc+j,v.Ib=an,Rf()}}else alert("todo:EmitYUV");z&&(v.Jb=Zn,P&&ds())}if(P&&!Z2){for(p=0;256>p;++p)b6[p]=89858*(p-128)+Gf>>Vf,_6[p]=-22014*(p-128)+Gf,w6[p]=-45773*(p-128),y6[p]=113618*(p-128)+Gf>>Vf;for(p=Kd;p<dp;++p)v=76283*(p-16)+Gf>>Vf,N6[p-Kd]=Kr(v,255),k6[p-Kd]=Kr(v+8>>4,15);Z2=1}return 1}function Lt(p){var v=p.ma,j=p.U,P=p.T;return t(!(1&p.ka)),0>=j||0>=P?0:(j=v.Ib(p,v),v.Jb!=null&&v.Jb(p,v,j),v.Dc+=j,1)}function Ua(p){p.ma.memory=null}function Wa(p,v,j,P){return xe(p,8)!=47?0:(v[0]=xe(p,14)+1,j[0]=xe(p,14)+1,P[0]=xe(p,1),xe(p,3)!=0?0:!p.h)}function Pn(p,v){if(4>p)return p+1;var j=p-2>>1;return(2+(1&p)<<j)+xe(v,j)+1}function Qn(p,v){return 120<v?v-120:1<=(j=((j=s6[v-1])>>4)*p+(8-(15&j)))?j:1;var j}function Cr(p,v,j){var P=T(j),z=p[v+=255&P].g-8;return 0<z&&(H(j,j.u+8),P=T(j),v+=p[v].value,v+=P&(1<<z)-1),H(j,j.u+p[v].g),p[v].value}function Gr(p,v,j){return j.g+=p.g,j.value+=p.value<<v>>>0,t(8>=j.g),p.g}function q(p,v,j){var P=p.xc;return t((v=P==0?0:p.vc[p.md*(j>>P)+(v>>P)])<p.Wb),p.Ya[v]}function ce(p,v,j,P){var z=p.ab,K=p.c*v,Z=p.C;v=Z+v;var te=j,se=P;for(P=p.Ta,j=p.Ua;0<z--;){var ue=p.gc[z],Ne=Z,Me=v,fe=te,Se=se,De=(se=P,te=j,ue.Ea);switch(t(Ne<Me),t(Me<=ue.nc),ue.hc){case 2:on(fe,Se,(Me-Ne)*De,se,te);break;case 0:var Ye=Ne,$e=Me,Ge=se,Je=te,lt=(jt=ue).Ea;Ye==0&&(Ud(fe,Se,null,null,1,Ge,Je),Ze(fe,Se+1,0,0,lt-1,Ge,Je+1),Se+=lt,Je+=lt,++Ye);for(var at=1<<jt.b,Et=at-1,_t=we(lt,jt.b),Vt=jt.K,jt=jt.w+(Ye>>jt.b)*_t;Ye<$e;){var tr=Vt,Sn=jt,Gt=1;for(vc(fe,Se,Ge,Je-lt,1,Ge,Je);Gt<lt;){var Tt=(Gt&~Et)+at;Tt>lt&&(Tt=lt),(0,zd[tr[Sn++]>>8&15])(fe,Se+ +Gt,Ge,Je+Gt-lt,Tt-Gt,Ge,Je+Gt),Gt=Tt}Se+=lt,Je+=lt,++Ye&Et||(jt+=_t)}Me!=ue.nc&&n(se,te-De,se,te+(Me-Ne-1)*De,De);break;case 1:for(De=fe,$e=Se,lt=(fe=ue.Ea)-(Je=fe&~(Ge=(Se=1<<ue.b)-1)),Ye=we(fe,ue.b),at=ue.K,ue=ue.w+(Ne>>ue.b)*Ye;Ne<Me;){for(Et=at,_t=ue,Vt=new vt,jt=$e+Je,tr=$e+fe;$e<jt;)ot(Et[_t++],Vt),Hd(Vt,De,$e,Se,se,te),$e+=Se,te+=Se;$e<tr&&(ot(Et[_t++],Vt),Hd(Vt,De,$e,lt,se,te),$e+=lt,te+=lt),++Ne&Ge||(ue+=Ye)}break;case 3:if(fe==se&&Se==te&&0<ue.b){for($e=se,fe=De=te+(Me-Ne)*De-(Je=(Me-Ne)*we(ue.Ea,ue.b)),Se=se,Ge=te,Ye=[],Je=(lt=Je)-1;0<=Je;--Je)Ye[Je]=Se[Ge+Je];for(Je=lt-1;0<=Je;--Je)$e[fe+Je]=Ye[Je];If(ue,Ne,Me,se,De,se,te)}else If(ue,Ne,Me,fe,Se,se,te)}te=P,se=j}se!=j&&n(P,j,te,se,K)}function ae(p,v){var j=p.V,P=p.Ba+p.c*p.C,z=v-p.C;if(t(v<=p.l.o),t(16>=z),0<z){var K=p.l,Z=p.Ta,te=p.Ua,se=K.width;if(ce(p,z,j,P),z=te=[te],t((j=p.C)<(P=v)),t(K.v<K.va),P>K.o&&(P=K.o),j<K.j){var ue=K.j-j;j=K.j,z[0]+=ue*se}if(j>=P?j=0:(z[0]+=4*K.v,K.ka=j-K.j,K.U=K.va-K.v,K.T=P-j,j=1),j){if(te=te[0],11>(j=p.ca).S){var Ne=j.f.RGBA,Me=(P=j.S,z=K.U,K=K.T,ue=Ne.eb,Ne.A),fe=K;for(Ne=Ne.fb+p.Ma*Ne.A;0<fe--;){var Se=Z,De=te,Ye=z,$e=ue,Ge=Ne;switch(P){case Wf:qd(Se,De,Ye,$e,Ge);break;case zf:So(Se,De,Ye,$e,Ge);break;case sp:So(Se,De,Ye,$e,Ge),Vd($e,Ge,0,Ye,1,0);break;case z2:kl(Se,De,Ye,$e,Ge);break;case Hf:Dt(Se,De,Ye,$e,Ge,1);break;case ip:Dt(Se,De,Ye,$e,Ge,1),Vd($e,Ge,0,Ye,1,0);break;case qf:Dt(Se,De,Ye,$e,Ge,0);break;case Yf:Dt(Se,De,Ye,$e,Ge,0),Vd($e,Ge,1,Ye,1,0);break;case ap:jo(Se,De,Ye,$e,Ge);break;case op:jo(Se,De,Ye,$e,Ge),F2($e,Ge,Ye,1,0);break;case H2:To(Se,De,Ye,$e,Ge);break;default:t(0)}te+=se,Ne+=Me}p.Ma+=K}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=j.height)}}p.C=v,t(p.C<=p.i)}function ie(p){var v;if(0<p.ua)return 0;for(v=0;v<p.Wb;++v){var j=p.Ya[v].G,P=p.Ya[v].H;if(0<j[1][P[1]+0].g||0<j[2][P[2]+0].g||0<j[3][P[3]+0].g)return 0}return 1}function de(p,v,j,P,z,K){if(p.Z!=0){var Z=p.qd,te=p.rd;for(t(Co[p.Z]!=null);v<j;++v)Co[p.Z](Z,te,P,z,P,z,K),Z=P,te=z,z+=K;p.qd=Z,p.rd=te}}function pe(p,v){var j=p.l.ma,P=j.Z==0||j.Z==1?p.l.j:p.C;if(P=p.C<P?P:p.C,t(v<=p.l.o),v>P){var z=p.l.width,K=j.ca,Z=j.tb+z*P,te=p.V,se=p.Ba+p.c*P,ue=p.gc;t(p.ab==1),t(ue[0].hc==3),ci(ue[0],P,v,te,se,K,Z),de(j,P,v,K,Z,z)}p.C=p.Ma=v}function Pe(p,v,j,P,z,K,Z){var te=p.$/P,se=p.$%P,ue=p.m,Ne=p.s,Me=j+p.$,fe=Me;z=j+P*z;var Se=j+P*K,De=280+Ne.ua,Ye=p.Pb?te:16777216,$e=0<Ne.ua?Ne.Wa:null,Ge=Ne.wc,Je=Me<Se?q(Ne,se,te):null;t(p.C<K),t(Se<=z);var lt=!1;e:for(;;){for(;lt||Me<Se;){var at=0;if(te>=Ye){var Et=Me-j;t((Ye=p).Pb),Ye.wd=Ye.m,Ye.xd=Et,0<Ye.s.ua&&We(Ye.s.Wa,Ye.s.vb),Ye=te+o6}if(se&Ge||(Je=q(Ne,se,te)),t(Je!=null),Je.Qb&&(v[Me]=Je.qb,lt=!0),!lt)if(X(ue),Je.jc){at=ue,Et=v;var _t=Me,Vt=Je.pd[T(at)&Nl-1];t(Je.jc),256>Vt.g?(H(at,at.u+Vt.g),Et[_t]=Vt.value,at=0):(H(at,at.u+Vt.g-256),t(256<=Vt.value),at=Vt.value),at==0&&(lt=!0)}else at=Cr(Je.G[0],Je.H[0],ue);if(ue.h)break;if(lt||256>at){if(!lt)if(Je.nd)v[Me]=(Je.qb|at<<8)>>>0;else{if(X(ue),lt=Cr(Je.G[1],Je.H[1],ue),X(ue),Et=Cr(Je.G[2],Je.H[2],ue),_t=Cr(Je.G[3],Je.H[3],ue),ue.h)break;v[Me]=(_t<<24|lt<<16|at<<8|Et)>>>0}if(lt=!1,++Me,++se>=P&&(se=0,++te,Z!=null&&te<=K&&!(te%16)&&Z(p,te),$e!=null))for(;fe<Me;)at=v[fe++],$e.X[(506832829*at&4294967295)>>>$e.Mb]=at}else if(280>at){if(at=Pn(at-256,ue),Et=Cr(Je.G[4],Je.H[4],ue),X(ue),Et=Qn(P,Et=Pn(Et,ue)),ue.h)break;if(Me-j<Et||z-Me<at)break e;for(_t=0;_t<at;++_t)v[Me+_t]=v[Me+_t-Et];for(Me+=at,se+=at;se>=P;)se-=P,++te,Z!=null&&te<=K&&!(te%16)&&Z(p,te);if(t(Me<=z),se&Ge&&(Je=q(Ne,se,te)),$e!=null)for(;fe<Me;)at=v[fe++],$e.X[(506832829*at&4294967295)>>>$e.Mb]=at}else{if(!(at<De))break e;for(lt=at-280,t($e!=null);fe<Me;)at=v[fe++],$e.X[(506832829*at&4294967295)>>>$e.Mb]=at;at=Me,t(!(lt>>>(Et=$e).Xa)),v[at]=Et.X[lt],lt=!0}lt||t(ue.h==L(ue))}if(p.Pb&&ue.h&&Me<z)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&We(p.s.vb,p.s.Wa);else{if(ue.h)break e;Z!=null&&Z(p,te>K?K:te),p.a=0,p.$=Me-j}return 1}return p.a=3,0}function ze(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var v=p.Wa;v!=null&&(v.X=null),p.vb=null,t(p!=null)}function Le(){var p=new At;return p==null?null:(p.a=0,p.xb=V2,Xt("Predictor","VP8LPredictors"),Xt("Predictor","VP8LPredictors_C"),Xt("PredictorAdd","VP8LPredictorsAdd"),Xt("PredictorAdd","VP8LPredictorsAdd_C"),on=Ve,Hd=pt,qd=ir,So=ct,jo=ut,To=Ot,kl=zt,E.VP8LMapColor32b=li,E.VP8LMapColor8b=Wd,p)}function Fe(p,v,j,P,z){var K=1,Z=[p],te=[v],se=P.m,ue=P.s,Ne=null,Me=0;e:for(;;){if(j)for(;K&&xe(se,1);){var fe=Z,Se=te,De=P,Ye=1,$e=De.m,Ge=De.gc[De.ab],Je=xe($e,2);if(De.Oc&1<<Je)K=0;else{switch(De.Oc|=1<<Je,Ge.hc=Je,Ge.Ea=fe[0],Ge.nc=Se[0],Ge.K=[null],++De.ab,t(4>=De.ab),Je){case 0:case 1:Ge.b=xe($e,3)+2,Ye=Fe(we(Ge.Ea,Ge.b),we(Ge.nc,Ge.b),0,De,Ge.K),Ge.K=Ge.K[0];break;case 3:var lt,at=xe($e,8)+1,Et=16<at?0:4<at?1:2<at?2:3;if(fe[0]=we(Ge.Ea,Et),Ge.b=Et,lt=Ye=Fe(at,1,0,De,Ge.K)){var _t,Vt=at,jt=Ge,tr=1<<(8>>jt.b),Sn=s(tr);if(Sn==null)lt=0;else{var Gt=jt.K[0],Tt=jt.w;for(Sn[0]=jt.K[0][0],_t=1;_t<1*Vt;++_t)Sn[_t]=Re(Gt[Tt+_t],Sn[_t-1]);for(;_t<4*tr;++_t)Sn[_t]=0;jt.K[0]=null,jt.K[0]=Sn,lt=1}}Ye=lt;break;case 2:break;default:t(0)}K=Ye}}if(Z=Z[0],te=te[0],K&&xe(se,1)&&!(K=1<=(Me=xe(se,4))&&11>=Me)){P.a=3;break e}var gt;if(gt=K)t:{var cn,qt,ar,Rr=P,Bn=Z,xa=te,Xr=Me,ra=j,va=Rr.m,jn=Rr.s,or=[null],pr=1,Jr=0,gr=i6[Xr];r:for(;;){if(ra&&xe(va,1)){var Un=xe(va,3)+2,Us=we(Bn,Un),dn=we(xa,Un),ja=Us*dn;if(!Fe(Us,dn,0,Rr,or))break r;for(or=or[0],jn.xc=Un,cn=0;cn<ja;++cn){var Tr=or[cn]>>8&65535;or[cn]=Tr,Tr>=pr&&(pr=Tr+1)}}if(va.h)break r;for(qt=0;5>qt;++qt){var Tn=q2[qt];!qt&&0<Xr&&(Tn+=1<<Xr),Jr<Tn&&(Jr=Tn)}var Va=o(pr*gr,U),ba=pr,Ga=o(ba,ne);if(Ga==null)var Ka=null;else t(65536>=ba),Ka=Ga;var Ta=s(Jr);if(Ka==null||Ta==null||Va==null){Rr.a=1;break r}var Xa=Va;for(cn=ar=0;cn<pr;++cn){var Or=Ka[cn],Ja=Or.G,Ws=Or.H,jl=0,zi=1,Wn=0;for(qt=0;5>qt;++qt){Tn=q2[qt],Ja[qt]=Xa,Ws[qt]=ar,!qt&&0<Xr&&(Tn+=1<<Xr);a:{var Xf,up=Tn,Jf=Rr,Xd=Ta,T6=Xa,A6=ar,fp=0,Do=Jf.m,E6=xe(Do,1);if(a(Xd,0,0,up),E6){var C6=xe(Do,1)+1,D6=xe(Do,1),tv=xe(Do,D6==0?1:8);Xd[tv]=1,C6==2&&(Xd[tv=xe(Do,8)]=1);var Zf=1}else{var rv=s(19),nv=xe(Do,4)+4;if(19<nv){Jf.a=3;var Qf=0;break a}for(Xf=0;Xf<nv;++Xf)rv[a6[Xf]]=xe(Do,3);var hp=void 0,Jd=void 0,av=Jf,O6=rv,eh=up,sv=Xd,mp=0,Oo=av.m,iv=8,ov=o(128,U);n:for(;M(ov,0,7,O6,19);){if(xe(Oo,1)){var P6=2+2*xe(Oo,3);if((hp=2+xe(Oo,P6))>eh)break n}else hp=eh;for(Jd=0;Jd<eh&&hp--;){X(Oo);var lv=ov[0+(127&T(Oo))];H(Oo,Oo.u+lv.g);var yc=lv.value;if(16>yc)sv[Jd++]=yc,yc!=0&&(iv=yc);else{var L6=yc==16,cv=yc-16,F6=r6[cv],dv=xe(Oo,t6[cv])+F6;if(Jd+dv>eh)break n;for(var $6=L6?iv:0;0<dv--;)sv[Jd++]=$6}}mp=1;break n}mp||(av.a=3),Zf=mp}(Zf=Zf&&!Do.h)&&(fp=M(T6,A6,8,Xd,up)),Zf&&fp!=0?Qf=fp:(Jf.a=3,Qf=0)}if(Qf==0)break r;if(zi&&n6[qt]==1&&(zi=Xa[ar].g==0),jl+=Xa[ar].g,ar+=Qf,3>=qt){var Zd,pp=Ta[0];for(Zd=1;Zd<Tn;++Zd)Ta[Zd]>pp&&(pp=Ta[Zd]);Wn+=pp}}if(Or.nd=zi,Or.Qb=0,zi&&(Or.qb=(Ja[3][Ws[3]+0].value<<24|Ja[1][Ws[1]+0].value<<16|Ja[2][Ws[2]+0].value)>>>0,jl==0&&256>Ja[0][Ws[0]+0].value&&(Or.Qb=1,Or.qb+=Ja[0][Ws[0]+0].value<<8)),Or.jc=!Or.Qb&&6>Wn,Or.jc){var th,Hi=Or;for(th=0;th<Nl;++th){var Po=th,Lo=Hi.pd[Po],rh=Hi.G[0][Hi.H[0]+Po];256<=rh.value?(Lo.g=rh.g+256,Lo.value=rh.value):(Lo.g=0,Lo.value=0,Po>>=Gr(rh,8,Lo),Po>>=Gr(Hi.G[1][Hi.H[1]+Po],16,Lo),Po>>=Gr(Hi.G[2][Hi.H[2]+Po],0,Lo),Gr(Hi.G[3][Hi.H[3]+Po],24,Lo))}}}jn.vc=or,jn.Wb=pr,jn.Ya=Ka,jn.yc=Va,gt=1;break t}gt=0}if(!(K=gt)){P.a=3;break e}if(0<Me){if(ue.ua=1<<Me,!Y(ue.Wa,Me)){P.a=1,K=0;break e}}else ue.ua=0;var gp=P,uv=Z,R6=te,xp=gp.s,vp=xp.xc;if(gp.c=uv,gp.i=R6,xp.md=we(uv,vp),xp.wc=vp==0?-1:(1<<vp)-1,j){P.xb=m6;break e}if((Ne=s(Z*te))==null){P.a=1,K=0;break e}K=(K=Pe(P,Ne,0,Z,te,te,null))&&!se.h;break e}return K?(z!=null?z[0]=Ne:(t(Ne==null),t(j)),P.$=0,j||ze(ue)):ze(ue),K}function G(p,v){var j=p.c*p.i,P=j+v+16*v;return t(p.c<=v),p.V=s(P),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+j+v,1)}function ke(p,v){var j=p.C,P=v-j,z=p.V,K=p.Ba+p.c*j;for(t(v<=p.l.o);0<P;){var Z=16<P?16:P,te=p.l.ma,se=p.l.width,ue=se*Z,Ne=te.ca,Me=te.tb+se*j,fe=p.Ta,Se=p.Ua;ce(p,Z,z,K),R2(fe,Se,Ne,Me,ue),de(te,j,j+Z,Ne,Me,se),P-=Z,z+=Z*p.c,j+=Z}t(j==v),p.C=p.Ma=v}function Be(){this.ub=this.yd=this.td=this.Rb=0}function tt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Xe(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function rt(){this.Yb=function(){var p=[];return function v(j,P,z){for(var K=z[P],Z=0;Z<K&&(j.push(z.length>P+1?[]:0),!(z.length<P+1));Z++)v(j[Z],P+1,z)}(p,0,[3,11]),p}()}function Nt(){this.jb=s(3),this.Wc=l([4,8],rt),this.Xc=l([4,17],rt)}function Zt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ht(){this.ld=this.La=this.dd=this.tc=0}function $r(){this.Na=this.la=0}function za(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ms(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ii(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ht),this.Y=0,this.ya=Array(new Ms),this.aa=0,this.l=new ea}function cs(){this.y=s(16),this.f=s(8),this.ea=s(8)}function vo(){this.cb=this.a=0,this.sc="",this.m=new w,this.Od=new Be,this.Kc=new tt,this.ed=new Zt,this.Qa=new Xe,this.Ic=this.$c=this.Aa=0,this.D=new ii,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,w),this.ia=0,this.pb=o(4,za),this.Pa=new Nt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new cs),this.Hd=0,this.rb=Array(new $r),this.sb=0,this.wa=Array(new Ht),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ms),this.L=this.aa=0,this.gd=l([4,2],Ht),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ea(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wm(){var p=new vo;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Gd||(Gd=Li)),p}function gn(p,v,j){return p.a==0&&(p.a=v,p.sc=j,p.cb=0),0}function Af(p,v,j){return 3<=j&&p[v+0]==157&&p[v+1]==1&&p[v+2]==42}function Ef(p,v){if(p==null)return 0;if(p.a=0,p.sc="OK",v==null)return gn(p,2,"null VP8Io passed to VP8GetHeaders()");var j=v.data,P=v.w,z=v.ha;if(4>z)return gn(p,7,"Truncated header.");var K=j[P+0]|j[P+1]<<8|j[P+2]<<16,Z=p.Od;if(Z.Rb=!(1&K),Z.td=K>>1&7,Z.yd=K>>4&1,Z.ub=K>>5,3<Z.td)return gn(p,3,"Incorrect keyframe parameters.");if(!Z.yd)return gn(p,4,"Frame not displayable.");P+=3,z-=3;var te=p.Kc;if(Z.Rb){if(7>z)return gn(p,7,"cannot parse picture header");if(!Af(j,P,z))return gn(p,3,"Bad code word");te.c=16383&(j[P+4]<<8|j[P+3]),te.Td=j[P+4]>>6,te.i=16383&(j[P+6]<<8|j[P+5]),te.Ud=j[P+6]>>6,P+=7,z-=7,p.za=te.c+15>>4,p.Ub=te.i+15>>4,v.width=te.c,v.height=te.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,a((K=p.Pa).jb,0,255,K.jb.length),t((K=p.Qa)!=null),K.Cb=0,K.Bb=0,K.Fb=1,a(K.Zb,0,0,K.Zb.length),a(K.Lb,0,0,K.Lb)}if(Z.ub>z)return gn(p,7,"bad partition length");V(K=p.m,j,P,Z.ub),P+=Z.ub,z-=Z.ub,Z.Rb&&(te.Ld=ge(K),te.Kd=ge(K)),te=p.Qa;var se,ue=p.Pa;if(t(K!=null),t(te!=null),te.Cb=ge(K),te.Cb){if(te.Bb=ge(K),ge(K)){for(te.Fb=ge(K),se=0;4>se;++se)te.Zb[se]=ge(K)?me(K,7):0;for(se=0;4>se;++se)te.Lb[se]=ge(K)?me(K,6):0}if(te.Bb)for(se=0;3>se;++se)ue.jb[se]=ge(K)?ee(K,8):255}else te.Bb=0;if(K.Ka)return gn(p,3,"cannot parse segment header");if((te=p.ed).zd=ge(K),te.Tb=ee(K,6),te.wb=ee(K,3),te.Pc=ge(K),te.Pc&&ge(K)){for(ue=0;4>ue;++ue)ge(K)&&(te.vd[ue]=me(K,6));for(ue=0;4>ue;++ue)ge(K)&&(te.od[ue]=me(K,6))}if(p.L=te.Tb==0?0:te.zd?1:2,K.Ka)return gn(p,3,"cannot parse filter header");var Ne=z;if(z=se=P,P=se+Ne,te=Ne,p.Xb=(1<<ee(p.m,2))-1,Ne<3*(ue=p.Xb))j=7;else{for(se+=3*ue,te-=3*ue,Ne=0;Ne<ue;++Ne){var Me=j[z+0]|j[z+1]<<8|j[z+2]<<16;Me>te&&(Me=te),V(p.Jc[+Ne],j,se,Me),se+=Me,te-=Me,z+=3}V(p.Jc[+ue],j,se,te),j=se<P?0:5}if(j!=0)return gn(p,j,"cannot parse partitions");for(j=ee(se=p.m,7),z=ge(se)?me(se,4):0,P=ge(se)?me(se,4):0,te=ge(se)?me(se,4):0,ue=ge(se)?me(se,4):0,se=ge(se)?me(se,4):0,Ne=p.Qa,Me=0;4>Me;++Me){if(Ne.Cb){var fe=Ne.Zb[Me];Ne.Fb||(fe+=j)}else{if(0<Me){p.pb[Me]=p.pb[0];continue}fe=j}var Se=p.pb[Me];Se.Sc[0]=lp[Kr(fe+z,127)],Se.Sc[1]=cp[Kr(fe+0,127)],Se.Eb[0]=2*lp[Kr(fe+P,127)],Se.Eb[1]=101581*cp[Kr(fe+te,127)]>>16,8>Se.Eb[1]&&(Se.Eb[1]=8),Se.Qc[0]=lp[Kr(fe+ue,117)],Se.Qc[1]=cp[Kr(fe+se,127)],Se.lc=fe+se}if(!Z.Rb)return gn(p,4,"Not a key frame.");for(ge(K),Z=p.Pa,j=0;4>j;++j){for(z=0;8>z;++z)for(P=0;3>P;++P)for(te=0;11>te;++te)ue=oe(K,f6[j][z][P][te])?ee(K,8):d6[j][z][P][te],Z.Wc[j][z].Yb[P][te]=ue;for(z=0;17>z;++z)Z.Xc[j][z]=Z.Wc[j][h6[z]]}return p.kc=ge(K),p.kc&&(p.Bd=ee(K,8)),p.cb=1}function Li(p,v,j,P,z,K,Z){var te=v[z].Yb[j];for(j=0;16>z;++z){if(!oe(p,te[j+0]))return z;for(;!oe(p,te[j+1]);)if(te=v[++z].Yb[0],j=0,z==16)return 16;var se=v[z+1].Yb;if(oe(p,te[j+2])){var ue=p,Ne=0;if(oe(ue,(fe=te)[(Me=j)+3]))if(oe(ue,fe[Me+6])){for(te=0,Me=2*(Ne=oe(ue,fe[Me+8]))+(fe=oe(ue,fe[Me+9+Ne])),Ne=0,fe=l6[Me];fe[te];++te)Ne+=Ne+oe(ue,fe[te]);Ne+=3+(8<<Me)}else oe(ue,fe[Me+7])?(Ne=7+2*oe(ue,165),Ne+=oe(ue,145)):Ne=5+oe(ue,159);else Ne=oe(ue,fe[Me+4])?3+oe(ue,fe[Me+5]):2;te=se[2]}else Ne=1,te=se[1];se=Z+c6[z],0>(ue=p).b&&re(ue);var Me,fe=ue.b,Se=(Me=ue.Ca>>1)-(ue.I>>fe)>>31;--ue.b,ue.Ca+=Se,ue.Ca|=1,ue.I-=(Me+1&Se)<<fe,K[se]=((Ne^Se)-Se)*P[(0<z)+0]}return 16}function ol(p){var v=p.rb[p.sb-1];v.la=0,v.Na=0,a(p.zc,0,0,p.zc.length),p.ja=0}function Is(p,v,j,P,z){z=p[v+j+32*P]+(z>>3),p[v+j+32*P]=-256&z?0>z?0:255:z}function ll(p,v,j,P,z,K){Is(p,v,0,j,P+z),Is(p,v,1,j,P+K),Is(p,v,2,j,P-K),Is(p,v,3,j,P-z)}function sn(p){return(20091*p>>16)+p}function Ad(p,v,j,P){var z,K=0,Z=s(16);for(z=0;4>z;++z){var te=p[v+0]+p[v+8],se=p[v+0]-p[v+8],ue=(35468*p[v+4]>>16)-sn(p[v+12]),Ne=sn(p[v+4])+(35468*p[v+12]>>16);Z[K+0]=te+Ne,Z[K+1]=se+ue,Z[K+2]=se-ue,Z[K+3]=te-Ne,K+=4,v++}for(z=K=0;4>z;++z)te=(p=Z[K+0]+4)+Z[K+8],se=p-Z[K+8],ue=(35468*Z[K+4]>>16)-sn(Z[K+12]),Is(j,P,0,0,te+(Ne=sn(Z[K+4])+(35468*Z[K+12]>>16))),Is(j,P,1,0,se+ue),Is(j,P,2,0,se-ue),Is(j,P,3,0,te-Ne),K++,P+=32}function zm(p,v,j,P){var z=p[v+0]+4,K=35468*p[v+4]>>16,Z=sn(p[v+4]),te=35468*p[v+1]>>16;ll(j,P,0,z+Z,p=sn(p[v+1]),te),ll(j,P,1,z+K,p,te),ll(j,P,2,z-K,p,te),ll(j,P,3,z-Z,p,te)}function Hm(p,v,j,P,z){Ad(p,v,j,P),z&&Ad(p,v+16,j,P+4)}function qm(p,v,j,P){Sl(p,v+0,j,P,1),Sl(p,v+32,j,P+128,1)}function oi(p,v,j,P){var z;for(p=p[v+0]+4,z=0;4>z;++z)for(v=0;4>v;++v)Is(j,P,v,z,p)}function Cf(p,v,j,P){p[v+0]&&mr(p,v+0,j,P),p[v+16]&&mr(p,v+16,j,P+4),p[v+32]&&mr(p,v+32,j,P+128),p[v+48]&&mr(p,v+48,j,P+128+4)}function Df(p,v,j,P){var z,K=s(16);for(z=0;4>z;++z){var Z=p[v+0+z]+p[v+12+z],te=p[v+4+z]+p[v+8+z],se=p[v+4+z]-p[v+8+z],ue=p[v+0+z]-p[v+12+z];K[0+z]=Z+te,K[8+z]=Z-te,K[4+z]=ue+se,K[12+z]=ue-se}for(z=0;4>z;++z)Z=(p=K[0+4*z]+3)+K[3+4*z],te=K[1+4*z]+K[2+4*z],se=K[1+4*z]-K[2+4*z],ue=p-K[3+4*z],j[P+0]=Z+te>>3,j[P+16]=ue+se>>3,j[P+32]=Z-te>>3,j[P+48]=ue-se>>3,P+=64}function bo(p,v,j){var P,z=v-32,K=Ya,Z=255-p[z-1];for(P=0;P<j;++P){var te,se=K,ue=Z+p[v-1];for(te=0;te<j;++te)p[v+te]=se[ue+p[z+te]];v+=32}}function Ed(p,v){bo(p,v,4)}function Ym(p,v){bo(p,v,8)}function Vm(p,v){bo(p,v,16)}function Gm(p,v){var j;for(j=0;16>j;++j)n(p,v+32*j,p,v-32,16)}function Cd(p,v){var j;for(j=16;0<j;--j)a(p,v,p[v-1],16),v+=32}function cl(p,v,j){var P;for(P=0;16>P;++P)a(v,j+32*P,p,16)}function yo(p,v){var j,P=16;for(j=0;16>j;++j)P+=p[v-1+32*j]+p[v+j-32];cl(P>>5,p,v)}function Km(p,v){var j,P=8;for(j=0;16>j;++j)P+=p[v-1+32*j];cl(P>>4,p,v)}function dl(p,v){var j,P=8;for(j=0;16>j;++j)P+=p[v+j-32];cl(P>>4,p,v)}function Dd(p,v){cl(128,p,v)}function Bt(p,v,j){return p+2*v+j+2>>2}function Xm(p,v){var j,P=v-32;for(P=new Uint8Array([Bt(p[P-1],p[P+0],p[P+1]),Bt(p[P+0],p[P+1],p[P+2]),Bt(p[P+1],p[P+2],p[P+3]),Bt(p[P+2],p[P+3],p[P+4])]),j=0;4>j;++j)n(p,v+32*j,P,0,P.length)}function Jm(p,v){var j=p[v-1],P=p[v-1+32],z=p[v-1+64],K=p[v-1+96];je(p,v+0,16843009*Bt(p[v-1-32],j,P)),je(p,v+32,16843009*Bt(j,P,z)),je(p,v+64,16843009*Bt(P,z,K)),je(p,v+96,16843009*Bt(z,K,K))}function Zm(p,v){var j,P=4;for(j=0;4>j;++j)P+=p[v+j-32]+p[v-1+32*j];for(P>>=3,j=0;4>j;++j)a(p,v+32*j,P,4)}function Qm(p,v){var j=p[v-1+0],P=p[v-1+32],z=p[v-1+64],K=p[v-1-32],Z=p[v+0-32],te=p[v+1-32],se=p[v+2-32],ue=p[v+3-32];p[v+0+96]=Bt(P,z,p[v-1+96]),p[v+1+96]=p[v+0+64]=Bt(j,P,z),p[v+2+96]=p[v+1+64]=p[v+0+32]=Bt(K,j,P),p[v+3+96]=p[v+2+64]=p[v+1+32]=p[v+0+0]=Bt(Z,K,j),p[v+3+64]=p[v+2+32]=p[v+1+0]=Bt(te,Z,K),p[v+3+32]=p[v+2+0]=Bt(se,te,Z),p[v+3+0]=Bt(ue,se,te)}function Fi(p,v){var j=p[v+1-32],P=p[v+2-32],z=p[v+3-32],K=p[v+4-32],Z=p[v+5-32],te=p[v+6-32],se=p[v+7-32];p[v+0+0]=Bt(p[v+0-32],j,P),p[v+1+0]=p[v+0+32]=Bt(j,P,z),p[v+2+0]=p[v+1+32]=p[v+0+64]=Bt(P,z,K),p[v+3+0]=p[v+2+32]=p[v+1+64]=p[v+0+96]=Bt(z,K,Z),p[v+3+32]=p[v+2+64]=p[v+1+96]=Bt(K,Z,te),p[v+3+64]=p[v+2+96]=Bt(Z,te,se),p[v+3+96]=Bt(te,se,se)}function $i(p,v){var j=p[v-1+0],P=p[v-1+32],z=p[v-1+64],K=p[v-1-32],Z=p[v+0-32],te=p[v+1-32],se=p[v+2-32],ue=p[v+3-32];p[v+0+0]=p[v+1+64]=K+Z+1>>1,p[v+1+0]=p[v+2+64]=Z+te+1>>1,p[v+2+0]=p[v+3+64]=te+se+1>>1,p[v+3+0]=se+ue+1>>1,p[v+0+96]=Bt(z,P,j),p[v+0+64]=Bt(P,j,K),p[v+0+32]=p[v+1+96]=Bt(j,K,Z),p[v+1+32]=p[v+2+96]=Bt(K,Z,te),p[v+2+32]=p[v+3+96]=Bt(Z,te,se),p[v+3+32]=Bt(te,se,ue)}function ep(p,v){var j=p[v+0-32],P=p[v+1-32],z=p[v+2-32],K=p[v+3-32],Z=p[v+4-32],te=p[v+5-32],se=p[v+6-32],ue=p[v+7-32];p[v+0+0]=j+P+1>>1,p[v+1+0]=p[v+0+64]=P+z+1>>1,p[v+2+0]=p[v+1+64]=z+K+1>>1,p[v+3+0]=p[v+2+64]=K+Z+1>>1,p[v+0+32]=Bt(j,P,z),p[v+1+32]=p[v+0+96]=Bt(P,z,K),p[v+2+32]=p[v+1+96]=Bt(z,K,Z),p[v+3+32]=p[v+2+96]=Bt(K,Z,te),p[v+3+64]=Bt(Z,te,se),p[v+3+96]=Bt(te,se,ue)}function tp(p,v){var j=p[v-1+0],P=p[v-1+32],z=p[v-1+64],K=p[v-1+96];p[v+0+0]=j+P+1>>1,p[v+2+0]=p[v+0+32]=P+z+1>>1,p[v+2+32]=p[v+0+64]=z+K+1>>1,p[v+1+0]=Bt(j,P,z),p[v+3+0]=p[v+1+32]=Bt(P,z,K),p[v+3+32]=p[v+1+64]=Bt(z,K,K),p[v+3+64]=p[v+2+64]=p[v+0+96]=p[v+1+96]=p[v+2+96]=p[v+3+96]=K}function fc(p,v){var j=p[v-1+0],P=p[v-1+32],z=p[v-1+64],K=p[v-1+96],Z=p[v-1-32],te=p[v+0-32],se=p[v+1-32],ue=p[v+2-32];p[v+0+0]=p[v+2+32]=j+Z+1>>1,p[v+0+32]=p[v+2+64]=P+j+1>>1,p[v+0+64]=p[v+2+96]=z+P+1>>1,p[v+0+96]=K+z+1>>1,p[v+3+0]=Bt(te,se,ue),p[v+2+0]=Bt(Z,te,se),p[v+1+0]=p[v+3+32]=Bt(j,Z,te),p[v+1+32]=p[v+3+64]=Bt(P,j,Z),p[v+1+64]=p[v+3+96]=Bt(z,P,j),p[v+1+96]=Bt(K,z,P)}function Od(p,v){var j;for(j=0;8>j;++j)n(p,v+32*j,p,v-32,8)}function ul(p,v){var j;for(j=0;8>j;++j)a(p,v,p[v-1],8),v+=32}function hc(p,v,j){var P;for(P=0;8>P;++P)a(v,j+32*P,p,8)}function mc(p,v){var j,P=8;for(j=0;8>j;++j)P+=p[v+j-32]+p[v-1+32*j];hc(P>>4,p,v)}function rp(p,v){var j,P=4;for(j=0;8>j;++j)P+=p[v+j-32];hc(P>>3,p,v)}function Pd(p,v){var j,P=4;for(j=0;8>j;++j)P+=p[v-1+32*j];hc(P>>3,p,v)}function Ld(p,v){hc(128,p,v)}function fl(p,v,j){var P=p[v-j],z=p[v+0],K=3*(z-P)+np[1020+p[v-2*j]-p[v+j]],Z=Uf[112+(K+4>>3)];p[v-j]=Ya[255+P+Uf[112+(K+3>>3)]],p[v+0]=Ya[255+z-Z]}function hl(p,v,j,P){var z=p[v+0],K=p[v+j];return hs[255+p[v-2*j]-p[v-j]]>P||hs[255+K-z]>P}function Fd(p,v,j,P){return 4*hs[255+p[v-j]-p[v+0]]+hs[255+p[v-2*j]-p[v+j]]<=P}function pc(p,v,j,P,z){var K=p[v-3*j],Z=p[v-2*j],te=p[v-j],se=p[v+0],ue=p[v+j],Ne=p[v+2*j],Me=p[v+3*j];return 4*hs[255+te-se]+hs[255+Z-ue]>P?0:hs[255+p[v-4*j]-K]<=z&&hs[255+K-Z]<=z&&hs[255+Z-te]<=z&&hs[255+Me-Ne]<=z&&hs[255+Ne-ue]<=z&&hs[255+ue-se]<=z}function $d(p,v,j,P){var z=2*P+1;for(P=0;16>P;++P)Fd(p,v+P,j,z)&&fl(p,v+P,j)}function ml(p,v,j,P){var z=2*P+1;for(P=0;16>P;++P)Fd(p,v+P*j,1,z)&&fl(p,v+P*j,1)}function Of(p,v,j,P){var z;for(z=3;0<z;--z)$d(p,v+=4*j,j,P)}function Pf(p,v,j,P){var z;for(z=3;0<z;--z)ml(p,v+=4,j,P)}function Ri(p,v,j,P,z,K,Z,te){for(K=2*K+1;0<z--;){if(pc(p,v,j,K,Z))if(hl(p,v,j,te))fl(p,v,j);else{var se=p,ue=v,Ne=j,Me=se[ue-2*Ne],fe=se[ue-Ne],Se=se[ue+0],De=se[ue+Ne],Ye=se[ue+2*Ne],$e=27*(Je=np[1020+3*(Se-fe)+np[1020+Me-De]])+63>>7,Ge=18*Je+63>>7,Je=9*Je+63>>7;se[ue-3*Ne]=Ya[255+se[ue-3*Ne]+Je],se[ue-2*Ne]=Ya[255+Me+Ge],se[ue-Ne]=Ya[255+fe+$e],se[ue+0]=Ya[255+Se-$e],se[ue+Ne]=Ya[255+De-Ge],se[ue+2*Ne]=Ya[255+Ye-Je]}v+=P}}function Mi(p,v,j,P,z,K,Z,te){for(K=2*K+1;0<z--;){if(pc(p,v,j,K,Z))if(hl(p,v,j,te))fl(p,v,j);else{var se=p,ue=v,Ne=j,Me=se[ue-Ne],fe=se[ue+0],Se=se[ue+Ne],De=Uf[112+(4+(Ye=3*(fe-Me))>>3)],Ye=Uf[112+(Ye+3>>3)],$e=De+1>>1;se[ue-2*Ne]=Ya[255+se[ue-2*Ne]+$e],se[ue-Ne]=Ya[255+Me+Ye],se[ue+0]=Ya[255+fe-De],se[ue+Ne]=Ya[255+Se-$e]}v+=P}}function Lf(p,v,j,P,z,K){Ri(p,v,j,1,16,P,z,K)}function Ff(p,v,j,P,z,K){Ri(p,v,1,j,16,P,z,K)}function pl(p,v,j,P,z,K){var Z;for(Z=3;0<Z;--Z)Mi(p,v+=4*j,j,1,16,P,z,K)}function $f(p,v,j,P,z,K){var Z;for(Z=3;0<Z;--Z)Mi(p,v+=4,1,j,16,P,z,K)}function k(p,v,j,P,z,K,Z,te){Ri(p,v,z,1,8,K,Z,te),Ri(j,P,z,1,8,K,Z,te)}function W(p,v,j,P,z,K,Z,te){Ri(p,v,1,z,8,K,Z,te),Ri(j,P,1,z,8,K,Z,te)}function he(p,v,j,P,z,K,Z,te){Mi(p,v+4*z,z,1,8,K,Z,te),Mi(j,P+4*z,z,1,8,K,Z,te)}function be(p,v,j,P,z,K,Z,te){Mi(p,v+4,1,z,8,K,Z,te),Mi(j,P+4,1,z,8,K,Z,te)}function Ee(){this.ba=new ur,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new nr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ke(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function st(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function St(){this.ua=0,this.Wa=new Q,this.vb=new Q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ne,this.yc=new U}function At(){this.xb=this.a=0,this.l=new ea,this.ca=new ur,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new St,this.ab=0,this.gc=o(4,st),this.Oc=0}function Mt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ea,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ut(p,v,j,P,z,K,Z){for(p=p==null?0:p[v+0],v=0;v<Z;++v)z[K+v]=p+j[P+v]&255,p=z[K+v]}function fr(p,v,j,P,z,K,Z){var te;if(p==null)Ut(null,null,j,P,z,K,Z);else for(te=0;te<Z;++te)z[K+te]=p[v+te]+j[P+te]&255}function Vr(p,v,j,P,z,K,Z){if(p==null)Ut(null,null,j,P,z,K,Z);else{var te,se=p[v+0],ue=se,Ne=se;for(te=0;te<Z;++te)ue=Ne+(se=p[v+te])-ue,Ne=j[P+te]+(-256&ue?0>ue?0:255:ue)&255,ue=se,z[K+te]=Ne}}function xn(p,v,j,P){var z=v.width,K=v.o;if(t(p!=null&&v!=null),0>j||0>=P||j+P>K)return null;if(!p.Cc){if(p.ga==null){var Z;if(p.ga=new Mt,(Z=p.ga==null)||(Z=v.width*v.o,t(p.Gb.length==0),p.Gb=s(Z),p.Uc=0,p.Gb==null?Z=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,Z=1),Z=!Z),!Z){Z=p.ga;var te=p.Fa,se=p.P,ue=p.qc,Ne=p.mb,Me=p.nb,fe=se+1,Se=ue-1,De=Z.l;if(t(te!=null&&Ne!=null&&v!=null),Co[0]=null,Co[1]=Ut,Co[2]=fr,Co[3]=Vr,Z.ca=Ne,Z.tb=Me,Z.c=v.width,Z.i=v.height,t(0<Z.c&&0<Z.i),1>=ue)v=0;else if(Z.$a=3&te[se+0],Z.Z=te[se+0]>>2&3,Z.Lc=te[se+0]>>4&3,se=te[se+0]>>6&3,0>Z.$a||1<Z.$a||4<=Z.Z||1<Z.Lc||se)v=0;else if(De.put=Lt,De.ac=ka,De.bc=Ua,De.ma=Z,De.width=v.width,De.height=v.height,De.Da=v.Da,De.v=v.v,De.va=v.va,De.j=v.j,De.o=v.o,Z.$a)e:{t(Z.$a==1),v=Le();t:for(;;){if(v==null){v=0;break e}if(t(Z!=null),Z.mc=v,v.c=Z.c,v.i=Z.i,v.l=Z.l,v.l.ma=Z,v.l.width=Z.c,v.l.height=Z.i,v.a=0,ye(v.m,te,fe,Se),!Fe(Z.c,Z.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&ie(v.s)?(Z.ic=1,te=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s(te),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(Z.ic=0,v=G(v,Z.c)),!v))break t;v=1;break e}Z.mc=null,v=0}else v=Se>=Z.c*Z.i;Z=!v}if(Z)return null;p.ga.Lc!=1?p.Ga=0:P=K-j}t(p.ga!=null),t(j+P<=K);e:{if(v=(te=p.ga).c,K=te.l.o,te.$a==0){if(fe=p.rc,Se=p.Vc,De=p.Fa,se=p.P+1+j*v,ue=p.mb,Ne=p.nb+j*v,t(se<=p.P+p.qc),te.Z!=0)for(t(Co[te.Z]!=null),Z=0;Z<P;++Z)Co[te.Z](fe,Se,De,se,ue,Ne,v),fe=ue,Se=Ne,Ne+=v,se+=v;else for(Z=0;Z<P;++Z)n(ue,Ne,De,se,v),fe=ue,Se=Ne,Ne+=v,se+=v;p.rc=fe,p.Vc=Se}else{if(t(te.mc!=null),v=j+P,t((Z=te.mc)!=null),t(v<=Z.i),Z.C>=v)v=1;else if(te.ic||ds(),te.ic){te=Z.V,fe=Z.Ba,Se=Z.c;var Ye=Z.i,$e=(De=1,se=Z.$/Se,ue=Z.$%Se,Ne=Z.m,Me=Z.s,Z.$),Ge=Se*Ye,Je=Se*v,lt=Me.wc,at=$e<Je?q(Me,ue,se):null;t($e<=Ge),t(v<=Ye),t(ie(Me));t:for(;;){for(;!Ne.h&&$e<Je;){if(ue&lt||(at=q(Me,ue,se)),t(at!=null),X(Ne),256>(Ye=Cr(at.G[0],at.H[0],Ne)))te[fe+$e]=Ye,++$e,++ue>=Se&&(ue=0,++se<=v&&!(se%16)&&pe(Z,se));else{if(!(280>Ye)){De=0;break t}Ye=Pn(Ye-256,Ne);var Et,_t=Cr(at.G[4],at.H[4],Ne);if(X(Ne),!($e>=(_t=Qn(Se,_t=Pn(_t,Ne)))&&Ge-$e>=Ye)){De=0;break t}for(Et=0;Et<Ye;++Et)te[fe+$e+Et]=te[fe+$e+Et-_t];for($e+=Ye,ue+=Ye;ue>=Se;)ue-=Se,++se<=v&&!(se%16)&&pe(Z,se);$e<Je&&ue&lt&&(at=q(Me,ue,se))}t(Ne.h==L(Ne))}pe(Z,se>v?v:se);break t}!De||Ne.h&&$e<Ge?(De=0,Z.a=Ne.h?5:3):Z.$=$e,v=De}else v=Pe(Z,Z.V,Z.Ba,Z.c,Z.i,v,ke);if(!v){P=0;break e}}j+P>=K&&(p.Cc=1),P=1}if(!P)return null;if(p.Cc&&((P=p.ga)!=null&&(P.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+j*z}function Dr(p,v,j,P,z,K){for(;0<z--;){var Z,te=p,se=v+(j?1:0),ue=p,Ne=v+(j?0:3);for(Z=0;Z<P;++Z){var Me=ue[Ne+4*Z];Me!=255&&(Me*=32897,te[se+4*Z+0]=te[se+4*Z+0]*Me>>23,te[se+4*Z+1]=te[se+4*Z+1]*Me>>23,te[se+4*Z+2]=te[se+4*Z+2]*Me>>23)}v+=K}}function Nn(p,v,j,P,z){for(;0<P--;){var K;for(K=0;K<j;++K){var Z=p[v+2*K+0],te=15&(ue=p[v+2*K+1]),se=4369*te,ue=(240&ue|ue>>4)*se>>16;p[v+2*K+0]=(240&Z|Z>>4)*se>>16&240|(15&Z|Z<<4)*se>>16>>4&15,p[v+2*K+1]=240&ue|te}v+=z}}function vn(p,v,j,P,z,K,Z,te){var se,ue,Ne=255;for(ue=0;ue<z;++ue){for(se=0;se<P;++se){var Me=p[v+se];K[Z+4*se]=Me,Ne&=Me}v+=j,Z+=te}return Ne!=255}function In(p,v,j,P,z){var K;for(K=0;K<z;++K)j[P+K]=p[v+K]>>8}function ds(){Vd=Dr,F2=Nn,$2=vn,R2=In}function Sa(p,v,j){E[p]=function(P,z,K,Z,te,se,ue,Ne,Me,fe,Se,De,Ye,$e,Ge,Je,lt){var at,Et=lt-1>>1,_t=te[se+0]|ue[Ne+0]<<16,Vt=Me[fe+0]|Se[De+0]<<16;t(P!=null);var jt=3*_t+Vt+131074>>2;for(v(P[z+0],255&jt,jt>>16,Ye,$e),K!=null&&(jt=3*Vt+_t+131074>>2,v(K[Z+0],255&jt,jt>>16,Ge,Je)),at=1;at<=Et;++at){var tr=te[se+at]|ue[Ne+at]<<16,Sn=Me[fe+at]|Se[De+at]<<16,Gt=_t+tr+Vt+Sn+524296,Tt=Gt+2*(tr+Vt)>>3;jt=Tt+_t>>1,_t=(Gt=Gt+2*(_t+Sn)>>3)+tr>>1,v(P[z+2*at-1],255&jt,jt>>16,Ye,$e+(2*at-1)*j),v(P[z+2*at-0],255&_t,_t>>16,Ye,$e+(2*at-0)*j),K!=null&&(jt=Gt+Vt>>1,_t=Tt+Sn>>1,v(K[Z+2*at-1],255&jt,jt>>16,Ge,Je+(2*at-1)*j),v(K[Z+2*at+0],255&_t,_t>>16,Ge,Je+(2*at+0)*j)),_t=tr,Vt=Sn}1&lt||(jt=3*_t+Vt+131074>>2,v(P[z+lt-1],255&jt,jt>>16,Ye,$e+(lt-1)*j),K!=null&&(jt=3*Vt+_t+131074>>2,v(K[Z+lt-1],255&jt,jt>>16,Ge,Je+(lt-1)*j)))}}function Rf(){ms[Wf]=p6,ms[zf]=G2,ms[z2]=g6,ms[Hf]=K2,ms[qf]=X2,ms[ap]=J2,ms[H2]=x6,ms[sp]=G2,ms[ip]=K2,ms[Yf]=X2,ms[op]=J2}function gc(p){return p&-16384?0>p?0:255:p>>v6}function gl(p,v){return gc((19077*p>>8)+(26149*v>>8)-14234)}function wo(p,v,j){return gc((19077*p>>8)-(6419*v>>8)-(13320*j>>8)+8708)}function xl(p,v){return gc((19077*p>>8)+(33050*v>>8)-17685)}function vl(p,v,j,P,z){P[z+0]=gl(p,j),P[z+1]=wo(p,v,j),P[z+2]=xl(p,v)}function bl(p,v,j,P,z){P[z+0]=xl(p,v),P[z+1]=wo(p,v,j),P[z+2]=gl(p,j)}function ta(p,v,j,P,z){var K=wo(p,v,j);v=K<<3&224|xl(p,v)>>3,P[z+0]=248&gl(p,j)|K>>5,P[z+1]=v}function yl(p,v,j,P,z){var K=240&xl(p,v)|15;P[z+0]=240&gl(p,j)|wo(p,v,j)>>4,P[z+1]=K}function wl(p,v,j,P,z){P[z+0]=255,vl(p,v,j,P,z+1)}function Rd(p,v,j,P,z){bl(p,v,j,P,z),P[z+3]=255}function Md(p,v,j,P,z){vl(p,v,j,P,z),P[z+3]=255}function Kr(p,v){return 0>p?0:p>v?v:p}function Ii(p,v,j){E[p]=function(P,z,K,Z,te,se,ue,Ne,Me){for(var fe=Ne+(-2&Me)*j;Ne!=fe;)v(P[z+0],K[Z+0],te[se+0],ue,Ne),v(P[z+1],K[Z+0],te[se+0],ue,Ne+j),z+=2,++Z,++se,Ne+=2*j;1&Me&&v(P[z+0],K[Z+0],te[se+0],ue,Ne)}}function xc(p,v,j){return j==0?p==0?v==0?6:5:v==0?4:0:j}function Mf(p,v,j,P,z){switch(p>>>30){case 3:Sl(v,j,P,z,0);break;case 2:fs(v,j,P,z);break;case 1:mr(v,j,P,z)}}function us(p,v){var j,P,z=v.M,K=v.Nb,Z=p.oc,te=p.pc+40,se=p.oc,ue=p.pc+584,Ne=p.oc,Me=p.pc+600;for(j=0;16>j;++j)Z[te+32*j-1]=129;for(j=0;8>j;++j)se[ue+32*j-1]=129,Ne[Me+32*j-1]=129;for(0<z?Z[te-1-32]=se[ue-1-32]=Ne[Me-1-32]=129:(a(Z,te-32-1,127,21),a(se,ue-32-1,127,9),a(Ne,Me-32-1,127,9)),P=0;P<p.za;++P){var fe=v.ya[v.aa+P];if(0<P){for(j=-1;16>j;++j)n(Z,te+32*j-4,Z,te+32*j+12,4);for(j=-1;8>j;++j)n(se,ue+32*j-4,se,ue+32*j+4,4),n(Ne,Me+32*j-4,Ne,Me+32*j+4,4)}var Se=p.Gd,De=p.Hd+P,Ye=fe.ad,$e=fe.Hc;if(0<z&&(n(Z,te-32,Se[De].y,0,16),n(se,ue-32,Se[De].f,0,8),n(Ne,Me-32,Se[De].ea,0,8)),fe.Za){var Ge=Z,Je=te-32+16;for(0<z&&(P>=p.za-1?a(Ge,Je,Se[De].y[15],4):n(Ge,Je,Se[De+1].y,0,4)),j=0;4>j;j++)Ge[Je+128+j]=Ge[Je+256+j]=Ge[Je+384+j]=Ge[Je+0+j];for(j=0;16>j;++j,$e<<=2)Ge=Z,Je=te+Q2[j],Bs[fe.Ob[j]](Ge,Je),Mf($e,Ye,16*+j,Ge,Je)}else if(Ge=xc(P,z,fe.Ob[0]),Eo[Ge](Z,te),$e!=0)for(j=0;16>j;++j,$e<<=2)Mf($e,Ye,16*+j,Z,te+Q2[j]);for(j=fe.Gc,Ge=xc(P,z,fe.Dd),Wi[Ge](se,ue),Wi[Ge](Ne,Me),$e=Ye,Ge=se,Je=ue,255&(fe=0|j)&&(170&fe?di($e,256,Ge,Je):jr($e,256,Ge,Je)),fe=Ne,$e=Me,255&(j>>=8)&&(170&j?di(Ye,320,fe,$e):jr(Ye,320,fe,$e)),z<p.Ub-1&&(n(Se[De].y,0,Z,te+480,16),n(Se[De].f,0,se,ue+224,8),n(Se[De].ea,0,Ne,Me+224,8)),j=8*K*p.B,Se=p.sa,De=p.ta+16*P+16*K*p.R,Ye=p.qa,fe=p.ra+8*P+j,$e=p.Ha,Ge=p.Ia+8*P+j,j=0;16>j;++j)n(Se,De+j*p.R,Z,te+32*j,16);for(j=0;8>j;++j)n(Ye,fe+j*p.B,se,ue+32*j,8),n($e,Ge+j*p.B,Ne,Me+32*j,8)}}function _l(p,v,j,P,z,K,Z,te,se){var ue=[0],Ne=[0],Me=0,fe=se!=null?se.kd:0,Se=se??new Ke;if(p==null||12>j)return 7;Se.data=p,Se.w=v,Se.ha=j,v=[v],j=[j],Se.gb=[Se.gb];e:{var De=v,Ye=j,$e=Se.gb;if(t(p!=null),t(Ye!=null),t($e!=null),$e[0]=0,12<=Ye[0]&&!r(p,De[0],"RIFF")){if(r(p,De[0]+8,"WEBP")){$e=3;break e}var Ge=Te(p,De[0]+4);if(12>Ge||4294967286<Ge){$e=3;break e}if(fe&&Ge>Ye[0]-8){$e=7;break e}$e[0]=Ge,De[0]+=12,Ye[0]-=12}$e=0}if($e!=0)return $e;for(Ge=0<Se.gb[0],j=j[0];;){e:{var Je=p;Ye=v,$e=j;var lt=ue,at=Ne,Et=De=[0];if((jt=Me=[Me])[0]=0,8>$e[0])$e=7;else{if(!r(Je,Ye[0],"VP8X")){if(Te(Je,Ye[0]+4)!=10){$e=3;break e}if(18>$e[0]){$e=7;break e}var _t=Te(Je,Ye[0]+8),Vt=1+et(Je,Ye[0]+12);if(2147483648<=Vt*(Je=1+et(Je,Ye[0]+15))){$e=3;break e}Et!=null&&(Et[0]=_t),lt!=null&&(lt[0]=Vt),at!=null&&(at[0]=Je),Ye[0]+=18,$e[0]-=18,jt[0]=1}$e=0}}if(Me=Me[0],De=De[0],$e!=0)return $e;if(Ye=!!(2&De),!Ge&&Me)return 3;if(K!=null&&(K[0]=!!(16&De)),Z!=null&&(Z[0]=Ye),te!=null&&(te[0]=0),Z=ue[0],De=Ne[0],Me&&Ye&&se==null){$e=0;break}if(4>j){$e=7;break}if(Ge&&Me||!Ge&&!Me&&!r(p,v[0],"ALPH")){j=[j],Se.na=[Se.na],Se.P=[Se.P],Se.Sa=[Se.Sa];e:{_t=p,$e=v,Ge=j;var jt=Se.gb;lt=Se.na,at=Se.P,Et=Se.Sa,Vt=22,t(_t!=null),t(Ge!=null),Je=$e[0];var tr=Ge[0];for(t(lt!=null),t(Et!=null),lt[0]=null,at[0]=null,Et[0]=0;;){if($e[0]=Je,Ge[0]=tr,8>tr){$e=7;break e}var Sn=Te(_t,Je+4);if(4294967286<Sn){$e=3;break e}var Gt=8+Sn+1&-2;if(Vt+=Gt,0<jt&&Vt>jt){$e=3;break e}if(!r(_t,Je,"VP8 ")||!r(_t,Je,"VP8L")){$e=0;break e}if(tr[0]<Gt){$e=7;break e}r(_t,Je,"ALPH")||(lt[0]=_t,at[0]=Je+8,Et[0]=Sn),Je+=Gt,tr-=Gt}}if(j=j[0],Se.na=Se.na[0],Se.P=Se.P[0],Se.Sa=Se.Sa[0],$e!=0)break}j=[j],Se.Ja=[Se.Ja],Se.xa=[Se.xa];e:if(jt=p,$e=v,Ge=j,lt=Se.gb[0],at=Se.Ja,Et=Se.xa,_t=$e[0],Je=!r(jt,_t,"VP8 "),Vt=!r(jt,_t,"VP8L"),t(jt!=null),t(Ge!=null),t(at!=null),t(Et!=null),8>Ge[0])$e=7;else{if(Je||Vt){if(jt=Te(jt,_t+4),12<=lt&&jt>lt-12){$e=3;break e}if(fe&&jt>Ge[0]-8){$e=7;break e}at[0]=jt,$e[0]+=8,Ge[0]-=8,Et[0]=Vt}else Et[0]=5<=Ge[0]&&jt[_t+0]==47&&!(jt[_t+4]>>5),at[0]=Ge[0];$e=0}if(j=j[0],Se.Ja=Se.Ja[0],Se.xa=Se.xa[0],v=v[0],$e!=0)break;if(4294967286<Se.Ja)return 3;if(te==null||Ye||(te[0]=Se.xa?2:1),Z=[Z],De=[De],Se.xa){if(5>j){$e=7;break}te=Z,fe=De,Ye=K,p==null||5>j?p=0:5<=j&&p[v+0]==47&&!(p[v+4]>>5)?(Ge=[0],jt=[0],lt=[0],ye(at=new A,p,v,j),Wa(at,Ge,jt,lt)?(te!=null&&(te[0]=Ge[0]),fe!=null&&(fe[0]=jt[0]),Ye!=null&&(Ye[0]=lt[0]),p=1):p=0):p=0}else{if(10>j){$e=7;break}te=De,p==null||10>j||!Af(p,v+3,j-3)?p=0:(fe=p[v+0]|p[v+1]<<8|p[v+2]<<16,Ye=16383&(p[v+7]<<8|p[v+6]),p=16383&(p[v+9]<<8|p[v+8]),1&fe||3<(fe>>1&7)||!(fe>>4&1)||fe>>5>=Se.Ja||!Ye||!p?p=0:(Z&&(Z[0]=Ye),te&&(te[0]=p),p=1))}if(!p||(Z=Z[0],De=De[0],Me&&(ue[0]!=Z||Ne[0]!=De)))return 3;se!=null&&(se[0]=Se,se.offset=v-se.w,t(4294967286>v-se.w),t(se.offset==se.ha-j));break}return $e==0||$e==7&&Me&&se==null?(K!=null&&(K[0]|=Se.na!=null&&0<Se.na.length),P!=null&&(P[0]=Z),z!=null&&(z[0]=De),0):$e}function Id(p,v,j){var P=v.width,z=v.height,K=0,Z=0,te=P,se=z;if(v.Da=p!=null&&0<p.Da,v.Da&&(te=p.cd,se=p.bd,K=p.v,Z=p.j,11>j||(K&=-2,Z&=-2),0>K||0>Z||0>=te||0>=se||K+te>P||Z+se>z))return 0;if(v.v=K,v.j=Z,v.va=K+te,v.o=Z+se,v.U=te,v.T=se,v.da=p!=null&&0<p.da,v.da){if(!ve(te,se,j=[p.ib],K=[p.hb]))return 0;v.ib=j[0],v.hb=K[0]}return v.ob=p!=null&&p.ob,v.Kb=p==null||!p.Sd,v.da&&(v.ob=v.ib<3*P/4&&v.hb<3*z/4,v.Kb=0),1}function Bd(p){if(p==null)return 2;if(11>p.S){var v=p.f.RGBA;v.fb+=(p.height-1)*v.A,v.A=-v.A}else v=p.f.kb,p=p.height,v.O+=(p-1)*v.fa,v.fa=-v.fa,v.N+=(p-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(p-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(p-1)*v.lb,v.lb=-v.lb);return 0}function _o(p,v,j,P){if(P==null||0>=p||0>=v)return 2;if(j!=null){if(j.Da){var z=j.cd,K=j.bd,Z=-2&j.v,te=-2&j.j;if(0>Z||0>te||0>=z||0>=K||Z+z>p||te+K>v)return 2;p=z,v=K}if(j.da){if(!ve(p,v,z=[j.ib],K=[j.hb]))return 2;p=z[0],v=K[0]}}P.width=p,P.height=v;e:{var se=P.width,ue=P.height;if(p=P.S,0>=se||0>=ue||!(p>=Wf&&13>p))p=2;else{if(0>=P.Rd&&P.sd==null){Z=K=z=v=0;var Ne=(te=se*ev[p])*ue;if(11>p||(K=(ue+1)/2*(v=(se+1)/2),p==12&&(Z=(z=se)*ue)),(ue=s(Ne+2*K+Z))==null){p=1;break e}P.sd=ue,11>p?((se=P.f.RGBA).eb=ue,se.fb=0,se.A=te,se.size=Ne):((se=P.f.kb).y=ue,se.O=0,se.fa=te,se.Fd=Ne,se.f=ue,se.N=0+Ne,se.Ab=v,se.Cd=K,se.ea=ue,se.W=0+Ne+K,se.Db=v,se.Ed=K,p==12&&(se.F=ue,se.J=0+Ne+2*K),se.Tc=Z,se.lb=z)}if(v=1,z=P.S,K=P.width,Z=P.height,z>=Wf&&13>z)if(11>z)p=P.f.RGBA,v&=(te=Math.abs(p.A))*(Z-1)+K<=p.size,v&=te>=K*ev[z],v&=p.eb!=null;else{p=P.f.kb,te=(K+1)/2,Ne=(Z+1)/2,se=Math.abs(p.fa),ue=Math.abs(p.Ab);var Me=Math.abs(p.Db),fe=Math.abs(p.lb),Se=fe*(Z-1)+K;v&=se*(Z-1)+K<=p.Fd,v&=ue*(Ne-1)+te<=p.Cd,v=(v&=Me*(Ne-1)+te<=p.Ed)&se>=K&ue>=te&Me>=te,v&=p.y!=null,v&=p.f!=null,v&=p.ea!=null,z==12&&(v&=fe>=K,v&=Se<=p.Tc,v&=p.F!=null)}else v=0;p=v?0:2}}return p!=0||j!=null&&j.fd&&(p=Bd(P)),p}var Nl=64,Ha=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],qa=24,No=32,Bi=8,ko=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];He("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(p){return p},E.Predictor2=function(p,v,j){return v[j+0]},E.Predictor3=function(p,v,j){return v[j+1]},E.Predictor4=function(p,v,j){return v[j-1]},E.Predictor5=function(p,v,j){return le(le(p,v[j+1]),v[j+0])},E.Predictor6=function(p,v,j){return le(p,v[j-1])},E.Predictor7=function(p,v,j){return le(p,v[j+0])},E.Predictor8=function(p,v,j){return le(v[j-1],v[j+0])},E.Predictor9=function(p,v,j){return le(v[j+0],v[j+1])},E.Predictor10=function(p,v,j){return le(le(p,v[j-1]),le(v[j+0],v[j+1]))},E.Predictor11=function(p,v,j){var P=v[j+0];return 0>=_e(P>>24&255,p>>24&255,(v=v[j-1])>>24&255)+_e(P>>16&255,p>>16&255,v>>16&255)+_e(P>>8&255,p>>8&255,v>>8&255)+_e(255&P,255&p,255&v)?P:p},E.Predictor12=function(p,v,j){var P=v[j+0];return(Ae((p>>24&255)+(P>>24&255)-((v=v[j-1])>>24&255))<<24|Ae((p>>16&255)+(P>>16&255)-(v>>16&255))<<16|Ae((p>>8&255)+(P>>8&255)-(v>>8&255))<<8|Ae((255&p)+(255&P)-(255&v)))>>>0},E.Predictor13=function(p,v,j){var P=v[j-1];return(Qe((p=le(p,v[j+0]))>>24&255,P>>24&255)<<24|Qe(p>>16&255,P>>16&255)<<16|Qe(p>>8&255,P>>8&255)<<8|Qe(255&p,255&P))>>>0};var Ud=E.PredictorAdd0;E.PredictorAdd1=Ze,He("Predictor2","PredictorAdd2"),He("Predictor3","PredictorAdd3"),He("Predictor4","PredictorAdd4"),He("Predictor5","PredictorAdd5"),He("Predictor6","PredictorAdd6"),He("Predictor7","PredictorAdd7"),He("Predictor8","PredictorAdd8"),He("Predictor9","PredictorAdd9"),He("Predictor10","PredictorAdd10"),He("Predictor11","PredictorAdd11"),He("Predictor12","PredictorAdd12"),He("Predictor13","PredictorAdd13");var vc=E.PredictorAdd2;yt("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var on,If=E.ColorIndexInverseTransform,li=E.MapARGB,ci=E.VP8LColorIndexInverseTransformAlpha,Wd=E.MapAlpha,zd=E.VP8LPredictorsAdd=[];zd.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var Hd,qd,So,jo,To,kl,Ao,Sl,fs,di,mr,jr,ln,kn,Ui,Yd,bc,Bf,E2,C2,D2,O2,P2,L2,Vd,F2,$2,R2,M2=s(511),I2=s(2041),B2=s(225),U2=s(767),W2=0,np=I2,Uf=B2,Ya=U2,hs=M2,Wf=0,zf=1,z2=2,Hf=3,qf=4,ap=5,H2=6,sp=7,ip=8,Yf=9,op=10,t6=[2,3,7],r6=[3,3,11],q2=[280,256,256,256,40],n6=[0,1,1,1,0],a6=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],s6=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],i6=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],o6=8,lp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],cp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Gd=null,l6=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],c6=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Y2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],d6=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],u6=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],f6=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],h6=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Eo=[],Bs=[],Wi=[],m6=1,V2=2,Co=[],ms=[];Sa("UpsampleRgbLinePair",vl,3),Sa("UpsampleBgrLinePair",bl,3),Sa("UpsampleRgbaLinePair",Md,4),Sa("UpsampleBgraLinePair",Rd,4),Sa("UpsampleArgbLinePair",wl,4),Sa("UpsampleRgba4444LinePair",yl,2),Sa("UpsampleRgb565LinePair",ta,2);var p6=E.UpsampleRgbLinePair,g6=E.UpsampleBgrLinePair,G2=E.UpsampleRgbaLinePair,K2=E.UpsampleBgraLinePair,X2=E.UpsampleArgbLinePair,J2=E.UpsampleRgba4444LinePair,x6=E.UpsampleRgb565LinePair,Vf=16,Gf=1<<Vf-1,Kd=-227,dp=482,v6=6,Z2=0,b6=s(256),y6=s(256),w6=s(256),_6=s(256),N6=s(dp-Kd),k6=s(dp-Kd);Ii("YuvToRgbRow",vl,3),Ii("YuvToBgrRow",bl,3),Ii("YuvToRgbaRow",Md,4),Ii("YuvToBgraRow",Rd,4),Ii("YuvToArgbRow",wl,4),Ii("YuvToRgba4444Row",yl,2),Ii("YuvToRgb565Row",ta,2);var Q2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Kf=[0,2,8],S6=[8,7,6,4,4,2,2,2,1,1,1,1],j6=1;this.WebPDecodeRGBA=function(p,v,j,P,z){var K=zf,Z=new Ee,te=new ur;Z.ba=te,te.S=K,te.width=[te.width],te.height=[te.height];var se=te.width,ue=te.height,Ne=new Ft;if(Ne==null||p==null)var Me=2;else t(Ne!=null),Me=_l(p,v,j,Ne.width,Ne.height,Ne.Pd,Ne.Qd,Ne.format,null);if(Me!=0?se=0:(se!=null&&(se[0]=Ne.width[0]),ue!=null&&(ue[0]=Ne.height[0]),se=1),se){te.width=te.width[0],te.height=te.height[0],P!=null&&(P[0]=te.width),z!=null&&(z[0]=te.height);e:{if(P=new ea,(z=new Ke).data=p,z.w=v,z.ha=j,z.kd=1,v=[0],t(z!=null),((p=_l(z.data,z.w,z.ha,null,null,null,v,null,z))==0||p==7)&&v[0]&&(p=4),(v=p)==0){if(t(Z!=null),P.data=z.data,P.w=z.w+z.offset,P.ha=z.ha-z.offset,P.put=Lt,P.ac=ka,P.bc=Ua,P.ma=Z,z.xa){if((p=Le())==null){Z=1;break e}if(function(fe,Se){var De=[0],Ye=[0],$e=[0];t:for(;;){if(fe==null)return 0;if(Se==null)return fe.a=2,0;if(fe.l=Se,fe.a=0,ye(fe.m,Se.data,Se.w,Se.ha),!Wa(fe.m,De,Ye,$e)){fe.a=3;break t}if(fe.xb=V2,Se.width=De[0],Se.height=Ye[0],!Fe(De[0],Ye[0],1,fe,null))break t;return 1}return t(fe.a!=0),0}(p,P)){if(P=(v=_o(P.width,P.height,Z.Oa,Z.ba))==0){t:{P=p;r:for(;;){if(P==null){P=0;break t}if(t(P.s.yc!=null),t(P.s.Ya!=null),t(0<P.s.Wb),t((j=P.l)!=null),t((z=j.ma)!=null),P.xb!=0){if(P.ca=z.ba,P.tb=z.tb,t(P.ca!=null),!Id(z.Oa,j,Hf)){P.a=2;break r}if(!G(P,j.width)||j.da)break r;if((j.da||$t(P.ca.S))&&ds(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&ds()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!Y(P.s.vb,P.s.Wa.Xa)){P.a=1;break r}P.xb=0}if(!Pe(P,P.V,P.Ba,P.c,P.i,j.o,ae))break r;z.Dc=P.Ma,P=1;break t}t(P.a!=0),P=0}P=!P}P&&(v=p.a)}else v=p.a}else{if((p=new Wm)==null){Z=1;break e}if(p.Fa=z.na,p.P=z.P,p.qc=z.Sa,Ef(p,P)){if((v=_o(P.width,P.height,Z.Oa,Z.ba))==0){if(p.Aa=0,j=Z.Oa,t((z=p)!=null),j!=null){if(0<(se=0>(se=j.Md)?0:100<se?255:255*se/100)){for(ue=Ne=0;4>ue;++ue)12>(Me=z.pb[ue]).lc&&(Me.ia=se*S6[0>Me.lc?0:Me.lc]>>3),Ne|=Me.ia;Ne&&(alert("todo:VP8InitRandom"),z.ia=1)}z.Ga=j.Id,100<z.Ga?z.Ga=100:0>z.Ga&&(z.Ga=0)}(function(fe,Se){if(fe==null)return 0;if(Se==null)return gn(fe,2,"NULL VP8Io parameter in VP8Decode().");if(!fe.cb&&!Ef(fe,Se))return 0;if(t(fe.cb),Se.ac==null||Se.ac(Se)){Se.ob&&(fe.L=0);var De=Kf[fe.L];if(fe.L==2?(fe.yb=0,fe.zb=0):(fe.yb=Se.v-De>>4,fe.zb=Se.j-De>>4,0>fe.yb&&(fe.yb=0),0>fe.zb&&(fe.zb=0)),fe.Va=Se.o+15+De>>4,fe.Hb=Se.va+15+De>>4,fe.Hb>fe.za&&(fe.Hb=fe.za),fe.Va>fe.Ub&&(fe.Va=fe.Ub),0<fe.L){var Ye=fe.ed;for(De=0;4>De;++De){var $e;if(fe.Qa.Cb){var Ge=fe.Qa.Lb[De];fe.Qa.Fb||(Ge+=Ye.Tb)}else Ge=Ye.Tb;for($e=0;1>=$e;++$e){var Je=fe.gd[De][$e],lt=Ge;if(Ye.Pc&&(lt+=Ye.vd[0],$e&&(lt+=Ye.od[0])),0<(lt=0>lt?0:63<lt?63:lt)){var at=lt;0<Ye.wb&&(at=4<Ye.wb?at>>2:at>>1)>9-Ye.wb&&(at=9-Ye.wb),1>at&&(at=1),Je.dd=at,Je.tc=2*lt+at,Je.ld=40<=lt?2:15<=lt?1:0}else Je.tc=0;Je.La=$e}}}De=0}else gn(fe,6,"Frame setup failed"),De=fe.a;if(De=De==0){if(De){fe.$c=0,0<fe.Aa||(fe.Ic=j6);t:{De=fe.Ic,Ye=4*(at=fe.za);var Et=32*at,_t=at+1,Vt=0<fe.L?at*(0<fe.Aa?2:1):0,jt=(fe.Aa==2?2:1)*at;if((Je=Ye+832+($e=3*(16*De+Kf[fe.L])/2*Et)+(Ge=fe.Fa!=null&&0<fe.Fa.length?fe.Kc.c*fe.Kc.i:0))!=Je)De=0;else{if(Je>fe.Vb){if(fe.Vb=0,fe.Ec=s(Je),fe.Fc=0,fe.Ec==null){De=gn(fe,1,"no memory during frame initialization.");break t}fe.Vb=Je}Je=fe.Ec,lt=fe.Fc,fe.Ac=Je,fe.Bc=lt,lt+=Ye,fe.Gd=o(Et,cs),fe.Hd=0,fe.rb=o(_t+1,$r),fe.sb=1,fe.wa=Vt?o(Vt,Ht):null,fe.Y=0,fe.D.Nb=0,fe.D.wa=fe.wa,fe.D.Y=fe.Y,0<fe.Aa&&(fe.D.Y+=at),t(!0),fe.oc=Je,fe.pc=lt,lt+=832,fe.ya=o(jt,Ms),fe.aa=0,fe.D.ya=fe.ya,fe.D.aa=fe.aa,fe.Aa==2&&(fe.D.aa+=at),fe.R=16*at,fe.B=8*at,at=(Et=Kf[fe.L])*fe.R,Et=Et/2*fe.B,fe.sa=Je,fe.ta=lt+at,fe.qa=fe.sa,fe.ra=fe.ta+16*De*fe.R+Et,fe.Ha=fe.qa,fe.Ia=fe.ra+8*De*fe.B+Et,fe.$c=0,lt+=$e,fe.mb=Ge?Je:null,fe.nb=Ge?lt:null,t(lt+Ge<=fe.Fc+fe.Vb),ol(fe),a(fe.Ac,fe.Bc,0,Ye),De=1}}if(De){if(Se.ka=0,Se.y=fe.sa,Se.O=fe.ta,Se.f=fe.qa,Se.N=fe.ra,Se.ea=fe.Ha,Se.Vd=fe.Ia,Se.fa=fe.R,Se.Rc=fe.B,Se.F=null,Se.J=0,!W2){for(De=-255;255>=De;++De)M2[255+De]=0>De?-De:De;for(De=-1020;1020>=De;++De)I2[1020+De]=-128>De?-128:127<De?127:De;for(De=-112;112>=De;++De)B2[112+De]=-16>De?-16:15<De?15:De;for(De=-255;510>=De;++De)U2[255+De]=0>De?0:255<De?255:De;W2=1}Ao=Df,Sl=Hm,di=qm,mr=oi,jr=Cf,fs=zm,ln=Lf,kn=Ff,Ui=k,Yd=W,bc=pl,Bf=$f,E2=he,C2=be,D2=$d,O2=ml,P2=Of,L2=Pf,Bs[0]=Zm,Bs[1]=Ed,Bs[2]=Xm,Bs[3]=Jm,Bs[4]=Qm,Bs[5]=$i,Bs[6]=Fi,Bs[7]=ep,Bs[8]=fc,Bs[9]=tp,Eo[0]=yo,Eo[1]=Vm,Eo[2]=Gm,Eo[3]=Cd,Eo[4]=Km,Eo[5]=dl,Eo[6]=Dd,Wi[0]=mc,Wi[1]=Ym,Wi[2]=Od,Wi[3]=ul,Wi[4]=Pd,Wi[5]=rp,Wi[6]=Ld,De=1}else De=0}De&&(De=function(tr,Sn){for(tr.M=0;tr.M<tr.Va;++tr.M){var Gt,Tt=tr.Jc[tr.M&tr.Xb],gt=tr.m,cn=tr;for(Gt=0;Gt<cn.za;++Gt){var qt=gt,ar=cn,Rr=ar.Ac,Bn=ar.Bc+4*Gt,xa=ar.zc,Xr=ar.ya[ar.aa+Gt];if(ar.Qa.Bb?Xr.$b=oe(qt,ar.Pa.jb[0])?2+oe(qt,ar.Pa.jb[2]):oe(qt,ar.Pa.jb[1]):Xr.$b=0,ar.kc&&(Xr.Ad=oe(qt,ar.Bd)),Xr.Za=!oe(qt,145)+0,Xr.Za){var ra=Xr.Ob,va=0;for(ar=0;4>ar;++ar){var jn,or=xa[0+ar];for(jn=0;4>jn;++jn){or=u6[Rr[Bn+jn]][or];for(var pr=Y2[oe(qt,or[0])];0<pr;)pr=Y2[2*pr+oe(qt,or[pr])];or=-pr,Rr[Bn+jn]=or}n(ra,va,Rr,Bn,4),va+=4,xa[0+ar]=or}}else or=oe(qt,156)?oe(qt,128)?1:3:oe(qt,163)?2:0,Xr.Ob[0]=or,a(Rr,Bn,or,4),a(xa,0,or,4);Xr.Dd=oe(qt,142)?oe(qt,114)?oe(qt,183)?1:3:2:0}if(cn.m.Ka)return gn(tr,7,"Premature end-of-partition0 encountered.");for(;tr.ja<tr.za;++tr.ja){if(cn=Tt,qt=(gt=tr).rb[gt.sb-1],Rr=gt.rb[gt.sb+gt.ja],Gt=gt.ya[gt.aa+gt.ja],Bn=gt.kc?Gt.Ad:0)qt.la=Rr.la=0,Gt.Za||(qt.Na=Rr.Na=0),Gt.Hc=0,Gt.Gc=0,Gt.ia=0;else{var Jr,gr;if(qt=Rr,Rr=cn,Bn=gt.Pa.Xc,xa=gt.ya[gt.aa+gt.ja],Xr=gt.pb[xa.$b],ar=xa.ad,ra=0,va=gt.rb[gt.sb-1],or=jn=0,a(ar,ra,0,384),xa.Za)var Un=0,Us=Bn[3];else{pr=s(16);var dn=qt.Na+va.Na;if(dn=Gd(Rr,Bn[1],dn,Xr.Eb,0,pr,0),qt.Na=va.Na=(0<dn)+0,1<dn)Ao(pr,0,ar,ra);else{var ja=pr[0]+3>>3;for(pr=0;256>pr;pr+=16)ar[ra+pr]=ja}Un=1,Us=Bn[0]}var Tr=15&qt.la,Tn=15&va.la;for(pr=0;4>pr;++pr){var Va=1&Tn;for(ja=gr=0;4>ja;++ja)Tr=Tr>>1|(Va=(dn=Gd(Rr,Us,dn=Va+(1&Tr),Xr.Sc,Un,ar,ra))>Un)<<7,gr=gr<<2|(3<dn?3:1<dn?2:ar[ra+0]!=0),ra+=16;Tr>>=4,Tn=Tn>>1|Va<<7,jn=(jn<<8|gr)>>>0}for(Us=Tr,Un=Tn>>4,Jr=0;4>Jr;Jr+=2){for(gr=0,Tr=qt.la>>4+Jr,Tn=va.la>>4+Jr,pr=0;2>pr;++pr){for(Va=1&Tn,ja=0;2>ja;++ja)dn=Va+(1&Tr),Tr=Tr>>1|(Va=0<(dn=Gd(Rr,Bn[2],dn,Xr.Qc,0,ar,ra)))<<3,gr=gr<<2|(3<dn?3:1<dn?2:ar[ra+0]!=0),ra+=16;Tr>>=2,Tn=Tn>>1|Va<<5}or|=gr<<4*Jr,Us|=Tr<<4<<Jr,Un|=(240&Tn)<<Jr}qt.la=Us,va.la=Un,xa.Hc=jn,xa.Gc=or,xa.ia=43690&or?0:Xr.ia,Bn=!(jn|or)}if(0<gt.L&&(gt.wa[gt.Y+gt.ja]=gt.gd[Gt.$b][Gt.Za],gt.wa[gt.Y+gt.ja].La|=!Bn),cn.Ka)return gn(tr,7,"Premature end-of-file encountered.")}if(ol(tr),gt=Sn,cn=1,Gt=(Tt=tr).D,qt=0<Tt.L&&Tt.M>=Tt.zb&&Tt.M<=Tt.Va,Tt.Aa==0)t:{if(Gt.M=Tt.M,Gt.uc=qt,us(Tt,Gt),cn=1,Gt=(gr=Tt.D).Nb,qt=(or=Kf[Tt.L])*Tt.R,Rr=or/2*Tt.B,pr=16*Gt*Tt.R,ja=8*Gt*Tt.B,Bn=Tt.sa,xa=Tt.ta-qt+pr,Xr=Tt.qa,ar=Tt.ra-Rr+ja,ra=Tt.Ha,va=Tt.Ia-Rr+ja,Tn=(Tr=gr.M)==0,jn=Tr>=Tt.Va-1,Tt.Aa==2&&us(Tt,gr),gr.uc)for(Va=(dn=Tt).D.M,t(dn.D.uc),gr=dn.yb;gr<dn.Hb;++gr){Un=gr,Us=Va;var ba=(Ga=(Wn=dn).D).Nb;Jr=Wn.R;var Ga=Ga.wa[Ga.Y+Un],Ka=Wn.sa,Ta=Wn.ta+16*ba*Jr+16*Un,Xa=Ga.dd,Or=Ga.tc;if(Or!=0)if(t(3<=Or),Wn.L==1)0<Un&&O2(Ka,Ta,Jr,Or+4),Ga.La&&L2(Ka,Ta,Jr,Or),0<Us&&D2(Ka,Ta,Jr,Or+4),Ga.La&&P2(Ka,Ta,Jr,Or);else{var Ja=Wn.B,Ws=Wn.qa,jl=Wn.ra+8*ba*Ja+8*Un,zi=Wn.Ha,Wn=Wn.Ia+8*ba*Ja+8*Un;ba=Ga.ld,0<Un&&(kn(Ka,Ta,Jr,Or+4,Xa,ba),Yd(Ws,jl,zi,Wn,Ja,Or+4,Xa,ba)),Ga.La&&(Bf(Ka,Ta,Jr,Or,Xa,ba),C2(Ws,jl,zi,Wn,Ja,Or,Xa,ba)),0<Us&&(ln(Ka,Ta,Jr,Or+4,Xa,ba),Ui(Ws,jl,zi,Wn,Ja,Or+4,Xa,ba)),Ga.La&&(bc(Ka,Ta,Jr,Or,Xa,ba),E2(Ws,jl,zi,Wn,Ja,Or,Xa,ba))}}if(Tt.ia&&alert("todo:DitherRow"),gt.put!=null){if(gr=16*Tr,Tr=16*(Tr+1),Tn?(gt.y=Tt.sa,gt.O=Tt.ta+pr,gt.f=Tt.qa,gt.N=Tt.ra+ja,gt.ea=Tt.Ha,gt.W=Tt.Ia+ja):(gr-=or,gt.y=Bn,gt.O=xa,gt.f=Xr,gt.N=ar,gt.ea=ra,gt.W=va),jn||(Tr-=or),Tr>gt.o&&(Tr=gt.o),gt.F=null,gt.J=null,Tt.Fa!=null&&0<Tt.Fa.length&&gr<Tr&&(gt.J=xn(Tt,gt,gr,Tr-gr),gt.F=Tt.mb,gt.F==null&&gt.F.length==0)){cn=gn(Tt,3,"Could not decode alpha data.");break t}gr<gt.j&&(or=gt.j-gr,gr=gt.j,t(!(1&or)),gt.O+=Tt.R*or,gt.N+=Tt.B*(or>>1),gt.W+=Tt.B*(or>>1),gt.F!=null&&(gt.J+=gt.width*or)),gr<Tr&&(gt.O+=gt.v,gt.N+=gt.v>>1,gt.W+=gt.v>>1,gt.F!=null&&(gt.J+=gt.v),gt.ka=gr-gt.j,gt.U=gt.va-gt.v,gt.T=Tr-gr,cn=gt.put(gt))}Gt+1!=Tt.Ic||jn||(n(Tt.sa,Tt.ta-qt,Bn,xa+16*Tt.R,qt),n(Tt.qa,Tt.ra-Rr,Xr,ar+8*Tt.B,Rr),n(Tt.Ha,Tt.Ia-Rr,ra,va+8*Tt.B,Rr))}if(!cn)return gn(tr,6,"Output aborted.")}return 1}(fe,Se)),Se.bc!=null&&Se.bc(Se),De&=1}return De?(fe.cb=0,De):0})(p,P)||(v=p.a)}}else v=p.a}v==0&&Z.Oa!=null&&Z.Oa.fd&&(v=Bd(Z.ba))}Z=v}K=Z!=0?null:11>K?te.f.RGBA.eb:te.f.kb.y}else K=null;return K};var ev=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(E,B){for(var C="",M=0;M<4;M++)C+=String.fromCharCode(E[B++]);return C}function u(E,B){return E[B+0]|E[B+1]<<8}function h(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function m(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var f=[0],x=[0],g=[],b=new c,y=e,N=function(E,B){var C={},M=0,U=!1,F=0,ne=0;if(C.frames=[],!function(w,A){for(var T=0;T<4;T++)if(w[A+T]!="RIFF".charCodeAt(T))return!0;return!1}(E,B)){for(m(E,B+=4),B+=8;B<E.length;){var V=d(E,B),ee=m(E,B+=4);B+=4;var me=ee+(1&ee);switch(V){case"VP8 ":case"VP8L":C.frames[M]===void 0&&(C.frames[M]={}),(xe=C.frames[M]).src_off=U?ne:B-8,xe.src_size=F+ee+8,M++,U&&(U=!1,F=0,ne=0);break;case"VP8X":(xe=C.header={}).feature_flags=E[B];var ye=B+4;xe.canvas_width=1+h(E,ye),ye+=3,xe.canvas_height=1+h(E,ye),ye+=3;break;case"ALPH":U=!0,F=me+8,ne=B-8;break;case"ANIM":(xe=C.header).bgcolor=m(E,B),ye=B+4,xe.loop_count=u(E,ye),ye+=2;break;case"ANMF":var Oe,xe;(xe=C.frames[M]={}).offset_x=2*h(E,B),B+=3,xe.offset_y=2*h(E,B),B+=3,xe.width=1+h(E,B),B+=3,xe.height=1+h(E,B),B+=3,xe.duration=h(E,B),B+=3,Oe=E[B++],xe.dispose=1&Oe,xe.blend=Oe>>1&1}V!="ANMF"&&(B+=me)}return C}}(y,0);N.response=y,N.rgbaoutput=!0,N.dataurl=!1;var S=N.header?N.header:null,_=N.frames?N.frames:null;if(S){S.loop_counter=S.loop_count,f=[S.canvas_height],x=[S.canvas_width];for(var D=0;D<_.length&&_[D].blend!=0;D++);}var I=_[0],O=b.WebPDecodeRGBA(y,I.src_off,I.src_size,x,f);I.rgba=O,I.imgwidth=x[0],I.imgheight=f[0];for(var R=0;R<x[0]*f[0]*4;R++)g[R]=O[R];return this.width=x,this.height=f,this.data=g,this}(function(e){var t,r,n,a,s,o,l,c,d,u=function(w){return w=w||{},this.isStrokeTransparent=w.isStrokeTransparent||!1,this.strokeOpacity=w.strokeOpacity||1,this.strokeStyle=w.strokeStyle||"#000000",this.fillStyle=w.fillStyle||"#000000",this.isFillTransparent=w.isFillTransparent||!1,this.fillOpacity=w.fillOpacity||1,this.font=w.font||"10px sans-serif",this.textBaseline=w.textBaseline||"alphabetic",this.textAlign=w.textAlign||"left",this.lineWidth=w.lineWidth||1,this.lineJoin=w.lineJoin||"miter",this.lineCap=w.lineCap||"butt",this.path=w.path||[],this.transform=w.transform!==void 0?w.transform.clone():new c,this.globalCompositeOperation=w.globalCompositeOperation||"normal",this.globalAlpha=w.globalAlpha||1,this.clip_path=w.clip_path||[],this.currentPoint=w.currentPoint||new o,this.miterLimit=w.miterLimit||10,this.lastPoint=w.lastPoint||new o,this.lineDashOffset=w.lineDashOffset||0,this.lineDash=w.lineDash||[],this.margin=w.margin||[0,0,0,0],this.prevPageLastElemOffset=w.prevPageLastElemOffset||0,this.ignoreClearRect=typeof w.ignoreClearRect!="boolean"||w.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(w){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var A=w;Object.defineProperty(this,"pdf",{get:function(){return A}});var T=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return T},set:function(Te){T=!!Te}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(Te){L=!!Te}});var H=0;Object.defineProperty(this,"posX",{get:function(){return H},set:function(Te){isNaN(Te)||(H=Te)}});var X=0;Object.defineProperty(this,"posY",{get:function(){return X},set:function(Te){isNaN(Te)||(X=Te)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Te){var Y;typeof Te=="number"?Y=[Te,Te,Te,Te]:((Y=new Array(4))[0]=Te[0],Y[1]=Te.length>=2?Te[1]:Y[0],Y[2]=Te.length>=3?Te[2]:Y[0],Y[3]=Te.length>=4?Te[3]:Y[1]),d.margin=Y}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(Te){re=Te}});var ge=0;Object.defineProperty(this,"lastBreak",{get:function(){return ge},set:function(Te){ge=Te}});var oe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return oe},set:function(Te){oe=Te}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Te){Te instanceof u&&(d=Te)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Te){d.path=Te}});var je=[];Object.defineProperty(this,"ctxStack",{get:function(){return je},set:function(Te){je=Te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Te){var Y;Y=m(Te),this.ctx.fillStyle=Y.style,this.ctx.isFillTransparent=Y.a===0,this.ctx.fillOpacity=Y.a,this.pdf.setFillColor(Y.r,Y.g,Y.b,{a:Y.a}),this.pdf.setTextColor(Y.r,Y.g,Y.b,{a:Y.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Te){var Y=m(Te);this.ctx.strokeStyle=Y.style,this.ctx.isStrokeTransparent=Y.a===0,this.ctx.strokeOpacity=Y.a,Y.a===0?this.pdf.setDrawColor(255,255,255):(Y.a,this.pdf.setDrawColor(Y.r,Y.g,Y.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Te){["butt","round","square"].indexOf(Te)!==-1&&(this.ctx.lineCap=Te,this.pdf.setLineCap(Te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Te){isNaN(Te)||(this.ctx.lineWidth=Te,this.pdf.setLineWidth(Te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Te){["bevel","round","miter"].indexOf(Te)!==-1&&(this.ctx.lineJoin=Te,this.pdf.setLineJoin(Te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Te){isNaN(Te)||(this.ctx.miterLimit=Te,this.pdf.setMiterLimit(Te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Te){this.ctx.textBaseline=Te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Te){["right","end","center","left","start"].indexOf(Te)!==-1&&(this.ctx.textAlign=Te)}});var Ie=null,et=null;Object.defineProperty(this,"fontFaces",{get:function(){return et},set:function(Te){Ie=null,et=Te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Te){var Y;if(this.ctx.font=Te,(Y=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Te))!==null){var We=Y[1];Y[2];var Q=Y[3],ve=Y[4];Y[5];var we=Y[6],Re=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ve)[2];ve=Math.floor(Re==="px"?parseFloat(ve)*this.pdf.internal.scaleFactor:Re==="em"?parseFloat(ve)*this.pdf.getFontSize():parseFloat(ve)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ve);var He=function(pt){var yt,ir,ct=[],ut=pt.trim();if(ut==="")return ag;if(ut in Ay)return[Ay[ut]];for(;ut!=="";){switch(ir=null,yt=(ut=Cy(ut)).charAt(0)){case'"':case"'":ir=n$(ut.substring(1),yt);break;default:ir=a$(ut)}if(ir===null||(ct.push(ir[0]),(ut=Cy(ir[1]))!==""&&ut.charAt(0)!==","))return ag;ut=ut.replace(/^,/,"")}return ct}(we);if(this.fontFaces){var vt=function(pt,yt){if(Ie===null){var ir=function(ct){var ut=[];return Object.keys(ct).forEach(function(Ot){ct[Ot].forEach(function(zt){var Dt=null;switch(zt){case"bold":Dt={family:Ot,weight:"bold"};break;case"italic":Dt={family:Ot,style:"italic"};break;case"bolditalic":Dt={family:Ot,weight:"bold",style:"italic"};break;case"":case"normal":Dt={family:Ot}}Dt!==null&&(Dt.ref={name:Ot,style:zt},ut.push(Dt))})}),ut}(pt.getFontList());Ie=function(ct){for(var ut={},Ot=0;Ot<ct.length;++Ot){var zt=ng(ct[Ot]),Dt=zt.family,Xt=zt.stretch,$t=zt.style,_r=zt.weight;ut[Dt]=ut[Dt]||{},ut[Dt][Xt]=ut[Dt][Xt]||{},ut[Dt][Xt][$t]=ut[Dt][Xt][$t]||{},ut[Dt][Xt][$t][_r]=zt}return ut}(ir.concat(yt))}return Ie}(this.pdf,this.fontFaces),le=He.map(function(pt){return{family:pt,stretch:"normal",weight:Q,style:We}}),Ae=function(pt,yt,ir){for(var ct=(ir=ir||{}).defaultFontFamily||"times",ut=Object.assign({},r$,ir.genericFontFamilies||{}),Ot=null,zt=null,Dt=0;Dt<yt.length;++Dt)if(ut[(Ot=ng(yt[Dt])).family]&&(Ot.family=ut[Ot.family]),pt.hasOwnProperty(Ot.family)){zt=pt[Ot.family];break}if(!(zt=zt||pt[ct]))throw new Error("Could not find a font-family for the rule '"+Ey(Ot)+"' and default family '"+ct+"'.");if(zt=function(Xt,$t){if($t[Xt])return $t[Xt];var _r=sx[Xt],Fr=_r<=sx.normal?-1:1,ur=Ty($t,nN,_r,Fr);if(!ur)throw new Error("Could not find a matching font-stretch value for "+Xt);return ur}(Ot.stretch,zt),zt=function(Xt,$t){if($t[Xt])return $t[Xt];for(var _r=rN[Xt],Fr=0;Fr<_r.length;++Fr)if($t[_r[Fr]])return $t[_r[Fr]];throw new Error("Could not find a matching font-style for "+Xt)}(Ot.style,zt),!(zt=function(Xt,$t){if($t[Xt])return $t[Xt];if(Xt===400&&$t[500])return $t[500];if(Xt===500&&$t[400])return $t[400];var _r=t$[Xt],Fr=Ty($t,aN,_r,Xt<400?-1:1);if(!Fr)throw new Error("Could not find a matching font-weight for value "+Xt);return Fr}(Ot.weight,zt)))throw new Error("Failed to resolve a font for the rule '"+Ey(Ot)+"'.");return zt}(vt,le);this.pdf.setFont(Ae.ref.name,Ae.ref.style)}else{var Qe="";(Q==="bold"||parseInt(Q,10)>=700||We==="bold")&&(Qe="bold"),We==="italic"&&(Qe+="italic"),Qe.length===0&&(Qe="normal");for(var _e="",Ze={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ve=0;Ve<He.length;Ve++){if(this.pdf.internal.getFont(He[Ve],Qe,{noFallback:!0,disableWarning:!0})!==void 0){_e=He[Ve];break}if(Qe==="bolditalic"&&this.pdf.internal.getFont(He[Ve],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_e=He[Ve],Qe="bold";else if(this.pdf.internal.getFont(He[Ve],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_e=He[Ve],Qe="normal";break}}if(_e===""){for(var ot=0;ot<He.length;ot++)if(Ze[He[ot]]){_e=Ze[He[ot]];break}}_e=_e===""?"Times":_e,this.pdf.setFont(_e,Qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Te){this.ctx.globalCompositeOperation=Te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Te){this.ctx.globalAlpha=Te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Te){this.ctx.lineDashOffset=Te,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Te){this.ctx.lineDash=Te,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Te){this.ctx.ignoreClearRect=!!Te}})};h.prototype.setLineDash=function(w){this.lineDash=w},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){_.call(this,"fill",!1)},h.prototype.stroke=function(){_.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(w,A){if(isNaN(w)||isNaN(A))throw Ar.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var T=this.ctx.transform.applyToPoint(new o(w,A));this.path.push({type:"mt",x:T.x,y:T.y}),this.ctx.lastPoint=new o(w,A)},h.prototype.closePath=function(){var w=new o(0,0),A=0;for(A=this.path.length-1;A!==-1;A--)if(this.path[A].type==="begin"&&Qt(this.path[A+1])==="object"&&typeof this.path[A+1].x=="number"){w=new o(this.path[A+1].x,this.path[A+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(w.x,w.y)},h.prototype.lineTo=function(w,A){if(isNaN(w)||isNaN(A))throw Ar.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var T=this.ctx.transform.applyToPoint(new o(w,A));this.path.push({type:"lt",x:T.x,y:T.y}),this.ctx.lastPoint=new o(T.x,T.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},h.prototype.quadraticCurveTo=function(w,A,T,L){if(isNaN(T)||isNaN(L)||isNaN(w)||isNaN(A))throw Ar.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var H=this.ctx.transform.applyToPoint(new o(T,L)),X=this.ctx.transform.applyToPoint(new o(w,A));this.path.push({type:"qct",x1:X.x,y1:X.y,x:H.x,y:H.y}),this.ctx.lastPoint=new o(H.x,H.y)},h.prototype.bezierCurveTo=function(w,A,T,L,H,X){if(isNaN(H)||isNaN(X)||isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L))throw Ar.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new o(H,X)),ge=this.ctx.transform.applyToPoint(new o(w,A)),oe=this.ctx.transform.applyToPoint(new o(T,L));this.path.push({type:"bct",x1:ge.x,y1:ge.y,x2:oe.x,y2:oe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new o(re.x,re.y)},h.prototype.arc=function(w,A,T,L,H,X){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L)||isNaN(H))throw Ar.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(X=!!X,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new o(w,A));w=re.x,A=re.y;var ge=this.ctx.transform.applyToPoint(new o(0,T)),oe=this.ctx.transform.applyToPoint(new o(0,0));T=Math.sqrt(Math.pow(ge.x-oe.x,2)+Math.pow(ge.y-oe.y,2))}Math.abs(H-L)>=2*Math.PI&&(L=0,H=2*Math.PI),this.path.push({type:"arc",x:w,y:A,radius:T,startAngle:L,endAngle:H,counterclockwise:X})},h.prototype.arcTo=function(w,A,T,L,H){throw new Error("arcTo not implemented.")},h.prototype.rect=function(w,A,T,L){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L))throw Ar.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(w,A),this.lineTo(w+T,A),this.lineTo(w+T,A+L),this.lineTo(w,A+L),this.lineTo(w,A),this.lineTo(w+T,A),this.lineTo(w,A)},h.prototype.fillRect=function(w,A,T,L){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L))throw Ar.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var H={};this.lineCap!=="butt"&&(H.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(H.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(w,A,T,L),this.fill(),H.hasOwnProperty("lineCap")&&(this.lineCap=H.lineCap),H.hasOwnProperty("lineJoin")&&(this.lineJoin=H.lineJoin)}},h.prototype.strokeRect=function(w,A,T,L){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L))throw Ar.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(w,A,T,L),this.stroke())},h.prototype.clearRect=function(w,A,T,L){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L))throw Ar.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(w,A,T,L))},h.prototype.save=function(w){w=typeof w!="boolean"||w;for(var A=this.pdf.internal.getCurrentPageInfo().pageNumber,T=0;T<this.pdf.internal.getNumberOfPages();T++)this.pdf.setPage(T+1),this.pdf.internal.out("q");if(this.pdf.setPage(A),w){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},h.prototype.restore=function(w){w=typeof w!="boolean"||w;for(var A=this.pdf.internal.getCurrentPageInfo().pageNumber,T=0;T<this.pdf.internal.getNumberOfPages();T++)this.pdf.setPage(T+1),this.pdf.internal.out("Q");this.pdf.setPage(A),w&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(w){var A,T,L,H;if(w.isCanvasGradient===!0&&(w=w.getColor()),!w)return{r:0,g:0,b:0,a:0,style:w};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(w))A=0,T=0,L=0,H=0;else{var X=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(w);if(X!==null)A=parseInt(X[1]),T=parseInt(X[2]),L=parseInt(X[3]),H=1;else if((X=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(w))!==null)A=parseInt(X[1]),T=parseInt(X[2]),L=parseInt(X[3]),H=parseFloat(X[4]);else{if(H=1,typeof w=="string"&&w.charAt(0)!=="#"){var re=new K3(w);w=re.ok?re.toHex():"#000000"}w.length===4?(A=w.substring(1,2),A+=A,T=w.substring(2,3),T+=T,L=w.substring(3,4),L+=L):(A=w.substring(1,3),T=w.substring(3,5),L=w.substring(5,7)),A=parseInt(A,16),T=parseInt(T,16),L=parseInt(L,16)}}return{r:A,g:T,b:L,a:H,style:w}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(w,A,T,L){if(isNaN(A)||isNaN(T)||typeof w!="string")throw Ar.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!f.call(this)){var H=me(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;M.call(this,{text:w,x:A,y:T,scale:X,angle:H,align:this.textAlign,maxWidth:L})}},h.prototype.strokeText=function(w,A,T,L){if(isNaN(A)||isNaN(T)||typeof w!="string")throw Ar.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){L=isNaN(L)?void 0:L;var H=me(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;M.call(this,{text:w,x:A,y:T,scale:X,renderingMode:"stroke",angle:H,align:this.textAlign,maxWidth:L})}},h.prototype.measureText=function(w){if(typeof w!="string")throw Ar.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var A=this.pdf,T=this.pdf.internal.scaleFactor,L=A.internal.getFontSize(),H=A.getStringUnitWidth(w)*L/A.internal.scaleFactor;return new function(X){var re=(X=X||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return re}}),this}({width:H*=Math.round(96*T/72*1e4)/1e4})},h.prototype.scale=function(w,A){if(isNaN(w)||isNaN(A))throw Ar.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var T=new c(w,0,0,A,0,0);this.ctx.transform=this.ctx.transform.multiply(T)},h.prototype.rotate=function(w){if(isNaN(w))throw Ar.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var A=new c(Math.cos(w),Math.sin(w),-Math.sin(w),Math.cos(w),0,0);this.ctx.transform=this.ctx.transform.multiply(A)},h.prototype.translate=function(w,A){if(isNaN(w)||isNaN(A))throw Ar.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var T=new c(1,0,0,1,w,A);this.ctx.transform=this.ctx.transform.multiply(T)},h.prototype.transform=function(w,A,T,L,H,X){if(isNaN(w)||isNaN(A)||isNaN(T)||isNaN(L)||isNaN(H)||isNaN(X))throw Ar.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new c(w,A,T,L,H,X);this.ctx.transform=this.ctx.transform.multiply(re)},h.prototype.setTransform=function(w,A,T,L,H,X){w=isNaN(w)?1:w,A=isNaN(A)?0:A,T=isNaN(T)?0:T,L=isNaN(L)?1:L,H=isNaN(H)?0:H,X=isNaN(X)?0:X,this.ctx.transform=new c(w,A,T,L,H,X)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(w,A,T,L,H,X,re,ge,oe){var je=this.pdf.getImageProperties(w),Ie=1,et=1,Te=1,Y=1;L!==void 0&&ge!==void 0&&(Te=ge/L,Y=oe/H,Ie=je.width/L*ge/L,et=je.height/H*oe/H),X===void 0&&(X=A,re=T,A=0,T=0),L!==void 0&&ge===void 0&&(ge=L,oe=H),L===void 0&&ge===void 0&&(ge=je.width,oe=je.height);for(var We,Q=this.ctx.transform.decompose(),ve=me(Q.rotate.shx),we=new c,Re=(we=(we=(we=we.multiply(Q.translate)).multiply(Q.skew)).multiply(Q.scale)).applyToRectangle(new l(X-A*Te,re-T*Y,L*Ie,H*et)),He=b.call(this,Re),vt=[],le=0;le<He.length;le+=1)vt.indexOf(He[le])===-1&&vt.push(He[le]);if(S(vt),this.autoPaging)for(var Ae=vt[0],Qe=vt[vt.length-1],_e=Ae;_e<Qe+1;_e++){this.pdf.setPage(_e);var Ze=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ve=_e===1?this.posY+this.margin[0]:this.margin[0],ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=_e===1?0:ot+(_e-2)*pt;if(this.ctx.clip_path.length!==0){var ir=this.path;We=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(We,this.posX+this.margin[3],-yt+Ve+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=ir}var ct=JSON.parse(JSON.stringify(Re));ct=N([ct],this.posX+this.margin[3],-yt+Ve+this.ctx.prevPageLastElemOffset)[0];var ut=(_e>Ae||_e<Qe)&&g.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ze,pt,null).clip().discardPath()),this.pdf.addImage(w,"JPEG",ct.x,ct.y,ct.w,ct.h,null,null,ve),ut&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(w,"JPEG",Re.x,Re.y,Re.w,Re.h,null,null,ve)};var b=function(w,A,T){var L=[];A=A||this.pdf.internal.pageSize.width,T=T||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var H=this.posY+this.ctx.prevPageLastElemOffset;switch(w.type){default:case"mt":case"lt":L.push(Math.floor((w.y+H)/T)+1);break;case"arc":L.push(Math.floor((w.y+H-w.radius)/T)+1),L.push(Math.floor((w.y+H+w.radius)/T)+1);break;case"qct":var X=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x,w.y);L.push(Math.floor((X.y+H)/T)+1),L.push(Math.floor((X.y+X.h+H)/T)+1);break;case"bct":var re=Oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x2,w.y2,w.x,w.y);L.push(Math.floor((re.y+H)/T)+1),L.push(Math.floor((re.y+re.h+H)/T)+1);break;case"rect":L.push(Math.floor((w.y+H)/T)+1),L.push(Math.floor((w.y+w.h+H)/T)+1)}for(var ge=0;ge<L.length;ge+=1)for(;this.pdf.internal.getNumberOfPages()<L[ge];)y.call(this);return L},y=function(){var w=this.fillStyle,A=this.strokeStyle,T=this.font,L=this.lineCap,H=this.lineWidth,X=this.lineJoin;this.pdf.addPage(),this.fillStyle=w,this.strokeStyle=A,this.font=T,this.lineCap=L,this.lineWidth=H,this.lineJoin=X},N=function(w,A,T){for(var L=0;L<w.length;L++)switch(w[L].type){case"bct":w[L].x2+=A,w[L].y2+=T;case"qct":w[L].x1+=A,w[L].y1+=T;default:w[L].x+=A,w[L].y+=T}return w},S=function(w){return w.sort(function(A,T){return A-T})},_=function(w,A){for(var T,L,H=this.fillStyle,X=this.strokeStyle,re=this.lineCap,ge=this.lineWidth,oe=Math.abs(ge*this.ctx.transform.scaleX),je=this.lineJoin,Ie=JSON.parse(JSON.stringify(this.path)),et=JSON.parse(JSON.stringify(this.path)),Te=[],Y=0;Y<et.length;Y++)if(et[Y].x!==void 0)for(var We=b.call(this,et[Y]),Q=0;Q<We.length;Q+=1)Te.indexOf(We[Q])===-1&&Te.push(We[Q]);for(var ve=0;ve<Te.length;ve++)for(;this.pdf.internal.getNumberOfPages()<Te[ve];)y.call(this);if(S(Te),this.autoPaging)for(var we=Te[0],Re=Te[Te.length-1],He=we;He<Re+1;He++){this.pdf.setPage(He),this.fillStyle=H,this.strokeStyle=X,this.lineCap=re,this.lineWidth=oe,this.lineJoin=je;var vt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],le=He===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_e=He===1?0:Ae+(He-2)*Qe;if(this.ctx.clip_path.length!==0){var Ze=this.path;T=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(T,this.posX+this.margin[3],-_e+le+this.ctx.prevPageLastElemOffset),D.call(this,w,!0),this.path=Ze}if(L=JSON.parse(JSON.stringify(Ie)),this.path=N(L,this.posX+this.margin[3],-_e+le+this.ctx.prevPageLastElemOffset),A===!1||He===0){var Ve=(He>we||He<Re)&&g.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vt,Qe,null).clip().discardPath()),D.call(this,w,A),Ve&&this.pdf.restoreGraphicsState()}this.lineWidth=ge}else this.lineWidth=oe,D.call(this,w,A),this.lineWidth=ge;this.path=Ie},D=function(w,A){if((w!=="stroke"||A||!x.call(this))&&(w==="stroke"||A||!f.call(this))){for(var T,L,H=[],X=this.path,re=0;re<X.length;re++){var ge=X[re];switch(ge.type){case"begin":H.push({begin:!0});break;case"close":H.push({close:!0});break;case"mt":H.push({start:ge,deltas:[],abs:[]});break;case"lt":var oe=H.length;if(X[re-1]&&!isNaN(X[re-1].x)&&(T=[ge.x-X[re-1].x,ge.y-X[re-1].y],oe>0)){for(;oe>=0;oe--)if(H[oe-1].close!==!0&&H[oe-1].begin!==!0){H[oe-1].deltas.push(T),H[oe-1].abs.push(ge);break}}break;case"bct":T=[ge.x1-X[re-1].x,ge.y1-X[re-1].y,ge.x2-X[re-1].x,ge.y2-X[re-1].y,ge.x-X[re-1].x,ge.y-X[re-1].y],H[H.length-1].deltas.push(T);break;case"qct":var je=X[re-1].x+2/3*(ge.x1-X[re-1].x),Ie=X[re-1].y+2/3*(ge.y1-X[re-1].y),et=ge.x+2/3*(ge.x1-ge.x),Te=ge.y+2/3*(ge.y1-ge.y),Y=ge.x,We=ge.y;T=[je-X[re-1].x,Ie-X[re-1].y,et-X[re-1].x,Te-X[re-1].y,Y-X[re-1].x,We-X[re-1].y],H[H.length-1].deltas.push(T);break;case"arc":H.push({deltas:[],abs:[],arc:!0}),Array.isArray(H[H.length-1].abs)&&H[H.length-1].abs.push(ge)}}L=A?null:w==="stroke"?"stroke":"fill";for(var Q=!1,ve=0;ve<H.length;ve++)if(H[ve].arc)for(var we=H[ve].abs,Re=0;Re<we.length;Re++){var He=we[Re];He.type==="arc"?R.call(this,He.x,He.y,He.radius,He.startAngle,He.endAngle,He.counterclockwise,void 0,A,!Q):U.call(this,He.x,He.y),Q=!0}else if(H[ve].close===!0)this.pdf.internal.out("h"),Q=!1;else if(H[ve].begin!==!0){var vt=H[ve].start.x,le=H[ve].start.y;F.call(this,H[ve].deltas,vt,le),Q=!0}L&&E.call(this,L),A&&B.call(this)}},I=function(w){var A=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,T=A*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return w-T;case"top":return w+A-T;case"hanging":return w+A-2*T;case"middle":return w+A/2-T;default:return w}},O=function(w){return w+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var w=function(){};return w.colorStops=[],w.addColorStop=function(A,T){this.colorStops.push([A,T])},w.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},w.isCanvasGradient=!0,w},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(w,A,T,L,H,X,re,ge,oe){for(var je=V.call(this,T,L,H,X),Ie=0;Ie<je.length;Ie++){var et=je[Ie];Ie===0&&(oe?C.call(this,et.x1+w,et.y1+A):U.call(this,et.x1+w,et.y1+A)),ne.call(this,w,A,et.x2,et.y2,et.x3,et.y3,et.x4,et.y4)}ge?B.call(this):E.call(this,re)},E=function(w){switch(w){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},C=function(w,A){this.pdf.internal.out(r(w)+" "+n(A)+" m")},M=function(w){var A;switch(w.align){case"right":case"end":A="right";break;case"center":A="center";break;default:A="left"}var T=this.pdf.getTextDimensions(w.text),L=I.call(this,w.y),H=O.call(this,L)-T.h,X=this.ctx.transform.applyToPoint(new o(w.x,L)),re=this.ctx.transform.decompose(),ge=new c;ge=(ge=(ge=ge.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var oe,je,Ie,et=this.ctx.transform.applyToRectangle(new l(w.x,L,T.w,T.h)),Te=ge.applyToRectangle(new l(w.x,H,T.w,T.h)),Y=b.call(this,Te),We=[],Q=0;Q<Y.length;Q+=1)We.indexOf(Y[Q])===-1&&We.push(Y[Q]);if(S(We),this.autoPaging)for(var ve=We[0],we=We[We.length-1],Re=ve;Re<we+1;Re++){this.pdf.setPage(Re);var He=Re===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],le=this.pdf.internal.pageSize.height-this.margin[2],Ae=le-this.margin[0],Qe=this.pdf.internal.pageSize.width-this.margin[1],_e=Qe-this.margin[3],Ze=Re===1?0:vt+(Re-2)*Ae;if(this.ctx.clip_path.length!==0){var Ve=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(oe,this.posX+this.margin[3],-1*Ze+He),D.call(this,"fill",!0),this.path=Ve}var ot=N([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-Ze+He+this.ctx.prevPageLastElemOffset)[0];w.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*w.scale),Ie=this.lineWidth,this.lineWidth=Ie*w.scale);var pt=this.autoPaging!=="text";if(pt||ot.y+ot.h<=le){if(pt||ot.y>=He&&ot.x<=Qe){var yt=pt?w.text:this.pdf.splitTextToSize(w.text,w.maxWidth||Qe-ot.x)[0],ir=N([JSON.parse(JSON.stringify(et))],this.posX+this.margin[3],-Ze+He+this.ctx.prevPageLastElemOffset)[0],ct=pt&&(Re>ve||Re<we)&&g.call(this);ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_e,Ae,null).clip().discardPath()),this.pdf.text(yt,ir.x,ir.y,{angle:w.angle,align:A,renderingMode:w.renderingMode}),ct&&this.pdf.restoreGraphicsState()}}else ot.y<le&&(this.ctx.prevPageLastElemOffset+=le-ot.y);w.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Ie)}else w.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*w.scale),Ie=this.lineWidth,this.lineWidth=Ie*w.scale),this.pdf.text(w.text,X.x+this.posX,X.y+this.posY,{angle:w.angle,align:A,renderingMode:w.renderingMode,maxWidth:w.maxWidth}),w.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Ie)},U=function(w,A,T,L){T=T||0,L=L||0,this.pdf.internal.out(r(w+T)+" "+n(A+L)+" l")},F=function(w,A,T){return this.pdf.lines(w,A,T,null,null)},ne=function(w,A,T,L,H,X,re,ge){this.pdf.internal.out([t(a(T+w)),t(s(L+A)),t(a(H+w)),t(s(X+A)),t(a(re+w)),t(s(ge+A)),"c"].join(" "))},V=function(w,A,T,L){for(var H=2*Math.PI,X=Math.PI/2;A>T;)A-=H;var re=Math.abs(T-A);re<H&&L&&(re=H-re);for(var ge=[],oe=L?-1:1,je=A;re>1e-5;){var Ie=je+oe*Math.min(re,X);ge.push(ee.call(this,w,je,Ie)),re-=Math.abs(Ie-je),je=Ie}return ge},ee=function(w,A,T){var L=(T-A)/2,H=w*Math.cos(L),X=w*Math.sin(L),re=H,ge=-X,oe=re*re+ge*ge,je=oe+re*H+ge*X,Ie=4/3*(Math.sqrt(2*oe*je)-je)/(re*X-ge*H),et=re-Ie*ge,Te=ge+Ie*re,Y=et,We=-Te,Q=L+A,ve=Math.cos(Q),we=Math.sin(Q);return{x1:w*Math.cos(A),y1:w*Math.sin(A),x2:et*ve-Te*we,y2:et*we+Te*ve,x3:Y*ve-We*we,y3:Y*we+We*ve,x4:w*Math.cos(T),y4:w*Math.sin(T)}},me=function(w){return 180*w/Math.PI},ye=function(w,A,T,L,H,X){var re=w+.5*(T-w),ge=A+.5*(L-A),oe=H+.5*(T-H),je=X+.5*(L-X),Ie=Math.min(w,H,re,oe),et=Math.max(w,H,re,oe),Te=Math.min(A,X,ge,je),Y=Math.max(A,X,ge,je);return new l(Ie,Te,et-Ie,Y-Te)},Oe=function(w,A,T,L,H,X,re,ge){var oe,je,Ie,et,Te,Y,We,Q,ve,we,Re,He,vt,le,Ae=T-w,Qe=L-A,_e=H-T,Ze=X-L,Ve=re-H,ot=ge-X;for(je=0;je<41;je++)ve=(We=(Ie=w+(oe=je/40)*Ae)+oe*((Te=T+oe*_e)-Ie))+oe*(Te+oe*(H+oe*Ve-Te)-We),we=(Q=(et=A+oe*Qe)+oe*((Y=L+oe*Ze)-et))+oe*(Y+oe*(X+oe*ot-Y)-Q),je==0?(Re=ve,He=we,vt=ve,le=we):(Re=Math.min(Re,ve),He=Math.min(He,we),vt=Math.max(vt,ve),le=Math.max(le,we));return new l(Math.round(Re),Math.round(He),Math.round(vt-Re),Math.round(le-He))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var w,A,T=(w=this.ctx.lineDash,A=this.ctx.lineDashOffset,JSON.stringify({lineDash:w,lineDashOffset:A}));this.prevLineDash!==T&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=T)}}})(Ct.API),function(e){var t=function(o){var l,c,d,u,h,m,f,x,g,b;for(c=[],d=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>d;d+=4)(h=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(m=(h=((h=((h=((h=(h-(b=h%85))/85)-(g=h%85))/85)-(x=h%85))/85)-(f=h%85))/85)%85,c.push(m+33,f+33,x+33,g+33,b+33)):c.push(122);return function(y,N){for(var S=N;S>0;S--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,d,u,h,m=String,f="length",x=255,g="charCodeAt",b="slice",y="replace";for(o[b](-2),o=o[b](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),d=[],u=0,h=(o+=l="uuuuu"[b](o[f]%5||5))[f];h>u;u+=5)c=52200625*(o[g](u)-33)+614125*(o[g](u+1)-33)+7225*(o[g](u+2)-33)+85*(o[g](u+3)-33)+(o[g](u+4)-33),d.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(N,S){for(var _=S;_>0;_--)N.pop()}(d,l[f]),m.fromCharCode.apply(m,d)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Jg(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(o,l){var c=0,d=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Ct.API),function(e){e.loadFile=function(t,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var h=new XMLHttpRequest,m=0,f=function(x){var g=x.length,b=[],y=String.fromCharCode;for(m=0;m<g;m+=1)b.push(y(255&x.charCodeAt(m)));return b.join("")};if(h.open("GET",c,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?u(f(this.responseText)):u(void 0)}),h.send(null),d&&h.status===200)return f(h.responseText)}(a,s,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Ct.API),function(e){function t(){return(Rt.html2canvas?Promise.resolve(Rt.html2canvas):Bh(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Rt.DOMPurify?Promise.resolve(Rt.DOMPurify):Bh(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Qt(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},s=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)d!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(l(h,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var f=0;f<u.length;++f){var x=u[f],g=x.src.find(function(b){return b.format==="truetype"});g&&d.addFont(g.url,x.ref.name,x.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,d.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Ct.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,h){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return d.updateProgress(null,u),m}).then(u,h).then(function(m){return d.updateProgress(1),m})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),m=d.call(h,l,c);return o.convert(m,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ct.getPageSize=function(l,c,d){if(Qt(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var h,m=(""+d).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+c}var x,g=0,b=0;if(f.hasOwnProperty(m))g=f[m][1]/h,b=f[m][0]/h;else try{g=d[1],b=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",b>g&&(x=b,b=g,g=x);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>b&&(x=b,b=g,g=x)}return{width:b,height:g,unit:c,k:h,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(ng):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(Ct.API),Ct.API.addJS=function(e){return Oy=e,this.internal.events.subscribe("postPutResources",function(){_h=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(_h+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Dy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Oy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){_h!==void 0&&Dy!==void 0&&this.internal.out("/Names <</JavaScript "+_h+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(s=0;s<d;s++){var h=r.internal.newObject();u.push(h);var m=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<u.length;s++)r.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(Ct.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,s,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(h){for(var m,f=256*h.charCodeAt(4)+h.charCodeAt(5),x=h.length,g={width:0,height:0,numcomponents:1},b=4;b<x;b+=2){if(b+=f,t.indexOf(h.charCodeAt(b+1))!==-1){m=256*h.charCodeAt(b+5)+h.charCodeAt(b+6),g={width:256*h.charCodeAt(b+7)+h.charCodeAt(b+8),height:m,numcomponents:h.charCodeAt(b+9)};break}f=256*h.charCodeAt(b+2)+h.charCodeAt(b+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:a}}return u}}(Ct.API),Ct.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,s=UF(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,d=s.palette,u=s.depth;a=d&&c===1?function(R){for(var E=R.width,B=R.height,C=R.data,M=R.palette,U=R.depth,F=!1,ne=[],V=[],ee=void 0,me=!1,ye=0,Oe=0;Oe<M.length;Oe++){var xe=Da(M[Oe],4),w=xe[0],A=xe[1],T=xe[2],L=xe[3];ne.push(w,A,T),L!=null&&(L===0?(ye++,V.length<1&&V.push(Oe)):L<255&&(me=!0))}if(me||ye>1){F=!0,V=void 0;var H=E*B;ee=new Uint8Array(H);for(var X=new DataView(C.buffer),re=0;re<H;re++){var ge=sg(X,re,U),oe=Da(M[ge],4)[3];ee[re]=oe}}else ye===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:F?8:void 0,colorBytes:C,alphaBytes:ee,needSMask:F,palette:ne,mask:V}}(s):c===2||c===4?function(R){for(var E=R.data,B=R.width,C=R.height,M=R.channels,U=R.depth,F=M===2?"DeviceGray":"DeviceRGB",ne=M-1,V=B*C,ee=ne,me=V*ee,ye=1*V,Oe=Math.ceil(me*U/8),xe=Math.ceil(ye*U/8),w=new Uint8Array(Oe),A=new Uint8Array(xe),T=new DataView(E.buffer),L=new DataView(w.buffer),H=new DataView(A.buffer),X=!1,re=0;re<V;re++){for(var ge=re*M,oe=0;oe<ee;oe++)Uy(L,sg(T,ge+oe,U),re*ee+oe,U);var je=sg(T,ge+ee,U);je<(1<<U)-1&&(X=!0),Uy(H,je,1*re,U)}return{colorSpace:F,colorsPerPixel:ne,sMaskBitsPerComponent:X?U:void 0,colorBytes:w,alphaBytes:A,needSMask:X}}(s):function(R){var E=R.data,B=R.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(C){for(var M=C.length,U=new Uint8Array(2*M),F=new DataView(U.buffer,U.byteOffset,U.byteLength),ne=0;ne<M;ne++)F.setUint16(2*ne,C[ne],!1);return U}(E):E,needSMask:!1}}(s);var h,m,f,x=a,g=x.colorSpace,b=x.colorsPerPixel,y=x.sMaskBitsPerComponent,N=x.colorBytes,S=x.alphaBytes,_=x.needSMask,D=x.palette,I=x.mask,O=null;return n!==Ct.API.image_compression.NONE&&typeof Jg=="function"?(O=function(R){var E;switch(R){case Ct.API.image_compression.FAST:E=11;break;case Ct.API.image_compression.MEDIUM:E=13;break;case Ct.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),h=this.decode.FLATE_DECODE,m="/Predictor ".concat(O," /Colors ").concat(b," /BitsPerComponent ").concat(u," /Columns ").concat(o),e=$y(N,Math.ceil(o*b*u/8),b,u,n),_&&(f=$y(S,Math.ceil(o*y/8),1,y,n))):(h=void 0,m=void 0,e=N,_&&(f=S)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:r,data:e,index:t,filter:h,decodeParameters:m,transparency:I,palette:D,sMask:f,predictor:O,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:y,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var s=new l$(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new ig(100).encode(d,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(Ct.API),qs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},qs.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Ar.log("bit decode error:"+r)}},qs.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},qs.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*a+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},qs.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},qs.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,d=s>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=e}},qs.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/t*255|0,u=a*this.width*4+4*s;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},qs.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},qs.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},qs.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var s=new qs(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},d=new ig(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Ct.API),zy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var s=new zy(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},d=new ig(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Ct.API),Ct.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,d=0;d<a;d+=4){var u=n[d],h=n[d+1],m=n[d+2],f=n[d+3];s[l++]=u,s[l++]=h,s[l++]=m,o[c++]=f}var x=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ct.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Tc=Ct.API,Nh=Tc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=t.doKerning!==!1,m=0,f=e.length,x=0,g=l[0]||c,b=[];for(r=0;r<f;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(m=h&&Qt(d[n])==="object"&&!isNaN(parseInt(d[n][x],10))?d[n][x]/u:0,b.push((l[n]||g)/c+m)),x=n;return b},Py=Tc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Tc.processArabic&&(e=Tc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:Nh.apply(this,arguments).reduce(function(s,o){return s+o},0)},Ly=function(e,t,r,n){for(var a=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;a.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(a.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&a.push(e.slice(c,s)),a},Fy=function(e,t,r){r||(r={});var n,a,s,o,l,c,d,u=[],h=[u],m=r.textIndent||0,f=0,x=0,g=e.split(" "),b=Nh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),N=[];g.map(function(_){(_=_.split(/\s*\n/)).length>1?N=N.concat(_.map(function(D,I){return(I&&D.length?`
`:"")+D})):N.push(_[0])}),g=N,c=Py.apply(this,[y,r])}for(s=0,o=g.length;s<o;s++){var S=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),S=1),m+f+(x=(a=Nh.apply(this,[n,r])).reduce(function(_,D){return _+D},0))>t||S){if(x>t){for(l=Ly.apply(this,[n,a,t-(m+f),t]),u.push(l.shift()),u=[l.pop()];l.length;)h.push([l.shift()]);x=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(_,D){return _+D},0)}else u=[n];h.push(u),m=x+c,f=b}else u.push(n),m+=f+x,f=b}return d=c?function(_,D){return(D?y:"")+_.join(" ")}:function(_){return _.join(" ")},h.map(d)},Tc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle),m="Unicode";return h.metadata[m]?{widths:h.metadata[m].widths||{0:1},kerning:h.metadata[m].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(Fy.apply(this,[n[l],o,s]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=t[s],a[t[s]]=r[s];var o=function(m){return"0x"+parseInt(m,10).toString(16)},l=e.__fontmetrics__.compress=function(m){var f,x,g,b,y=["{"];for(var N in m){if(f=m[N],isNaN(parseInt(N,10))?x="'"+N+"'":(N=parseInt(N,10),x=(x=o(N).slice(2)).slice(0,-1)+a[x.slice(-1)]),typeof f=="number")f<0?(g=o(f).slice(3),b="-"):(g=o(f).slice(2),b=""),g=b+g.slice(0,-1)+a[g.slice(-1)];else{if(Qt(f)!=="object")throw new Error("Don't know what to do with value type "+Qt(f)+".");g=l(f)}y.push(x+g)}return y.push("}"),y.join("")},c=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,x,g,b,y={},N=1,S=y,_=[],D="",I="",O=m.length-1,R=1;R<O;R+=1)(b=m[R])=="'"?f?(g=f.join(""),f=void 0):f=[]:f?f.push(b):b=="{"?(_.push([S,g]),S={},g=void 0):b=="}"?((x=_.pop())[0][x[1]]=S,g=void 0,S=x[0]):b=="-"?N=-1:g===void 0?n.hasOwnProperty(b)?(D+=n[b],g=parseInt(D,16)*N,N=1,D=""):D+=b:n.hasOwnProperty(b)?(I+=n[b],S[g]=parseInt(I,16)*N,N=1,g=void 0,I=""):I+=b;return y},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var f=m.font,x=h.Unicode[f.postScriptName];x&&(f.metadata.Unicode={},f.metadata.Unicode.widths=x.widths,f.metadata.Unicode.kerning=x.kerning);var g=u.Unicode[f.postScriptName];g&&(f.metadata.Unicode.encoding=g,f.encoding=g.codePages[0])}])}(Ct.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Wh(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(Ct),Ct.API.addSvgAsImage=function(e,t,r,n,a,s,o,l){if(isNaN(t)||isNaN(r))throw Ar.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Ar.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Rt.canvg?Promise.resolve(Rt.canvg):Bh(()=>import("./index.es-D9ZMLzc3.js"),__vite__mapDeps([0,1,2]))).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,o,l)})},Ct.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Ct.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,h=0;function m(x,g){var b,y=!1;for(b=0;b<x.length;b+=1)x[b]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var f=l.length;for(h=0;h<f;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(Qt(e)==="object"){for(a in e)if(s=e[a],m(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&m(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(d=0;d<s.length;d+=1)if(n=!0,s[d].length===1&&typeof s[d][0]=="number")c.push(String(s[d]-1));else if(s[d].length>1){for(u=0;u<s[d].length;u+=1)typeof s[d][u]!="number"&&(n=!1);n===!0&&c.push([s[d][0]-1,s[d][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,g=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?g.push("/"+x+" /"+r[x].value):g.push("/"+x+" "+r[x].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ct.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],h=0,m=s.length;h<m;++h){if(l=o.metadata.characterToGlyph(s.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(s){var o,l,c,d,u,h,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,m=(l=Object.keys(s).sort(function(f,x){return f-x})).length;h<m;h++)o=l[h],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(d=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",x=0;x<m.length;x++)f+=String.fromCharCode(m[x]);var g=d();u({data:f,addLength1:!0,objectId:g}),c("endobj");var b=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Oc(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var N=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Oc(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+e.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+b+" 0 R"),c("/BaseFont /"+Oc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+N+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,m="",f=0;f<h.length;f++)m+=String.fromCharCode(h[f]);var x=d();u({data:m,addLength1:!0,objectId:x}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var b=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Oc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Oc(l.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,d=s.y,u=s.options||{},h=s.mutex||{},m=h.pdfEscape,f=h.activeFontKey,x=h.fonts,g=f,b="",y=0,N="",S=x[g].encoding;if(x[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:h};for(N=l,g=f,Array.isArray(l)&&(N=l[0]),y=0;y<N.length;y+=1)x[g].metadata.hasOwnProperty("cmap")&&(o=x[g].metadata.cmap.unicode.codeMap[N[y].charCodeAt(0)]),o||N[y].charCodeAt(0)<256&&x[g].metadata.hasOwnProperty("Unicode")?b+=N[y]:b+="";var _="";return parseInt(g.slice(1))<14||S==="WinAnsiEncoding"?_=m(b,g).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(_=r(b,x[g])),h.isHex=!0,{text:_,x:c,y:d,options:u,mutex:h}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([a(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(a(Object.assign({},c,{text:o[d]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(Ct),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ct.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,s,o,l,c,d,u,h=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),N=!1,S=0;this.__bidiEngine__={};var _=function(C){var M=C.charCodeAt(),U=M>>8,F=g[U];return F!==void 0?h[256*F+(255&M)]:U===252||U===253?"AL":y.test(U)?"L":U===8?"R":"N"},D=function(C){for(var M,U=0;U<C.length;U++){if((M=_(C.charAt(U)))==="L")return!1;if(M==="R")return!0}return!1},I=function(C,M,U,F){var ne,V,ee,me,ye=M[F];switch(ye){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":N=!1;break;case"N":case"AN":break;case"EN":N&&(ye="AN");break;case"AL":N=!0,ye="R";break;case"WS":case"BN":ye="N";break;case"CS":F<1||F+1>=M.length||(ne=U[F-1])!=="EN"&&ne!=="AN"||(V=M[F+1])!=="EN"&&V!=="AN"?ye="N":N&&(V="AN"),ye=V===ne?V:"N";break;case"ES":ye=(ne=F>0?U[F-1]:"B")==="EN"&&F+1<M.length&&M[F+1]==="EN"?"EN":"N";break;case"ET":if(F>0&&U[F-1]==="EN"){ye="EN";break}if(N){ye="N";break}for(ee=F+1,me=M.length;ee<me&&M[ee]==="ET";)ee++;ye=ee<me&&M[ee]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(me=M.length,ee=F+1;ee<me&&M[ee]==="NSM";)ee++;if(ee<me){var Oe=C[F],xe=Oe>=1425&&Oe<=2303||Oe===64286;if(ne=M[ee],xe&&(ne==="R"||ne==="AL")){ye="R";break}}}ye=F<1||(ne=M[F-1])==="B"?"N":U[F-1];break;case"B":N=!1,a=!0,ye=S;break;case"S":s=!0,ye="N"}return ye},O=function(C,M,U){var F=C.split("");return U&&R(F,U,{hiLevel:S}),F.reverse(),M&&M.reverse(),F.join("")},R=function(C,M,U){var F,ne,V,ee,me,ye=-1,Oe=C.length,xe=0,w=[],A=S?f:m,T=[];for(N=!1,a=!1,s=!1,ne=0;ne<Oe;ne++)T[ne]=_(C[ne]);for(V=0;V<Oe;V++){if(me=xe,w[V]=I(C,T,w,V),F=240&(xe=A[me][x[w[V]]]),xe&=15,M[V]=ee=A[xe][5],F>0)if(F===16){for(ne=ye;ne<V;ne++)M[ne]=1;ye=-1}else ye=-1;if(A[xe][6])ye===-1&&(ye=V);else if(ye>-1){for(ne=ye;ne<V;ne++)M[ne]=ee;ye=-1}T[V]==="B"&&(M[V]=0),U.hiLevel|=ee}s&&function(L,H,X){for(var re=0;re<X;re++)if(L[re]==="S"){H[re]=S;for(var ge=re-1;ge>=0&&L[ge]==="WS";ge--)H[ge]=S}}(T,M,Oe)},E=function(C,M,U,F,ne){if(!(ne.hiLevel<C)){if(C===1&&S===1&&!a)return M.reverse(),void(U&&U.reverse());for(var V,ee,me,ye,Oe=M.length,xe=0;xe<Oe;){if(F[xe]>=C){for(me=xe+1;me<Oe&&F[me]>=C;)me++;for(ye=xe,ee=me-1;ye<ee;ye++,ee--)V=M[ye],M[ye]=M[ee],M[ee]=V,U&&(V=U[ye],U[ye]=U[ee],U[ee]=V);xe=me}xe++}}},B=function(C,M,U){var F=C.split(""),ne={hiLevel:S};return U||(U=[]),R(F,U,ne),function(V,ee,me){if(me.hiLevel!==0&&u)for(var ye,Oe=0;Oe<V.length;Oe++)ee[Oe]===1&&(ye=b.indexOf(V[Oe]))>=0&&(V[Oe]=b[ye+1])}(F,U,ne),E(2,F,M,U,ne),E(1,F,M,U,ne),F.join("")};return this.__bidiEngine__.doBidiReorder=function(C,M,U){if(function(ne,V){if(V)for(var ee=0;ee<ne.length;ee++)V[ee]=ee;l===void 0&&(l=D(ne)),d===void 0&&(d=D(ne))}(C,M),o||!c||d)if(o&&c&&l^d)S=l?1:0,C=O(C,M,U);else if(!o&&c&&d)S=l?1:0,C=B(C,M,U),C=O(C,M);else if(!o||l||c||d){if(o&&!c&&l^d)C=O(C,M),l?(S=0,C=B(C,M,U)):(S=1,C=B(C,M,U),C=O(C,M));else if(o&&l&&!c&&d)S=1,C=B(C,M,U),C=O(C,M);else if(!o&&!c&&l^d){var F=u;l?(S=1,C=B(C,M,U),S=0,u=!1,C=B(C,M,U),u=F):(S=0,C=B(C,M,U),C=O(C,M),S=1,u=!1,C=B(C,M,U),u=F,C=O(C,M))}}else S=0,C=B(C,M,U);else S=l?1:0,C=B(C,M,U);return C},this.__bidiEngine__.setOptions=function(C){C&&(o=C.isInputVisual,c=C.isOutputVisual,l=C.isInputRtl,d=C.isOutputRtl,u=C.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Ct),Ct.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Jo(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new N$(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new c$(this.contents),this.head=new u$(this),this.name=new g$(this),this.cmap=new iN(this),this.toUnicode={},this.hhea=new f$(this),this.maxp=new x$(this),this.hmtx=new v$(this),this.post=new m$(this),this.os2=new h$(this),this.loca=new _$(this),this.glyf=new b$(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ai,Jo=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,s;for(s=[],n=0,a=t.length;n<a;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),c$=function(){var e;function t(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,s,o,l,c,d,u,h,m,f,x,g;for(g in f=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(f)/c),o=Math.floor(h/c),u=16*f-h,(a=new Jo).writeInt(this.scalarType),a.writeShort(f),a.writeShort(h),a.writeShort(o),a.writeShort(u),s=16*f,d=a.pos+s,l=null,x=[],r)for(m=r[g],a.writeString(g),a.writeInt(e(m)),a.writeInt(d),a.writeInt(m.length),x=x.concat(m),g==="head"&&(l=d),d+=m.length;d%4;)x.push(0),d++;return a.write(x),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,s,o;for(r=oN.call(r);r.length%4;)r.push(0);for(s=new Jo(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},t}(),d$={}.hasOwnProperty,Ci=function(e,t){for(var r in t)d$.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ai=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var u$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Jo).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Hy=function(){function e(t,r){var n,a,s,o,l,c,d,u,h,m,f,x,g,b,y,N,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(f=t.readUInt16(),m=f/2,t.pos+=6,s=function(){var _,D;for(D=[],c=_=0;0<=m?_<m:_>m;c=0<=m?++_:--_)D.push(t.readUInt16());return D}(),t.pos+=2,g=function(){var _,D;for(D=[],c=_=0;0<=m?_<m:_>m;c=0<=m?++_:--_)D.push(t.readUInt16());return D}(),d=function(){var _,D;for(D=[],c=_=0;0<=m?_<m:_>m;c=0<=m?++_:--_)D.push(t.readUInt16());return D}(),u=function(){var _,D;for(D=[],c=_=0;0<=m?_<m:_>m;c=0<=m?++_:--_)D.push(t.readUInt16());return D}(),a=(this.length-t.pos+this.offset)/2,l=function(){var _,D;for(D=[],c=_=0;0<=a?_<a:_>a;c=0<=a?++_:--_)D.push(t.readUInt16());return D}(),c=y=0,S=s.length;y<S;c=++y)for(b=s[c],n=N=x=g[c];x<=b?N<=b:N>=b;n=x<=b?++N:--N)u[c]===0?o=n+d[c]:(o=l[u[c]/2+(n-x)-(m-c)]||0)!==0&&(o+=d[c]),this.codeMap[n]=65535&o}t.pos=h}return e.encode=function(t,r){var n,a,s,o,l,c,d,u,h,m,f,x,g,b,y,N,S,_,D,I,O,R,E,B,C,M,U,F,ne,V,ee,me,ye,Oe,xe,w,A,T,L,H,X,re,ge,oe,je,Ie;switch(F=new Jo,o=Object.keys(t).sort(function(et,Te){return et-Te}),r){case"macroman":for(g=0,b=function(){var et=[];for(x=0;x<256;++x)et.push(0);return et}(),N={0:0},s={},ne=0,ye=o.length;ne<ye;ne++)N[ge=t[a=o[ne]]]==null&&(N[ge]=++g),s[a]={old:t[a],new:N[t[a]]},b[a]=N[t[a]];return F.writeUInt16(1),F.writeUInt16(0),F.writeUInt32(12),F.writeUInt16(0),F.writeUInt16(262),F.writeUInt16(0),F.write(b),{charMap:s,subtable:F.data,maxGlyphID:g+1};case"unicode":for(M=[],h=[],S=0,N={},n={},y=d=null,V=0,Oe=o.length;V<Oe;V++)N[D=t[a=o[V]]]==null&&(N[D]=++S),n[a]={old:D,new:N[D]},l=N[D]-a,y!=null&&l===d||(y&&h.push(y),M.push(a),d=l),y=a;for(y&&h.push(y),h.push(65535),M.push(65535),B=2*(E=M.length),R=2*Math.pow(Math.log(E)/Math.LN2,2),m=Math.log(R/2)/Math.LN2,O=2*E-R,c=[],I=[],f=[],x=ee=0,xe=M.length;ee<xe;x=++ee){if(C=M[x],u=h[x],C===65535){c.push(0),I.push(0);break}if(C-(U=n[C].new)>=32768)for(c.push(0),I.push(2*(f.length+E-x)),a=me=C;C<=u?me<=u:me>=u;a=C<=u?++me:--me)f.push(n[a].new);else c.push(U-C),I.push(0)}for(F.writeUInt16(3),F.writeUInt16(1),F.writeUInt32(12),F.writeUInt16(4),F.writeUInt16(16+8*E+2*f.length),F.writeUInt16(0),F.writeUInt16(B),F.writeUInt16(R),F.writeUInt16(m),F.writeUInt16(O),X=0,w=h.length;X<w;X++)a=h[X],F.writeUInt16(a);for(F.writeUInt16(0),re=0,A=M.length;re<A;re++)a=M[re],F.writeUInt16(a);for(oe=0,T=c.length;oe<T;oe++)l=c[oe],F.writeUInt16(l);for(je=0,L=I.length;je<L;je++)_=I[je],F.writeUInt16(_);for(Ie=0,H=f.length;Ie<H;Ie++)g=f[Ie],F.writeUInt16(g);return{charMap:n,subtable:F.data,maxGlyphID:S+1}}},e}(),iN=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new Hy(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=Hy.encode(t,r),(a=new Jo).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),f$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),h$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),m$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),p$=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},g$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,s,o,l,c,d,u,h,m;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=u=0,h=n.length;u<h;s=++u)a=n[s],t.pos=a.offset,d=t.readString(a.length),o=new p$(d,a),c[m=a.nameID]==null&&(c[m]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),x$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),v$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=a?d<a:d>a;r=0<=a?++d:--d)u.push(t.readInt16());return u}(),this.widths=(function(){var d,u,h,m;for(m=[],d=0,u=(h=this.metrics).length;d<u;d++)s=h[d],m.push(s.advance);return m}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),oN=[].slice,b$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,s,o,l,c,d,u,h;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(a=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Jo(r.read(a))).readShort(),d=l.readShort(),h=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=o===-1?new w$(l,d,h,c,u):new y$(l,o,d,h,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=t[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),y$=function(){function e(t,r,n,a,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),w$=function(){function e(t,r,n,a,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Jo(oN.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),_$=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ci(e,ai),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),N$=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,s,o,l,c;for(a={},o=0,l=t.length;o<l;o++)a[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},e.prototype.encode=function(t,r){var n,a,s,o,l,c,d,u,h,m,f,x,g,b,y;for(a in n=iN.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),f={0:0},y=n.charMap)f[(c=y[a]).old]=c.new;for(x in m=n.maxGlyphID,o)x in f||(f[x]=m++);return u=function(N){var S,_;for(S in _={},N)_[N[S]]=S;return _}(f),h=Object.keys(u).sort(function(N,S){return N-S}),g=function(){var N,S,_;for(_=[],N=0,S=h.length;N<S;N++)l=h[N],_.push(u[l]);return _}(),s=this.font.glyf.encode(o,g,f),d=this.font.loca.encode(s.offsets,g),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();Ct.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();function lN(e,t,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,d=l*c,u=/\r\n|\r|\n/g,h="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof e=="string"?e.split(u):e,m=h.length||1),r+=l*(2-s),n.valign==="middle"?r-=m/2*d:n.valign==="bottom"&&(r-=m*d),n.halign==="center"||n.halign==="right"){var f=l;if(n.halign==="center"&&(f*=.5),h&&m>=1){for(var x=0;x<h.length;x++)a.text(h[x],t-a.getStringUnitWidth(h[x])*f,r),r+=d;return a}t-=a.getStringUnitWidth(e)*f}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var qy={},Yc=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:qy=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,s;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=e.unifyColor(t.lineColor),u&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,s){return this.jsPDFDocument.rect(t,r,n,a,s)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return qy||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),ix=function(e,t){return ix=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},ix(e,t)};function cN(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ix(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var dN=function(e){cN(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function k$(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function S$(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function k0(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function uN(e,t,r,n){var a=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:s});var o=fN(a,!1);o&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,o)}function fN(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function lm(e,t){var r,n,a,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(s=e.bottom)!==null&&s!==void 0?s:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function hN(e,t){var r=lm(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function j$(e,t,r,n,a){var s={},o=1.3333333333333333,l=og(t,function(S){return a.getComputedStyle(S).backgroundColor});l!=null&&(s.fillColor=l);var c=og(t,function(S){return a.getComputedStyle(S).color});c!=null&&(s.textColor=c);var d=A$(n,r);d&&(s.cellPadding=d);var u="borderTopColor",h=o*r,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var f=(parseFloat(m)||0)/h;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var x=og(t,function(S){return a.getComputedStyle(S)[u]});x!=null&&(s.lineColor=x);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var b=parseInt(n.fontSize||"");isNaN(b)||(s.fontSize=b/o);var y=T$(n);y&&(s.fontStyle=y);var N=(n.fontFamily||"").toLowerCase();return e.indexOf(N)!==-1&&(s.font=N),s}function T$(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function og(e,t){var r=mN(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function mN(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:mN(e.parentElement,t):r}function A$(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=lm(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function pN(e,t,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],h=[],m=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:h,foot:m};for(var f=0;f<l.rows.length;f++){var x=l.rows[f],g=(o=(s=x==null?void 0:x.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),b=E$(c,d,r,x,n,a);b&&(g==="thead"?u.push(b):g==="tfoot"?m.push(b):h.push(b))}return{head:u,body:h,foot:m}}function E$(e,t,r,n,a,s){for(var o=new dN(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(a||d.display!=="none"){var u=void 0;s&&(u=j$(e,c,t,d,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:C$(c)})}}var h=r.getComputedStyle(n);if(o.length>0&&(a||h.display!=="none"))return o}function C$(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function D$(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Zi(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function gN(e,t){var r=new Yc(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();D$(a,n,t);var s=Zi({},a,n,t),o;typeof window<"u"&&(o=window);var l=O$(a,n,t),c=P$(a,n,t),d=L$(r,s),u=$$(r,s,o);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function O$(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],h=r[c];n.columnStyles=Zi({},d,u,h)}else{var m=[e,t,r],f=m.map(function(x){return x[c]||{}});n[c]=Zi({},f[0],f[1],f[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function P$(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function L$(e,t){var r,n,a,s,o,l,c,d,u,h,m,f,x=lm(t.margin,40/e.scaleFactor()),g=(r=F$(e,t.startY))!==null&&r!==void 0?r:x.top,b;t.showFoot===!0?b="everyPage":t.showFoot===!1?b="never":b=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var y;t.showHead===!0?y="everyPage":t.showHead===!1?y="never":y=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var N=(s=t.useCss)!==null&&s!==void 0?s:!1,S=t.theme||(N?"plain":"striped"),_=!!t.horizontalPageBreak,D=(o=t.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:N,theme:S,startY:g,margin:x,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:b,tableLineWidth:(h=t.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(m=t.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:_,horizontalPageBreakRepeat:D,horizontalPageBreakBehaviour:(f=t.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function F$(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof t=="number"?t:(t==null||t===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function $$(e,t,r){var n=t.head||[],a=t.body||[],s=t.foot||[];if(t.html){var o=t.includeHiddenHtml;if(r){var l=pN(e,t.html,r,o,t.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||R$(n,a,s);return{columns:c,head:n,body:a,foot:s}}function R$(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var d=void 0;Array.isArray(n)?d=a.length:d=s+(c>0?"_".concat(c):"");var u={dataKey:d};a.push(u)}}),a}var ox=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),M$=function(e){cN(t,e);function t(r,n,a,s,o,l){var c=e.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return t}(ox),I$=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new M$(t,this,n,a,s,o),h=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new ox(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new ox(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),xN=function(){function e(t,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=t,t instanceof dN&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),d=c+l;return d>a?d:a},0)},e}(),vN=function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var s=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,s=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=lm(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),B$=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},e}();function U$(e,t){W$(e,t);var r=[],n=0;t.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(t);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=lx(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=lx(r,a,function(s){return s.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),H$(t),q$(t,e),z$(t)}function W$(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=hN(e,t);t.allRows().forEach(function(s){for(var o=0,l=t.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,s,c,null);var h=d.padding("horizontal");d.contentWidth=k0(d.text,d.styles,e)+h;var m=k0(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=m+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>a?(d.minWidth=a,d.wrappedWidth=a):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var f=10/r;d.minWidth=d.styles.minCellWidth||f,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(s){for(var o=0,l=t.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},h=u.cellWidth||u.minCellWidth;h&&typeof h=="number"&&(c.minWidth=h,c.wrappedWidth=h)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function lx(e,t,r){for(var n=t,a=e.reduce(function(f,x){return f+x.wrappedWidth},0),s=0;s<e.length;s++){var o=e[s],l=o.wrappedWidth/a,c=n*l,d=o.width+c,u=r(o),h=d<u?u:d;t-=h-o.width,o.width=h}if(t=Math.round(t*1e10)/1e10,t){var m=e.filter(function(f){return t<0?f.width>r(f):!0});m.length&&(t=lx(m,t,r))}return t}function z$(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=e.columns;o<l.length;o++){var c=l[o],d=t[c.index];if(r>1)r--,delete s.cells[c.index];else if(d)d.cell.height+=s.height,r=d.cell.colSpan,delete s.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=s.cells[c.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var h=n.length-a,m=u.rowSpan>h?h:u.rowSpan;t[c.index]={cell:u,left:m,row:s}}}}}function H$(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,s=0,o=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(o-=1,o>1&&e.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var d=a;delete n.cells[c.index],a=null,d.width=c.width+s}else{var d=n.cells[c.index];if(!d)continue;if(o=d.colSpan,s=0,d.colSpan>1){a=d,s+=c.width;continue}d.width=c.width+s}}}function q$(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var s=a[n],o=0,l=e.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=Yy(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=Yy(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var h=d.styles.overflow(d.text,u);typeof h=="string"?d.text=[h]:d.text=h}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var m=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<m*d.rowSpan?r={height:m,count:d.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>s.height&&(s.height=m)}}r.count--}}function Yy(e,t,r,n,a){return e.map(function(s){return Y$(s,t,r,n,a)})}function Y$(e,t,r,n,a){var s=1e4*n.scaleFactor();if(t=Math.ceil(t*s)/s,t>=k0(e,r,n))return e;for(;t<k0(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function bN(e,t){var r=new Yc(e),n=V$(t,r.scaleFactor()),a=new I$(t,n);return U$(r,a),r.applyStyles(r.userStyles),a}function V$(e,t){var r=e.content,n=K$(r.columns);if(r.head.length===0){var a=Vy(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=Vy(n,"foot");a&&r.foot.push(a)}var s=e.settings.theme,o=e.styles;return{columns:n,head:lg("head",r.head,n,o,s,t),body:lg("body",r.body,n,o,s,t),foot:lg("foot",r.foot,n,o,s,t)}}function lg(e,t,r,n,a,s){var o={},l=t.map(function(c,d){for(var u=0,h={},m=0,f=0,x=0,g=r;x<g.length;x++){var b=g[x];if(o[b.index]==null||o[b.index].left===0)if(f===0){var y=void 0;Array.isArray(c)?y=c[b.index-m-u]:y=c[b.dataKey];var N={};typeof y=="object"&&!Array.isArray(y)&&(N=(y==null?void 0:y.styles)||{});var S=X$(e,b,d,a,n,s,N),_=new vN(y,S,e);h[b.dataKey]=_,h[b.index]=_,f=_.colSpan-1,o[b.index]={left:_.rowSpan-1,times:f}}else f--,m++;else o[b.index].left--,f=o[b.index].times,u++}return new xN(c,d,e,h)});return l}function Vy(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=G$(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function G$(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function K$(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new B$(a,t,r)})}function X$(e,t,r,n,a,s,o){var l=S$(n),c;e==="head"?c=a.headStyles:e==="body"?c=a.bodyStyles:e==="foot"&&(c=a.footStyles);var d=Zi({},l.table,l[e],a.styles,c),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},h=e==="body"?u:{},m=e==="body"&&r%2===0?Zi({},l.alternateRow,a.alternateRowStyles):{},f=k$(s),x=Zi({},f,d,m,h);return Zi(x,o)}function J$(e,t,r){var n;r===void 0&&(r={});var a=hN(e,t),s=new Map,o=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var f=t.columns.find(function(x){return x.dataKey===m||x.index===m});f&&!s.has(f.index)&&(s.set(f.index,!0),o.push(f.index),l.push(t.columns[f.index]),a-=f.wrappedWidth)});for(var d=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(s.has(u)){u++;continue}var h=t.columns[u].wrappedWidth;if(d||a>=h)d=!1,o.push(u),l.push(t.columns[u]),a-=h;else break;u++}return{colIndexes:o,columns:l,lastIndex:u-1}}function Z$(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=J$(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function yN(e,t){var r=t.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(m,f){return m+f.height},0);l+=d}var u=new Yc(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(_N(u),s.y=a.top),t.callWillDrawPageHooks(u,s);var h=Zi({},s);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?Q$(u,t,h,s):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(m){return uo(u,t,m,s,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(m,f){var x=f===t.body.length-1;S0(u,t,m,x,h,s,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(m){return uo(u,t,m,s,t.columns)})),uN(u,t,h,s),t.callEndPageHooks(u,s),t.finalY=s.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function Q$(e,t,r,n){var a=Z$(e,t),s=t.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?yu(e,t,r,n,d.columns,!0):Gy(e,t,n,d.columns),eR(e,t,r,n,d.columns),cg(e,t,n,d.columns)});else for(var o=-1,l=a[0],c=function(){var d=o;if(l){e.applyStyles(e.userStyles);var u=l.columns;o>=0?yu(e,t,r,n,u,!0):Gy(e,t,n,u),d=Ky(e,t,o+1,n,u),cg(e,t,n,u)}var h=d-o;a.slice(1).forEach(function(m){e.applyStyles(e.userStyles),yu(e,t,r,n,m.columns,!0),Ky(e,t,o+1,n,m.columns,h),cg(e,t,n,m.columns)}),o=d};o<t.body.length-1;)c()}function Gy(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(s){return uo(e,t,s,r,n)})}function eR(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(s,o){var l=o===t.body.length-1;S0(e,t,s,l,r,n,a)})}function Ky(e,t,r,n,a,s){e.applyStyles(e.userStyles),s=s??t.body.length;var o=Math.min(r+s,t.body.length),l=-1;return t.body.slice(r,o).forEach(function(c,d){var u=r+d===t.body.length-1,h=wN(e,t,u,n);c.canEntireRowFit(h,a)&&(uo(e,t,c,n,a),l=r+d)}),l}function cg(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(s){return uo(e,t,s,r,n)})}function tR(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),s=Math.floor((t-a)/n);return Math.max(0,s)}function rR(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new vN(d.raw,d.styles,d.section);u=Zi(u,d),u.text=[];var h=tR(d,t,n);d.text.length>h&&(u.text=d.text.splice(h,d.text.length));var m=n.scaleFactor(),f=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(m,f),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(m,f),u.contentHeight>s&&(s=u.contentHeight),a[c.index]=u}}var x=new xN(e.raw,-1,e.section,a,!0);x.height=s;for(var g=0,b=r.columns;g<b.length;g++){var c=b[g],u=x.cells[c.index];u&&(u.height=x.height);var d=e.cells[c.index];d&&(d.height=e.height)}return x}function nR(e,t,r,n){var a=e.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),h=t.getMaxCellHeight(n.columns)>l;return h?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function S0(e,t,r,n,a,s,o){var l=wN(e,t,n,s);if(r.canEntireRowFit(l,o))uo(e,t,r,s,o);else if(nR(e,r,l,t)){var c=rR(r,l,t,e);uo(e,t,r,s,o),yu(e,t,a,s,o),S0(e,t,c,n,a,s,o)}else yu(e,t,a,s,o),S0(e,t,r,n,a,s,o)}function uo(e,t,r,n,a){n.x=t.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}aR(e,c,n);var u=c.getTextPos();lN(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function aR(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=fN(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),sR(e,t,r,n.lineWidth))}function sR(e,t,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+t.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+t.height,o=r.x+t.width,l=r.y+t.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+t.width,s=r.y,o=r.x+t.width,l=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(d,u,h,m,f){e.getDocument().setLineWidth(d),e.getDocument().line(u,h,m,f,"S")}}function wN(e,t,r,n){var a=t.settings.margin.bottom,s=t.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function yu(e,t,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!s&&t.foot.forEach(function(l){return uo(e,t,l,n,a)}),t.callEndPageHooks(e,n);var o=t.settings.margin;uN(e,t,r,n),_N(e),t.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return uo(e,t,l,n,a)}),e.applyStyles(e.userStyles))}function _N(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function iR(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=gN(this,n),s=bN(this,a);return yN(this,s),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){lN(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return Yc.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){Yc.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Yc(this),s=pN(a,t,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var dg;function Mo(e,t){var r=gN(e,t),n=bN(e,r);yN(e,n)}try{if(typeof window<"u"&&window){var Xy=window,Jy=Xy.jsPDF||((dg=Xy.jspdf)===null||dg===void 0?void 0:dg.jsPDF);Jy&&iR(Jy)}}catch(e){console.error("Could not apply autoTable plugin",e)}const NN=(e,t,r)=>{const n=zn.book_new(),a=e.map((_,D)=>{var I,O;return{"#":D+1,"Task Title":_.title,Description:_.description||"N/A",Status:Zy(_.status),Priority:Qy(_.priority),"Assigned To":_.assigned_to&&_.assigned_to.length>0?_.assigned_to.map(R=>R.full_name).join(", "):"Unassigned",Team:((I=_.team_id)==null?void 0:I.name)||"No Team","Created By":((O=_.created_by)==null?void 0:O.full_name)||"Unknown","Created Date":ug(_.created_at),"Due Date":_.due_date?ug(_.due_date):"No Due Date","Is Overdue":cx(_)?"Yes":"No","Days Until Due":_.due_date?ew(_.due_date):"N/A"}}),s=zn.json_to_sheet(a);s["!cols"]=[{wch:5},{wch:30},{wch:40},{wch:15},{wch:12},{wch:25},{wch:20},{wch:20},{wch:15},{wch:15},{wch:12},{wch:15}],zn.book_append_sheet(n,s,"Task Summary");const o=t.statusDistribution.map(_=>({Status:_.name,Count:_.value,Percentage:(_.value/t.totalTasks*100).toFixed(2)+"%"})),l=zn.json_to_sheet(o);l["!cols"]=[{wch:20},{wch:10},{wch:15}],zn.book_append_sheet(n,l,"Status Distribution");const c=t.priorityDistribution.map(_=>({Priority:_.name,Count:_.value,Percentage:(_.value/t.totalTasks*100).toFixed(2)+"%"})),d=zn.json_to_sheet(c);d["!cols"]=[{wch:20},{wch:10},{wch:15}],zn.book_append_sheet(n,d,"Priority Distribution");const u=oR(e),h=zn.json_to_sheet(u);if(h["!cols"]=[{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:18}],zn.book_append_sheet(n,h,"Team Performance"),t.teamDistribution&&t.teamDistribution.length>0){const _=t.teamDistribution.map((I,O)=>({Rank:O+1,"Team Name":I.name,"Total Tasks":I.value,Percentage:(I.value/t.totalTasks*100).toFixed(2)+"%"})),D=zn.json_to_sheet(_);D["!cols"]=[{wch:8},{wch:30},{wch:15},{wch:15}],zn.book_append_sheet(n,D,"Tasks by Team")}const m=t.assigneePerformance.map(_=>({"User Name":_.name,"Total Tasks":_.total,Completed:_.completed,Overdue:_.overdue,"In Progress":_.total-_.completed-_.overdue,"Completion Rate":_.completionRate+"%",Performance:_.completionRate>=80?"Excellent":_.completionRate>=60?"Good":_.completionRate>=40?"Average":"Needs Improvement"})),f=zn.json_to_sheet(m);f["!cols"]=[{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:18},{wch:18}],zn.book_append_sheet(n,f,"User Performance");const x=e.filter(cx).map((_,D)=>({"#":D+1,"Task Title":_.title,Priority:Qy(_.priority),"Assigned To":_.assigned_to&&_.assigned_to.length>0?_.assigned_to.map(I=>I.full_name).join(", "):"Unassigned","Due Date":ug(_.due_date),"Days Overdue":Math.abs(ew(_.due_date)),Status:Zy(_.status)})),g=zn.json_to_sheet(x);g["!cols"]=[{wch:5},{wch:30},{wch:12},{wch:25},{wch:15},{wch:15},{wch:15}],zn.book_append_sheet(n,g,"Overdue Tasks");const b=[{Metric:"Total Tasks",Value:t.totalTasks},{Metric:"Completed Tasks",Value:t.completedTasks},{Metric:"In Progress Tasks",Value:t.inProgressTasks},{Metric:"Overdue Tasks",Value:t.overdueTasks},{Metric:"Completion Rate",Value:(t.completedTasks/t.totalTasks*100).toFixed(2)+"%"},{Metric:"Overdue Rate",Value:(t.overdueTasks/t.totalTasks*100).toFixed(2)+"%"}],y=zn.json_to_sheet(b);y["!cols"]=[{wch:25},{wch:20}],zn.book_append_sheet(n,y,"Summary Statistics");const S=`TaskFlow_Report_${new Date().toISOString().slice(0,10)}.xlsx`;kP(n,S)};function Zy(e){return e.replace("_"," ").toUpperCase()}function Qy(e){return e.toUpperCase()}function ug(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function cx(e){return!e.due_date||e.status==="done"?!1:new Date(e.due_date)<new Date}function ew(e){if(!e)return"N/A";const t=new Date,n=new Date(e)-t;return Math.ceil(n/(1e3*60*60*24))}function oR(e){const t={};return e.forEach(r=>{var a;const n=((a=r.team_id)==null?void 0:a.name)||"No Team";t[n]||(t[n]={total:0,completed:0,inProgress:0,overdue:0}),t[n].total++,r.status==="done"&&t[n].completed++,r.status==="in_progress"&&t[n].inProgress++,cx(r)&&t[n].overdue++}),Object.entries(t).map(([r,n])=>({"Team Name":r,"Total Tasks":n.total,Completed:n.completed,"In Progress":n.inProgress,Overdue:n.overdue,"Completion Rate":n.total>0?(n.completed/n.total*100).toFixed(2)+"%":"0%"}))}const kN=(e,t,r,n,a="all")=>{try{const s=new Ct,o=s.internal.pageSize.getWidth(),l=s.internal.pageSize.getHeight(),c=mR(e,a),d=pR(c);let u=20;lR(s,a,n,c.length),s.addPage(),u=20,s.setFillColor(59,130,246),s.rect(0,u-5,o,12,"F"),s.setTextColor(255,255,255),s.setFontSize(16),s.setFont(void 0,"bold"),s.text("Executive Summary - Visual Analytics",o/2,u+3,{align:"center"}),u+=20,s.setTextColor(0,0,0),u=cR(s,d,15,u),u=dR(s,d,15,u+10),s.addPage(),u=20,Tl(s,"Summary Statistics",u),u+=15;const h=hR(d,a);if(Mo(s,{startY:u,head:[["Metric","Value","Details"]],body:h,theme:"grid",headStyles:{fillColor:[59,130,246],fontStyle:"bold",fontSize:11,halign:"center"},styles:{fontSize:10,cellPadding:5,valign:"middle"},columnStyles:{0:{fontStyle:"bold",cellWidth:60,halign:"left"},1:{halign:"center",cellWidth:30,fontStyle:"bold",fontSize:12},2:{halign:"center",cellWidth:60}},margin:{left:15,right:15}}),u=s.lastAutoTable.finalY+15,u>l-80&&(s.addPage(),u=20),Tl(s,"Key Performance Indicators",u),u+=15,uR(s,d,u),s.addPage(),u=20,Tl(s,"Task Distribution Analysis",u),u+=15,d.statusDistribution&&d.statusDistribution.length>0){const y=d.statusDistribution.map(N=>[N.name,N.value.toString(),(N.value/d.totalTasks*100).toFixed(1)+"%",xR(N.name)]);Mo(s,{startY:u,head:[["Status","Count","Percentage","Trend"]],body:y,theme:"striped",headStyles:{fillColor:[59,130,246],fontStyle:"bold"},styles:{fontSize:10},margin:{left:15,right:15}}),u=s.lastAutoTable.finalY+15}if(u>l-70?(s.addPage(),u=20):u+=5,d.priorityDistribution&&d.priorityDistribution.length>0){const y=d.priorityDistribution.map(N=>[N.name,N.value.toString(),(N.value/d.totalTasks*100).toFixed(1)+"%",vR(N.name)]);Mo(s,{startY:u,head:[["Priority","Count","Percentage","Level"]],body:y,theme:"striped",headStyles:{fillColor:[245,158,11],fontStyle:"bold"},styles:{fontSize:10},margin:{left:15,right:15}})}const m=yR(c);if(m.length>0){s.addPage(),u=20,Tl(s,"Team Performance Analysis",u),u+=15;const y=m.map(N=>[N["Team Name"],N["Total Tasks"].toString(),N.Completed.toString(),N["In Progress"].toString(),N.Overdue.toString(),N["Completion Rate"],tw(parseFloat(N["Completion Rate"]))]);if(Mo(s,{startY:u,head:[["Team","Total","Done","Progress","Overdue","Rate","Rating"]],body:y,theme:"grid",headStyles:{fillColor:[16,185,129],fontStyle:"bold",fontSize:10,halign:"center"},styles:{fontSize:9,cellPadding:4,valign:"middle"},columnStyles:{0:{cellWidth:52,fontStyle:"bold"},1:{cellWidth:20,halign:"center"},2:{cellWidth:20,halign:"center",textColor:[16,185,129]},3:{cellWidth:23,halign:"center",textColor:[59,130,246]},4:{cellWidth:22,halign:"center",textColor:[239,68,68]},5:{cellWidth:20,halign:"center",fontStyle:"bold"},6:{fontStyle:"bold",halign:"center",cellWidth:25}},margin:{left:15,right:15}}),u=s.lastAutoTable.finalY+20,!(u>220||!d.teamDistribution)){if(d.teamDistribution&&d.teamDistribution.length>0){Tl(s,"Tasks by Team Distribution",u),u+=15;const N=d.teamDistribution.map((S,_)=>[(_+1).toString(),S.name,S.value.toString(),d.totalTasks>0?(S.value/d.totalTasks*100).toFixed(1)+"%":"0%"]);Mo(s,{startY:u,head:[["Rank","Team Name","Tasks","Share"]],body:N,theme:"striped",headStyles:{fillColor:[16,185,129],fontStyle:"bold",fontSize:10,halign:"center"},styles:{fontSize:9,cellPadding:4,valign:"middle"},columnStyles:{0:{cellWidth:20,halign:"center",fontStyle:"bold"},1:{cellWidth:90,fontStyle:"bold"},2:{cellWidth:25,halign:"center"},3:{cellWidth:25,halign:"center",fontStyle:"bold"}},margin:{left:15,right:15}})}}}if(d.assigneePerformance&&d.assigneePerformance.length>0){s.addPage(),u=20,Tl(s,"Individual Performance Report",u),u+=15;const y=d.assigneePerformance.map(N=>[N.name,N.total.toString(),N.completed.toString(),N.overdue.toString(),(N.total-N.completed-N.overdue).toString(),N.completionRate+"%",tw(N.completionRate)]);Mo(s,{startY:u,head:[["User","Total","Done","Overdue","Pending","Rate","Rating"]],body:y,theme:"striped",headStyles:{fillColor:[139,92,246],fontStyle:"bold",fontSize:10,halign:"center"},styles:{fontSize:9,cellPadding:4,valign:"middle"},columnStyles:{0:{cellWidth:52,fontStyle:"bold"},1:{cellWidth:20,halign:"center"},2:{cellWidth:20,halign:"center",textColor:[16,185,129]},3:{cellWidth:22,halign:"center",textColor:[239,68,68]},4:{cellWidth:22,halign:"center"},5:{cellWidth:20,halign:"center",fontStyle:"bold"},6:{fontStyle:"bold",halign:"center",cellWidth:26}},margin:{left:15,right:15}})}const f=c.filter(jN);if(f.length>0){s.addPage(),u=20,s.setFillColor(239,68,68),s.rect(0,u-5,o,12,"F"),s.setTextColor(255,255,255),s.setFontSize(16),s.setFont(void 0,"bold"),s.text("CRITICAL: Overdue Tasks",o/2,u+3,{align:"center"}),u+=20,s.setTextColor(0,0,0);const y=f.slice(0,30).map(N=>[N.title.substring(0,40)+(N.title.length>40?"...":""),rw(N.priority),N.assigned_to&&N.assigned_to.length>0?N.assigned_to[0].full_name.substring(0,18):"Unassigned",nw(N.due_date),Math.abs(_R(N.due_date)).toString()+" days"]);Mo(s,{startY:u,head:[["Task","Priority","Assigned To","Due Date","Days Overdue"]],body:y,theme:"grid",headStyles:{fillColor:[239,68,68],fontStyle:"bold",fontSize:10,halign:"center"},styles:{fontSize:9,cellPadding:4,valign:"middle"},columnStyles:{0:{cellWidth:70},1:{halign:"center",fontStyle:"bold",cellWidth:25},2:{cellWidth:35,halign:"left"},3:{halign:"center",cellWidth:28},4:{halign:"center",textColor:[239,68,68],fontStyle:"bold",cellWidth:32}},margin:{left:15,right:15}}),f.length>30&&(u=s.lastAutoTable.finalY+10,s.setFontSize(10),s.setTextColor(239,68,68),s.setFont(void 0,"bold"),s.text(`... and ${f.length-30} more overdue tasks requiring immediate attention`,15,u),s.setTextColor(0,0,0),s.setFont(void 0,"normal"))}s.addPage(),u=20,Tl(s,"Detailed Task Breakdown",u),u+=15;const x=c.slice(0,50).map((y,N)=>[(N+1).toString(),y.title.substring(0,35)+(y.title.length>35?"...":""),wR(y.status),rw(y.priority),y.assigned_to&&y.assigned_to.length>0?y.assigned_to[0].full_name.substring(0,16):"Unassigned",y.due_date?nw(y.due_date):"No date"]);Mo(s,{startY:u,head:[["#","Task Title","Status","Priority","Assignee","Due Date"]],body:x,theme:"grid",headStyles:{fillColor:[59,130,246],fontStyle:"bold",fontSize:10,halign:"center"},styles:{fontSize:9,cellPadding:4,valign:"middle"},columnStyles:{0:{cellWidth:10,halign:"center",fontStyle:"bold"},1:{cellWidth:62},2:{cellWidth:22,halign:"center",fontStyle:"bold"},3:{cellWidth:20,halign:"center",fontStyle:"bold"},4:{cellWidth:32,halign:"left"},5:{cellWidth:26,halign:"center"}},margin:{left:15,right:15}}),c.length>50&&(u=s.lastAutoTable.finalY+10,s.setFontSize(10),s.text(`... and ${c.length-50} more tasks (see Excel export for complete list)`,15,u)),gR(s,a);const g=new Date().toISOString().slice(0,10),b=a==="all"?"Full":a.charAt(0).toUpperCase()+a.slice(1);s.save(`TaskFlow_${b}_Report_${g}.pdf`)}catch(s){throw console.error("Error in generateComprehensivePDFReport:",s),s}};function lR(e,t,r,n){const a=e.internal.pageSize.getWidth(),s=e.internal.pageSize.getHeight();e.setFillColor(59,130,246),e.rect(0,0,a,s/3,"F"),e.setFillColor(37,99,235),e.rect(0,s/3,a,s/3,"F"),e.setFillColor(29,78,216),e.rect(0,s/3*2,a,s/3,"F"),e.setTextColor(255,255,255),e.setFontSize(32),e.setFont(void 0,"bold"),e.text("TaskFlow",a/2,60,{align:"center"}),e.setFontSize(24),e.text("Analytics Report",a/2,75,{align:"center"}),e.setFontSize(18),e.setFont(void 0,"normal");const o=t==="all"?"Complete Overview":t==="daily"?"Daily Report":t==="weekly"?"Weekly Report":"Monthly Report";e.text(o,a/2,95,{align:"center"}),e.setFillColor(255,255,255),e.roundedRect(30,120,a-60,80,5,5,"F"),e.setTextColor(0,0,0),e.setFontSize(12),e.setFont(void 0,"bold"),e.text("Report Details",a/2,135,{align:"center"}),e.setFont(void 0,"normal"),e.setFontSize(10),e.text(`Generated: ${new Date().toLocaleString()}`,a/2,150,{align:"center"}),e.text(`Generated By: ${(r==null?void 0:r.full_name)||"System"}`,a/2,160,{align:"center"}),e.text(`Total Tasks Analyzed: ${n}`,a/2,170,{align:"center"}),e.text(`Report Period: ${SN(t)}`,a/2,180,{align:"center"}),e.setFontSize(8),e.setTextColor(255,255,255),e.text("Confidential - For Internal Use Only",a/2,s-20,{align:"center"})}function Tl(e,t,r){const n=e.internal.pageSize.getWidth();e.setFillColor(59,130,246),e.rect(15,r-3,n-30,10,"F"),e.setTextColor(255,255,255),e.setFontSize(14),e.setFont(void 0,"bold"),e.text(t,n/2,r+4,{align:"center"}),e.setTextColor(0,0,0),e.setFont(void 0,"normal")}function cR(e,t,r,n){const s=r+40+10,o=n+80/2,l=80/2-10;if(e.setFontSize(12),e.setFont(void 0,"bold"),e.text("Status Distribution",s,n-5,{align:"center"}),e.setFont(void 0,"normal"),!t.statusDistribution||t.statusDistribution.length===0)return e.setFontSize(10),e.text("No data available",s,o,{align:"center"}),n+80+10;let c=0;const d=[[107,114,128],[59,130,246],[245,158,11],[16,185,129],[239,68,68]];t.statusDistribution.forEach((m,f)=>{const x=m.value/t.totalTasks*360,g=d[f%d.length];e.setFillColor(g[0],g[1],g[2]),fR(e,s,o,l,c,c+x),c+=x});let u=n+10;const h=s+l+30;return t.statusDistribution.forEach((m,f)=>{const x=d[f%d.length];e.setFillColor(x[0],x[1],x[2]),e.rect(h,u-3,8,8,"F"),e.setFontSize(9),e.setTextColor(0,0,0),e.text(`${m.name}: ${m.value} (${(m.value/t.totalTasks*100).toFixed(1)}%)`,h+12,u+3),u+=10}),Math.max(o+l+10,u)}function dR(e,t,r,n){if(!t.priorityDistribution||t.priorityDistribution.length===0)return n;e.setFontSize(12),e.setFont(void 0,"bold"),e.text("Priority Distribution",r+80,n,{align:"center"}),e.setFont(void 0,"normal"),n+=10;const a=Math.max(...t.priorityDistribution.map(c=>c.value)),s=12,o=120,l={LOW:[16,185,129],MEDIUM:[245,158,11],HIGH:[249,115,22],URGENT:[239,68,68]};return t.priorityDistribution.forEach(c=>{const d=c.value/a*o,u=l[c.name]||[107,114,128];e.setFontSize(9),e.text(c.name,r,n+8),e.setFillColor(u[0],u[1],u[2]),e.rect(r+30,n,d,s,"F"),e.setFontSize(8),e.text(`${c.value} (${(c.value/t.totalTasks*100).toFixed(1)}%)`,r+32+d,n+8),n+=s+5}),n}function uR(e,t,r){const l=[{label:"Total",value:t.totalTasks,color:[59,130,246]},{label:"Completed",value:t.completedTasks,color:[16,185,129]},{label:"In Progress",value:t.inProgressTasks,color:[245,158,11]},{label:"Overdue",value:t.overdueTasks,color:[239,68,68]}];let c=20;l.forEach(d=>{e.setFillColor(d.color[0],d.color[1],d.color[2]),e.roundedRect(c,r,40,25,3,3,"F"),e.setTextColor(255,255,255),e.setFontSize(18),e.setFont(void 0,"bold"),e.text(d.value.toString(),c+40/2,r+13,{align:"center"}),e.setFontSize(8),e.setFont(void 0,"normal"),e.text(d.label,c+40/2,r+21,{align:"center"}),c+=50}),e.setTextColor(0,0,0)}function fR(e,t,r,n,a,s){const o=(a-90)*Math.PI/180;e.lines([[n*Math.cos(o),n*Math.sin(o)],[0,0]],t,r);for(let l=a;l<s;l+=1){const c=(l-90)*Math.PI/180,d=(l+1-90)*Math.PI/180;e.triangle(t,r,t+n*Math.cos(c),r+n*Math.sin(c),t+n*Math.cos(d),r+n*Math.sin(d),"F")}}function hR(e,t){const r=e.totalTasks>0?(e.completedTasks/e.totalTasks*100).toFixed(1):"0.0",n=e.totalTasks>0?(e.overdueTasks/e.totalTasks*100).toFixed(1):"0.0",a=e.totalTasks>0?(e.inProgressTasks/e.totalTasks*100).toFixed(1):"0.0";return[["Total Tasks",e.totalTasks.toString(),"Tracked"],["Completed Tasks",e.completedTasks.toString(),r+"%"],["In Progress",e.inProgressTasks.toString(),a+"%"],["Overdue Tasks",e.overdueTasks.toString(),n+"%"],["Completion Rate",r+"%",bR(parseFloat(r))],["Report Period",SN(t),"Timeframe"]]}function mR(e,t){if(t==="all")return e;const r=new Date;let n;switch(t){case"daily":n=new Date(r.getFullYear(),r.getMonth(),r.getDate());break;case"weekly":n=new Date(r.getTime()-7*24*60*60*1e3);break;case"monthly":n=new Date(r.getFullYear(),r.getMonth(),1);break;default:return e}return e.filter(a=>new Date(a.created_at)>=n)}function pR(e){const t=new Date,r=e.filter(f=>f.due_date&&new Date(f.due_date)<t&&f.status!=="done"),n=e.filter(f=>f.status==="done"),a=e.filter(f=>f.status==="in_progress"),s=e.reduce((f,x)=>(f[x.status]=(f[x.status]||0)+1,f),{}),o=Object.entries(s).map(([f,x])=>({name:f.replace("_"," ").toUpperCase(),value:x})),l=e.reduce((f,x)=>(f[x.priority]=(f[x.priority]||0)+1,f),{}),c=Object.entries(l).map(([f,x])=>({name:f.toUpperCase(),value:x})),d=e.reduce((f,x)=>(x.assigned_to&&x.assigned_to.length>0&&x.assigned_to.forEach(g=>{const b=g._id,y=g.full_name;f[b]||(f[b]={name:y,total:0,completed:0,overdue:0}),f[b].total++,x.status==="done"&&f[b].completed++,x.due_date&&new Date(x.due_date)<t&&x.status!=="done"&&f[b].overdue++}),f),{}),u=Object.values(d).map(f=>({name:f.name,total:f.total,completed:f.completed,overdue:f.overdue,completionRate:f.total>0?Math.round(f.completed/f.total*100):0})),h=e.reduce((f,x)=>{var b;const g=((b=x.team_id)==null?void 0:b.name)||"Unassigned";return f[g]=(f[g]||0)+1,f},{}),m=Object.entries(h).map(([f,x])=>({name:f,value:x})).sort((f,x)=>x.value-f.value);return{totalTasks:e.length,overdueTasks:r.length,completedTasks:n.length,inProgressTasks:a.length,statusDistribution:o,priorityDistribution:c,teamDistribution:m,assigneePerformance:u}}function gR(e,t){const r=e.internal.getNumberOfPages(),n=e.internal.pageSize.getWidth(),a=e.internal.pageSize.getHeight();for(let s=1;s<=r;s++){e.setPage(s),e.setFontSize(8),e.setTextColor(128,128,128),e.setDrawColor(200,200,200),e.line(15,a-15,n-15,a-15);const o=t==="all"?"Full":t.charAt(0).toUpperCase()+t.slice(1);e.text(`TaskFlow ${o} Report | Page ${s} of ${r} | ${new Date().toLocaleDateString()}`,n/2,a-10,{align:"center"})}}function SN(e){const t=new Date;switch(e){case"daily":return t.toLocaleDateString();case"weekly":return`${new Date(t.getTime()-7*24*60*60*1e3).toLocaleDateString()} - ${t.toLocaleDateString()}`;case"monthly":return t.toLocaleDateString("en-US",{month:"long",year:"numeric"});default:return"All Time"}}function xR(e){return{TODO:"Pending","IN PROGRESS":"Active",IN_PROGRESS:"Active",REVIEW:"In Review",DONE:"Complete",ARCHIVED:"Archived"}[e]||"Pending"}function vR(e){return{LOW:"Low Priority",MEDIUM:"Medium Priority",HIGH:"High Priority",URGENT:"Urgent"}[e]||"Medium Priority"}function bR(e){return e>=80?"Excellent":e>=60?"Good":e>=40?"Fair":"Needs Attention"}function tw(e){const t=typeof e=="string"?parseFloat(e):e;return t>=80?"***":t>=60?"**":t>=40?"*":"Low"}function yR(e){const t={};return e.forEach(r=>{var a;const n=((a=r.team_id)==null?void 0:a.name)||"No Team";t[n]||(t[n]={total:0,completed:0,inProgress:0,overdue:0}),t[n].total++,r.status==="done"&&t[n].completed++,r.status==="in_progress"&&t[n].inProgress++,jN(r)&&t[n].overdue++}),Object.entries(t).map(([r,n])=>({"Team Name":r,"Total Tasks":n.total,Completed:n.completed,"In Progress":n.inProgress,Overdue:n.overdue,"Completion Rate":n.total>0?(n.completed/n.total*100).toFixed(1)+"%":"0%"}))}function wR(e){return e.replace("_"," ").toUpperCase()}function rw(e){return e.toUpperCase()}function nw(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function jN(e){return!e.due_date||e.status==="done"?!1:new Date(e.due_date)<new Date}function _R(e){if(!e)return"N/A";const t=new Date,n=new Date(e)-t;return Math.ceil(n/(1e3*60*60*24))}const NR=()=>{const{user:e,logout:t}=pn(),{theme:r}=Lr(),{toggleMobileSidebar:n}=Mn(),a=Cs();Px();const[s,o]=J.useState({totalTasks:0,myTasks:0,inProgress:0,completed:0,overdueTasks:0}),[l,c]=J.useState([]),[d,u]=J.useState([]),[h,m]=J.useState([]),[f,x]=J.useState([]),[g,b]=J.useState([]),[y,N]=J.useState({dateRange:"all",customStartDate:"",customEndDate:"",status:"",priority:""}),[S,_]=J.useState({statusBreakdown:{},priorityBreakdown:{},completionRate:0,totalCompleted:0,totalTasks:0}),[D,I]=J.useState({totalTasks:0,overdueTasks:0,completedTasks:0,inProgressTasks:0,statusDistribution:[],priorityDistribution:[],teamDistribution:[],overdueByPriority:[],completionTrend:[],assigneePerformance:[]}),[O,R]=J.useState({statusDistribution:[],progressOverTime:[],priorityDistribution:[]}),[E,B]=J.useState(!0),[C,M]=J.useState("all"),[U,F]=J.useState(!1),[ne,V]=J.useState(null),[ee,me]=J.useState(!1),[ye,Oe]=J.useState(!1),[xe,w]=J.useState(0),[A,T]=J.useState(""),[L,H]=J.useState(!1),X=J.useRef(null),re=J.useCallback(async()=>{var Q,ve;if(["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role))try{const we=await it.get("/teams");b(we.data.teams||[])}catch(we){((Q=we.response)==null?void 0:Q.status)===403||(((ve=we.response)==null?void 0:ve.status)===401?console.error("Authentication required"):console.error("Error fetching teams:",we))}},[e==null?void 0:e.role]);J.useEffect(()=>{const Q=localStorage.getItem("pwa-installed")==="true",ve=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://");if(Q||ve){Oe(!0),me(!1),localStorage.setItem("pwa-installed","true");return}const we=He=>{He.preventDefault(),V(He),localStorage.getItem("pwa-installed")||me(!0)},Re=()=>{Oe(!0),me(!1),V(null),localStorage.setItem("pwa-installed","true")};return window.addEventListener("beforeinstallprompt",we),window.addEventListener("appinstalled",Re),()=>{window.removeEventListener("beforeinstallprompt",we),window.removeEventListener("appinstalled",Re)}},[]);const ge=async()=>{if(ye||localStorage.getItem("pwa-installed")==="true"){alert("âœ… TaskFlow is Already Installed!");return}if(!ne){alert("Install functionality not available. Please check your browser settings.");return}try{ne.prompt();const{outcome:Q}=await ne.userChoice;Q==="accepted"&&(Oe(!0),localStorage.setItem("pwa-installed","true"),setTimeout(()=>{alert("ðŸŽ‰ TaskFlow has been installed!")},1e3)),V(null),me(!1)}catch(Q){console.error("Error during installation:",Q)}},oe=J.useCallback(async()=>{try{const Q=await it.get("/notifications");w(Q.data.unreadCount||0)}catch{}},[]);J.useEffect(()=>{e&&oe()},[e,oe]),J.useEffect(()=>{const Q=ve=>{X.current&&!X.current.contains(ve.target)&&F(!1)};return U&&document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[U]),el({onTaskCreated:()=>{je()},onTaskUpdated:()=>{je()},onTaskDeleted:()=>{je()},onTeamCreated:()=>{re()},onTeamUpdated:()=>{re()},onTeamDeleted:()=>{re()}});const je=J.useCallback(async()=>{try{B(!0);const[Q,ve]=await Promise.all([it.get("/tasks"),re()]),we=Q.data.tasks||[];m(we);const Re=new Date,He=we.filter(ct=>ct.assigned_to&&ct.assigned_to.some(ut=>ut._id===e._id)),vt=we.filter(ct=>ct.status==="in_progress"),le=we.filter(ct=>ct.status==="done"),Ae=we.filter(ct=>ct.due_date&&new Date(ct.due_date)<Re&&ct.status!=="done");o({totalTasks:we.length,myTasks:He.length,inProgress:vt.length,completed:le.length,overdueTasks:Ae.length}),u(Ae.slice(0,5)),c(we.slice(0,10));const Qe={todo:we.filter(ct=>ct.status==="todo").length,in_progress:we.filter(ct=>ct.status==="in_progress").length,review:we.filter(ct=>ct.status==="review").length,done:we.filter(ct=>ct.status==="done").length},_e={low:we.filter(ct=>ct.priority==="low").length,medium:we.filter(ct=>ct.priority==="medium").length,high:we.filter(ct=>ct.priority==="high").length,critical:we.filter(ct=>ct.priority==="critical").length},Ze=Object.entries(Qe).map(([ct,ut])=>({name:ct.replace("_"," ").charAt(0).toUpperCase()+ct.slice(1).replace("_"," "),value:ut})),Ve=Object.entries(_e).map(([ct,ut])=>({name:ct.charAt(0).toUpperCase()+ct.slice(1),value:ut})),ot=we.reduce((ct,ut)=>{var zt;const Ot=((zt=ut.team_id)==null?void 0:zt.name)||"Unassigned";return ct[Ot]=(ct[Ot]||0)+1,ct},{}),pt=Object.entries(ot).map(([ct,ut])=>({name:ct,value:ut})).sort((ct,ut)=>ut.value-ct.value),yt=we.reduce((ct,ut)=>(ut.assigned_to&&ut.assigned_to.length>0&&ut.assigned_to.forEach(Ot=>{const zt=Ot._id,Dt=Ot.full_name;ct[zt]||(ct[zt]={name:Dt,total:0,completed:0,overdue:0}),ct[zt].total++,ut.status==="done"&&ct[zt].completed++,ut.due_date&&new Date(ut.due_date)<Re&&ut.status!=="done"&&ct[zt].overdue++}),ct),{}),ir=Object.values(yt).map(ct=>({name:ct.name,total:ct.total,completed:ct.completed,overdue:ct.overdue,completionRate:ct.total>0?Math.round(ct.completed/ct.total*100):0}));I({totalTasks:we.length,overdueTasks:Ae.length,completedTasks:le.length,inProgressTasks:vt.length,statusDistribution:Ze,priorityDistribution:Ve,teamDistribution:pt,assigneePerformance:ir}),B(!1)}catch(Q){console.error("Error fetching dashboard data:",Q),B(!1)}},[e,re]);J.useEffect(()=>{e&&je()},[e,je]);const Ie=J.useCallback(()=>{let Q=[...l];if(A.trim()){const ve=A.toLowerCase();Q=Q.filter(we=>{var Re,He,vt,le,Ae;return((Re=we.title)==null?void 0:Re.toLowerCase().includes(ve))||((He=we.description)==null?void 0:He.toLowerCase().includes(ve))||((le=(vt=we.team_id)==null?void 0:vt.name)==null?void 0:le.toLowerCase().includes(ve))||((Ae=we.assigned_to)==null?void 0:Ae.some(Qe=>{var _e;return(_e=Qe.full_name)==null?void 0:_e.toLowerCase().includes(ve)}))})}if(y.status&&(Q=Q.filter(ve=>ve.status===y.status)),y.priority&&(Q=Q.filter(ve=>ve.priority===y.priority)),y.dateRange!=="all"){const ve=new Date;let we;switch(y.dateRange){case"today":we=new Date(ve.getFullYear(),ve.getMonth(),ve.getDate());break;case"week":we=new Date(ve.getTime()-7*24*60*60*1e3);break;case"month":we=new Date(ve.getFullYear(),ve.getMonth(),1);break;default:we=null}we&&(Q=Q.filter(Re=>new Date(Re.created_at)>=we))}return Q},[l,A,y]),et=async Q=>{try{if(Q==="excel"){const ve=await NN(h,D,y),we=window.URL.createObjectURL(ve),Re=document.createElement("a");Re.href=we,Re.download=`taskflow-report-${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),window.URL.revokeObjectURL(we)}else Q==="pdf"&&await kN(h,D,y,e);F(!1)}catch(ve){console.error("Error generating report:",ve),alert("Failed to generate report. Please try again.")}},Te=Q=>{const ve={low:"bg-gray-500/10 text-gray-400 border-gray-500/20",medium:"bg-blue-500/10 text-blue-400 border-blue-500/20",high:"bg-orange-500/10 text-orange-400 border-orange-500/20",critical:"bg-red-500/10 text-red-400 border-red-500/20"};return ve[Q]||ve.medium},Y=Q=>{const ve={todo:"text-gray-400 bg-gray-400",in_progress:"text-blue-400 bg-blue-400",review:"text-yellow-400 bg-yellow-400",done:"text-green-400 bg-green-400"};return ve[Q]||ve.todo},We=Q=>{if(!Q)return"No date";const ve=new Date(Q),Re=ve-new Date,He=Math.ceil(Re/(1e3*60*60*24));return He<0?ve.toLocaleDateString("en-US",{month:"short",day:"numeric"}):He===0?"Today":He===1?"Tomorrow":ve.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return E?i.jsx("div",{className:`min-h-screen ${r==="dark"?"bg-[#111418]":"bg-gray-50"} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#136dec] mx-auto mb-4"}),i.jsx("p",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium`,children:"Loading dashboard..."})]})}):i.jsxs("div",{className:`flex h-screen w-full ${r==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),ee&&!ye&&i.jsx("div",{className:`fixed top-4 left-1/2 transform -translate-x-1/2 z-50 ${r==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-lg shadow-2xl p-4 max-w-md w-full mx-4`,children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(UT,{className:"w-8 h-8 text-[#136dec]"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:`text-sm font-bold ${r==="dark"?"text-white":"text-gray-900"} mb-1`,children:"Install TaskFlow App"}),i.jsx("p",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-3`,children:"Get quick access and work offline by installing TaskFlow on your device"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:ge,className:"flex-1 bg-[#136dec] hover:bg-[#1258c4] text-white text-xs font-bold px-4 py-2 rounded transition-colors",children:"Install Now"}),i.jsx("button",{onClick:()=>me(!1),className:`px-4 py-2 text-xs font-medium ${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:"Later"})]})]}),i.jsx("button",{onClick:()=>me(!1),className:`${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:i.jsx(kr,{className:"w-5 h-5"})})]})}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsxs("header",{className:`h-16 flex items-center justify-between px-4 sm:px-6 border-b ${r==="dark"?"border-[#282f39] bg-[#111418]":"border-gray-200 bg-white"} shrink-0 z-20`,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:n,className:`lg:hidden ${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsx("h2",{className:`${r==="dark"?"text-white":"text-gray-900"} text-base sm:text-lg font-bold leading-tight tracking-tight`,children:"Dashboard"})]}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"relative w-80 hidden md:block",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(oo,{className:`w-5 h-5 ${r==="dark"?"text-[#9da8b9]":"text-gray-400"}`})}),i.jsx("input",{className:`block w-full rounded-[0.125rem] ${r==="dark"?"bg-[#1c2027] text-white placeholder-[#9da8b9]":"bg-gray-100 text-gray-900 placeholder-gray-400"} border-0 py-2 pl-10 pr-3 focus:ring-1 focus:ring-[#136dec] sm:text-sm`,placeholder:"Search tasks, projects, or people...",type:"text",value:A,onChange:Q=>T(Q.target.value)}),A&&i.jsx("button",{onClick:()=>T(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i.jsx(kr,{className:"w-4 h-4 text-[#9da8b9] hover:text-white"})})]}),i.jsxs("div",{className:`flex items-center gap-2 sm:gap-4 border-l ${r==="dark"?"border-[#282f39]":"border-gray-200"} pl-2 sm:pl-6`,children:[i.jsxs("button",{onClick:()=>a("/notifications"),className:`${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors relative p-2`,children:[i.jsx(Jc,{className:"w-5 h-5"}),xe>0&&i.jsx("span",{className:`absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500 ring-2 ${r==="dark"?"ring-[#111418]":"ring-white"}`})]}),i.jsx("button",{onClick:()=>a("/"),className:`${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors hidden sm:block p-2`,title:"Help & Documentation",children:i.jsx(LT,{className:"w-5 h-5"})}),i.jsx("button",{onClick:()=>a("/settings"),className:`${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors p-2`,children:i.jsx(J0,{className:"w-5 h-5"})})]})]})]}),i.jsx("div",{className:`${r==="dark"?"bg-[#111418] border-[#282f39]":"bg-white border-gray-200"} border-b px-4 sm:px-6 py-4 shrink-0 overflow-x-auto`,children:i.jsxs("div",{className:"flex items-center gap-4 sm:gap-8 text-sm min-w-max",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:`text-xl sm:text-2xl font-bold ${r==="dark"?"text-white":"text-gray-900"} tracking-tight`,children:s.totalTasks}),i.jsx("span",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium uppercase text-[10px] sm:text-xs tracking-wide whitespace-nowrap`,children:"Total Tasks"})]}),i.jsx("div",{className:`h-8 w-px ${r==="dark"?"bg-[#282f39]":"bg-gray-200"}`}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:`text-xl sm:text-2xl font-bold ${r==="dark"?"text-white":"text-gray-900"} tracking-tight`,children:s.myTasks}),i.jsx("span",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium uppercase text-[10px] sm:text-xs tracking-wide whitespace-nowrap`,children:"Assigned to Me"})]}),i.jsx("div",{className:`h-8 w-px ${r==="dark"?"bg-[#282f39]":"bg-gray-200"}`}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"text-xl sm:text-2xl font-bold text-red-400 tracking-tight",children:s.overdueTasks}),i.jsx("span",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium uppercase text-[10px] sm:text-xs tracking-wide whitespace-nowrap`,children:"Overdue"})]}),i.jsx("div",{className:`h-8 w-px ${r==="dark"?"bg-[#282f39]":"bg-gray-200"}`}),i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-[#136dec] tracking-tight",children:[s.totalTasks>0?Math.round(s.inProgress/s.totalTasks*100):0,"%"]}),i.jsx("span",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium uppercase text-[10px] sm:text-xs tracking-wide whitespace-nowrap`,children:"Team Capacity"})]}),i.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[i.jsx("span",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} hidden sm:inline`,children:"Last updated: Just now"}),i.jsxs(vi,{to:"/tasks",className:"flex items-center gap-2 bg-[#136dec] hover:bg-[#1258c4] text-white text-xs font-bold px-3 py-2 rounded-[0.125rem] transition-colors whitespace-nowrap",children:[i.jsx(Si,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"New Task"}),i.jsx("span",{className:"sm:hidden",children:"New"})]})]})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:[(e==null?void 0:e.role)!=="member"&&i.jsxs("div",{className:"mb-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:`${r==="dark"?"text-white":"text-gray-900"} text-lg font-bold leading-tight`,children:"Performance Overview"}),i.jsx(vi,{to:"/analytics",className:"text-xs text-[#136dec] hover:text-blue-400 font-medium",children:"View Detailed Analytics â†’"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6",children:[i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${r==="dark"?"border-[#282f39]":"border-gray-200"} p-4 sm:p-6`,children:[i.jsx("h4",{className:`text-sm sm:text-base font-bold ${r==="dark"?"text-white":"text-gray-900"} mb-4`,children:"Status Distribution"}),i.jsx("div",{className:"h-[280px] sm:h-[300px] w-full",style:{minHeight:"280px",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",height:"100%",minWidth:200,minHeight:280,children:i.jsxs(M5,{children:[i.jsx(I5,{data:D.statusDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({name:Q,percent:ve})=>ve<.05?null:`${Q.split(" ")[0]} ${(ve*100).toFixed(0)}%`,outerRadius:"70%",fill:"#8884d8",dataKey:"value",children:D.statusDistribution.map((Q,ve)=>i.jsx(t0,{fill:Q.name.toLowerCase().includes("done")?"#22c55e":Q.name.toLowerCase().includes("progress")?"#136dec":Q.name.toLowerCase().includes("review")?"#a855f7":Q.name.toLowerCase().includes("todo")?"#eab308":"#6b7280"},`cell-${ve}`))}),i.jsx(Ea,{contentStyle:{backgroundColor:r==="dark"?"#1c2027":"#ffffff",border:`1px solid ${r==="dark"?"#282f39":"#e5e7eb"}`,borderRadius:"4px",fontSize:"14px"}})]})})})]}),i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${r==="dark"?"border-[#282f39]":"border-gray-200"} p-4 sm:p-6`,children:[i.jsx("h4",{className:`text-sm sm:text-base font-bold ${r==="dark"?"text-white":"text-gray-900"} mb-4`,children:"Priority Breakdown"}),i.jsx("div",{className:"h-[280px] sm:h-[300px] w-full",style:{minHeight:"280px",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",height:"100%",minWidth:200,minHeight:280,children:i.jsxs(Ki,{data:D.priorityDistribution,margin:{top:10,right:10,left:0,bottom:10},children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:r==="dark"?"#282f39":"#e5e7eb"}),i.jsx(xs,{dataKey:"name",stroke:r==="dark"?"#9da8b9":"#6b7280",tick:{fontSize:13},tickLine:{stroke:r==="dark"?"#9da8b9":"#6b7280"}}),i.jsx(vs,{stroke:r==="dark"?"#9da8b9":"#6b7280",tick:{fontSize:13},tickLine:{stroke:r==="dark"?"#9da8b9":"#6b7280"}}),i.jsx(Ea,{contentStyle:{backgroundColor:r==="dark"?"#1c2027":"#ffffff",border:`1px solid ${r==="dark"?"#282f39":"#e5e7eb"}`,borderRadius:"4px",fontSize:"14px"}}),i.jsx(Ys,{dataKey:"value",fill:"#136dec",radius:[8,8,0,0]})]})})})]}),i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${r==="dark"?"border-[#282f39]":"border-gray-200"} p-4 sm:p-6`,children:[i.jsx("h4",{className:`text-sm sm:text-base font-bold ${r==="dark"?"text-white":"text-gray-900"} mb-4`,children:"Team Distribution"}),i.jsx("div",{className:"h-[280px] sm:h-[300px] w-full",style:{minHeight:"280px",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",height:"100%",minWidth:200,minHeight:280,children:i.jsxs(Ki,{data:D.teamDistribution.slice(0,5),margin:{top:10,right:10,left:0,bottom:60},children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:r==="dark"?"#282f39":"#e5e7eb"}),i.jsx(xs,{dataKey:"name",stroke:r==="dark"?"#9da8b9":"#6b7280",tick:{fontSize:12},angle:-35,textAnchor:"end",height:80,interval:0,tickLine:{stroke:r==="dark"?"#9da8b9":"#6b7280"}}),i.jsx(vs,{stroke:r==="dark"?"#9da8b9":"#6b7280",tick:{fontSize:13},tickLine:{stroke:r==="dark"?"#9da8b9":"#6b7280"}}),i.jsx(Ea,{contentStyle:{backgroundColor:r==="dark"?"#1c2027":"#ffffff",border:`1px solid ${r==="dark"?"#282f39":"#e5e7eb"}`,borderRadius:"4px",fontSize:"14px"}}),i.jsx(Ys,{dataKey:"value",fill:"#22c55e",radius:[8,8,0,0],children:D.teamDistribution.slice(0,5).map((Q,ve)=>i.jsx(t0,{fill:`hsl(${ve*50}, 70%, 50%)`},`cell-${ve}`))})]})})})]})]})]}),i.jsxs("div",{className:"flex flex-col xl:flex-row gap-3 sm:gap-4 md:gap-6 h-full",children:[i.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[i.jsx("h3",{className:`${r==="dark"?"text-white":"text-gray-900"} text-sm sm:text-base md:text-lg font-bold leading-tight`,children:"Active Task Queue"}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsxs("button",{onClick:()=>{H(!L),F(!1)},className:`flex items-center gap-1 px-2 py-1 text-xs font-medium ${r==="dark"?"text-[#9da8b9] hover:text-white hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"} rounded-[0.125rem] transition-colors ${L?"bg-[#136dec] text-white":""}`,children:[i.jsx(zl,{className:"w-4 h-4"}),"Filter"]}),i.jsxs("div",{className:"relative",ref:X,children:[i.jsxs("button",{onClick:()=>{F(!U),H(!1)},className:`flex items-center gap-1 px-2 py-1 text-xs font-medium ${r==="dark"?"text-[#9da8b9] hover:text-white hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"} rounded-[0.125rem] transition-colors`,children:[i.jsx(Yx,{className:"w-4 h-4"}),"Export"]}),U&&i.jsxs("div",{className:`absolute right-0 top-full mt-2 ${r==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-[0.125rem] shadow-lg p-2 z-50 min-w-[200px]`,children:[i.jsxs("button",{onClick:()=>et("excel"),className:`flex items-center gap-2 w-full px-3 py-2 text-sm ${r==="dark"?"text-white hover:bg-[#282f39]":"text-gray-900 hover:bg-gray-100"} rounded-[0.125rem] transition-colors`,children:[i.jsx(Vx,{className:"w-4 h-4"}),"Export as Excel"]}),i.jsxs("button",{onClick:()=>et("pdf"),className:`flex items-center gap-2 w-full px-3 py-2 text-sm ${r==="dark"?"text-white hover:bg-[#282f39]":"text-gray-900 hover:bg-gray-100"} rounded-[0.125rem] transition-colors`,children:[i.jsx(Su,{className:"w-4 h-4"}),"Export as PDF"]})]})]})]})]}),L&&i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-[0.125rem] p-4 mb-4`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:`text-sm font-bold ${r==="dark"?"text-white":"text-gray-900"}`,children:"Filter Tasks"}),i.jsx("button",{onClick:()=>{N({dateRange:"all",customStartDate:"",customEndDate:"",status:"",priority:""}),T("")},className:"text-xs text-[#136dec] hover:text-blue-400 font-medium",children:"Clear All"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[i.jsxs("select",{value:y.status,onChange:Q=>N({...y,status:Q.target.value}),className:`h-9 px-3 ${r==="dark"?"bg-[#282f39]":"bg-white"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-sm ${r==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx("option",{value:"",children:"All Statuses"}),i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"})]}),i.jsxs("select",{value:y.priority,onChange:Q=>N({...y,priority:Q.target.value}),className:`h-9 px-3 ${r==="dark"?"bg-[#282f39]":"bg-white"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-sm ${r==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx("option",{value:"",children:"All Priorities"}),i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"critical",children:"Critical"})]}),i.jsxs("select",{value:y.dateRange,onChange:Q=>N({...y,dateRange:Q.target.value}),className:`h-9 px-3 ${r==="dark"?"bg-[#282f39]":"bg-white"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-sm ${r==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx("option",{value:"all",children:"All Time"}),i.jsx("option",{value:"today",children:"Today"}),i.jsx("option",{value:"week",children:"This Week"}),i.jsx("option",{value:"month",children:"This Month"})]}),i.jsx("button",{onClick:()=>H(!1),className:"h-9 px-4 bg-[#136dec] text-white text-sm font-medium rounded hover:bg-[#1258c4] transition-colors",children:"Apply Filters"})]})]}),i.jsxs("div",{className:`border ${r==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} rounded-[0.125rem] overflow-hidden flex flex-col`,children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:`${r==="dark"?"bg-[#181b21] border-[#282f39]":"bg-gray-50 border-gray-200"} border-b`,children:[i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-8`,children:i.jsx("input",{className:`form-checkbox rounded-[0.125rem] ${r==="dark"?"border-[#282f39] bg-[#282f39]":"border-gray-300 bg-gray-100"} text-[#136dec] focus:ring-0 focus:ring-offset-0 h-3 w-3`,type:"checkbox"})}),i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-5/12`,children:"Task Name"}),i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-2/12`,children:"Priority"}),i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-2/12`,children:"Due Date"}),i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-2/12`,children:"Status"}),i.jsx("th",{className:`px-4 py-3 text-xs font-semibold ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-1/12 text-right`,children:"Owner"})]})}),i.jsxs("tbody",{className:`divide-y ${r==="dark"?"divide-[#282f39]":"divide-gray-200"} text-sm`,children:[Ie().length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:`px-4 py-8 text-center ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:A||y.status||y.priority||y.dateRange!=="all"?"No tasks match your filters. Try adjusting your search or filters.":"No tasks found. Create your first task to get started!"})}):Ie().slice(0,5).map(Q=>{var ve,we,Re;return i.jsxs("tr",{className:`group ${r==="dark"?"hover:bg-[#232830]":"hover:bg-gray-50"} transition-colors cursor-pointer`,onClick:()=>a("/tasks"),children:[i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{className:`form-checkbox rounded-[0.125rem] ${r==="dark"?"border-[#282f39] bg-[#282f39] group-hover:border-[#9da8b9]":"border-gray-300 bg-gray-100 group-hover:border-gray-400"} text-[#136dec] focus:ring-0 focus:ring-offset-0 h-3 w-3`,type:"checkbox",onClick:He=>He.stopPropagation()})}),i.jsx("td",{className:"px-4 py-3",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:`${r==="dark"?"text-white":"text-gray-900"} font-medium`,children:Q.title}),i.jsxs("span",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:["Project: ",((ve=Q.team_id)==null?void 0:ve.name)||"No Team"]})]})}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("div",{className:`inline-flex items-center px-2 py-0.5 rounded-[0.125rem] text-xs font-medium border ${Te(Q.priority)}`,children:((we=Q.priority)==null?void 0:we.charAt(0).toUpperCase())+((Re=Q.priority)==null?void 0:Re.slice(1))})}),i.jsx("td",{className:`px-4 py-3 ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} font-mono text-xs`,children:We(Q.due_date)}),i.jsx("td",{className:"px-4 py-3",children:i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${Y(Q.status).split(" ")[0]}`,children:[i.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${Y(Q.status).split(" ")[1]}`}),Q.status.replace("_"," ").charAt(0).toUpperCase()+Q.status.slice(1).replace("_"," ")]})}),i.jsx("td",{className:"px-4 py-3 text-right",children:Q.assigned_to&&Q.assigned_to.length>0&&i.jsx(qv,{user:Q.assigned_to[0],size:"sm",className:"ml-auto"})})]},Q._id)}),l.length===0&&!A&&y.status===""&&y.priority===""&&y.dateRange==="all"&&i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:`px-4 py-8 text-center ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"No tasks found. Create your first task to get started!"})})]})]})}),i.jsxs("div",{className:`p-3 border-t ${r==="dark"?"border-[#282f39] bg-[#181b21] text-[#9da8b9]":"border-gray-200 bg-gray-50 text-gray-600"} flex justify-between items-center text-xs`,children:[i.jsxs("span",{children:["Showing ",Math.min(5,l.length)," of ",s.totalTasks," tasks"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:`${r==="dark"?"hover:text-white":"hover:text-gray-900"} disabled:opacity-50`,disabled:!0,children:"Previous"}),i.jsx("span",{className:r==="dark"?"text-[#282f39]":"text-gray-300",children:"|"}),i.jsx(vi,{to:"/tasks",className:r==="dark"?"hover:text-white":"hover:text-gray-900",children:"View All"})]})]})]})]}),i.jsxs("div",{className:"w-full xl:w-80 shrink-0 flex flex-col gap-6",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h3",{className:`${r==="dark"?"text-white":"text-gray-900"} text-sm font-bold uppercase tracking-wider`,children:"Attention Needed"})}),i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-[0.125rem] overflow-hidden`,children:[i.jsxs("div",{className:`flex flex-col divide-y ${r==="dark"?"divide-[#282f39]":"divide-gray-200"}`,children:[d.slice(0,2).map(Q=>{var ve,we,Re;return i.jsxs("div",{className:`p-3 ${r==="dark"?"hover:bg-[#232830]":"hover:bg-gray-50"} transition-colors cursor-pointer border-l-2 border-transparent hover:border-red-500`,onClick:()=>a("/tasks"),children:[i.jsxs("div",{className:"flex justify-between items-start mb-1",children:[i.jsx("p",{className:`text-sm ${r==="dark"?"text-white":"text-gray-900"} font-medium line-clamp-1`,children:Q.title}),i.jsxs("span",{className:"text-xs text-red-400 font-mono whitespace-nowrap",children:[Math.abs(Math.ceil((new Date(Q.due_date)-new Date)/(1e3*60*60*24))),"d ago"]})]}),i.jsxs("p",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-2`,children:[((ve=Q.team_id)==null?void 0:ve.name)||"No Team"," â€¢ ",((we=Q.priority)==null?void 0:we.charAt(0).toUpperCase())+((Re=Q.priority)==null?void 0:Re.slice(1))]}),Q.assigned_to&&Q.assigned_to.length>0&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(qv,{user:Q.assigned_to[0],size:"xs"}),i.jsxs("span",{className:`text-[10px] ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:["Assigned to ",Q.assigned_to[0].full_name]})]})]},Q._id)}),d.length===0&&i.jsx("div",{className:`p-4 text-center text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"No overdue tasks! ðŸŽ‰"})]}),d.length>2&&i.jsxs(vi,{to:"/tasks",className:`block ${r==="dark"?"bg-[#181b21] text-[#9da8b9] hover:text-white border-[#282f39]":"bg-gray-50 text-gray-600 hover:text-gray-900 border-gray-200"} p-2 text-center text-xs transition-colors border-t`,children:["View all ",d.length," overdue"]})]})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h3",{className:`${r==="dark"?"text-white":"text-gray-900"} text-sm font-bold uppercase tracking-wider`,children:"Team Load"})}),i.jsx("div",{className:`${r==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-[0.125rem] p-4`,children:i.jsxs("div",{className:"flex flex-col gap-4",children:[D.assigneePerformance.slice(0,3).map(Q=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"bg-[#136dec]/20 flex items-center justify-center rounded-full size-8 text-[#136dec] text-sm font-bold",children:Q.name.charAt(0)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex justify-between items-end mb-1",children:[i.jsx("span",{className:`text-sm ${r==="dark"?"text-white":"text-gray-900"} font-medium truncate`,children:Q.name}),i.jsxs("span",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[Q.total," tasks"]})]}),i.jsx("div",{className:`h-1.5 w-full ${r==="dark"?"bg-[#111418]":"bg-gray-200"} rounded-full overflow-hidden`,children:i.jsx("div",{className:`h-full rounded-full ${Q.completionRate>=80?"bg-[#136dec]":Q.completionRate>=50?"bg-green-500":"bg-orange-400"}`,style:{width:`${Q.completionRate}%`}})})]})]},Q.name)),D.assigneePerformance.length===0&&i.jsx("p",{className:`text-sm text-center ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} py-4`,children:"No team members with assigned tasks"})]})})]}),i.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h3",{className:`${r==="dark"?"text-white":"text-gray-900"} text-sm font-bold uppercase tracking-wider`,children:"Live Activity"})}),i.jsxs("div",{className:"relative pl-2 space-y-4",children:[i.jsx("div",{className:`absolute left-2 top-2 bottom-0 w-px ${r==="dark"?"bg-[#282f39]":"bg-gray-200"}`}),l.slice(0,3).map((Q,ve)=>{var we,Re;return i.jsxs("div",{className:"relative pl-6",children:[i.jsx("div",{className:`absolute left-0 top-1.5 size-4 rounded-full ${r==="dark"?"bg-[#111418] border-[#282f39]":"bg-white border-gray-200"} border flex items-center justify-center`,children:i.jsx("div",{className:`size-1.5 rounded-full ${Q.status==="done"?"bg-green-500":Q.status==="in_progress"?"bg-[#136dec]":"bg-gray-400"}`})}),i.jsxs("p",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:`${r==="dark"?"text-white":"text-gray-900"} font-medium`,children:((Re=(we=Q.assigned_to)==null?void 0:we[0])==null?void 0:Re.full_name)||"Someone"})," ",Q.status==="done"?"completed":"updated"," ",i.jsx("span",{className:"text-[#136dec] hover:underline cursor-pointer",children:Q.title})]}),i.jsx("p",{className:`text-[10px] ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-0.5`,children:new Date(Q.created_at||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]},Q._id)}),l.length===0&&i.jsx("p",{className:`text-xs ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} text-center py-4`,children:"No recent activity"})]})]})]})]})]})]})]})},uf=({children:e,title:t,subtitle:r,actions:n,headerContent:a,noPadding:s=!1,maxWidth:o="max-w-[1920px]"})=>{const{theme:l}=Lr(),{toggleMobileSidebar:c,isMobile:d}=Mn();return i.jsxs("div",{className:`flex h-screen overflow-hidden ${l==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[(t||a)&&i.jsx("header",{className:`
              flex-none border-b
              ${l==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}
              ${s?"":"px-4 sm:px-6 lg:px-8 py-3 sm:py-4"}
            `,children:i.jsxs("div",{className:`flex items-center justify-between gap-3 sm:gap-4 ${o} mx-auto w-full`,children:[i.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[d&&i.jsx("button",{onClick:c,className:`
                      flex-none p-2 rounded-lg
                      ${l==="dark"?"hover:bg-[#282f39] text-[#9da8b9] hover:text-white":"hover:bg-gray-100 text-gray-600 hover:text-gray-900"}
                      transition-colors md:hidden
                    `,"aria-label":"Toggle menu",children:i.jsx(Os,{size:20})}),t&&i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h1",{className:`
                        font-bold truncate
                        ${l==="dark"?"text-white":"text-gray-900"}
                        text-lg sm:text-xl lg:text-2xl
                      `,children:t}),r&&i.jsx("p",{className:`
                          text-xs sm:text-sm truncate mt-0.5
                          ${l==="dark"?"text-[#9da8b9]":"text-gray-600"}
                        `,children:r})]}),a]}),n&&i.jsx("div",{className:"flex items-center gap-2 sm:gap-3 flex-none",children:n})]})}),i.jsx("div",{className:"flex-1 overflow-auto",children:i.jsx("div",{className:`${o} mx-auto w-full h-full ${s?"":"p-4 sm:p-6 lg:p-8"}`,children:e})})]})]})},fg=({isOpen:e,onClose:t,title:r,children:n,footer:a,size:s="default",noPadding:o=!1})=>{const{theme:l}=Lr();if(J.useEffect(()=>{const d=u=>{u.key==="Escape"&&e&&t()};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[e,t]),J.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;const c={small:"sm:max-w-md",default:"sm:max-w-lg md:max-w-2xl",large:"sm:max-w-2xl md:max-w-4xl lg:max-w-5xl",full:"sm:max-w-full sm:m-4 md:m-8"};return i.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:t}),i.jsxs("div",{className:`
          relative w-full ${c[s]||c.default}
          ${l==="dark"?"bg-gradient-to-b from-[#1c2027] to-[#181c23]":"bg-gradient-to-b from-white to-gray-50"}
          rounded-t-3xl sm:rounded-xl
          shadow-2xl
          flex flex-col
          max-h-[92vh] sm:max-h-[90vh]
          animate-slideUp sm:animate-scaleIn
          border-t-4 border-[#136dec]
        `,children:[i.jsx("div",{className:"sm:hidden flex justify-center pt-3 pb-2",children:i.jsx("div",{className:"w-12 h-1.5 bg-[#4b5563] rounded-full"})}),i.jsxs("div",{className:`
            flex-none flex items-center justify-between
            ${o?"":"px-4 py-3 sm:p-6"}
            border-b ${l==="dark"?"border-[#282f39]":"border-gray-200"}
            sticky top-0 ${l==="dark"?"bg-[#1c2027]":"bg-white"}
            z-10 rounded-t-3xl sm:rounded-t-xl
          `,children:[i.jsx("h2",{className:`
              font-bold
              ${l==="dark"?"text-white":"text-gray-900"}
              text-base sm:text-xl lg:text-2xl
              pr-4 truncate
            `,children:r}),i.jsx("button",{onClick:t,className:`
              flex-none p-2 rounded-lg
              ${l==="dark"?"hover:bg-[#282f39] text-[#9da8b9] hover:text-white":"hover:bg-gray-100 text-gray-600 hover:text-gray-900"}
              transition-colors
            `,"aria-label":"Close modal",children:i.jsx(kr,{size:20})})]}),i.jsx("div",{className:`
            flex-1 overflow-y-auto overflow-x-hidden
            ${o?"":"p-4 sm:p-6"}
          `,children:n}),a&&i.jsx("div",{className:`
              flex-none
              ${o?"":"p-4 sm:p-6"}
              border-t ${l==="dark"?"border-[#282f39]":"border-gray-200"}
              sticky bottom-0 ${l==="dark"?"bg-[#1c2027]":"bg-white"}
              sm:rounded-b-xl
            `,children:a})]})]})},kR=({children:e,cols:t={base:1,sm:1,md:2,lg:3,xl:3},gap:r="gap-4 sm:gap-6",className:n=""})=>{const a=`
    grid-cols-${t.base}
    ${t.sm?`sm:grid-cols-${t.sm}`:""}
    ${t.md?`md:grid-cols-${t.md}`:""}
    ${t.lg?`lg:grid-cols-${t.lg}`:""}
    ${t.xl?`xl:grid-cols-${t.xl}`:""}
  `;return i.jsx("div",{className:`grid ${a} ${r} ${n}`,children:e})},SR=({task:e,onView:t,onEdit:r,onDelete:n,onStatusChange:a,canEdit:s=!1,canDelete:o=!1,getUserInitials:l})=>{const{theme:c}=Lr(),[d,u]=J.useState(!1),h=S=>{const _={low:"bg-slate-500/10 text-slate-300 border-slate-500/20",medium:"bg-orange-400/10 text-orange-300 border-orange-400/20",high:"bg-red-500/10 text-red-300 border-red-500/20",urgent:"bg-red-600/15 text-red-300 border-red-600/30 shadow-lg shadow-red-900/20"};return _[S]||_.medium},m=S=>{const _={low:"bg-slate-400",medium:"bg-orange-400",high:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]",urgent:"bg-red-600 shadow-[0_0_12px_rgba(220,38,38,0.7)] animate-pulse"};return _[S]||_.medium},f=S=>{const _={todo:"bg-slate-500/10 text-slate-300 border-slate-500/20",in_progress:"bg-blue-500/10 text-blue-300 border-blue-500/20",review:"bg-yellow-500/10 text-yellow-300 border-yellow-500/20",done:"bg-emerald-500/10 text-emerald-300 border-emerald-500/20",archived:"bg-gray-500/10 text-gray-400 border-gray-500/20"};return _[S]||_.todo},x=S=>({todo:"To Do",in_progress:"In Progress",review:"Review",done:"Done",archived:"Archived"})[S]||"Unknown",g=S=>({low:"Low",medium:"Medium",high:"High",urgent:"Urgent"})[S]||"Medium",b=e.due_date&&new Date(e.due_date)<new Date,y=e.due_date?Math.ceil((new Date(e.due_date)-new Date)/(1e3*60*60*24)):null,N=S=>{a(S),u(!1)};return i.jsxs("div",{className:`relative ${c==="dark"?"bg-gradient-to-br from-[#1c2027] to-[#181c23] border-[#282f39] hover:border-[#3a4454]":"bg-gradient-to-br from-white to-gray-50 border-gray-200 hover:border-gray-300"} border rounded-xl overflow-hidden transition-all duration-300 hover:shadow-2xl hover:shadow-blue-900/10 hover:-translate-y-1 group`,children:[i.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${e.priority==="urgent"?"bg-gradient-to-r from-red-600 via-red-500 to-red-600":e.priority==="high"?"bg-gradient-to-r from-red-500 via-orange-500 to-red-500":e.priority==="medium"?"bg-gradient-to-r from-orange-400 via-yellow-400 to-orange-400":"bg-gradient-to-r from-slate-400 via-slate-500 to-slate-400"}`}),i.jsxs("div",{className:"p-5",onClick:t,children:[i.jsxs("div",{className:"flex items-start justify-between mb-4 cursor-pointer",children:[i.jsxs("div",{className:"flex-1 min-w-0 pr-3",children:[i.jsx("h3",{className:`text-lg font-bold ${c==="dark"?"text-white":"text-gray-900"} mb-2 line-clamp-2 group-hover:text-[#136dec] transition-colors duration-200`,children:e.title}),e.description&&i.jsx("p",{className:`text-sm ${c==="dark"?"text-[#9da8b9]":"text-gray-600"} line-clamp-2 leading-relaxed`,children:e.description})]}),i.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full border ${h(e.priority)} backdrop-blur-sm transition-all duration-200 hover:scale-105`,children:[i.jsx("div",{className:`size-2 rounded-full ${m(e.priority)}`}),i.jsx("span",{className:"text-xs font-semibold whitespace-nowrap",children:g(e.priority)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"relative",onClick:S=>S.stopPropagation(),children:[i.jsxs("button",{onClick:()=>u(!d),className:`w-full flex items-center justify-between gap-2 px-3 py-2 rounded-lg border ${f(e.status)} transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]`,children:[i.jsx("span",{className:"text-xs font-semibold",children:x(e.status)}),i.jsx(wi,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&i.jsx("div",{className:`absolute top-full left-0 right-0 mt-2 ${c==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-lg shadow-2xl overflow-hidden z-10 animate-slideUp`,children:["todo","in_progress","review","done","archived"].map(S=>i.jsx("button",{onClick:()=>N(S),className:`w-full px-3 py-2.5 text-left text-sm transition-colors ${e.status===S?"bg-[#136dec] text-white font-semibold":`${c==="dark"?"text-[#9da8b9] hover:bg-[#282f39] hover:text-white":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`}`,children:x(S)},S))})]}),e.due_date&&i.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border ${b?"bg-red-500/10 text-red-300 border-red-500/30 animate-pulse":y<=3?"bg-yellow-500/10 text-yellow-300 border-yellow-500/30":`${c==="dark"?"bg-[#282f39] text-[#9da8b9] border-[#3a4454]":"bg-gray-100 text-gray-600 border-gray-200"}`} transition-all duration-200`,children:[i.jsx(Gn,{size:14,className:"flex-shrink-0"}),i.jsx("div",{className:"flex flex-col min-w-0",children:i.jsx("span",{className:"text-xs font-semibold truncate",children:new Date(e.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})})]})]}),e.assigned_to&&e.assigned_to.length>0&&i.jsxs("div",{className:`flex items-center gap-3 px-3 py-2.5 rounded-lg mb-4 border transition-all duration-200 ${c==="dark"?"bg-[#282f39]/30 border-[#282f39] hover:bg-[#282f39]/50":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[i.jsx(ji,{size:16,className:`${c==="dark"?"text-[#9da8b9]":"text-gray-400"} flex-shrink-0`}),i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("div",{className:`size-8 rounded-full bg-gradient-to-br from-purple-500 via-blue-500 to-indigo-600 flex items-center justify-center text-xs text-white font-bold shadow-lg ring-2 ${c==="dark"?"ring-[#282f39]":"ring-white"}`,children:l(e.assigned_to[0].full_name)}),i.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[i.jsx("span",{className:`text-sm font-semibold ${c==="dark"?"text-white":"text-gray-900"} truncate`,children:e.assigned_to[0].full_name}),e.assigned_to.length>1&&i.jsxs("span",{className:`text-xs ${c==="dark"?"text-[#9da8b9]":"text-gray-500"}`,children:["+",e.assigned_to.length-1," more"]})]})]})]}),b&&i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-500/10 border border-red-500/30 rounded-lg mb-4 animate-pulse",children:[i.jsx(Zc,{size:14,className:"text-red-400"}),i.jsxs("span",{className:"text-xs font-semibold text-red-400",children:["Overdue by ",Math.abs(y)," day",Math.abs(y)!==1?"s":""]})]}),i.jsxs("div",{className:`flex items-center gap-2 pt-4 border-t ${c==="dark"?"border-[#282f39]":"border-gray-200"}`,onClick:S=>S.stopPropagation(),children:[s&&i.jsxs("button",{onClick:r,className:"flex-1 min-h-[44px] flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-[#136dec] to-blue-600 hover:from-blue-600 hover:to-[#136dec] text-white text-sm font-semibold rounded-lg transition-all duration-200 hover:shadow-lg hover:shadow-blue-900/30 hover:scale-[1.02] active:scale-[0.98]",children:[i.jsx(Hl,{size:16}),i.jsx("span",{children:"Edit"})]}),o&&i.jsx("button",{onClick:n,className:`min-h-[44px] min-w-[44px] flex items-center justify-center px-3 py-2.5 ${c==="dark"?"bg-[#282f39] hover:bg-red-600 text-[#9da8b9] hover:text-white":"bg-gray-100 hover:bg-red-500 text-gray-600 hover:text-white"} rounded-lg transition-all duration-200 hover:shadow-lg hover:shadow-red-900/30 hover:scale-[1.02] active:scale-[0.98]`,children:i.jsx(ua,{size:16})}),!s&&!o&&i.jsx("button",{onClick:t,className:`flex-1 min-h-[44px] flex items-center justify-center gap-2 px-4 py-2.5 ${c==="dark"?"bg-[#282f39] hover:bg-[#3a4454] text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900"} text-sm font-semibold rounded-lg transition-all duration-200 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]`,children:i.jsx("span",{children:"View Details"})})]})]})]})},jR=()=>{var vt;const{user:e,socket:t}=pn(),[r,n]=W0();Cs();const{theme:a}=Lr(),{toggleMobileSidebar:s}=Mn(),[o,l]=J.useState([]),[c,d]=J.useState([]),[u,h]=J.useState(!0),[m,f]=J.useState(!1),[x,g]=J.useState(!1),[b,y]=J.useState(!1),[N,S]=J.useState(null),[_,D]=J.useState(null),[I,O]=J.useState([]),[R,E]=J.useState([]),[B,C]=J.useState(""),[M,U]=J.useState(!1),[F,ne]=J.useState({status:"",priority:"",showMyTasksOnly:!1,team:"",assigned_to:"",dueDateFrom:"",dueDateTo:"",search:""}),[V,ee]=J.useState({title:"",description:"",priority:"medium",status:"todo",due_date:"",team_id:"",assigned_to:[]}),[me,ye]=J.useState([]),[Oe,xe]=J.useState([]);J.useEffect(()=>{if(A(),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&(T(),L()),r.get("create")==="true"&&(f(!0),r.delete("create"),n(r)),t)return t.on("task:created",le=>{l(Ae=>[le,...Ae])}),t.on("task:updated",le=>{l(Ae=>Ae.map(Qe=>Qe._id===le._id?le:Qe))}),()=>{t.off("task:created"),t.off("task:updated")}},[t]),J.useEffect(()=>{w()},[o,F]),el({onTaskCreated:()=>A(),onTaskUpdated:()=>A(),onTaskDeleted:()=>A(),onCommentAdded:()=>A()});const w=J.useCallback(()=>{let le=[...o];if(F.status&&(le=le.filter(Ae=>Ae.status===F.status)),F.priority&&(le=le.filter(Ae=>Ae.priority===F.priority)),F.team&&(le=le.filter(Ae=>Ae.team_id&&(Ae.team_id._id===F.team||Ae.team_id===F.team))),F.assigned_to&&(le=le.filter(Ae=>Ae.assigned_to&&Ae.assigned_to.some(Qe=>(Qe._id||Qe)===F.assigned_to))),F.dueDateFrom&&(le=le.filter(Ae=>Ae.due_date&&new Date(Ae.due_date)>=new Date(F.dueDateFrom))),F.dueDateTo&&(le=le.filter(Ae=>Ae.due_date&&new Date(Ae.due_date)<=new Date(F.dueDateTo))),F.search){const Ae=F.search.toLowerCase();le=le.filter(Qe=>Qe.title.toLowerCase().includes(Ae)||Qe.description&&Qe.description.toLowerCase().includes(Ae))}F.showMyTasksOnly&&(le=le.filter(Ae=>{if(!Ae.assigned_to)return!1;const _e=(Array.isArray(Ae.assigned_to)?Ae.assigned_to.map(Ze=>typeof Ze=="object"?Ze._id:Ze):[typeof Ae.assigned_to=="object"?Ae.assigned_to._id:Ae.assigned_to]).includes(e==null?void 0:e.id);if((e==null?void 0:e.role)==="member"){const Ze=e.team_id&&Ae.team_id&&(Ae.team_id._id===e.team_id||Ae.team_id===e.team_id);return _e&&Ze}return _e})),d(le)},[o,F,e==null?void 0:e.id,e==null?void 0:e.role,e==null?void 0:e.team_id]),A=async()=>{try{const le=await it.get("/tasks");l(le.data.tasks),h(!1)}catch(le){console.error("Error fetching tasks:",le),h(!1)}},T=async()=>{var le;try{const Ae=(e==null?void 0:e.role)==="team_lead"?"/users/team-members":"/users",Qe=await it.get(Ae);ye(Qe.data.users)}catch(Ae){((le=Ae.response)==null?void 0:le.status)!==403&&console.error("Error fetching users:",Ae)}},L=async()=>{try{const le=await it.get("/teams");xe(le.data.teams)}catch(le){console.error("Error fetching teams:",le)}},H=async le=>{var Ae,Qe;le.preventDefault();try{await it.post("/tasks",V),f(!1),ee({title:"",description:"",priority:"medium",status:"todo",due_date:"",team_id:"",assigned_to:[]}),A()}catch(_e){console.error("Error creating task:",_e),alert(((Qe=(Ae=_e.response)==null?void 0:Ae.data)==null?void 0:Qe.message)||"Failed to create task")}},X=async(le,Ae)=>{var Qe,_e;l(Ze=>Ze.map(Ve=>Ve._id===le?{...Ve,...Ae}:Ve));try{const Ve=(await it.patch(`/tasks/${le}`,Ae)).data.task;l(ot=>ot.map(pt=>pt._id===le?Ve:pt)),(N==null?void 0:N._id)===le&&S(Ve),(_==null?void 0:_._id)===le&&D(Ve)}catch(Ze){console.error("Error updating task:",Ze),alert(((_e=(Qe=Ze.response)==null?void 0:Qe.data)==null?void 0:_e.message)||"Failed to update task"),A()}},re=le=>{var _e,Ze;const Ae=Oe.find(Ve=>{var ot;return Ve._id===(((ot=le.team_id)==null?void 0:ot._id)||le.team_id)});let Qe=Ae?Ae.members:[];Ae&&(e==null?void 0:e.role)==="team_lead"&&!Qe.some(ot=>ot._id===(e==null?void 0:e.id))&&((_e=Ae.lead_id)==null?void 0:_e._id)===(e==null?void 0:e.id)&&(Qe=[...Qe,{_id:e.id,full_name:e.full_name||e.username||e.email,role:e.role,email:e.email}]),O(Qe),D({...le,assigned_to:le.assigned_to?Array.isArray(le.assigned_to)?le.assigned_to.map(Ve=>Ve._id||Ve):[le.assigned_to._id||le.assigned_to]:[],team_id:((Ze=le.team_id)==null?void 0:Ze._id)||le.team_id||""}),g(!0)},ge=async le=>{var Ae,Qe;le.preventDefault();try{const _e={title:_.title,description:_.description,priority:_.priority,status:_.status,due_date:_.due_date,team_id:_.team_id,assigned_to:_.assigned_to};await it.patch(`/tasks/${_._id}`,_e),g(!1),D(null),O([]),A()}catch(_e){console.error("Error updating task:",_e),alert(((Qe=(Ae=_e.response)==null?void 0:Ae.data)==null?void 0:Qe.message)||"Failed to update task")}},oe=le=>{var ot;const Ae=Oe.find(pt=>pt._id===le);let Qe=Ae?Ae.members:[];Ae&&(e==null?void 0:e.role)==="team_lead"&&!Qe.some(yt=>yt._id===(e==null?void 0:e.id))&&((ot=Ae.lead_id)==null?void 0:ot._id)===(e==null?void 0:e.id)&&(Qe=[...Qe,{_id:e.id,full_name:e.full_name||e.username||e.email,role:e.role,email:e.email}]),O(Qe);const _e=Qe.map(pt=>pt._id),Ve=(_.assigned_to||[]).filter(pt=>_e.includes(pt));D({..._,team_id:le,assigned_to:Ve})},je=le=>{const Ae=_.assigned_to||[],Qe=Ae.includes(le);D(Qe?{..._,assigned_to:Ae.filter(_e=>_e!==le)}:{..._,assigned_to:[...Ae,le]})},Ie=async le=>{var Ae,Qe;if(confirm("Are you sure you want to delete this task?"))try{await it.delete(`/tasks/${le}`),A(),y(!1)}catch(_e){console.error("Error deleting task:",_e),alert(((Qe=(Ae=_e.response)==null?void 0:Ae.data)==null?void 0:Qe.message)||"Failed to delete task")}},et=async le=>{S(le),y(!0);try{const Ae=await it.get(`/comments/${le._id}/comments`);E(Ae.data.comments)}catch(Ae){console.error("Error fetching comments:",Ae)}},Te=async le=>{if(le.preventDefault(),!!B.trim())try{await it.post(`/comments/${N._id}/comments`,{content:B}),C("");const Ae=await it.get(`/comments/${N._id}/comments`);E(Ae.data.comments)}catch(Ae){console.error("Error adding comment:",Ae)}},Y=le=>{const Ae={todo:"bg-[#282f39] text-[#9da8b9] border-[#4b5563]/30",in_progress:"bg-blue-500/10 text-blue-400 border-blue-500/20",review:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",done:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20",archived:"bg-red-500/10 text-red-400 border-red-500/20"};return Ae[le]||Ae.todo},We=le=>({todo:"To Do",in_progress:"In Progress",review:"Review",done:"Done",archived:"Archived"})[le]||"Unknown",Q=le=>{const Ae={low:"bg-slate-500",medium:"bg-orange-400",high:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.4)]",urgent:"bg-red-600 shadow-[0_0_12px_rgba(220,38,38,0.6)]"};return Ae[le]||Ae.medium},ve=le=>({low:"Low",medium:"Medium",high:"High",urgent:"Urgent"})[le]||"Medium",we=le=>{var Ae;return["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)?!0:le.created_by._id===(e==null?void 0:e.id)||((Ae=le.assigned_to)==null?void 0:Ae._id)===(e==null?void 0:e.id)},Re=le=>["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)?!0:le.created_by._id===(e==null?void 0:e.id),He=le=>{if(!le)return"U";const Ae=le.split(" ");return Ae.length>=2?(Ae[0][0]+Ae[1][0]).toUpperCase():le.substring(0,2).toUpperCase()};return u?i.jsx("div",{className:`h-screen flex items-center justify-center ${a==="dark"?"bg-[#111418] text-white":"bg-gray-50 text-gray-900"} font-['Inter']`,children:i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"relative",children:i.jsx("div",{className:`animate-spin rounded-full h-16 w-16 border-4 ${a==="dark"?"border-[#282f39]":"border-gray-200"} border-t-[#136dec]`})}),i.jsx("p",{className:`${a==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Loading tasks..."})]})}):i.jsxs(i.Fragment,{children:[i.jsxs(uf,{title:"Tasks",actions:i.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 h-9 bg-[#136dec] hover:bg-blue-600 text-white text-sm font-semibold px-4 rounded transition-colors shadow-lg shadow-blue-900/20",children:[i.jsx(Si,{size:20}),i.jsx("span",{className:"hidden sm:inline",children:"New Task"}),i.jsx("span",{className:"sm:inline",children:"New"})]}),children:[i.jsxs("div",{className:"mb-4 space-y-3",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(oo,{size:18,className:`absolute left-3 top-1/2 -translate-y-1/2 ${a==="dark"?"text-[#9da8b9]":"text-gray-400"}`}),i.jsx("input",{type:"text",value:F.search,onChange:le=>ne({...F,search:le.target.value}),placeholder:"Search tasks...",className:`w-full pl-10 pr-4 py-2.5 ${a==="dark"?"bg-[#1c2027] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900 placeholder:text-gray-400"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`})]}),i.jsxs("button",{onClick:()=>U(!0),className:`lg:hidden flex items-center justify-center gap-2 px-4 py-2.5 ${a==="dark"?"bg-[#1c2027] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg hover:border-[#136dec] transition-colors`,children:[i.jsx(zl,{size:18}),i.jsx("span",{children:"Filters"}),(F.status||F.priority||F.team||F.assigned_to)&&i.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-[#136dec] text-white text-xs rounded-full",children:[F.status,F.priority,F.team,F.assigned_to].filter(Boolean).length})]})]}),i.jsxs("div",{className:"hidden lg:flex flex-wrap gap-2",children:[i.jsxs("select",{value:F.status,onChange:le=>ne({...F,status:le.target.value}),className:`px-3 py-1.5 ${a==="dark"?"bg-[#1c2027] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"}),i.jsx("option",{value:"archived",children:"Archived"})]}),i.jsxs("select",{value:F.priority,onChange:le=>ne({...F,priority:le.target.value}),className:`px-3 py-1.5 ${a==="dark"?"bg-[#1c2027] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Priorities"}),i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]}),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&Oe.length>0&&i.jsxs("select",{value:F.team,onChange:le=>ne({...F,team:le.target.value}),className:`px-3 py-1.5 ${a==="dark"?"bg-[#1c2027] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Teams"}),Oe.map(le=>i.jsx("option",{value:le._id,children:le.name},le._id))]}),(F.status||F.priority||F.team||F.assigned_to)&&i.jsx("button",{onClick:()=>ne({...F,status:"",priority:"",team:"",assigned_to:""}),className:`px-3 py-1.5 text-sm ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:"Clear Filters"})]})]}),i.jsx("div",{className:"lg:hidden",children:c.length===0?i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"} text-lg`,children:"No tasks found. Create your first task!"})}):i.jsx(kR,{cols:{base:1,sm:1,md:2},gap:"md",children:c.map(le=>i.jsx(SR,{task:le,onView:()=>et(le),onEdit:()=>re(le),onDelete:()=>Ie(le._id),onStatusChange:Ae=>X(le._id,{status:Ae}),canEdit:we(le),canDelete:Re(le),getUserInitials:He},le._id))})}),i.jsxs("div",{className:"hidden lg:block",children:[i.jsx("div",{className:`overflow-x-auto ${a==="dark"?"bg-[#111418]":"bg-gray-50"} rounded-lg border ${a==="dark"?"border-[#282f39]":"border-gray-200"}`,children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{className:`${a==="dark"?"bg-[#1c2027]":"bg-gray-100"}`,children:i.jsxs("tr",{children:[i.jsx("th",{className:`py-3 pl-6 pr-3 w-10 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"}`,children:i.jsx("input",{type:"checkbox",className:"size-4 rounded border-[#4b5563] bg-transparent text-[#136dec] focus:ring-offset-0 focus:ring-0 cursor-pointer"})}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} text-xs font-semibold ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} uppercase tracking-wider cursor-pointer group`,children:i.jsxs("div",{className:"flex items-center gap-1",children:["Task",i.jsx(wi,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} text-xs font-semibold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-32`,children:"Priority"}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} text-xs font-semibold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-36`,children:"Status"}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} text-xs font-semibold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-40`,children:"Assignee"}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} text-xs font-semibold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider w-32`,children:"Due Date"}),i.jsx("th",{className:`py-3 px-3 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"} w-16`})]})}),i.jsx("tbody",{className:`divide-y ${a==="dark"?"divide-[#282f39]":"divide-gray-200"}`,children:c.map((le,Ae)=>i.jsxs("tr",{className:`group transition-colors cursor-pointer ${a==="dark"?"hover:bg-[#161b22]":"hover:bg-gray-100"} ${Ae%2===1?a==="dark"?"bg-[#1c2027]/30":"bg-gray-50":""}`,onClick:()=>et(le),children:[i.jsx("td",{className:"py-2.5 pl-6 pr-3",onClick:Qe=>Qe.stopPropagation(),children:i.jsx("input",{type:"checkbox",className:"size-4 rounded border-[#4b5563] bg-transparent text-[#136dec] focus:ring-offset-0 focus:ring-0 cursor-pointer"})}),i.jsx("td",{className:"py-2.5 px-3",children:i.jsx("div",{className:"flex flex-col",children:i.jsx("span",{className:`text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} group-hover:text-[#136dec] line-clamp-2`,children:le.title})})}),i.jsx("td",{className:"py-2.5 px-3",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`size-2 rounded-full ${Q(le.priority)}`}),i.jsx("span",{className:`text-xs ${a==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:ve(le.priority)})]})}),i.jsx("td",{className:"py-2.5 px-3",onClick:Qe=>Qe.stopPropagation(),children:i.jsxs("select",{value:le.status,onChange:Qe=>X(le._id,{status:Qe.target.value}),className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border ${Y(le.status)} bg-transparent focus:ring-0 focus:outline-none cursor-pointer`,children:[i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"}),i.jsx("option",{value:"archived",children:"Archived"})]})}),i.jsx("td",{className:"py-2.5 px-3",children:le.assigned_to&&le.assigned_to.length>0?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"size-6 rounded-full bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center text-[10px] text-white font-bold",children:He(le.assigned_to[0].full_name)}),i.jsxs("span",{className:`text-xs ${a==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:[le.assigned_to[0].full_name,le.assigned_to.length>1&&` +${le.assigned_to.length-1}`]})]}):i.jsx("span",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-500"}`,children:"Unassigned"})}),i.jsx("td",{className:"py-2.5 px-3",children:i.jsx("span",{className:`text-xs ${le.due_date&&new Date(le.due_date)<new Date?"text-red-400":a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:le.due_date?new Date(le.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"No date"})}),i.jsx("td",{className:"py-2.5 px-3 text-right",onClick:Qe=>Qe.stopPropagation(),children:i.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[we(le)&&i.jsx("button",{onClick:()=>re(le),className:`${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-500 hover:text-gray-900"} p-1`,children:i.jsx(Hl,{size:16})}),Re(le)&&i.jsx("button",{onClick:()=>Ie(le._id),className:`${a==="dark"?"text-[#9da8b9]":"text-gray-500"} hover:text-red-400 p-1`,children:i.jsx(ua,{size:16})}),i.jsx("button",{className:`${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-500 hover:text-gray-900"} p-1`,children:i.jsx(O4,{size:18})})]})})]},le._id))})]})}),c.length===0&&i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"} text-lg`,children:"No tasks found. Create your first task!"})})]}),i.jsx("div",{className:`mt-4 flex items-center justify-between text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:i.jsxs("span",{children:[c.length," of ",o.length," tasks"]})})]}),M&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/70 z-40 lg:hidden",onClick:()=>U(!1)}),i.jsx("div",{className:`fixed inset-y-0 right-0 w-80 max-w-[85vw] ${a==="dark"?"bg-[#1c2027]":"bg-white"} shadow-xl z-50 lg:hidden transform transition-transform duration-300 ease-out animate-slideInRight`,children:i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${a==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx("h3",{className:`text-lg font-semibold ${a==="dark"?"text-white":"text-gray-900"}`,children:"Filters"}),i.jsx("button",{onClick:()=>U(!1),className:`${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-500 hover:text-gray-900"}`,children:i.jsx(kr,{size:24})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Status"}),i.jsxs("select",{value:F.status,onChange:le=>ne({...F,status:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"}),i.jsx("option",{value:"archived",children:"Archived"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Priority"}),i.jsxs("select",{value:F.priority,onChange:le=>ne({...F,priority:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Priorities"}),i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&Oe.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Team"}),i.jsxs("select",{value:F.team,onChange:le=>ne({...F,team:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Teams"}),Oe.map(le=>i.jsx("option",{value:le._id,children:le.name},le._id))]})]}),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&me.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Assigned To"}),i.jsxs("select",{value:F.assigned_to,onChange:le=>ne({...F,assigned_to:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Users"}),me.map(le=>i.jsx("option",{value:le._id,children:le.full_name},le._id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Due Date From"}),i.jsx("input",{type:"date",value:F.dueDateFrom,onChange:le=>ne({...F,dueDateFrom:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Due Date To"}),i.jsx("input",{type:"date",value:F.dueDateTo,onChange:le=>ne({...F,dueDateTo:le.target.value}),className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`})]})]}),i.jsxs("div",{className:`p-4 border-t ${a==="dark"?"border-[#282f39]":"border-gray-200"} space-y-2`,children:[i.jsx("button",{onClick:()=>{ne({...F,status:"",priority:"",team:"",assigned_to:"",dueDateFrom:"",dueDateTo:""}),U(!1)},className:`w-full px-4 py-2 ${a==="dark"?"bg-[#282f39] text-white hover:bg-[#3a4454]":"bg-gray-200 text-gray-900 hover:bg-gray-300"} rounded transition-colors`,children:"Clear All"}),i.jsx("button",{onClick:()=>U(!1),className:"w-full px-4 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"Apply Filters"})]})]})})]}),i.jsxs(fg,{isOpen:m,onClose:()=>f(!1),title:"Create New Task",size:"large",children:[i.jsxs("form",{onSubmit:H,className:"space-y-3 sm:space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Title *"}),i.jsx("input",{type:"text",value:V.title,onChange:le=>ee({...V,title:le.target.value}),className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all`,required:!0,placeholder:"Enter task title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Description"}),i.jsx("textarea",{value:V.description,onChange:le=>ee({...V,description:le.target.value}),className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all resize-none`,rows:"3",placeholder:"Add a description (optional)"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Priority"}),i.jsxs("select",{value:V.priority,onChange:le=>ee({...V,priority:le.target.value}),className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all`,children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Status"}),i.jsxs("select",{value:V.status,onChange:le=>ee({...V,status:le.target.value}),className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all`,children:[i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Due Date *"}),i.jsx("input",{type:"date",value:V.due_date,onChange:le=>ee({...V,due_date:le.target.value}),className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all`,required:!0})]}),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Select Team"}),i.jsxs("select",{value:V.team_id,onChange:le=>{var Ze;const Ae=le.target.value,Qe=Oe.find(Ve=>Ve._id===Ae);let _e=Qe?Qe.members:[];Qe&&(e==null?void 0:e.role)==="team_lead"&&!_e.some(ot=>ot._id===(e==null?void 0:e.id))&&((Ze=Qe.lead_id)==null?void 0:Ze._id)===(e==null?void 0:e.id)&&(_e=[..._e,{_id:e.id,full_name:e.full_name||e.username||e.email,role:e.role,email:e.email}]),O(_e),ee({...V,team_id:Ae,assigned_to:[]})},className:`w-full px-3 sm:px-4 py-2.5 sm:py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded-lg text-sm focus:ring-2 focus:ring-[#136dec] focus:border-transparent transition-all`,children:[i.jsx("option",{value:"",children:"No Team"}),Oe.map(le=>i.jsx("option",{value:le._id,children:le.name},le._id))]})]}),V.team_id&&I.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs sm:text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-1.5 sm:mb-2`,children:"Assign Team Members"}),i.jsx("div",{className:`space-y-2 max-h-40 overflow-y-auto border ${a==="dark"?"border-[#282f39] bg-[#111418]":"border-gray-300 bg-gray-50"} rounded-lg p-2.5 sm:p-3`,children:I.map(le=>i.jsxs("label",{className:`flex items-center space-x-2.5 min-h-[44px] sm:min-h-0 cursor-pointer ${a==="dark"?"hover:bg-[#1c2027]":"hover:bg-gray-100"} rounded px-2 py-1 transition-colors`,children:[i.jsx("input",{type:"checkbox",checked:V.assigned_to.includes(le._id),onChange:()=>{const Ae=V.assigned_to,Qe=Ae.includes(le._id);ee(Qe?{...V,assigned_to:Ae.filter(_e=>_e!==le._id)}:{...V,assigned_to:[...Ae,le._id]})},className:"rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec] w-4 h-4"}),i.jsxs("span",{className:`text-xs sm:text-sm ${a==="dark"?"text-white":"text-gray-900"}`,children:[le.full_name," ",i.jsxs("span",{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:["(",le.role,")"]}),le._id===(e==null?void 0:e.id)&&i.jsx("span",{className:"text-[#136dec] font-medium",children:" (You)"})]})]},le._id))})]})]})]}),i.jsxs("div",{className:`flex flex-col-reverse sm:flex-row justify-end gap-2 sm:gap-4 pt-4 mt-4 sm:mt-6 border-t ${a==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx("button",{type:"button",onClick:()=>f(!1),className:`w-full sm:w-auto min-h-[44px] px-6 py-2.5 sm:py-2 ${a==="dark"?"bg-[#282f39] hover:bg-[#3a4454] text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"} text-sm font-medium rounded-lg transition-all active:scale-95`,children:"Cancel"}),i.jsx("button",{type:"submit",onClick:H,className:"w-full sm:w-auto min-h-[44px] px-6 py-2.5 sm:py-2 bg-gradient-to-r from-[#136dec] to-blue-600 hover:from-blue-600 hover:to-[#136dec] text-white text-sm rounded-lg transition-all font-semibold shadow-lg shadow-blue-900/30 active:scale-95",children:"Create Task"})]})]}),i.jsxs(fg,{isOpen:x&&_,onClose:()=>{g(!1),D(null)},title:"Edit Task",size:"large",children:[_&&i.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Title *"}),i.jsx("input",{type:"text",value:_.title,onChange:le=>D({..._,title:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Description"}),i.jsx("textarea",{value:_.description,onChange:le=>D({..._,description:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,rows:"4"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Priority"}),i.jsxs("select",{value:_.priority,onChange:le=>D({..._,priority:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"low",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Low"}),i.jsx("option",{value:"medium",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Medium"}),i.jsx("option",{value:"high",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"High"}),i.jsx("option",{value:"urgent",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Urgent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Status"}),i.jsxs("select",{value:_.status,onChange:le=>D({..._,status:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"todo",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"To Do"}),i.jsx("option",{value:"in_progress",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"In Progress"}),i.jsx("option",{value:"review",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Review"}),i.jsx("option",{value:"done",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Done"}),i.jsx("option",{value:"archived",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"Archived"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Due Date *"}),i.jsx("input",{type:"date",value:_.due_date?new Date(_.due_date).toISOString().split("T")[0]:"",onChange:le=>D({..._,due_date:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),["admin","hr","team_lead"].includes(e==null?void 0:e.role)&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Select Team"}),i.jsxs("select",{value:_.team_id||"",onChange:le=>oe(le.target.value),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:"No Team"}),Oe.map(le=>i.jsx("option",{value:le._id,className:a==="dark"?"bg-[#111418] text-white":"bg-white text-gray-900",children:le.name},le._id))]})]}),_.team_id&&I.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Assign Team Members"}),i.jsx("div",{className:`space-y-2 max-h-40 overflow-y-auto border ${a==="dark"?"border-[#282f39] bg-[#111418]":"border-gray-300 bg-gray-50"} rounded-lg p-3`,children:I.map(le=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:_.assigned_to.includes(le._id),onChange:()=>je(le._id),className:"rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec]"}),i.jsxs("span",{className:`text-sm ${a==="dark"?"text-white":"text-gray-900"}`,children:[le.full_name," (",le.role,")",le._id===(e==null?void 0:e.id)&&i.jsx("span",{className:"text-[#136dec] font-medium",children:" (You)"})]})]},le._id))})]})]})]}),i.jsxs("div",{className:`flex justify-end space-x-4 pt-4 mt-6 border-t ${a==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx("button",{type:"button",onClick:()=>{g(!1),D(null)},className:`px-6 py-2 ${a==="dark"?"bg-[#282f39] hover:bg-[#3a4454] text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"} rounded transition-colors`,children:"Cancel"}),i.jsx("button",{type:"submit",onClick:ge,className:"px-6 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"Update Task"})]})]}),i.jsx(fg,{isOpen:b&&N,onClose:()=>y(!1),title:(N==null?void 0:N.title)||"Task Details",size:"large",children:N&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx("p",{className:`${a==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:N.description})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Status"}),we(N)?i.jsxs("select",{value:N.status,onChange:le=>X(N._id,{status:le.target.value}),className:`w-full px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"}),i.jsx("option",{value:"archived",children:"Archived"})]}):i.jsx("span",{className:`inline-block px-3 py-1 rounded text-sm ${Y(N.status)}`,children:We(N.status)})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Priority"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`size-3 rounded-full ${Q(N.priority)}`}),i.jsx("span",{className:`${a==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:ve(N.priority)})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Created by:"})," ",((vt=N.created_by)==null?void 0:vt.full_name)||"Unknown"]}),N.team_id&&i.jsxs("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Team:"})," ",N.team_id.name]})]}),i.jsx("div",{children:N.assigned_to&&N.assigned_to.length>0&&i.jsxs("div",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Assigned to:"}),i.jsx("div",{className:"mt-1",children:N.assigned_to.map(le=>i.jsx("span",{className:"inline-block bg-blue-500/10 text-blue-400 text-xs px-2 py-1 rounded mr-1 mb-1 border border-blue-500/20",children:le.full_name},le._id))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("div",{children:i.jsxs("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(N.created_at).toLocaleString()]})}),i.jsx("div",{children:N.due_date&&i.jsxs("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Due:"}),i.jsx("span",{className:`font-medium ml-1 ${new Date(N.due_date)<new Date?"text-red-400":"text-orange-400"}`,children:new Date(N.due_date).toLocaleString()})]})})]}),N.updated_at!==N.created_at&&i.jsx("div",{children:i.jsxs("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Last updated:"})," ",new Date(N.updated_at).toLocaleString()]})})]}),i.jsxs("div",{className:`border-t ${a==="dark"?"border-[#282f39]":"border-gray-200"} pt-6`,children:[i.jsxs("h3",{className:`text-lg font-semibold mb-4 flex items-center ${a==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx($T,{className:"w-5 h-5 mr-2"}),"Comments"]}),i.jsxs("div",{className:"space-y-4 mb-4 max-h-60 overflow-y-auto",children:[R.map(le=>{var Ae;return i.jsxs("div",{className:`rounded-lg p-4 border ${a==="dark"?"bg-[#111418] border-[#282f39]":"bg-gray-50 border-gray-200"}`,children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("span",{className:`font-medium text-sm ${a==="dark"?"text-white":"text-gray-900"}`,children:((Ae=le.author_id)==null?void 0:Ae.full_name)||"Unknown"}),i.jsx("span",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-500"}`,children:new Date(le.created_at).toLocaleString()})]}),i.jsx("p",{className:`text-sm ${a==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:le.content})]},le._id)}),R.length===0&&i.jsx("p",{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"} text-sm`,children:"No comments yet"})]}),i.jsxs("form",{onSubmit:Te,className:"flex space-x-2",children:[i.jsx("input",{type:"text",value:B,onChange:le=>C(le.target.value),placeholder:"Add a comment...",className:`flex-1 px-4 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`}),i.jsx("button",{type:"submit",className:"px-6 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"Post"})]})]})]})})]})},TR=()=>{var Te;const{user:e,socket:t}=pn(),{theme:r}=Lr(),{toggleMobileSidebar:n}=Mn(),a=Cs(),[s,o]=W0(),l=tl(),[c,d]=J.useState([]),[u,h]=J.useState(!1),[m,f]=J.useState(!1),[x,g]=J.useState(null),[b,y]=J.useState(null),[N,S]=J.useState({team:"",assigned_to:"",showMyTasksOnly:!1,status:"",priority:"",dueDateFrom:"",dueDateTo:"",search:""}),[_,D]=J.useState({title:"",description:"",priority:"medium",status:"todo",due_date:"",team_id:"",assigned_to:[]}),[I,O]=J.useState([]),[R,E]=J.useState([]),[B,C]=J.useState([]),[M,U]=J.useState(null),F=[{id:"todo",title:"Todo",dotColor:"bg-slate-500",count:0},{id:"in_progress",title:"In Progress",dotColor:"bg-[#136dec] animate-pulse",count:0,hasTopBorder:!0},{id:"review",title:"Review",dotColor:"bg-purple-500",count:0},{id:"done",title:"Done",dotColor:"bg-green-500",count:0}];J.useEffect(()=>{if(ne(),["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)&&(V(),ee()),s.get("create")==="true"&&(f(!0),s.delete("create"),o(s)),t)return t.on("task:created",Y=>{d(We=>[Y,...We])}),t.on("task:updated",Y=>{d(We=>We.map(Q=>Q._id===Y._id?Y:Q))}),()=>{t.off("task:created"),t.off("task:updated")}},[t]),el({onTaskCreated:()=>ne(),onTaskUpdated:()=>ne(),onTaskDeleted:()=>ne(),onStatusChanged:()=>ne()});const ne=async()=>{try{const Y=await it.get("/tasks");d(Y.data.tasks),h(!1)}catch(Y){console.error("Error fetching tasks:",Y),h(!1)}},V=async()=>{var Y;try{const We=await it.get("/users");O(We.data.users)}catch(We){((Y=We.response)==null?void 0:Y.status)!==403&&console.error("Error fetching users:",We)}},ee=async()=>{var Y;try{const We=await it.get("/teams");E(We.data.teams)}catch(We){((Y=We.response)==null?void 0:Y.status)!==403&&console.error("Error fetching teams:",We)}},me=async Y=>{var We,Q;Y.preventDefault();try{await it.post("/tasks",_),f(!1),D({title:"",description:"",priority:"medium",status:"todo",due_date:"",team_id:"",assigned_to:[]}),C([]),ne()}catch(ve){console.error("Error creating task:",ve),alert(((Q=(We=ve.response)==null?void 0:We.data)==null?void 0:Q.message)||"Failed to create task")}},ye=async(Y,We)=>{var Q,ve;d(we=>we.map(Re=>Re._id===Y?{...Re,...We}:Re));try{const Re=(await it.patch(`/tasks/${Y}`,We)).data.task;d(He=>He.map(vt=>vt._id===Y?Re:vt))}catch(we){console.error("Error updating task:",we),alert(((ve=(Q=we.response)==null?void 0:Q.data)==null?void 0:ve.message)||"Failed to update task"),ne()}},Oe=Y=>{l.show({title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone and will remove all associated data.",confirmText:"Delete Task",cancelText:"Cancel",variant:"danger",onConfirm:async()=>{var We,Q;try{await it.delete(`/tasks/${Y}`),ne()}catch(ve){console.error("Error deleting task:",ve),alert(((Q=(We=ve.response)==null?void 0:We.data)==null?void 0:Q.message)||"Failed to delete task")}}})},xe=(Y,We)=>{y(We),Y.dataTransfer.effectAllowed="move",Y.currentTarget.style.opacity="0.5"},w=Y=>{Y.currentTarget.style.opacity="1",y(null),U(null)},A=Y=>{Y.preventDefault(),Y.dataTransfer.dropEffect="move"},T=(Y,We)=>{Y.preventDefault(),U(We)},L=Y=>{Y.currentTarget===Y.target&&U(null)},H=async(Y,We)=>{if(Y.preventDefault(),Y.stopPropagation(),U(null),!b||b.status===We){y(null);return}try{await ye(b._id,{status:We}),y(null)}catch(Q){console.error("Error updating task status:",Q),y(null)}},X=Y=>{var ve;const We=R.find(we=>we._id===Y);let Q=We?We.members:[];We&&(e==null?void 0:e.role)==="team_lead"&&!Q.some(Re=>Re._id===(e==null?void 0:e.id))&&((ve=We.lead_id)==null?void 0:ve._id)===(e==null?void 0:e.id)&&(Q=[...Q,{_id:e.id,full_name:e.full_name||e.username||e.email,role:e.role,email:e.email}]),C(Q),D({..._,team_id:Y,assigned_to:[]})},re=Y=>{const We=_.assigned_to,Q=We.includes(Y);D(Q?{..._,assigned_to:We.filter(ve=>ve!==Y)}:{..._,assigned_to:[...We,Y]})},ge=Y=>{let We=c.filter(Q=>Q.status===Y);if(N.team&&(We=We.filter(Q=>Q.team_id&&(Q.team_id._id===N.team||Q.team_id===N.team))),N.assigned_to&&(We=We.filter(Q=>Q.assigned_to&&Q.assigned_to.some(ve=>(ve._id||ve)===N.assigned_to))),N.priority&&(We=We.filter(Q=>Q.priority===N.priority)),N.dueDateFrom&&(We=We.filter(Q=>Q.due_date&&new Date(Q.due_date)>=new Date(N.dueDateFrom))),N.dueDateTo&&(We=We.filter(Q=>Q.due_date&&new Date(Q.due_date)<=new Date(N.dueDateTo))),N.search){const Q=N.search.toLowerCase();We=We.filter(ve=>ve.title.toLowerCase().includes(Q)||ve.description&&ve.description.toLowerCase().includes(Q))}return N.showMyTasksOnly&&(We=We.filter(Q=>{if(!Q.assigned_to)return!1;const we=(Array.isArray(Q.assigned_to)?Q.assigned_to.map(Re=>typeof Re=="object"?Re._id:Re):[typeof Q.assigned_to=="object"?Q.assigned_to._id:Q.assigned_to]).includes(e==null?void 0:e.id);if((e==null?void 0:e.role)==="member"){const Re=e.team_id&&Q.team_id&&(Q.team_id._id===e.team_id||Q.team_id===e.team_id);return we&&Re}return we})),We},oe=Y=>{const We={low:{bg:"bg-blue-400/10",text:"text-blue-400",label:"Low"},medium:{bg:"bg-yellow-500/10",text:"text-yellow-500",label:"Med"},high:{bg:"bg-red-400/10",text:"text-red-400",label:"High"},urgent:{bg:"bg-red-600/10",text:"text-red-600",label:"Urgent"}};return We[Y]||We.medium},je=Y=>{if(!Y)return"U";const We=Y.split(" ");return We.length>=2?(We[0][0]+We[1][0]).toUpperCase():Y.substring(0,2).toUpperCase()},Ie=Y=>["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)?!0:Y.created_by._id===(e==null?void 0:e.id)||Y.assigned_to&&Y.assigned_to.some(We=>We._id===(e==null?void 0:e.id)),et=Y=>["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role);return u?i.jsx("div",{className:`${r==="dark"?"bg-[#111418]":"bg-gray-50"} ${r==="dark"?"text-white":"text-gray-900"} font-['Inter'] h-screen flex items-center justify-center`,children:i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"flex gap-3",children:[0,1,2,3].map(Y=>i.jsx("div",{className:"w-4 h-12 bg-[#136dec] rounded-full animate-pulse",style:{animationDelay:`${Y*.15}s`}},Y))}),i.jsx("p",{className:`${r==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Loading Kanban board..."})]})}):i.jsxs("div",{className:`flex h-screen w-full ${r==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsxs("header",{className:`border-b ${r==="dark"?"border-[#282f39]":"border-gray-200"} ${r==="dark"?"bg-[#111418]":"bg-gray-50"} shrink-0`,children:[i.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-6 py-3 sm:py-4",children:[i.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 flex-1 min-w-0",children:[i.jsx("button",{onClick:n,className:`lg:hidden ${r==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors flex-shrink-0`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("h2",{className:`${r==="dark"?"text-white":"text-gray-900"} text-base sm:text-xl font-bold leading-tight truncate`,children:"Kanban Board"}),i.jsx("p",{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs mt-0.5 sm:mt-1 hidden sm:block`,children:"Visual task workflow with drag & drop"})]})]}),i.jsxs("div",{className:"flex gap-2 sm:gap-3 flex-shrink-0",children:[i.jsx("button",{onClick:()=>a("/settings"),className:`hidden sm:flex items-center justify-center rounded h-9 px-3 ${r==="dark"?"bg-[#282f39]":"bg-white"} ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ${r==="dark"?"hover:text-white":"hover:text-gray-900"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} ${r==="dark"?"hover:border-[#5a6472]":"hover:border-gray-300"} transition-colors`,children:i.jsx(J0,{size:20})}),i.jsx("button",{onClick:()=>a("/teams"),className:`hidden lg:flex items-center justify-center rounded h-9 px-3 ${r==="dark"?"bg-[#282f39]":"bg-white"} ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ${r==="dark"?"hover:text-white":"hover:text-gray-900"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} ${r==="dark"?"hover:border-[#5a6472]":"hover:border-gray-300"} transition-colors`,children:i.jsx(zg,{size:20})}),i.jsxs("button",{onClick:()=>f(!0),className:"flex items-center justify-center rounded h-9 px-3 sm:px-4 bg-[#136dec] text-white gap-2 text-sm font-bold hover:bg-blue-600 transition-colors shadow-sm shadow-blue-900/20",children:[i.jsx(Si,{size:20}),i.jsx("span",{className:"hidden sm:inline",children:"Create Task"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 px-3 sm:px-6 pb-3 sm:pb-4 overflow-x-auto scrollbar-thin",children:[i.jsxs("div",{className:`relative flex items-center h-9 w-full sm:w-64 ${r==="dark"?"bg-[#282f39]":"bg-white"} rounded border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} focus-within:border-[#136dec]/50 transition-colors flex-shrink-0`,children:[i.jsx(oo,{className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ml-3 flex-shrink-0`,size:18}),i.jsx("input",{value:N.search,onChange:Y=>S({...N,search:Y.target.value}),className:`w-full bg-transparent border-none text-sm ${r==="dark"?"text-white":"text-gray-900"} placeholder-[#6b7280] focus:ring-0 px-2 h-full`,placeholder:"Search tasks..."})]}),i.jsx("div",{className:"hidden sm:block w-px h-6 bg-[#3e454f] mx-2"}),i.jsxs("div",{className:"flex gap-2 flex-nowrap",children:[N.showMyTasksOnly&&i.jsxs("button",{onClick:()=>S({...N,showMyTasksOnly:!1}),className:"flex h-7 items-center gap-1.5 sm:gap-2 rounded-full bg-[#136dec]/20 border border-[#136dec]/30 px-2.5 sm:px-3 text-[#136dec] hover:bg-[#136dec]/30 transition-colors whitespace-nowrap flex-shrink-0",children:[i.jsx("span",{className:"text-xs font-medium",children:"My Tasks"}),i.jsx(kr,{size:14})]}),!N.showMyTasksOnly&&i.jsx("button",{onClick:()=>S({...N,showMyTasksOnly:!0}),className:`flex h-7 items-center gap-1.5 sm:gap-2 rounded-full ${r==="dark"?"bg-[#282f39]":"bg-white"} border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} px-2.5 sm:px-3 ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ${r==="dark"?"hover:text-white":"hover:text-gray-900"} ${r==="dark"?"hover:border-[#5a6472]":"hover:border-gray-300"} transition-colors whitespace-nowrap flex-shrink-0`,children:i.jsx("span",{className:"text-xs font-medium",children:"My Tasks"})}),N.priority&&i.jsxs("button",{onClick:()=>S({...N,priority:""}),className:"flex h-7 items-center gap-1.5 sm:gap-2 rounded-full bg-orange-500/20 border border-orange-500/30 px-2.5 sm:px-3 text-orange-400 hover:bg-orange-500/30 transition-colors whitespace-nowrap flex-shrink-0",children:[i.jsx("span",{className:"text-xs font-medium",children:N.priority.charAt(0).toUpperCase()+N.priority.slice(1)}),i.jsx(kr,{size:14})]})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-x-auto overflow-y-hidden p-3 sm:p-6",children:[i.jsx("div",{className:"lg:hidden mb-2 flex items-center gap-2 text-xs text-[#9da8b9]",children:i.jsx("span",{children:"â† Swipe to see more columns â†’"})}),i.jsx("div",{className:"flex h-full gap-3 sm:gap-4 pb-4",style:{minWidth:"max-content"},children:F.map(Y=>{const We=ge(Y.id),Q=M===Y.id;return i.jsxs("div",{className:`flex flex-col w-[280px] sm:w-[320px] lg:w-1/4 lg:min-w-[280px] ${r==="dark"?"bg-[#1c2128]":"bg-white"} rounded-xl h-full border transition-all duration-200 ${Q?"border-[#136dec] bg-[#136dec]/5 scale-[1.02]":`${r==="dark"?"border-[#3e454f]/50":"border-gray-200"}`}`,onDragOver:A,onDragEnter:ve=>T(ve,Y.id),onDragLeave:L,onDrop:ve=>H(ve,Y.id),children:[i.jsxs("div",{className:`flex items-center justify-between p-3 sm:p-4 border-b ${r==="dark"?"border-[#3e454f]/50":"border-gray-200"} relative overflow-hidden ${Y.hasTopBorder?"border-t-2 border-t-[#136dec]":""}`,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${Y.dotColor} flex-shrink-0`}),i.jsx("h3",{className:`text-sm font-semibold ${r==="dark"?"text-white":"text-gray-900"} truncate`,children:Y.title}),i.jsx("span",{className:`${r==="dark"?"bg-[#282f39]":"bg-gray-100"} ${r==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs px-2 py-0.5 rounded-full border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} font-medium flex-shrink-0`,children:We.length})]}),i.jsx(O4,{className:"text-[#6b7280] hover:text-white cursor-pointer flex-shrink-0",size:18})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-2 sm:p-3 flex flex-col gap-2 sm:gap-3 scrollbar-thin scrollbar-thumb-[#3e454f] scrollbar-track-transparent",children:We.map(ve=>{const we=oe(ve.priority),Re=ve.status==="done";return i.jsxs("div",{draggable:Ie(ve),onDragStart:He=>xe(He,ve),onDragEnd:w,className:`group ${r==="dark"?"bg-gradient-to-br from-[#282f39] to-[#242a35]":"bg-gradient-to-br from-gray-50 to-white"} p-3 sm:p-4 rounded-lg border ${r==="dark"?"border-[#3e454f]":"border-gray-200"} hover:border-[#136dec]/50 cursor-grab active:cursor-grabbing shadow-sm hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5 ${Re?"opacity-70 hover:opacity-100":""}`,onClick:()=>g(ve),children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("span",{className:`text-[11px] font-mono text-[#6b7280] ${Re?"line-through":""}`,children:ve._id.substring(0,8).toUpperCase()}),i.jsx("span",{className:`text-[10px] font-bold ${we.text} ${we.bg} px-1.5 py-0.5 rounded uppercase tracking-wider`,children:we.label})]}),i.jsx("p",{className:`text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-3 leading-snug group-hover:text-[#136dec] transition-colors ${Re?"line-through decoration-slate-600":""}`,children:ve.title}),i.jsxs("div",{className:`flex items-center justify-between border-t ${r==="dark"?"border-[#3e454f]/50":"border-gray-200"} pt-2 mt-auto`,children:[i.jsxs("div",{className:"flex -space-x-2",children:[ve.assigned_to&&ve.assigned_to.length>0?ve.assigned_to.slice(0,2).map((He,vt)=>i.jsx("div",{className:`size-5 rounded-full bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center text-[8px] text-white font-bold ring-2 ring-[#282f39] ${Re?"grayscale":""}`,title:He.full_name,children:je(He.full_name)},He._id||vt)):i.jsx("div",{className:"size-5 rounded-full bg-[#3e454f] flex items-center justify-center text-[8px] text-[#6b7280] font-bold",children:"?"}),ve.assigned_to&&ve.assigned_to.length>2&&i.jsxs("div",{className:"size-5 rounded-full bg-[#3e454f] flex items-center justify-center text-[8px] text-white font-bold ring-2 ring-[#282f39]",children:["+",ve.assigned_to.length-2]})]}),i.jsxs("div",{className:`flex items-center gap-1 ${Re?"text-green-500":ve.due_date&&new Date(ve.due_date)<new Date?"text-red-400":ve.due_date&&new Date(ve.due_date)<new Date(Date.now()+864e5)?"text-[#136dec]":"text-[#6b7280]"}`,children:[i.jsx(Gn,{size:14}),i.jsx("span",{className:"text-[11px]",children:ve.due_date?new Date(ve.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"No date"})]})]})]},ve._id)})}),i.jsxs("button",{onClick:()=>{D({..._,status:Y.id}),f(!0)},className:`p-2 mx-2 mb-2 flex items-center gap-2 text-[#6b7280] ${r==="dark"?"hover:text-white":"hover:text-gray-900"} ${r==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"} rounded transition-colors text-sm font-medium`,children:[i.jsx(Si,{size:18}),i.jsx("span",{children:"Add Task"})]})]},Y.id)})})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border ${r==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${r==="dark"?"text-white":"text-gray-900"}`,children:"Create New Task"}),i.jsx("button",{onClick:()=>f(!1),className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ${r==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:24})})]}),i.jsxs("form",{onSubmit:me,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Title *"}),i.jsx("input",{type:"text",value:_.title,onChange:Y=>D({..._,title:Y.target.value}),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Description"}),i.jsx("textarea",{value:_.description,onChange:Y=>D({..._,description:Y.target.value}),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,rows:"4"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Priority"}),i.jsxs("select",{value:_.priority,onChange:Y=>D({..._,priority:Y.target.value}),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Status"}),i.jsxs("select",{value:_.status,onChange:Y=>D({..._,status:Y.target.value}),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Due Date *"}),i.jsx("input",{type:"date",value:_.due_date,onChange:Y=>D({..._,due_date:Y.target.value}),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Select Team"}),i.jsxs("select",{value:_.team_id,onChange:Y=>X(Y.target.value),className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"No Team"}),R.map(Y=>i.jsx("option",{value:Y._id,children:Y.name},Y._id))]})]}),_.team_id&&B.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Assign Team Members"}),i.jsx("div",{className:`space-y-2 max-h-40 overflow-y-auto border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded-lg p-3 ${r==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:B.map(Y=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:_.assigned_to.includes(Y._id),onChange:()=>re(Y._id),className:"rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec]"}),i.jsxs("span",{className:`text-sm ${r==="dark"?"text-white":"text-gray-900"}`,children:[Y.full_name," (",Y.role,")",Y._id===(e==null?void 0:e.id)&&i.jsx("span",{className:"text-[#136dec] font-medium",children:" (You)"})]})]},Y._id))})]})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{f(!1),C([])},className:`px-6 py-2 ${r==="dark"?"bg-[#282f39]":"bg-gray-200"} ${r==="dark"?"text-white":"text-gray-900"} rounded ${r==="dark"?"hover:bg-[#3a4454]":"hover:bg-gray-300"} transition-colors`,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-6 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"Create Task"})]})]})]})}),x&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${r==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg p-8 max-w-3xl w-full max-h-[90vh] overflow-y-auto border ${r==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${r==="dark"?"text-white":"text-gray-900"}`,children:x.title}),i.jsx("button",{onClick:()=>g(null),className:`${r==="dark"?"text-[#9da8b9]":"text-gray-600"} ${r==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:24})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx("p",{className:`${r==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:x.description||"No description"})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Status"}),i.jsxs("select",{value:x.status,onChange:Y=>{ye(x._id,{status:Y.target.value}),g({...x,status:Y.target.value})},className:`w-full px-4 py-2 ${r==="dark"?"bg-[#111418]":"bg-gray-50"} border ${r==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${r==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Priority"}),i.jsx("div",{className:"flex items-center gap-2",children:(()=>{const Y=oe(x.priority);return i.jsx("span",{className:`inline-block px-3 py-1 rounded text-sm ${Y.bg} ${Y.text} font-medium`,children:Y.label})})()})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:`text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Created by:"})," ",((Te=x.created_by)==null?void 0:Te.full_name)||"Unknown"]}),x.team_id&&i.jsxs("p",{className:`text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Team:"})," ",x.team_id.name]})]}),i.jsx("div",{children:x.assigned_to&&x.assigned_to.length>0&&i.jsxs("div",{className:`text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Assigned to:"}),i.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:x.assigned_to.map(Y=>i.jsx("span",{className:"inline-block bg-blue-500/10 text-blue-400 text-xs px-2 py-1 rounded border border-blue-500/20",children:Y.full_name},Y._id))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("div",{children:i.jsxs("p",{className:`text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(x.created_at).toLocaleString()]})}),i.jsx("div",{children:x.due_date&&i.jsxs("p",{className:`text-sm ${r==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:"font-medium",children:"Due:"}),i.jsx("span",{className:`font-medium ml-1 ${new Date(x.due_date)<new Date?"text-red-400":"text-orange-400"}`,children:new Date(x.due_date).toLocaleString()})]})})]})]}),et()&&i.jsx("div",{className:`pt-4 border-t ${r==="dark"?"border-[#282f39]":"border-gray-200"}`,children:i.jsx("button",{onClick:()=>{Oe(x._id),g(null)},className:"px-4 py-2 bg-red-500/10 text-red-400 rounded hover:bg-red-500/20 transition-colors border border-red-500/20",children:"Delete Task"})})]})]})}),i.jsx(rl,{isOpen:l.isOpen,onClose:l.onClose,onConfirm:l.onConfirm,title:l.title,message:l.message,confirmText:l.confirmText,cancelText:l.cancelText,variant:l.variant,isLoading:l.isLoading})]})},AR=()=>{const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),n=tl(),[a,s]=J.useState([]),[o,l]=J.useState([]),[c,d]=J.useState(!0),[u,h]=J.useState(!1),[m,f]=J.useState(!1),[x,g]=J.useState(null),[b,y]=J.useState({name:"",hr_id:"",lead_id:""}),[N,S]=J.useState(""),[_,D]=J.useState([]),[I,O]=J.useState(!1),[R,E]=J.useState(null),[B,C]=J.useState(""),[M,U]=J.useState("all");J.useEffect(()=>{e!=null&&e.id&&(F(),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&ne())},[e==null?void 0:e.id,e==null?void 0:e.role]),el({onTeamCreated:()=>{e!=null&&e.id&&F()},onTeamUpdated:()=>{e!=null&&e.id&&F()},onTeamDeleted:()=>{e!=null&&e.id&&F()},onUserUpdated:()=>{["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&ne()}});const F=async()=>{try{let re=(await it.get("/teams")).data.teams;(e==null?void 0:e.role)==="team_lead"&&(re=re.filter(ge=>{var oe;return((oe=ge.lead_id)==null?void 0:oe._id)===(e==null?void 0:e.id)||ge.lead_id===(e==null?void 0:e.id)})),s(re),d(!1)}catch(X){console.error("Error fetching teams:",X),d(!1)}},ne=async()=>{try{const X=await it.get("/users");l(X.data.users)}catch(X){console.error("Error fetching users:",X)}},V=async X=>{var re,ge;X.preventDefault();try{await it.post("/teams",b),h(!1),y({name:"",hr_id:"",lead_id:""}),F()}catch(oe){console.error("Error creating team:",oe),alert(((ge=(re=oe.response)==null?void 0:re.data)==null?void 0:ge.message)||"Failed to create team")}},ee=async X=>{var re,ge;X.preventDefault();try{if(I&&_.length>0){const oe=await it.post(`/teams/${x._id}/members/bulk`,{userIds:_}),{results:je}=oe.data;let Ie=`Added ${je.added.length} member(s)`;je.skipped.length>0&&(Ie+=`, skipped ${je.skipped.length} (already members)`),je.failed.length>0&&(Ie+=`, failed ${je.failed.length}`),alert(Ie)}else N&&await it.post(`/teams/${x._id}/members`,{userId:N});f(!1),S(""),D([]),O(!1),F()}catch(oe){console.error("Error adding member:",oe),alert(((ge=(re=oe.response)==null?void 0:re.data)==null?void 0:ge.message)||"Failed to add member")}},me=X=>{D(re=>re.includes(X)?re.filter(ge=>ge!==X):[...re,X])},ye=()=>{const X=o.filter(re=>{var ge;return!((ge=x==null?void 0:x.members)!=null&&ge.some(oe=>oe._id===re._id))});_.length===X.length?D([]):D(X.map(re=>re._id))},Oe=(X,re)=>{n.show({title:"Remove Member",message:"Are you sure you want to remove this member from the team? They will no longer have access to team resources.",confirmText:"Remove",cancelText:"Cancel",variant:"warning",onConfirm:async()=>{var ge,oe;try{await it.delete(`/teams/${X}/members/${re}`),F()}catch(je){console.error("Error removing member:",je),alert(((oe=(ge=je.response)==null?void 0:ge.data)==null?void 0:oe.message)||"Failed to remove member")}}})},xe=async(X,re)=>{var oe,je;if(await n.show({title:"Delete Team",message:`Are you sure you want to delete team "${re}"? All members will be unassigned from this team and this action cannot be undone.`,confirmText:"Delete Team",cancelText:"Cancel",variant:"danger"}))try{await it.delete(`/teams/${X}`),F(),alert("Team deleted successfully")}catch(Ie){console.error("Error deleting team:",Ie),alert(((je=(oe=Ie.response)==null?void 0:oe.data)==null?void 0:je.message)||"Failed to delete team")}},w=async()=>{var re,ge;if(a.length===0){alert("No teams to delete");return}if(await n.show({title:"Delete All Teams",message:`âš ï¸ DANGER: You are about to delete ALL ${a.length} team(s). All members will be unassigned. This action CANNOT be undone. Are you absolutely sure?`,confirmText:`Delete ${a.length} Team(s)`,cancelText:"Cancel",variant:"danger"}))try{d(!0),await it.delete("/teams/bulk/all"),F(),alert("Successfully deleted all teams")}catch(oe){console.error("Error deleting all teams:",oe),alert(((ge=(re=oe.response)==null?void 0:re.data)==null?void 0:ge.message)||"Failed to delete teams"),d(!1)}},A=async X=>{var re,ge;try{await it.patch(`/teams/${X}/pin`),F()}catch(oe){console.error("Error toggling pin:",oe),alert(((ge=(re=oe.response)==null?void 0:re.data)==null?void 0:ge.message)||"Failed to toggle pin")}},T=(X,re)=>{E(re),X.dataTransfer.effectAllowed="move"},L=X=>{X.preventDefault(),X.dataTransfer.dropEffect="move"},H=async(X,re)=>{if(X.preventDefault(),!R||R._id===re._id){E(null);return}const ge=[...a],oe=ge.findIndex(Ie=>Ie._id===R._id),je=ge.findIndex(Ie=>Ie._id===re._id);ge.splice(oe,1),ge.splice(je,0,R),s(ge);try{const Ie=ge.map((et,Te)=>({id:et._id,priority:ge.length-Te}));await it.post("/teams/reorder",{teamOrder:Ie})}catch(Ie){console.error("Error reordering teams:",Ie),F()}E(null)};return c?i.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"flex",children:[i.jsx(Cn,{}),i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"loading-bar-container",children:i.jsx("div",{className:"loading-bar bg-[#136dec]"})}),i.jsx("p",{className:`${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Loading teams..."})]})})]})}):["admin","hr","team_lead","community_admin"].includes(e==null?void 0:e.role)?i.jsxs("div",{className:`min-h-screen ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,"data-testid":"teams-page",children:[i.jsxs("div",{className:"flex",children:[i.jsx(Cn,{}),i.jsxs("div",{className:"flex-1 p-4 sm:p-6 lg:p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:r,className:`lg:hidden ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:(e==null?void 0:e.role)==="team_lead"?"My Team":"Teams"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-2`,children:(e==null?void 0:e.role)==="team_lead"?"Manage your team and members":"Manage your teams and members"})]})]}),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-[0.125rem] hover:bg-red-700 transition-colors flex items-center space-x-2",title:"Delete all teams",children:[i.jsx(ua,{className:"w-5 h-5"}),i.jsx("span",{children:"Delete All"})]}),i.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-[#136dec] text-white rounded-[0.125rem] hover:bg-[#1158c7] transition-colors flex items-center space-x-2","data-testid":"create-team-btn",children:[i.jsx(Si,{className:"w-5 h-5"}),i.jsx("span",{children:"Create Team"})]})]})]}),a.length===0?i.jsxs("div",{className:`rounded-[0.125rem] shadow-md p-12 text-center border ${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}`,children:[i.jsx(ks,{className:`w-16 h-16 mx-auto mb-4 ${t==="dark"?"text-[#9da8b9]":"text-gray-400"}`}),i.jsx("h3",{className:`text-xl font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:(e==null?void 0:e.role)==="team_lead"?"No Team Assigned":"No Teams Yet"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:(e==null?void 0:e.role)==="team_lead"?"You are not currently assigned as a team lead. Please contact an administrator.":"Get started by creating your first team."})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(X=>{var re,ge,oe;return i.jsxs("div",{draggable:["admin","hr","community_admin"].includes(e==null?void 0:e.role),onDragStart:je=>T(je,X),onDragOver:L,onDrop:je=>H(je,X),className:`rounded-[0.125rem] shadow-md p-6 relative border transition-colors ${t==="dark"?"bg-[#1c2027] border-[#282f39] hover:border-[#3e454f]":"bg-white border-gray-200 hover:border-gray-300"} ${(R==null?void 0:R._id)===X._id?"opacity-50":""} ${["admin","hr","community_admin"].includes(e==null?void 0:e.role)?"cursor-move":""}`,"data-testid":"team-card",children:[X.pinned&&i.jsx("div",{className:"absolute top-2 left-2",children:i.jsx(Iv,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"})}),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&i.jsx("div",{className:"absolute top-2 right-2",children:i.jsx(PT,{className:`w-5 h-5 ${t==="dark"?"text-[#9da8b9]":"text-gray-400"}`})}),i.jsxs("div",{className:"flex items-center justify-between mb-4 mt-4",children:[i.jsx("h3",{className:`text-xl font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:X.name}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ks,{className:"w-6 h-6 text-[#136dec]"}),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>A(X._id),className:`hover:text-yellow-600 p-1 transition-colors ${X.pinned?"text-yellow-500":t==="dark"?"text-[#9da8b9]":"text-gray-400"}`,title:X.pinned?"Unpin Team":"Pin Team","data-testid":"pin-team-btn",children:i.jsx(Iv,{className:`w-5 h-5 ${X.pinned?"fill-yellow-500":""}`})}),i.jsx("button",{onClick:()=>xe(X._id,X.name),className:"text-red-600 hover:text-red-800 p-1",title:"Delete Team","data-testid":"delete-team-btn",children:i.jsx(ua,{className:"w-5 h-5"})})]})]})]}),i.jsxs("div",{className:"space-y-2 mb-4",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"HR:"}),i.jsx("span",{className:`ml-2 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:(re=X.hr_id)==null?void 0:re.full_name})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Team Lead:"}),i.jsx("span",{className:`ml-2 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:(ge=X.lead_id)==null?void 0:ge.full_name})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Members:"}),i.jsx("span",{className:`ml-2 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:((oe=X.members)==null?void 0:oe.length)||0})]})]}),i.jsxs("div",{className:`border-t pt-4 ${t==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Team Members"}),i.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:X.members&&X.members.length>0?X.members.map(je=>i.jsxs("div",{className:`flex justify-between items-center rounded-[0.125rem] p-2 border ${t==="dark"?"bg-[#111418] border-[#282f39]":"bg-white border-gray-200"}`,"data-testid":"team-member",children:[i.jsx("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:je.full_name}),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&i.jsx("button",{onClick:()=>Oe(X._id,je._id),className:"text-red-600 hover:text-red-800","data-testid":"remove-member-btn",children:i.jsx(WT,{className:"w-4 h-4"})})]},je._id)):i.jsx("p",{className:"text-sm text-[#9da8b9]",children:"No members yet"})})]}),["admin","hr","community_admin"].includes(e==null?void 0:e.role)&&i.jsxs("button",{onClick:()=>{g(X),f(!0)},className:"w-full mt-4 px-4 py-2 bg-green-600 text-white rounded-[0.125rem] hover:bg-green-700 transition-colors flex items-center justify-center space-x-2","data-testid":"add-member-btn",children:[i.jsx(zg,{className:"w-4 h-4"}),i.jsx("span",{children:"Add Member"})]})]},X._id)})})]})]}),u&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50","data-testid":"create-team-modal",children:i.jsxs("div",{className:"bg-[#1c2027] rounded-[0.125rem] p-8 max-w-md w-full mx-4 border border-[#282f39]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Create New Team"}),i.jsx("button",{onClick:()=>h(!1),className:"text-[#9da8b9] hover:text-white transition-colors",children:i.jsx(kr,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:V,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Team Name *"}),i.jsx("input",{type:"text",value:b.name,onChange:X=>y({...b,name:X.target.value}),className:"input",required:!0,"data-testid":"team-name-input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"HR *"}),i.jsxs("select",{value:b.hr_id,onChange:X=>y({...b,hr_id:X.target.value}),className:"input",required:!0,"data-testid":"team-hr-select",children:[i.jsx("option",{value:"",children:"Select HR"}),o.filter(X=>X.role==="hr"||X.role==="admin").map(X=>i.jsx("option",{value:X._id,children:X.full_name},X._id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Team Lead *"}),i.jsxs("select",{value:b.lead_id,onChange:X=>y({...b,lead_id:X.target.value}),className:"input",required:!0,"data-testid":"team-lead-select",children:[i.jsx("option",{value:"",children:"Select Team Lead"}),o.filter(X=>X.role==="team_lead"||X.role==="admin").map(X=>i.jsx("option",{value:X._id,children:X.full_name},X._id))]})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>h(!1),className:"btn btn-secondary",children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"submit-create-team",children:"Create Team"})]})]})]})}),m&&x&&(()=>{var ge;const X=o.filter(oe=>{var je;return!((je=x.members)!=null&&je.some(Ie=>Ie._id===oe._id))}),re=X.filter(oe=>{const je=B===""||oe.full_name.toLowerCase().includes(B.toLowerCase())||oe.email.toLowerCase().includes(B.toLowerCase()),Ie=M==="all"||oe.role===M;return je&&Ie});return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50","data-testid":"add-member-modal",children:i.jsxs("div",{className:"bg-[#1c2027] rounded-[0.125rem] p-8 max-w-3xl w-full mx-4 border border-[#282f39] max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Add Members to ",x.name]}),i.jsxs("p",{className:"text-sm text-[#9da8b9] mt-1",children:[X.length," user(s) available â€¢ ",((ge=x.members)==null?void 0:ge.length)||0," current member(s)"]})]}),i.jsx("button",{onClick:()=>{f(!1),O(!1),D([]),S(""),C(""),U("all")},className:"text-[#9da8b9] hover:text-white transition-colors",children:i.jsx(kr,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:ee,className:"space-y-5",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(oo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[#9da8b9]"}),i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:B,onChange:oe=>C(oe.target.value),className:"w-full pl-10 pr-4 py-3 bg-[#111418] border border-[#282f39] rounded-[0.125rem] text-white placeholder-[#9da8b9] focus:border-[#136dec] focus:outline-none transition-colors"})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zl,{className:"w-4 h-4 text-[#9da8b9]"}),i.jsx("span",{className:"text-sm text-[#9da8b9]",children:"Filter by role:"})]}),["all","admin","hr","team_lead","member"].map(oe=>i.jsx("button",{type:"button",onClick:()=>U(oe),className:`px-3 py-1.5 rounded-[0.125rem] text-xs font-medium transition-colors ${M===oe?"bg-[#136dec] text-white":"bg-[#282f39] text-[#9da8b9] hover:bg-[#3e454f] hover:text-white"}`,children:oe==="all"?"All Roles":oe.replace("_"," ").toUpperCase()},oe))]})]}),i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-[#136dec]/10 to-transparent rounded-[0.125rem] border border-[#136dec]/20",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-semibold text-white block",children:I?"âœ“ Multi-Select Mode Active":"Single Select Mode"}),i.jsx("span",{className:"text-xs text-[#9da8b9]",children:I?`${_.length} user(s) selected`:"Select one user at a time"})]}),i.jsx("button",{type:"button",onClick:()=>{O(!I),S(""),D([])},className:`px-5 py-2.5 rounded-[0.125rem] text-sm font-medium transition-all ${I?"bg-green-600 text-white hover:bg-green-700 shadow-lg shadow-green-600/25":"bg-[#136dec] text-white hover:bg-[#1158c7] shadow-lg shadow-[#136dec]/25"}`,children:I?"â† Single Select":"Multi-Select â†’"})]}),I?i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-3 px-1",children:[i.jsxs("label",{className:"text-sm font-medium text-white",children:[re.length," user(s) â€¢ ",_.length," selected"]}),i.jsx("button",{type:"button",onClick:ye,className:"text-sm font-medium text-[#136dec] hover:text-[#1158c7] transition-colors",children:_.length===re.length&&re.length>0?"âœ— Deselect All":"âœ“ Select All"})]}),i.jsx("div",{className:"border border-[#282f39] rounded-[0.125rem] max-h-96 overflow-y-auto bg-[#111418]",children:re.length>0?re.map(oe=>i.jsxs("label",{className:"flex items-center p-4 hover:bg-[#1c2027] cursor-pointer border-b border-[#282f39] last:border-b-0 transition-colors group",children:[i.jsx("input",{type:"checkbox",checked:_.includes(oe._id),onChange:()=>me(oe._id),className:"w-5 h-5 text-[#136dec] rounded focus:ring-[#136dec] mr-4 cursor-pointer"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-white group-hover:text-[#136dec] transition-colors",children:oe.full_name}),i.jsx("div",{className:"text-sm text-[#9da8b9] truncate",children:oe.email})]}),i.jsx("div",{className:"ml-3",children:i.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#282f39] text-[#9da8b9] capitalize",children:oe.role.replace("_"," ")})})]},oe._id)):i.jsxs("div",{className:"p-8 text-center",children:[i.jsx(ks,{className:"w-12 h-12 mx-auto mb-3 text-[#9da8b9]"}),i.jsx("p",{className:"text-[#9da8b9] font-medium",children:"No users found"}),i.jsx("p",{className:"text-sm text-[#9da8b9] mt-1",children:"Try adjusting your search or filters"})]})})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-white mb-3",children:"Select User *"}),re.length>0?i.jsx("div",{className:"border border-[#282f39] rounded-[0.125rem] max-h-96 overflow-y-auto bg-[#111418]",children:re.map(oe=>i.jsxs("label",{className:"flex items-center p-4 hover:bg-[#1c2027] cursor-pointer border-b border-[#282f39] last:border-b-0 transition-colors group",children:[i.jsx("input",{type:"radio",name:"selectedUser",value:oe._id,checked:N===oe._id,onChange:je=>S(je.target.value),className:"w-5 h-5 text-[#136dec] focus:ring-[#136dec] mr-4 cursor-pointer"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-white group-hover:text-[#136dec] transition-colors",children:oe.full_name}),i.jsx("div",{className:"text-sm text-[#9da8b9] truncate",children:oe.email})]}),i.jsx("div",{className:"ml-3",children:i.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#282f39] text-[#9da8b9] capitalize",children:oe.role.replace("_"," ")})})]},oe._id))}):i.jsxs("div",{className:"border border-[#282f39] rounded-[0.125rem] p-8 text-center bg-[#111418]",children:[i.jsx(ks,{className:"w-12 h-12 mx-auto mb-3 text-[#9da8b9]"}),i.jsx("p",{className:"text-[#9da8b9] font-medium",children:"No users found"}),i.jsx("p",{className:"text-sm text-[#9da8b9] mt-1",children:"Try adjusting your search or filters"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-[#282f39] mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{f(!1),O(!1),D([]),S(""),C(""),U("all")},className:"px-5 py-2.5 bg-[#282f39] text-white rounded-[0.125rem] hover:bg-[#3e454f] transition-colors font-medium",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"px-5 py-2.5 bg-[#136dec] text-white rounded-[0.125rem] hover:bg-[#1158c7] transition-colors font-medium shadow-lg shadow-[#136dec]/25 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2","data-testid":"submit-add-member",disabled:I?_.length===0:!N,children:[i.jsx(zg,{className:"w-4 h-4"}),I?`Add ${_.length} Member${_.length!==1?"s":""}`:"Add Member"]})]})]})]})})})(),i.jsx(rl,{isOpen:n.isOpen,onClose:n.onClose,onConfirm:n.onConfirm,title:n.title,message:n.message,confirmText:n.confirmText,cancelText:n.cancelText,variant:n.variant,isLoading:n.isLoading})]}):i.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"flex",children:[i.jsx(Cn,{}),i.jsx("div",{className:"flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsx("div",{className:"text-center",children:i.jsx("p",{className:`text-xl ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"You don't have permission to access this page."})})})]})})};function ER(){const{user:e}=pn(),{theme:t,currentTheme:r}=Lr(),{toggleMobileSidebar:n}=Mn(),a=tl(),[s,o]=J.useState([]),[l,c]=J.useState([]),[d,u]=J.useState(!0),[h,m]=J.useState(""),[f,x]=J.useState(""),[g,b]=J.useState(!1),[y,N]=J.useState(!1),[S,_]=J.useState(!1),[D,I]=J.useState({userId:"",userEmail:"",newPassword:""}),[O,R]=J.useState(null),[E,B]=J.useState(!1),[C,M]=J.useState(null),[U,F]=J.useState("create"),[ne,V]=J.useState(null),[ee,me]=J.useState([]),[ye,Oe]=J.useState(""),[xe,w]=J.useState("all"),[A,T]=J.useState("all"),[L,H]=J.useState({full_name:"",email:"",password:"",role:"member",team_id:""}),X=e&&(e.role==="admin"||e.role==="hr");J.useEffect(()=>{X&&(re(),ge())},[X]),el({onUserCreated:()=>{X&&re()},onUserUpdated:()=>{X&&re()},onUserDeleted:()=>{X&&re()}});const re=async()=>{var _e,Ze;try{u(!0);const Ve=await it.get("/users");o(Ve.data.users),m("")}catch(Ve){m(((Ze=(_e=Ve.response)==null?void 0:_e.data)==null?void 0:Ze.message)||"Failed to fetch users")}finally{u(!1)}},ge=async()=>{try{const _e=await it.get("/teams");c(_e.data.teams||[])}catch(_e){console.error("Failed to fetch teams:",_e)}},oe=J.useMemo(()=>{let _e=[...s];if(ye.trim()){const Ze=ye.toLowerCase();_e=_e.filter(Ve=>{var ot;return Ve.full_name.toLowerCase().includes(Ze)||Ve.email.toLowerCase().includes(Ze)||((ot=Ve.team_id)==null?void 0:ot.name)&&Ve.team_id.name.toLowerCase().includes(Ze)})}return xe!=="all"&&(_e=_e.filter(Ze=>Ze.role===xe)),A!=="all"&&(A==="no_team"?_e=_e.filter(Ze=>!Ze.team_id):_e=_e.filter(Ze=>{var Ve;return((Ve=Ze.team_id)==null?void 0:Ve._id)===A})),_e},[s,ye,xe,A]),je=_e=>{const{name:Ze,value:Ve}=_e.target;H(Ze==="role"&&Ve==="admin"?ot=>({...ot,[Ze]:Ve,team_id:""}):ot=>({...ot,[Ze]:Ve}))},Ie=()=>{F("create"),H({full_name:"",email:"",password:"",role:"member",team_id:""}),b(!0),m(""),x("")},et=_e=>{var Ze;F("edit"),V(_e),H({full_name:_e.full_name,email:_e.email,password:"",role:_e.role,team_id:((Ze=_e.team_id)==null?void 0:Ze._id)||""}),b(!0),m(""),x("")},Te=async _e=>{var Ze,Ve;_e.preventDefault(),m(""),x("");try{if(U==="create")await it.post("/users",L),x("User created successfully");else{const ot={...L};delete ot.password,await it.put(`/users/${ne._id}`,ot),x("User updated successfully")}await re(),setTimeout(()=>{b(!1),x("")},1500)}catch(ot){m(((Ve=(Ze=ot.response)==null?void 0:Ze.data)==null?void 0:Ve.message)||`Failed to ${U} user`)}},Y=(_e,Ze)=>{a.show({title:"Delete User",message:`Are you sure you want to delete user: ${Ze}? This will permanently remove their account and all associated data.`,confirmText:"Delete User",cancelText:"Cancel",variant:"danger",onConfirm:async()=>{var Ve,ot;try{await it.delete(`/users/${_e}`),x("User deleted successfully"),await re(),setTimeout(()=>x(""),3e3)}catch(pt){m(((ot=(Ve=pt.response)==null?void 0:Ve.data)==null?void 0:ot.message)||"Failed to delete user"),setTimeout(()=>m(""),3e3)}}})},We=()=>{if(ee.length===0){m("Please select users to delete"),setTimeout(()=>m(""),3e3);return}a.show({title:"Delete Multiple Users",message:`Are you sure you want to delete ${ee.length} user(s)? This will permanently remove their accounts and all associated data. This action cannot be undone.`,confirmText:`Delete ${ee.length} User${ee.length!==1?"s":""}`,cancelText:"Cancel",variant:"danger",onConfirm:async()=>{var _e,Ze;try{const Ve=await it.post("/users/bulk-delete",{userIds:ee});x(Ve.data.message),me([]),await re(),setTimeout(()=>x(""),3e3)}catch(Ve){m(((Ze=(_e=Ve.response)==null?void 0:_e.data)==null?void 0:Ze.message)||"Failed to delete users"),setTimeout(()=>m(""),3e3)}}})},Q=_e=>{me(Ze=>Ze.includes(_e)?Ze.filter(Ve=>Ve!==_e):[...Ze,_e])},ve=()=>{ee.length===s.filter(_e=>_e._id!==e.id).length?me([]):me(s.filter(_e=>_e._id!==e.id).map(_e=>_e._id))},we=async(_e,Ze)=>{I({userId:_e,userEmail:Ze,newPassword:""}),_(!0)},Re=async _e=>{var ot,pt;_e.preventDefault();const{userId:Ze,newPassword:Ve}=D;if(Ve.length<6){m("Password must be at least 6 characters"),setTimeout(()=>m(""),3e3);return}try{await it.patch(`/users/${Ze}/password`,{password:Ve}),x("Password reset successfully"),setTimeout(()=>x(""),3e3),_(!1),I({userId:"",userEmail:"",newPassword:""})}catch(yt){m(((pt=(ot=yt.response)==null?void 0:ot.data)==null?void 0:pt.message)||"Failed to reset password"),setTimeout(()=>m(""),3e3)}},He=_e=>{const Ze=_e.target.files[0];if(Ze){if(!["application/json","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(Ze.type)){m("Invalid file type. Please upload JSON or Excel file."),setTimeout(()=>m(""),3e3);return}R(Ze),m("")}},vt=async()=>{var _e,Ze;if(!O){m("Please select a file to import");return}B(!0),m(""),M(null);try{const Ve=new FormData;Ve.append("file",O);const pt=O.type.includes("spreadsheet")||O.type.includes("excel")?"/users/bulk-import/excel":"/users/bulk-import/json",yt=await it.post(pt,Ve,{headers:{"Content-Type":"multipart/form-data"}});M(yt.data),x(`Successfully imported ${yt.data.successful.length} users`),await re()}catch(Ve){m(((Ze=(_e=Ve.response)==null?void 0:_e.data)==null?void 0:Ze.message)||"Failed to import users")}finally{B(!1)}},le=async _e=>{try{const Ze=_e==="json"?"/users/bulk-import/template-json":"/users/bulk-import/template",Ve=await it.get(Ze,{responseType:"blob"}),ot=window.URL.createObjectURL(new Blob([Ve.data])),pt=document.createElement("a");pt.href=ot,pt.setAttribute("download",`user_import_template.${_e==="json"?"json":"xlsx"}`),document.body.appendChild(pt),pt.click(),pt.remove(),window.URL.revokeObjectURL(ot)}catch{m("Failed to download template"),setTimeout(()=>m(""),3e3)}},Ae=_e=>{const Ze={admin:{bg:"bg-purple-500/20",text:"text-purple-400",label:"Admin"},hr:{bg:"bg-blue-500/20",text:"text-blue-400",label:"HR"},team_lead:{bg:"bg-green-500/20",text:"text-green-400",label:"Team Lead"},member:{bg:"bg-slate-500/20",text:"text-slate-300",label:"Member"}};return Ze[_e]||Ze.member},Qe=_e=>({ACTIVE:{bg:"bg-green-500/20",text:"text-green-400",label:"Active"},INACTIVE:{bg:"bg-red-500/20",text:"text-red-400",label:"Inactive"},ON_NOTICE:{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"On Notice"},EXITED:{bg:"bg-gray-500/20",text:"text-gray-400",label:"Exited"}})[_e]||{bg:"bg-green-500/20",text:"text-green-400",label:"Active"};return X?d?i.jsx("div",{className:`${t==="dark"?"bg-[#111418]":"bg-gray-50"} ${t==="dark"?"text-white":"text-gray-900"} h-screen flex items-center justify-center`,children:i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"flex gap-3",children:[0,1,2,3].map(_e=>i.jsx("div",{className:"w-4 h-12 bg-[#136dec] rounded-full animate-pulse",style:{animationDelay:`${_e*.15}s`}},_e))}),i.jsx("p",{className:`${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Loading users..."})]})}):i.jsxs("div",{className:`flex h-screen w-full ${r.background}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${r.background} overflow-hidden`,children:[i.jsxs("header",{className:`border-b ${r.border} ${r.background} shrink-0`,children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between px-3 sm:px-4 md:px-6 py-3 sm:py-4 gap-2 sm:gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[i.jsx("button",{onClick:n,className:`lg:hidden ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:20,className:"sm:w-6 sm:h-6"})}),i.jsxs("div",{children:[i.jsx("h2",{className:`${t==="dark"?"text-white":"text-gray-900"} text-base sm:text-lg md:text-xl font-bold leading-tight`,children:"User & Team Management"}),i.jsxs("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs mt-0.5 sm:mt-1`,children:[s.length," users â€¢ ",l.length," teams"]})]})]}),i.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[i.jsxs("button",{onClick:()=>N(!0),className:"flex items-center justify-center rounded h-7 sm:h-8 md:h-9 px-2 sm:px-3 md:px-4 bg-green-600 text-white gap-1 sm:gap-1.5 text-[10px] sm:text-xs md:text-sm font-bold hover:bg-green-700 transition-colors",children:[i.jsx(L4,{size:14,className:"sm:w-4 sm:h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Bulk Import"}),i.jsx("span",{className:"sm:hidden",children:"Import"})]}),i.jsxs("button",{onClick:Ie,className:"flex items-center justify-center rounded h-7 sm:h-8 md:h-9 px-2 sm:px-3 md:px-4 bg-[#136dec] text-white gap-1 sm:gap-1.5 text-[10px] sm:text-xs md:text-sm font-bold hover:bg-blue-600 transition-colors",children:[i.jsx(Si,{size:14,className:"sm:w-4 sm:h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Create User"}),i.jsx("span",{className:"sm:hidden",children:"Create"})]})]})]}),i.jsx("div",{className:"px-1 sm:px-4 md:px-6 pb-1 sm:pb-3 md:pb-4",children:i.jsxs("div",{className:"flex flex-col gap-0.5 sm:gap-2 md:gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(oo,{className:`absolute left-1 sm:left-3 top-1/2 -translate-y-1/2 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,size:11}),i.jsx("input",{value:ye,onChange:_e=>Oe(_e.target.value),className:`w-full h-5 sm:h-8 md:h-9 lg:h-10 pl-5 sm:pl-8 md:pl-10 pr-1 sm:pr-3 md:pr-4 ${r.surface} border ${r.border} rounded text-[9px] sm:text-xs md:text-sm ${r.text} placeholder-[#6b7280] focus:ring-1 focus:ring-[#136dec] focus:border-transparent`,placeholder:"Search..."})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-0.5 sm:gap-2 md:gap-3",children:[i.jsxs("select",{value:xe,onChange:_e=>w(_e.target.value),className:`h-5 sm:h-8 md:h-9 lg:h-10 px-0.5 sm:px-2 md:px-3 ${r.surface} border ${r.border} rounded text-[8px] sm:text-xs md:text-sm ${r.text} focus:ring-1 focus:ring-[#136dec] focus:border-transparent overflow-hidden`,style:{textOverflow:"ellipsis"},children:[i.jsx("option",{value:"all",children:"All"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"hr",children:"HR"}),i.jsx("option",{value:"team_lead",children:"Lead"}),i.jsx("option",{value:"member",children:"Member"})]}),i.jsxs("select",{value:A,onChange:_e=>T(_e.target.value),className:`h-5 sm:h-8 md:h-9 lg:h-10 px-0.5 sm:px-2 md:px-3 ${r.surface} border ${r.border} rounded text-[8px] sm:text-xs md:text-sm ${r.text} focus:ring-1 focus:ring-[#136dec] focus:border-transparent overflow-hidden`,style:{textOverflow:"ellipsis"},children:[i.jsx("option",{value:"all",children:"All Teams"}),i.jsx("option",{value:"no_team",children:"No Team"}),l.map(_e=>i.jsx("option",{value:_e._id,children:_e.name},_e._id))]})]})]})}),ee.length>0&&i.jsx("div",{className:"px-4 sm:px-6 pb-4",children:i.jsxs("div",{className:`${t==="dark"?"bg-[#136dec]/10 border-[#136dec]/30":"bg-blue-50 border-blue-200"} border rounded p-3 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3`,children:[i.jsxs("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:[ee.length," user(s) selected"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>me([]),className:`text-xs ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors px-2 py-1`,children:"Clear Selection"}),i.jsxs("button",{onClick:We,className:"flex items-center gap-1.5 px-3 py-1.5 bg-red-600 text-white rounded text-xs font-medium hover:bg-red-700 transition-colors",children:[i.jsx(ua,{size:14}),"Delete Selected"]})]})]})})]}),i.jsxs("div",{className:"flex-1 overflow-auto p-4 sm:p-6",children:[h&&i.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded p-3 mb-4 flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-red-400",children:h}),i.jsx("button",{onClick:()=>m(""),className:"text-red-400 hover:text-red-300",children:i.jsx(kr,{size:16})})]}),f&&i.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3 mb-4 flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-green-400",children:f}),i.jsx("button",{onClick:()=>x(""),className:"text-green-400 hover:text-green-300",children:i.jsx(kr,{size:16})})]}),i.jsx("div",{className:`hidden md:block ${r.surface} rounded border ${r.border} overflow-hidden`,children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:`${r.surfaceSecondary}`,children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left",children:i.jsx("input",{type:"checkbox",checked:ee.length===s.filter(_e=>_e._id!==e.id).length&&s.length>1,onChange:ve,className:"rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec]"})}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"User"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Role"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Status"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Team"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider hidden lg:table-cell`,children:"Created"}),i.jsx("th",{className:`px-4 py-3 text-right text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y ${r.border}`,children:oe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"7",className:`px-4 py-8 text-center ${r.textSecondary}`,children:"No users found"})}):oe.map(_e=>{var ot;const Ze=Ae(_e.role),Ve=Qe(_e.employmentStatus);return i.jsxs("tr",{className:`${r.hover} transition-colors`,children:[i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"checkbox",checked:ee.includes(_e._id),onChange:()=>Q(_e._id),disabled:_e._id===e.id,className:"rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec] disabled:opacity-50"})}),i.jsxs("td",{className:"px-4 py-3",children:[i.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:_e.full_name}),i.jsx("div",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:_e.email})]}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded ${Ze.bg} ${Ze.text}`,children:Ze.label})}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded ${Ve.bg} ${Ve.text}`,children:Ve.label})}),i.jsx("td",{className:`px-4 py-3 text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:((ot=_e.team_id)==null?void 0:ot.name)||"No Team"}),i.jsx("td",{className:`px-4 py-3 text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} hidden lg:table-cell`,children:new Date(_e.created_at).toLocaleDateString()}),i.jsx("td",{className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>et(_e),className:`p-1.5 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white hover:bg-[#282f39]":"hover:text-gray-900 hover:bg-gray-100"} rounded transition-colors`,title:"Edit User",children:i.jsx(Hl,{size:16})}),i.jsx("button",{onClick:()=>we(_e._id,_e.email),className:`p-1.5 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white hover:bg-[#282f39]":"hover:text-gray-900 hover:bg-gray-100"} rounded transition-colors`,title:"Reset Password",children:i.jsx(Ug,{size:16})}),_e._id!==e.id&&i.jsx("button",{onClick:()=>Y(_e._id,_e.email),className:`p-1.5 ${t==="dark"?"text-[#9da8b9] hover:text-red-500 hover:bg-red-500/10":"text-gray-600 hover:text-red-600 hover:bg-red-50"} rounded transition-colors`,title:"Delete User",children:i.jsx(ua,{size:16})})]})})]},_e._id)})})]})})}),i.jsx("div",{className:"md:hidden space-y-3",children:oe.length===0?i.jsx("div",{className:`${r.surface} rounded border ${r.border} p-8 text-center ${r.textSecondary}`,children:"No users found"}):oe.map(_e=>{var Ve;const Ze=Ae(_e.role);return i.jsx("div",{className:`${r.surface} rounded border ${r.border} p-4`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("input",{type:"checkbox",checked:ee.includes(_e._id),onChange:()=>Q(_e._id),disabled:_e._id===e.id,className:"mt-1 rounded border-[#4b5563] text-[#136dec] focus:ring-[#136dec] disabled:opacity-50"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:`text-sm font-semibold ${t==="dark"?"text-white":"text-gray-900"} truncate`,children:_e.full_name}),i.jsx("p",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} truncate mt-0.5`,children:_e.email})]}),i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded ${Ze.bg} ${Ze.text} shrink-0`,children:Ze.label})]}),i.jsx("div",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-3`,children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ks,{size:12}),i.jsx("span",{children:((Ve=_e.team_id)==null?void 0:Ve.name)||"No Team"})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>et(_e),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} ${t==="dark"?"text-white":"text-gray-900"} rounded text-xs font-medium transition-colors`,children:[i.jsx(Hl,{size:14}),"Edit"]}),i.jsxs("button",{onClick:()=>we(_e._id,_e.email),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} ${t==="dark"?"text-white":"text-gray-900"} rounded text-xs font-medium transition-colors`,children:[i.jsx(Ug,{size:14}),"Reset"]}),_e._id!==e.id&&i.jsx("button",{onClick:()=>Y(_e._id,_e.email),className:"px-3 py-2 bg-red-500/10 text-red-500 rounded text-xs font-medium hover:bg-red-500/20 transition-colors",children:i.jsx(ua,{size:14})})]})]})]})},_e._id)})})]})]}),g&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-5 sm:p-8 max-w-md w-full max-h-[90vh] overflow-y-auto`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[i.jsx("h2",{className:`text-lg sm:text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:U==="create"?"Create New User":"Edit User"}),i.jsx("button",{onClick:()=>b(!1),className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:20})})]}),i.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Full Name *"}),i.jsx("input",{type:"text",name:"full_name",value:L.full_name,onChange:je,className:`w-full px-4 py-2 ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Email *"}),i.jsx("input",{type:"email",name:"email",value:L.email,onChange:je,className:`w-full px-4 py-2 ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),U==="create"&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Password *"}),i.jsx("input",{type:"password",name:"password",value:L.password,onChange:je,className:`w-full px-4 py-2 ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Role *"}),i.jsxs("select",{name:"role",value:L.role,onChange:je,className:`w-full px-4 py-2 ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,children:[i.jsx("option",{value:"member",children:"Member"}),i.jsx("option",{value:"team_lead",children:"Team Lead"}),i.jsx("option",{value:"hr",children:"HR"}),i.jsx("option",{value:"admin",children:"Admin"})]})]}),L.role!=="admin"&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Team"}),i.jsxs("select",{name:"team_id",value:L.team_id,onChange:je,className:`w-full px-4 py-2 ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"No Team"}),l.map(_e=>i.jsx("option",{value:_e._id,children:_e.name},_e._id))]})]}),h&&i.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded p-2 text-sm text-red-400",children:h}),f&&i.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-2 text-sm text-green-400",children:f}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-4 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>b(!1),className:`px-4 sm:px-6 py-2.5 ${t==="dark"?"bg-[#282f39]":"bg-gray-200"} ${t==="dark"?"text-white":"text-gray-900"} rounded ${t==="dark"?"hover:bg-[#3a4454]":"hover:bg-gray-300"} transition-colors text-sm sm:text-base`,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 sm:px-6 py-2.5 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold text-sm sm:text-base",children:U==="create"?"Create User":"Update User"})]})]})]})}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-5 sm:p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[i.jsx("h2",{className:`text-lg sm:text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Bulk Import Users"}),i.jsx("button",{onClick:()=>{N(!1),R(null),M(null)},className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:20})})]}),i.jsxs("div",{className:"space-y-5 sm:space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3`,children:"Step 1: Download Template"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[i.jsxs("button",{onClick:()=>le("excel"),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-sm",children:[i.jsx(Vx,{size:16}),"Excel Template"]}),i.jsxs("button",{onClick:()=>le("json"),className:"flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm",children:[i.jsx(CT,{size:16}),"JSON Template"]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3`,children:"Step 2: Upload File"}),i.jsx("input",{type:"file",accept:".json,.xlsx,.xls",onChange:He,className:`w-full px-3 py-2 text-sm ${t==="dark"?"bg-[#111418]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} rounded ${t==="dark"?"text-white":"text-gray-900"} file:mr-3 file:py-1.5 file:px-3 file:rounded file:border-0 file:bg-[#136dec] file:text-white file:cursor-pointer file:text-sm hover:file:bg-blue-600`}),O&&i.jsxs("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-2`,children:["Selected: ",O.name]})]}),C&&i.jsxs("div",{className:"space-y-3",children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Import Results"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3",children:i.jsxs("p",{className:"text-sm text-green-400",children:["âœ“ Successfully imported: ",C.successful.length," users"]})}),C.failed.length>0&&i.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded p-3",children:[i.jsxs("p",{className:"text-sm text-red-400 font-medium mb-2",children:["âœ— Failed: ",C.failed.length," users"]}),i.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:C.failed.map((_e,Ze)=>i.jsxs("p",{className:"text-xs text-red-300",children:[_e.email,": ",_e.reason]},Ze))})]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3 pt-4",children:[i.jsx("button",{onClick:()=>{N(!1),R(null),M(null)},className:`px-4 sm:px-6 py-2.5 ${t==="dark"?"bg-[#282f39]":"bg-gray-200"} ${t==="dark"?"text-white":"text-gray-900"} rounded ${t==="dark"?"hover:bg-[#3a4454]":"hover:bg-gray-300"} transition-colors text-sm sm:text-base`,children:"Close"}),i.jsx("button",{onClick:vt,disabled:!O||E,className:"px-4 sm:px-6 py-2.5 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:E?"Importing...":"Import Users"})]})]})]})}),i.jsx(rl,{isOpen:a.isOpen,onClose:a.onClose,onConfirm:a.onConfirm,title:a.title,message:a.message,confirmText:a.confirmText,cancelText:a.cancelText,variant:a.variant,isLoading:a.isLoading}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg shadow-xl max-w-md w-full p-6`,children:[i.jsx("h3",{className:`text-xl font-bold ${t==="dark"?"text-white":"text-gray-900"} mb-4`,children:"Reset Password"}),i.jsxs("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-4 text-sm`,children:["Enter new password for ",i.jsx("span",{className:"font-semibold",children:D.userEmail})]}),i.jsxs("form",{onSubmit:Re,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"New Password *"}),i.jsx("input",{type:"password",value:D.newPassword,onChange:_e=>I({...D,newPassword:_e.target.value}),placeholder:"Enter new password (min 6 characters)",className:`w-full p-3 ${t==="dark"?"bg-[#111418] border-[#282f39] text-white placeholder:text-[#58606e]":"bg-white border-gray-300 text-gray-900"} border rounded-lg focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,minLength:6,autoFocus:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>{_(!1),I({userId:"",userEmail:"",newPassword:""})},className:`px-4 py-2 ${t==="dark"?"bg-[#282f39] hover:bg-[#3a4454]":"bg-gray-200 hover:bg-gray-300"} ${t==="dark"?"text-white":"text-gray-900"} rounded transition-colors`,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"Reset Password"})]})]})]})})]}):i.jsxs("div",{className:`flex h-screen w-full ${r.background}`,children:[i.jsx(Cn,{}),i.jsx("main",{className:`flex-1 flex items-center justify-center ${r.background}`,children:i.jsxs("div",{className:`${r.surface} p-8 rounded border ${r.border}`,children:[i.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Access Denied"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"You don't have permission to access user management."}),i.jsx("p",{className:"text-[#6b7280] mt-2",children:"Only Admin and HR can manage users."})]})})]})}function CR(){const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),n=t==="dark",a=tl(),[s,o]=J.useState([]),[l,c]=J.useState([]),[d,u]=J.useState(!0),[h,m]=J.useState(""),[f,x]=J.useState(""),[g,b]=J.useState(!1),[y,N]=J.useState("create"),[S,_]=J.useState(null),[D,I]=J.useState(""),[O,R]=J.useState("all"),[E,B]=J.useState("all"),[C,M]=J.useState({full_name:"",email:"",password:"",role:"member",team_id:""}),U=e&&e.role==="community_admin";J.useEffect(()=>{U&&(F(),ne())},[U]),el({onUserCreated:()=>{U&&F()},onUserUpdated:()=>{U&&F()},onUserDeleted:()=>{U&&F()}});const F=async()=>{var T,L;try{u(!0);const H=await it.get("/users");o(H.data.users),m("")}catch(H){m(((L=(T=H.response)==null?void 0:T.data)==null?void 0:L.message)||"Failed to fetch users")}finally{u(!1)}},ne=async()=>{try{const T=await it.get("/teams");c(T.data.teams||[])}catch(T){console.error("Failed to fetch teams:",T)}},V=J.useMemo(()=>{let T=[...s];if(D.trim()){const L=D.toLowerCase();T=T.filter(H=>{var X;return H.full_name.toLowerCase().includes(L)||H.email.toLowerCase().includes(L)||((X=H.team_id)==null?void 0:X.name)&&H.team_id.name.toLowerCase().includes(L)})}return O!=="all"&&(T=T.filter(L=>L.role===O)),E!=="all"&&(E==="no_team"?T=T.filter(L=>!L.team_id):T=T.filter(L=>{var H;return((H=L.team_id)==null?void 0:H._id)===E})),T},[s,D,O,E]),ee=T=>{const{name:L,value:H}=T.target;M(X=>({...X,[L]:H}))},me=()=>{N("create"),M({full_name:"",email:"",password:"",role:"member",team_id:""}),b(!0),m(""),x("")},ye=T=>{var L;N("edit"),_(T),M({full_name:T.full_name,email:T.email,password:"",role:T.role,team_id:((L=T.team_id)==null?void 0:L._id)||""}),b(!0),m(""),x("")},Oe=async T=>{var L,H;T.preventDefault(),m(""),x("");try{if(y==="create")await it.post("/users",C),x("User created successfully");else{const X={...C};delete X.password,await it.put(`/users/${S._id}`,X),x("User updated successfully")}await F(),setTimeout(()=>{b(!1),x("")},1500)}catch(X){m(((H=(L=X.response)==null?void 0:L.data)==null?void 0:H.message)||`Failed to ${y} user`)}},xe=(T,L)=>{a.show({title:"Delete User",message:`Are you sure you want to delete user: ${L}? This will permanently remove their account and all associated data from your workspace.`,confirmText:"Delete User",cancelText:"Cancel",variant:"danger",onConfirm:async()=>{var H,X;try{await it.delete(`/users/${T}`),x("User deleted successfully"),await F(),setTimeout(()=>x(""),3e3)}catch(re){m(((X=(H=re.response)==null?void 0:H.data)==null?void 0:X.message)||"Failed to delete user"),setTimeout(()=>m(""),3e3)}}})},w=async(T,L)=>{var X,re;const H=prompt(`Enter new password for ${L}:`);if(H){if(H.length<6){m("Password must be at least 6 characters"),setTimeout(()=>m(""),3e3);return}try{await it.patch(`/users/${T}/password`,{password:H}),x("Password reset successfully"),setTimeout(()=>x(""),3e3)}catch(ge){m(((re=(X=ge.response)==null?void 0:X.data)==null?void 0:re.message)||"Failed to reset password"),setTimeout(()=>m(""),3e3)}}},A=T=>({admin:"bg-red-500",hr:"bg-purple-500",team_lead:"bg-blue-500",member:"bg-green-500",community_admin:"bg-orange-500"})[T]||"bg-gray-500";return U?d?i.jsxs("div",{className:"flex h-screen",children:[i.jsx(Cn,{}),i.jsx("div",{className:`flex-1 overflow-auto ${n?"bg-[#0f1419]":"bg-gray-50"} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`inline-block animate-spin rounded-full h-12 w-12 border-b-2 ${n?"border-blue-400":"border-blue-600"}`}),i.jsx("p",{className:`mt-4 ${n?"text-gray-400":"text-gray-600"}`,children:"Loading users..."})]})})]}):i.jsxs("div",{className:"flex h-screen",children:[i.jsx(Cn,{}),i.jsx("div",{className:`flex-1 overflow-auto ${n?"bg-[#0f1419]":"bg-gray-50"}`,children:i.jsxs("div",{className:"p-8",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:r,className:`lg:hidden ${n?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:`text-3xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Community User Management"}),i.jsx("p",{className:`mt-2 ${n?"text-gray-400":"text-gray-600"}`,children:"Manage users in your community workspace"})]})]})}),h&&i.jsx("div",{className:`mb-4 p-4 rounded-lg ${n?"bg-red-900/20 border border-red-700":"bg-red-50 border border-red-200"}`,children:i.jsx("p",{className:n?"text-red-300":"text-red-800",children:h})}),f&&i.jsx("div",{className:`mb-4 p-4 rounded-lg ${n?"bg-green-900/20 border border-green-700":"bg-green-50 border border-green-200"}`,children:i.jsx("p",{className:n?"text-green-300":"text-green-800",children:f})}),i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm p-6 mb-6`,children:i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(oo,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-gray-500":"text-gray-400"}`,size:20}),i.jsx("input",{type:"text",placeholder:"Search by name, email, or team...",value:D,onChange:T=>I(T.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),i.jsxs("select",{value:O,onChange:T=>R(T.target.value),className:`px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[i.jsx("option",{value:"all",children:"All Roles"}),i.jsx("option",{value:"member",children:"Member"}),i.jsx("option",{value:"team_lead",children:"Team Lead"}),i.jsx("option",{value:"hr",children:"HR"})]}),i.jsxs("select",{value:E,onChange:T=>B(T.target.value),className:`px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[i.jsx("option",{value:"all",children:"All Teams"}),i.jsx("option",{value:"no_team",children:"No Team"}),l.map(T=>i.jsx("option",{value:T._id,children:T.name},T._id))]})]}),i.jsxs("button",{onClick:me,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[i.jsx(Si,{size:20}),"Add User"]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm p-6`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-600"}`,children:"Total Users"}),i.jsx("p",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:s.length})]}),i.jsx(ks,{className:"text-blue-500",size:40})]})}),i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm p-6`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-600"}`,children:"Members"}),i.jsx("p",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:s.filter(T=>T.role==="member").length})]}),i.jsx(ji,{className:"text-green-500",size:40})]})}),i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm p-6`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-600"}`,children:"Team Leads"}),i.jsx("p",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:s.filter(T=>T.role==="team_lead").length})]}),i.jsx(ji,{className:"text-blue-500",size:40})]})}),i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm p-6`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-600"}`,children:"Filtered"}),i.jsx("p",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:V.length})]}),i.jsx(oo,{className:"text-purple-500",size:40})]})})]}),i.jsx("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-sm overflow-hidden`,children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:n?"bg-[#1a1f2e]":"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${n?"text-gray-400":"text-gray-500"} uppercase tracking-wider`,children:"User"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${n?"text-gray-400":"text-gray-500"} uppercase tracking-wider`,children:"Email"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${n?"text-gray-400":"text-gray-500"} uppercase tracking-wider`,children:"Role"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${n?"text-gray-400":"text-gray-500"} uppercase tracking-wider`,children:"Team"}),i.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium ${n?"text-gray-400":"text-gray-500"} uppercase tracking-wider`,children:"Actions"})]})}),i.jsx("tbody",{className:`${n?"divide-y divide-gray-700":"divide-y divide-gray-200"}`,children:V.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:"5",className:"px-6 py-8 text-center",children:[i.jsx(ks,{className:`mx-auto ${n?"text-gray-600":"text-gray-400"}`,size:48}),i.jsx("p",{className:`mt-2 ${n?"text-gray-400":"text-gray-600"}`,children:"No users found"})]})}):V.map(T=>i.jsxs("tr",{className:n?"hover:bg-[#1a1f2e]":"hover:bg-gray-50",children:[i.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${n?"text-white":"text-gray-900"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:i.jsx("div",{className:`h-10 w-10 rounded-full ${A(T.role)} flex items-center justify-center text-white font-semibold`,children:T.full_name.charAt(0).toUpperCase()})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"font-medium",children:T.full_name}),T._id===e.id&&i.jsx("span",{className:"text-xs text-blue-500",children:"(You)"})]})]})}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${n?"text-gray-300":"text-gray-600"}`,children:T.email}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${A(T.role)} text-white`,children:T.role.replace("_"," ").toUpperCase()})}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${n?"text-gray-300":"text-gray-600"}`,children:T.team_id?T.team_id.name:"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>ye(T),className:`p-2 rounded ${n?"hover:bg-[#1a1f2e] text-blue-400":"hover:bg-gray-100 text-blue-600"} transition-colors`,title:"Edit User",children:i.jsx(Hl,{size:18})}),i.jsx("button",{onClick:()=>w(T._id,T.email),className:`p-2 rounded ${n?"hover:bg-[#1a1f2e] text-yellow-400":"hover:bg-gray-100 text-yellow-600"} transition-colors`,title:"Reset Password",children:i.jsx(Ug,{size:18})}),T._id!==e.id&&i.jsx("button",{onClick:()=>xe(T._id,T.email),className:`p-2 rounded ${n?"hover:bg-[#1a1f2e] text-red-400":"hover:bg-gray-100 text-red-600"} transition-colors`,title:"Delete User",children:i.jsx(ua,{size:18})})]})})]},T._id))})]})})})]})}),g&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:`${n?"bg-[#111418]":"bg-white"} rounded-lg shadow-xl max-w-md w-full`,children:[i.jsxs("div",{className:`flex items-center justify-between p-6 border-b ${n?"border-gray-700":"border-gray-200"}`,children:[i.jsx("h3",{className:`text-xl font-semibold ${n?"text-white":"text-gray-900"}`,children:y==="create"?"Add New User":"Edit User"}),i.jsx("button",{onClick:()=>b(!1),className:`${n?"text-gray-400 hover:text-gray-300":"text-gray-500 hover:text-gray-700"} transition-colors`,children:i.jsx(kr,{size:24})})]}),i.jsxs("form",{onSubmit:Oe,className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n?"text-gray-300":"text-gray-700"} mb-2`,children:"Full Name *"}),i.jsx("input",{type:"text",name:"full_name",value:C.full_name,onChange:ee,required:!0,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n?"text-gray-300":"text-gray-700"} mb-2`,children:"Email *"}),i.jsx("input",{type:"email",name:"email",value:C.email,onChange:ee,required:!0,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),y==="create"&&i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n?"text-gray-300":"text-gray-700"} mb-2`,children:"Password *"}),i.jsx("input",{type:"password",name:"password",value:C.password,onChange:ee,required:y==="create",minLength:6,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n?"text-gray-300":"text-gray-700"} mb-2`,children:"Role *"}),i.jsxs("select",{name:"role",value:C.role,onChange:ee,required:!0,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[i.jsx("option",{value:"member",children:"Member"}),i.jsx("option",{value:"team_lead",children:"Team Lead"}),i.jsx("option",{value:"hr",children:"HR"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n?"text-gray-300":"text-gray-700"} mb-2`,children:"Team"}),i.jsxs("select",{name:"team_id",value:C.team_id,onChange:ee,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-[#1a1f2e] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`,children:[i.jsx("option",{value:"",children:"No Team"}),l.map(T=>i.jsx("option",{value:T._id,children:T.name},T._id))]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>b(!1),className:`flex-1 px-4 py-2 border rounded-lg ${n?"border-gray-700 text-gray-300 hover:bg-[#1a1f2e]":"border-gray-300 text-gray-700 hover:bg-gray-50"} transition-colors`,children:"Cancel"}),i.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:y==="create"?"Create User":"Update User"})]})]})]})}),i.jsx(rl,{isOpen:a.isOpen,onClose:a.onClose,onConfirm:a.onConfirm,title:a.title,message:a.message,confirmText:a.confirmText,cancelText:a.cancelText,variant:a.variant,isLoading:a.isLoading})]}):i.jsxs("div",{className:"flex h-screen",children:[i.jsx(Cn,{}),i.jsx("div",{className:`flex-1 overflow-auto ${n?"bg-[#0f1419] text-white":"bg-gray-50 text-gray-900"}`,children:i.jsx("div",{className:"p-8",children:i.jsx("div",{className:`${n?"bg-red-900/20 border-red-700":"bg-red-50 border-red-200"} border rounded-lg p-4`,children:i.jsx("p",{className:n?"text-red-300":"text-red-800",children:"You do not have permission to access this page. Only Community Administrators can manage users."})})})})]})}function DR(){const{theme:e}=Lr(),{toggleMobileSidebar:t}=Mn(),r=tl(),n=e==="dark",[a,s]=J.useState([]),[o,l]=J.useState(!0),[c,d]=J.useState(!1),[u,h]=J.useState(!1),[m,f]=J.useState(!1),[x,g]=J.useState(!1),[b,y]=J.useState(!1),[N,S]=J.useState(""),[_,D]=J.useState(null),[I,O]=J.useState(!1),[R,E]=J.useState(""),[B,C]=J.useState({name:"",type:"COMMUNITY",ownerEmail:""}),[M,U]=J.useState({name:"",type:"COMMUNITY"});J.useEffect(()=>{V()},[]);const F=A=>{S(A),g(!0),setTimeout(()=>g(!1),3e3)},ne=A=>{S(A),y(!0)},V=async()=>{var A,T;try{console.log("ðŸ“‹ Fetching workspaces..."),l(!0);const L=await it.get("/workspaces");console.log("âœ… Workspaces fetched:",L.data),s(L.data)}catch(L){console.error("âŒ Error fetching workspaces:",L),ne("Failed to fetch workspaces: "+(((T=(A=L.response)==null?void 0:A.data)==null?void 0:T.message)||L.message))}finally{l(!1)}},ee=async A=>{var T,L;if(A.preventDefault(),!B.name.trim()){ne("Please enter a workspace name");return}try{console.log("ðŸ“ Creating workspace:",B),O(!0);const H=await it.post("/workspaces",B);console.log("âœ… Workspace created:",H.data),d(!1),C({name:"",type:"COMMUNITY",ownerEmail:""}),F("Workspace created successfully!"),V()}catch(H){console.error("âŒ Error creating workspace:",H),ne("Failed to create workspace: "+(((L=(T=H.response)==null?void 0:T.data)==null?void 0:L.message)||H.message))}finally{O(!1)}},me=async A=>{var T,L;if(A.preventDefault(),!M.name.trim()){ne("Please enter a workspace name");return}try{console.log("ðŸ“ Updating workspace:",_._id,M),O(!0);const H=await it.put(`/workspaces/${_._id}`,M);console.log("âœ… Workspace updated:",H.data),h(!1),D(null),F("Workspace updated successfully!"),V()}catch(H){console.error("âŒ Error updating workspace:",H),ne("Failed to update workspace: "+(((L=(T=H.response)==null?void 0:T.data)==null?void 0:L.message)||H.message))}finally{O(!1)}},ye=async A=>{D(A),E(""),f(!0)},Oe=async()=>{var A,T;if(R!=="DELETE"){ne('Please type "DELETE" to confirm');return}try{console.log("ðŸ—‘ï¸ Deleting workspace:",_._id),O(!0),f(!1);const L=await it.delete(`/workspaces/${_._id}`);console.log("âœ… Workspace deleted:",L.data);const H=L.data.deleted||{};F(`Workspace deleted successfully!

Deleted:
â€¢ ${H.users||0} users
â€¢ ${H.tasks||0} tasks
â€¢ ${H.teams||0} teams`),V()}catch(L){console.error("âŒ Error deleting workspace:",L),ne("Failed to delete workspace: "+(((T=(A=L.response)==null?void 0:A.data)==null?void 0:T.message)||L.message))}finally{O(!1),D(null),E("")}},xe=async A=>{var H,X;const T=A.isActive?"deactivate":"activate";if(await r.show({title:`${T==="activate"?"Activate":"Deactivate"} Workspace`,message:`Are you sure you want to ${T} workspace "${A.name}"? Users in this workspace will ${T==="deactivate"?"lose access until it is reactivated":"regain access"}.`,confirmText:T==="activate"?"Activate":"Deactivate",cancelText:"Cancel",variant:T==="deactivate"?"warning":"info"}))try{console.log(`ðŸ”„ ${T}ing workspace:`,A._id),O(!0);const re=await it.patch(`/workspaces/${A._id}/toggle-status`);console.log(`âœ… Workspace ${T}d:`,re.data),F(`Workspace ${T}d successfully!`),V()}catch(re){console.error(`âŒ Error ${T}ing workspace:`,re),ne(`Failed to ${T} workspace: `+(((X=(H=re.response)==null?void 0:H.data)==null?void 0:X.message)||re.message))}finally{O(!1)}},w=A=>{D(A),U({name:A.name,type:A.type}),h(!0)};return o?i.jsxs("div",{className:`flex h-screen ${n?"bg-[#0f1419]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsx(ih,{className:"w-8 h-8 animate-spin text-purple-600"})})]}):i.jsxs("div",{className:`flex h-screen ${n?"bg-[#0f1419]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:t,className:`lg:hidden ${n?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsxs("h1",{className:`text-3xl font-bold flex items-center gap-3 ${n?"text-white":"text-gray-900"}`,children:[i.jsx(Mh,{className:"w-8 h-8 text-purple-600"}),"Workspace Management"]}),i.jsx("p",{className:`mt-2 ${n?"text-gray-400":"text-gray-600"}`,children:"Manage all workspaces in the system"})]})]}),i.jsxs("button",{onClick:()=>d(!0),disabled:I,className:"flex items-center gap-2 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors disabled:opacity-50",children:[i.jsx(Si,{className:"w-5 h-5"}),"Create Workspace"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.map(A=>{var T,L,H;return i.jsxs("div",{className:`rounded-xl p-6 ${n?"bg-[#1a1f2e] border border-gray-800":"bg-white border border-gray-200"} hover:shadow-xl transition-shadow`,children:[i.jsx("div",{className:"flex justify-between items-start mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:A.name}),i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${A.type==="CORE"?"bg-purple-900/30 text-purple-400":"bg-blue-900/30 text-blue-400"}`,children:A.type}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${A.isActive?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:A.isActive?"Active":"Inactive"})]})]})}),i.jsxs("div",{className:`grid grid-cols-3 gap-4 mb-4 p-4 rounded-lg ${n?"bg-[#0f1419]":"bg-gray-50"}`,children:[i.jsxs("div",{className:"text-center",children:[i.jsx(ks,{className:"w-5 h-5 mx-auto mb-1 text-purple-500"}),i.jsx("p",{className:`text-sm font-semibold ${n?"text-white":"text-gray-900"}`,children:((T=A.stats)==null?void 0:T.userCount)||0}),i.jsx("p",{className:`text-xs ${n?"text-gray-500":"text-gray-600"}`,children:"Users"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx(n0,{className:"w-5 h-5 mx-auto mb-1 text-blue-500"}),i.jsx("p",{className:`text-sm font-semibold ${n?"text-white":"text-gray-900"}`,children:((L=A.stats)==null?void 0:L.taskCount)||0}),i.jsx("p",{className:`text-xs ${n?"text-gray-500":"text-gray-600"}`,children:"Tasks"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx(Mh,{className:"w-5 h-5 mx-auto mb-1 text-green-500"}),i.jsx("p",{className:`text-sm font-semibold ${n?"text-white":"text-gray-900"}`,children:((H=A.stats)==null?void 0:H.teamCount)||0}),i.jsx("p",{className:`text-xs ${n?"text-gray-500":"text-gray-600"}`,children:"Teams"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>w(A),disabled:I,className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg transition-colors ${n?"bg-blue-900/30 hover:bg-blue-900/50 text-blue-400":"bg-blue-100 hover:bg-blue-200 text-blue-600"} disabled:opacity-50`,title:"Edit",children:i.jsx(RT,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>xe(A),disabled:I,className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg transition-colors ${A.isActive?n?"bg-orange-900/30 hover:bg-orange-900/50 text-orange-400":"bg-orange-100 hover:bg-orange-200 text-orange-600":n?"bg-green-900/30 hover:bg-green-900/50 text-green-400":"bg-green-100 hover:bg-green-200 text-green-600"} disabled:opacity-50`,title:A.isActive?"Deactivate":"Activate",children:A.isActive?i.jsx(MT,{className:"w-4 h-4"}):i.jsx(IT,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>ye(A),disabled:I,className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg transition-colors ${n?"bg-red-900/30 hover:bg-red-900/50 text-red-400":"bg-red-100 hover:bg-red-200 text-red-600"} disabled:opacity-50`,title:"Delete",children:i.jsx(ua,{className:"w-4 h-4"})})]})]},A._id)}),a.length===0&&i.jsxs("div",{className:"col-span-full text-center py-12",children:[i.jsx(Mh,{className:`w-16 h-16 mx-auto mb-4 ${n?"text-gray-700":"text-gray-300"}`}),i.jsx("p",{className:`text-lg ${n?"text-gray-400":"text-gray-600"}`,children:"No workspaces found. Create one to get started!"})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`rounded-xl p-6 w-full max-w-md ${n?"bg-[#1a1f2e]":"bg-white"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Create Workspace"}),i.jsx("button",{onClick:()=>d(!1),disabled:I,className:`p-2 rounded-lg ${n?"hover:bg-gray-800":"hover:bg-gray-100"}`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:"Workspace Name *"}),i.jsx("input",{type:"text",value:B.name,onChange:A=>C({...B,name:A.target.value}),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-purple-500 focus:border-transparent`,placeholder:"e.g., Acme Corporation",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:"Type *"}),i.jsxs("select",{value:B.type,onChange:A=>C({...B,type:A.target.value}),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-purple-500 focus:border-transparent`,children:[i.jsx("option",{value:"COMMUNITY",children:"COMMUNITY (Free - Limited)"}),i.jsx("option",{value:"CORE",children:"CORE (Enterprise - Unlimited)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:"Owner Email (Optional)"}),i.jsx("input",{type:"email",value:B.ownerEmail,onChange:A=>C({...B,ownerEmail:A.target.value}),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-purple-500 focus:border-transparent`,placeholder:"admin@example.com"})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>d(!1),disabled:I,className:`flex-1 px-4 py-2 rounded-lg ${n?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"} disabled:opacity-50`,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:I,className:"flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg disabled:opacity-50 flex items-center justify-center gap-2",children:I?i.jsxs(i.Fragment,{children:[i.jsx(ih,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Workspace"})]})]})]})}),u&&_&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`rounded-xl p-6 w-full max-w-md ${n?"bg-[#1a1f2e]":"bg-white"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Edit Workspace"}),i.jsx("button",{onClick:()=>h(!1),disabled:I,className:`p-2 rounded-lg ${n?"hover:bg-gray-800":"hover:bg-gray-100"}`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:me,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:"Workspace Name *"}),i.jsx("input",{type:"text",value:M.name,onChange:A=>U({...M,name:A.target.value}),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-purple-500 focus:border-transparent`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:"Type *"}),i.jsxs("select",{value:M.type,onChange:A=>U({...M,type:A.target.value}),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-purple-500 focus:border-transparent`,children:[i.jsx("option",{value:"COMMUNITY",children:"COMMUNITY"}),i.jsx("option",{value:"CORE",children:"CORE"})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>h(!1),disabled:I,className:`flex-1 px-4 py-2 rounded-lg ${n?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"} disabled:opacity-50`,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:I,className:"flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg disabled:opacity-50 flex items-center justify-center gap-2",children:I?i.jsxs(i.Fragment,{children:[i.jsx(ih,{className:"w-4 h-4 animate-spin"}),"Updating..."]}):"Update Workspace"})]})]})]})})]}),x&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fade-in",children:i.jsxs("div",{className:`rounded-xl p-6 w-full max-w-md ${n?"bg-[#1a1f2e]":"bg-white"} animate-scale-in`,children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"p-3 rounded-full bg-green-500/10",children:i.jsx(da,{className:"w-6 h-6 text-green-500"})}),i.jsx("h3",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Success!"})]}),i.jsx("p",{className:`${n?"text-gray-300":"text-gray-700"} whitespace-pre-line`,children:N})]})}),b&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`rounded-xl p-6 w-full max-w-md ${n?"bg-[#1a1f2e]":"bg-white"}`,children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"p-3 rounded-full bg-red-500/10",children:i.jsx(Ss,{className:"w-6 h-6 text-red-500"})}),i.jsx("h3",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Error"})]}),i.jsx("p",{className:`mb-6 ${n?"text-gray-300":"text-gray-700"}`,children:N}),i.jsx("button",{onClick:()=>y(!1),className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg",children:"Close"})]})}),m&&_&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`rounded-xl p-6 w-full max-w-md ${n?"bg-[#1a1f2e]":"bg-white"}`,children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"p-3 rounded-full bg-red-500/10",children:i.jsx(ua,{className:"w-6 h-6 text-red-500"})}),i.jsx("h3",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:"Delete Workspace"})]}),i.jsxs("div",{className:`mb-6 ${n?"text-gray-300":"text-gray-700"}`,children:[i.jsxs("p",{className:"mb-4",children:["âš ï¸ You are about to delete workspace ",i.jsxs("strong",{children:['"',_.name,'"']})]}),i.jsx("p",{className:"mb-4",children:"This will permanently delete ALL data:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[i.jsx("li",{children:"All users in this workspace"}),i.jsx("li",{children:"All tasks in this workspace"}),i.jsx("li",{children:"All teams in this workspace"})]}),i.jsx("p",{className:"text-red-500 font-semibold mb-4",children:"This action CANNOT be undone!"}),i.jsxs("p",{className:"mb-2",children:["Type ",i.jsx("strong",{className:"text-red-500",children:"DELETE"})," to confirm:"]}),i.jsx("input",{type:"text",value:R,onChange:A=>E(A.target.value),className:`w-full px-4 py-2 rounded-lg border ${n?"bg-[#0f1419] border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-red-500 focus:border-transparent`,placeholder:"Type DELETE here",autoFocus:!0})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{f(!1),D(null),E("")},disabled:I,className:`flex-1 px-4 py-2 rounded-lg ${n?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"} disabled:opacity-50`,children:"Cancel"}),i.jsx("button",{onClick:Oe,disabled:I||R!=="DELETE",className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg disabled:opacity-50 flex items-center justify-center gap-2",children:I?i.jsxs(i.Fragment,{children:[i.jsx(ih,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):"Delete Workspace"})]})]})}),i.jsx(rl,{isOpen:r.isOpen,onClose:r.onClose,onConfirm:r.onConfirm,title:r.title,message:r.message,confirmText:r.confirmText,cancelText:r.cancelText,variant:r.variant,isLoading:r.isLoading})]})}const OR=()=>{const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),[n,a]=J.useState([]),[s,o]=J.useState([]),[l,c]=J.useState(!0),[d,u]=J.useState({status:"",priority:"",team:"",user:"",dateRange:"all",customStartDate:"",customEndDate:""}),[h,m]=J.useState([]),[f,x]=J.useState([]),[g,b]=J.useState("all"),[y,N]=J.useState(!1),[S,_]=J.useState(!1),[D,I]=J.useState({totalTasks:0,overdueTasks:0,completedTasks:0,inProgressTasks:0,statusDistribution:[],priorityDistribution:[],teamDistribution:[],overdueByPriority:[],completionTrend:[],assigneePerformance:[],weeklyProgress:[],hourlyDistribution:[],taskAgeDistribution:[],completionRateByTeam:[],priorityTrend:[],statusTransitions:[]});J.useEffect(()=>{(async()=>{await O(),await R(),["admin","hr"].includes(e==null?void 0:e.role)&&await E()})()},[e==null?void 0:e.role]),J.useEffect(()=>{C()},[n,d]),J.useEffect(()=>{s.length>=0&&B(s)},[s]),el({onTaskCreated:()=>O(),onTaskUpdated:()=>O(),onTaskDeleted:()=>O()});const O=async()=>{try{const V=await it.get("/tasks");a(V.data.tasks),c(!1)}catch(V){console.error("Error fetching tasks:",V),c(!1)}},R=async()=>{var V;try{const ee=await it.get("/teams");m(ee.data.teams)}catch(ee){((V=ee.response)==null?void 0:V.status)!==403&&console.error("Error fetching teams:",ee)}},E=async()=>{var V;try{const ee=await it.get("/users");x(ee.data.users)}catch(ee){((V=ee.response)==null?void 0:V.status)!==403&&console.error("Error fetching users:",ee)}},B=J.useCallback(V=>{const ee=new Date,me=V.filter(Q=>Q.due_date&&new Date(Q.due_date)<ee&&Q.status!=="done"),ye=V.filter(Q=>Q.status==="done"),Oe=V.filter(Q=>Q.status==="in_progress"),xe=V.reduce((Q,ve)=>(Q[ve.status]=(Q[ve.status]||0)+1,Q),{}),w=Object.entries(xe).map(([Q,ve])=>({name:Q.replace("_"," ").toUpperCase(),value:ve,color:M(Q)})),A=V.reduce((Q,ve)=>(Q[ve.priority]=(Q[ve.priority]||0)+1,Q),{}),T=Object.entries(A).map(([Q,ve])=>({name:Q.toUpperCase(),value:ve})),L=me.reduce((Q,ve)=>(Q[ve.priority]=(Q[ve.priority]||0)+1,Q),{}),H=Object.entries(L).map(([Q,ve])=>({name:Q.toUpperCase(),value:ve})),X=[];for(let Q=29;Q>=0;Q--){const ve=new Date;ve.setDate(ve.getDate()-Q);const we=V.filter(He=>new Date(He.created_at).toDateString()===ve.toDateString()),Re=we.filter(He=>He.status==="done");X.push({date:ve.toLocaleDateString("en-US",{month:"short",day:"numeric"}),created:we.length,completed:Re.length})}const re=[];for(let Q=7;Q>=0;Q--){const ve=new Date;ve.setDate(ve.getDate()-Q*7);const we=new Date(ve);we.setDate(we.getDate()+6);const Re=V.filter(Ae=>{const Qe=new Date(Ae.created_at);return Qe>=ve&&Qe<=we}),He=Re.filter(Ae=>Ae.status==="done").length,vt=Re.filter(Ae=>Ae.status==="in_progress").length,le=Re.filter(Ae=>Ae.status==="todo").length;re.push({week:`W${Q===0?"Now":Q}`,completed:He,inProgress:vt,todo:le,total:Re.length})}const ge=Array(24).fill(0).map((Q,ve)=>({hour:ve===0?"12 AM":ve<12?`${ve} AM`:ve===12?"12 PM":`${ve-12} PM`,count:0}));V.forEach(Q=>{const ve=new Date(Q.created_at).getHours();ge[ve].count++});const oe=[{range:"0-1 days",count:0},{range:"1-3 days",count:0},{range:"3-7 days",count:0},{range:"7-14 days",count:0},{range:"14-30 days",count:0},{range:"30+ days",count:0}];V.forEach(Q=>{if(Q.status!=="done"){const ve=Math.floor((ee-new Date(Q.created_at))/864e5);ve<=1?oe[0].count++:ve<=3?oe[1].count++:ve<=7?oe[2].count++:ve<=14?oe[3].count++:ve<=30?oe[4].count++:oe[5].count++}});const je=[];for(let Q=11;Q>=0;Q--){const ve=new Date;ve.setDate(ve.getDate()-Q*7);const we=new Date(ve);we.setDate(we.getDate()+6);const Re=V.filter(He=>{const vt=new Date(He.created_at);return vt>=ve&&vt<=we});je.push({week:`W${12-Q}`,low:Re.filter(He=>He.priority==="low").length,medium:Re.filter(He=>He.priority==="medium").length,high:Re.filter(He=>He.priority==="high").length,urgent:Re.filter(He=>He.priority==="urgent").length})}const Ie=V.reduce((Q,ve)=>(ve.assigned_to&&ve.assigned_to.length>0&&ve.assigned_to.forEach(we=>{const Re=we._id,He=we.full_name;Q[Re]||(Q[Re]={name:He,total:0,completed:0,overdue:0}),Q[Re].total++,ve.status==="done"&&Q[Re].completed++,ve.due_date&&new Date(ve.due_date)<ee&&ve.status!=="done"&&Q[Re].overdue++}),Q),{}),et=Object.values(Ie).map(Q=>({name:Q.name,total:Q.total,completed:Q.completed,overdue:Q.overdue,completionRate:Q.total>0?Math.round(Q.completed/Q.total*100):0})),Te=V.reduce((Q,ve)=>{var Re;const we=((Re=ve.team_id)==null?void 0:Re.name)||"Unassigned";return Q[we]=(Q[we]||0)+1,Q},{}),Y=Object.entries(Te).map(([Q,ve])=>({name:Q,value:ve})).sort((Q,ve)=>ve.value-Q.value),We=Object.entries(V.reduce((Q,ve)=>{var Re;const we=((Re=ve.team_id)==null?void 0:Re.name)||"Unassigned";return Q[we]||(Q[we]={total:0,completed:0}),Q[we].total++,ve.status==="done"&&Q[we].completed++,Q},{})).map(([Q,ve])=>({team:Q,rate:ve.total>0?Math.round(ve.completed/ve.total*100):0,completed:ve.completed,total:ve.total})).sort((Q,ve)=>ve.rate-Q.rate);I({totalTasks:V.length,overdueTasks:me.length,completedTasks:ye.length,inProgressTasks:Oe.length,statusDistribution:w,priorityDistribution:T,teamDistribution:Y,overdueByPriority:H,completionTrend:X,assigneePerformance:et,weeklyProgress:re,hourlyDistribution:ge,taskAgeDistribution:oe,completionRateByTeam:We,priorityTrend:je})},[]),C=()=>{let V=[...n];if((e==null?void 0:e.role)==="member"&&(V=V.filter(ee=>{const me=ee.assigned_to&&ee.assigned_to.some(Oe=>Oe._id===e.id||Oe===e.id),ye=e.team_id&&ee.team_id&&(ee.team_id._id===e.team_id||ee.team_id===e.team_id);return me&&ye})),d.status&&(V=V.filter(ee=>ee.status===d.status)),d.priority&&(V=V.filter(ee=>ee.priority===d.priority)),d.team&&(V=V.filter(ee=>{var me;return((me=ee.team_id)==null?void 0:me._id)===d.team})),d.user&&(d.user==="unassigned"?V=V.filter(ee=>!ee.assigned_to||ee.assigned_to.length===0):V=V.filter(ee=>ee.assigned_to&&ee.assigned_to.some(me=>me._id===d.user))),d.dateRange!=="all"){const ee=new Date;let me;switch(d.dateRange){case"today":me=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate());break;case"week":me=new Date(ee.getTime()-7*24*60*60*1e3);break;case"month":me=new Date(ee.getFullYear(),ee.getMonth(),1);break;case"custom":if(d.customStartDate&&d.customEndDate){me=new Date(d.customStartDate);const ye=new Date(d.customEndDate);ye.setHours(23,59,59,999),V=V.filter(Oe=>{const xe=new Date(Oe.created_at);return xe>=me&&xe<=ye})}break}me&&d.dateRange!=="custom"&&(V=V.filter(ye=>new Date(ye.created_at)>=me))}o(V)},M=V=>{const ee={todo:"#6b7280",in_progress:"#136dec",review:"#eab308",done:"#22c55e",archived:"#ef4444"};return ee[V]||ee.todo},U=V=>{const ee={low:"#10b981",medium:"#f59e0b",high:"#f97316",urgent:"#ef4444"};return ee[V]||ee.medium},F=()=>{try{NN(s,D,d)}catch(V){console.error("Error generating Excel report:",V),alert("Error generating Excel report. Please try again.")}},ne=()=>{try{kN(s,D,d,e,g),N(!1)}catch(V){console.error("Error generating PDF report:",V),alert("Error generating PDF report. Please try again.")}};return l?i.jsx("div",{className:`${t==="dark"?"bg-[#111418]":"bg-gray-50"} ${t==="dark"?"text-white":"text-gray-900"} font-['Inter'] h-screen flex items-center justify-center`,children:i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"flex gap-3",children:[0,1,2,3].map(V=>i.jsx("div",{className:"w-4 h-12 bg-[#136dec] rounded-full animate-pulse",style:{animationDelay:`${V*.15}s`}},V))}),i.jsx("p",{className:`${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Loading analytics..."})]})}):i.jsxs("div",{className:`flex h-screen w-full ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${t==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsxs("header",{className:`border-b ${t==="dark"?"border-[#282f39]":"border-gray-200"} ${t==="dark"?"bg-[#111418]":"bg-gray-50"} shrink-0`,children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between px-3 sm:px-6 py-3 sm:py-4 gap-3 sm:gap-0",children:[i.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 flex-1 min-w-0",children:[i.jsx("button",{onClick:r,className:`lg:hidden flex-shrink-0 ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("h2",{className:`${t==="dark"?"text-white":"text-gray-900"} text-base sm:text-lg md:text-xl font-bold leading-tight truncate`,children:"Analytics & Reports"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs mt-0.5 sm:mt-1 line-clamp-2`,children:(e==null?void 0:e.role)==="member"?"View your personal task statistics":(e==null?void 0:e.role)==="team_lead"?"Overview of your team performance":"Track team performance, task velocity, and operational metrics"})]})]}),["admin","hr"].includes(e==null?void 0:e.role)&&i.jsxs("div",{className:"flex gap-2 sm:gap-3 flex-shrink-0",children:[i.jsxs("button",{onClick:F,className:"flex items-center justify-center rounded h-9 px-3 sm:px-4 bg-green-600 text-white gap-2 text-sm font-bold hover:bg-green-700 transition-colors",title:"Export comprehensive Excel report",children:[i.jsx(Vx,{size:18}),i.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>N(!y),className:"flex items-center justify-center rounded h-9 px-3 sm:px-4 bg-red-600 text-white gap-2 text-sm font-bold hover:bg-red-700 transition-colors",title:"Export PDF report",children:[i.jsx(Su,{size:18}),i.jsx("span",{className:"hidden sm:inline",children:"PDF"}),i.jsx(wi,{size:16,className:"hidden sm:block"})]}),y&&i.jsx("div",{className:`absolute right-0 mt-2 w-56 rounded ${t==="dark"?"bg-[#1c2027]":"bg-white"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"} shadow-lg z-10`,children:i.jsxs("div",{className:"py-1",children:[i.jsx("div",{className:`px-4 py-2 text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Report Period"}),i.jsx("button",{onClick:()=>{b("daily"),ne()},className:`block w-full text-left px-4 py-2 text-sm ${t==="dark"?"text-white":"text-gray-900"} ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"} transition-colors`,children:"Daily Report (Today)"}),i.jsx("button",{onClick:()=>{b("weekly"),ne()},className:`block w-full text-left px-4 py-2 text-sm ${t==="dark"?"text-white":"text-gray-900"} ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"} transition-colors`,children:"Weekly Report (Last 7 Days)"}),i.jsx("button",{onClick:()=>{b("monthly"),ne()},className:`block w-full text-left px-4 py-2 text-sm ${t==="dark"?"text-white":"text-gray-900"} ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"} transition-colors`,children:"Monthly Report (This Month)"}),i.jsx("button",{onClick:()=>{b("all"),ne()},className:`block w-full text-left px-4 py-2 text-sm ${t==="dark"?"text-white":"text-gray-900"} ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"} transition-colors`,children:"Complete Report (All Time)"})]})})]})]})]}),i.jsxs("div",{className:"px-3 sm:px-6 pb-3 sm:pb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[i.jsxs("button",{onClick:()=>_(!S),className:"flex items-center gap-2 sm:hover:bg-[#282f39]/30 sm:px-2 sm:py-1 sm:rounded transition-colors lg:pointer-events-none",children:[i.jsx(zl,{size:14,className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`}),i.jsx("span",{className:`text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Filters"}),i.jsx(wi,{size:16,className:`lg:hidden transition-transform ${S?"rotate-180":""} ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`})]}),S&&i.jsx("button",{onClick:()=>u({status:"",priority:"",team:"",user:"",dateRange:"all",customStartDate:"",customEndDate:""}),className:"text-[10px] sm:text-xs text-[#136dec] hover:text-blue-400 font-medium",children:"Reset All"})]}),i.jsxs("div",{className:`grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-3 transition-all duration-300 overflow-hidden ${S?"max-h-[500px] opacity-100":"max-h-0 opacity-0 lg:max-h-[500px] lg:opacity-100"}`,children:[i.jsxs("select",{value:d.status,onChange:V=>u({...d,status:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"}),i.jsx("option",{value:"archived",children:"Archived"})]}),i.jsxs("select",{value:d.priority,onChange:V=>u({...d,priority:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Priority"}),i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]}),(e==null?void 0:e.role)!=="member"&&i.jsxs(i.Fragment,{children:[i.jsxs("select",{value:d.dateRange,onChange:V=>u({...d,dateRange:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"all",children:"All Time"}),i.jsx("option",{value:"today",children:"Today"}),i.jsx("option",{value:"week",children:"Last 7 Days"}),i.jsx("option",{value:"month",children:"This Month"}),i.jsx("option",{value:"custom",children:"Custom"})]}),i.jsxs("select",{value:d.team,onChange:V=>u({...d,team:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Teams"}),h.map(V=>i.jsx("option",{value:V._id,children:V.name},V._id))]}),i.jsxs("select",{value:d.user,onChange:V=>u({...d,user:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Users"}),i.jsx("option",{value:"unassigned",children:"Unassigned"}),f.map(V=>i.jsx("option",{value:V._id,children:V.full_name},V._id))]})]})]}),d.dateRange==="custom"&&S&&i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 mt-2 sm:mt-3 lg:block lg:grid",children:[i.jsx("input",{type:"date",value:d.customStartDate,onChange:V=>u({...d,customStartDate:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`}),i.jsx("input",{type:"date",value:d.customEndDate,onChange:V=>u({...d,customEndDate:V.target.value}),className:`h-9 px-2 sm:px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-xs sm:text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-auto p-3 sm:p-6",children:[i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[i.jsx("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-4`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-2",children:[i.jsxs("div",{className:"w-full",children:[i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs uppercase tracking-wider font-medium`,children:"Total Tasks"}),i.jsx("p",{className:`text-2xl sm:text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"} mt-1 sm:mt-2`,children:D.totalTasks})]}),i.jsx(zx,{className:"text-[#136dec] hidden sm:block",size:40})]})}),i.jsx("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-4`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-2",children:[i.jsxs("div",{className:"w-full",children:[i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs uppercase tracking-wider font-medium`,children:"Overdue"}),i.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-red-500 mt-1 sm:mt-2",children:D.overdueTasks})]}),i.jsx(ku,{className:"text-red-500 hidden sm:block",size:40})]})}),i.jsx("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-4`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-2",children:[i.jsxs("div",{className:"w-full",children:[i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs uppercase tracking-wider font-medium`,children:"Completed"}),i.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-green-500 mt-1 sm:mt-2",children:D.completedTasks})]}),i.jsx(Qc,{className:"text-green-500 hidden sm:block",size:40})]})}),i.jsx("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-4`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-2",children:[i.jsxs("div",{className:"w-full",children:[i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-[10px] sm:text-xs uppercase tracking-wider font-medium`,children:"In Progress"}),i.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-yellow-500 mt-1 sm:mt-2",children:D.inProgressTasks})]}),i.jsx(Zc,{className:"text-yellow-500 hidden sm:block",size:40})]})})]}),(e==null?void 0:e.role)!=="member"&&i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Task Status Distribution"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(M5,{children:[i.jsx(I5,{data:D.statusDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({name:V,percent:ee})=>window.innerWidth<640?`${(ee*100).toFixed(0)}%`:`${V} ${(ee*100).toFixed(0)}%`,outerRadius:"55%",fill:"#8884d8",dataKey:"value",children:D.statusDistribution.map((V,ee)=>i.jsx(t0,{fill:V.color},`cell-${ee}`))}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}})]})})})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Task Priority Distribution"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(Ki,{data:D.priorityDistribution,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"name",stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"value",fill:"#136dec"})]})})})]})]}),["admin","hr"].includes(e==null?void 0:e.role)&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:"text-xs sm:text-sm font-bold text-red-500 uppercase tracking-wider mb-3 sm:mb-4",children:"Overdue Tasks by Priority"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(Ki,{data:D.overdueByPriority,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"name",stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"value",fill:"#ef4444"})]})})})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Completion Trend (30 Days)"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(fv,{data:D.completionTrend,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"date",stroke:"#9da8b9",tick:{fontSize:7},angle:-60,textAnchor:"end",height:50}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:9}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(wc,{type:"monotone",dataKey:"created",stackId:"1",stroke:"#136dec",fill:"#136dec"}),i.jsx(wc,{type:"monotone",dataKey:"completed",stackId:"2",stroke:"#22c55e",fill:"#22c55e"})]})})})]})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6 mb-4 sm:mb-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"User Performance"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.5,minWidth:200,children:i.jsxs(Ki,{data:D.assigneePerformance,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"name",stroke:"#9da8b9",tick:{fontSize:7},angle:-60,textAnchor:"end",height:70}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"total",fill:"#136dec",name:"Total Tasks"}),i.jsx(Ys,{dataKey:"completed",fill:"#22c55e",name:"Completed"}),i.jsx(Ys,{dataKey:"overdue",fill:"#ef4444",name:"Overdue"})]})})})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6 mb-4 sm:mb-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Tasks by Team"}),D.teamDistribution&&D.teamDistribution.length>0?i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.5,minWidth:200,children:i.jsxs(Ki,{data:D.teamDistribution,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"name",stroke:"#9da8b9",tick:{fontSize:7},angle:-60,textAnchor:"end",height:80,interval:0}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"value",fill:"#22c55e",name:"Tasks",children:D.teamDistribution.map((V,ee)=>i.jsx(t0,{fill:`hsl(${ee*40}, 70%, 50%)`},`cell-${ee}`))})]})})}):i.jsx("p",{className:`text-center py-8 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-sm`,children:"No team data available"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Weekly Progress (Last 8 Weeks)"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(z6,{data:D.weeklyProgress,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"week",stroke:"#9da8b9",tick:{fontSize:9}}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(yp,{wrapperStyle:{fontSize:"11px"}}),i.jsx(wp,{type:"monotone",dataKey:"completed",stroke:"#22c55e",strokeWidth:2,name:"Completed"}),i.jsx(wp,{type:"monotone",dataKey:"inProgress",stroke:"#136dec",strokeWidth:2,name:"In Progress"}),i.jsx(wp,{type:"monotone",dataKey:"todo",stroke:"#6b7280",strokeWidth:2,name:"To Do"})]})})})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Task Creation by Hour"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(Ki,{data:D.hourlyDistribution,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"hour",stroke:"#9da8b9",tick:{fontSize:6},angle:-60,textAnchor:"end",height:55}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:10}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"count",fill:"#f59e0b",name:"Tasks Created"})]})})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-4 sm:mb-6",children:[i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Open Task Age Distribution"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(Ki,{data:D.taskAgeDistribution,layout:"vertical",children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{type:"number",stroke:"#9da8b9",tick:{fontSize:9}}),i.jsx(vs,{dataKey:"range",type:"category",stroke:"#9da8b9",tick:{fontSize:8},width:60}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(Ys,{dataKey:"count",fill:"#8b5cf6",name:"Tasks"})]})})})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-3 sm:p-6`,children:[i.jsx("h3",{className:`text-xs sm:text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-3 sm:mb-4`,children:"Priority Trend (12 Weeks)"}),i.jsx("div",{style:{width:"100%",minWidth:"200px"},children:i.jsx(Aa,{width:"100%",aspect:1.8,minWidth:200,children:i.jsxs(fv,{data:D.priorityTrend,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"week",stroke:"#9da8b9",tick:{fontSize:8}}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:9}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.5rem"}}),i.jsx(yp,{wrapperStyle:{fontSize:"9px"}}),i.jsx(wc,{type:"monotone",dataKey:"urgent",stackId:"1",stroke:"#ef4444",fill:"#ef4444",name:"Urgent"}),i.jsx(wc,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f97316",fill:"#f97316",name:"High"}),i.jsx(wc,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#f59e0b",fill:"#f59e0b",name:"Medium"}),i.jsx(wc,{type:"monotone",dataKey:"low",stackId:"1",stroke:"#10b981",fill:"#10b981",name:"Low"})]})})})]})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-6 mb-6`,children:[i.jsx("h3",{className:`text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider mb-4`,children:"Team Completion Rate"}),i.jsx(Aa,{width:"100%",height:350,minWidth:200,minHeight:350,children:i.jsxs(Ki,{data:D.completionRateByTeam,children:[i.jsx(gs,{strokeDasharray:"3 3",stroke:"#282f39"}),i.jsx(xs,{dataKey:"team",stroke:"#9da8b9",tick:{fontSize:10},angle:-45,textAnchor:"end",height:100}),i.jsx(vs,{stroke:"#9da8b9",tick:{fontSize:11},label:{value:"Completion Rate %",angle:-90,position:"insideLeft"}}),i.jsx(Ea,{contentStyle:{backgroundColor:"#1c2027",border:"1px solid #282f39",borderRadius:"0.125rem"},formatter:(V,ee,me)=>ee==="rate"?[`${V}%`,"Completion Rate"]:[V,ee]}),i.jsx(yp,{}),i.jsx(Ys,{dataKey:"rate",fill:"#06b6d4",name:"Completion Rate %"})]})})]})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} overflow-hidden`,children:[i.jsx("div",{className:`p-4 border-b ${t==="dark"?"border-[#282f39]":"border-gray-200"}`,children:i.jsx("h3",{className:`text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:d.status||d.priority||d.team||d.user||d.dateRange!=="all"?`Filtered Tasks (${s.length})`:`All Tasks (${s.length})`})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:`${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("tr",{children:[i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Task"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Status"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Priority"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider hidden lg:table-cell`,children:"Assigned"}),i.jsx("th",{className:`px-4 py-3 text-left text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider`,children:"Due Date"})]})}),i.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-[#282f39]":"divide-gray-200"}`,children:s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:`px-4 py-8 text-center ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"No tasks found matching the selected filters"})}):s.slice(0,50).map(V=>{const ee=V.due_date&&new Date(V.due_date)<new Date&&V.status!=="done";return i.jsxs("tr",{className:`${ee?"bg-red-900/10":""} ${t==="dark"?"hover:bg-[#282f39]/50":"hover:bg-gray-50"} transition-colors`,children:[i.jsxs("td",{className:"px-4 py-3",children:[i.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:V.title}),i.jsx("div",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} truncate max-w-xs`,children:V.description})]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded ${V.status==="done"?"bg-green-500/20 text-green-400":V.status==="in_progress"?"bg-blue-500/20 text-blue-400":V.status==="review"?"bg-yellow-500/20 text-yellow-400":"bg-slate-500/20 text-slate-300"}`,children:V.status.replace("_"," ")})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded",style:{backgroundColor:U(V.priority)+"20",color:U(V.priority)},children:V.priority})}),i.jsx("td",{className:`px-4 py-3 text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} hidden lg:table-cell`,children:V.assigned_to&&V.assigned_to.length>0?V.assigned_to.map(me=>me.full_name).join(", "):"Unassigned"}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:`text-sm flex items-center gap-2 ${ee?"text-red-400":`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`}`,children:[ee&&i.jsx(ku,{size:16}),V.due_date?new Date(V.due_date).toLocaleDateString():"No date"]})})]},V._id)})})]})})]})]})]})]})},PR=()=>{var f;const{theme:e,colorScheme:t,toggleTheme:r,setThemeMode:n,setColorSchemeMode:a,themes:s,colorSchemes:o}=Lr(),[l,c]=J.useState(!1),[d,u]=J.useState(!1),h=()=>{switch(e){case"light":return i.jsx(Dp,{className:"w-5 h-5"});case"dark":return i.jsx(Mv,{className:"w-5 h-5"});case"auto":return i.jsx(Wg,{className:"w-5 h-5"});default:return i.jsx(Dp,{className:"w-5 h-5"})}},m=()=>{var x;return((x=s[e])==null?void 0:x.name)||"Light"};return i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Change theme",children:[h(),i.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:m()}),i.jsx(wi,{className:"w-4 h-4 text-gray-500"})]}),l&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),i.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 z-50",children:i.jsx("div",{className:"py-1",children:Object.entries(s).map(([x,g])=>i.jsxs("button",{onClick:()=>{n(x),c(!1)},className:`w-full flex items-center space-x-3 px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${e===x?"bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"}`,children:[x==="light"&&i.jsx(Dp,{className:"w-4 h-4"}),x==="dark"&&i.jsx(Mv,{className:"w-4 h-4"}),x==="auto"&&i.jsx(Wg,{className:"w-4 h-4"}),i.jsx("span",{children:g.name})]},x))})})]})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>u(!d),className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Change color scheme",children:[i.jsx(P4,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),i.jsx("div",{className:`w-4 h-4 rounded-full ${((f=o[t])==null?void 0:f.primary)||"bg-blue-500"}`}),i.jsx(wi,{className:"w-4 h-4 text-gray-500"})]}),d&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>u(!1)}),i.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 z-50",children:i.jsx("div",{className:"py-1",children:Object.entries(o).map(([x,g])=>i.jsxs("button",{onClick:()=>{a(x),u(!1)},className:`w-full flex items-center space-x-3 px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${t===x?"bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"}`,children:[i.jsx("div",{className:`w-4 h-4 rounded-full ${g.primary}`}),i.jsx("span",{children:g.name})]},x))})})]})]}),i.jsx("button",{onClick:r,className:"p-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Toggle theme",children:h()})]})},LR=()=>{var u,h;const{currentTheme:e}=Lr(),[t,r]=J.useState("default"),[n,a]=J.useState(!0),[s,o]=J.useState({taskAssigned:!0,taskUpdated:!0,taskDue:!0,taskOverdue:!0,newComment:!0,taskCreated:!0});J.useEffect(()=>{a(es.isNotificationSupported()),r(es.getPermissionStatus());const m=localStorage.getItem("notificationSettings");m&&o(JSON.parse(m))},[]);const l=async()=>{const m=await es.requestPermission();r(m)},c=m=>{const f={...s,[m]:!s[m]};o(f),localStorage.setItem("notificationSettings",JSON.stringify(f))},d=async()=>{try{if(Notification.permission!=="granted"){alert('âš ï¸ Please enable notifications first by clicking "Enable Notifications" button.');return}await es.showNotification("ðŸŽ‰ Test Notification",{body:"If you can see this, notifications are working perfectly!",icon:"/icons/pwa-192x192.png",badge:"/icons/pwa-64x64.png",tag:"test",requireInteraction:!1,vibrate:[200,100,200]});const f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?`âœ… Test notification sent!

ðŸ“± On mobile:
- Check your notification tray
- Ensure Do Not Disturb is off
- For iOS: Add to Home Screen first`:"âœ… Test notification sent! Check your desktop for the notification.";alert(f)}catch(m){console.error("âŒ Error showing test notification:",m),alert(`âŒ Error showing notification:
${m.message}

Check browser console for details.`)}};return n?i.jsxs("div",{className:`${e.surface} rounded-lg p-4 sm:p-6 shadow-md`,children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx(Jc,{className:`w-5 h-5 sm:w-6 sm:h-6 ${e.textSecondary}`}),i.jsx("h3",{className:`text-base sm:text-lg font-semibold ${e.text}`,children:"Notification Settings"})]}),i.jsx("div",{className:`mb-6 p-3 sm:p-4 rounded-lg ${e.surfaceSecondary}`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:`font-medium ${e.text} text-sm sm:text-base`,children:"Permission Status"}),i.jsxs("p",{className:`text-xs sm:text-sm ${e.textSecondary} mt-1`,children:[t==="granted"&&"âœ… Notifications are enabled",t==="denied"&&"âŒ Notifications are blocked",t==="default"&&"âš ï¸ Notification permission not requested"]})]}),t!=="granted"&&i.jsx("button",{onClick:l,className:"btn bg-blue-600 text-white hover:bg-blue-700 text-sm px-4 py-2 w-full sm:w-auto",children:"Enable Notifications"}),t==="granted"&&i.jsx("button",{onClick:d,className:"btn bg-green-600 text-white hover:bg-green-700 text-sm px-4 py-2 w-full sm:w-auto",children:"Test Notification"})]})}),t==="granted"&&i.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[i.jsx("h4",{className:`font-medium ${e.text} text-sm sm:text-base`,children:"Notification Preferences"}),i.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[i.jsx(Ac,{label:"Task Assigned to Me",description:"Get notified when a task is assigned to you",checked:s.taskAssigned,onChange:()=>c("taskAssigned"),currentTheme:e}),i.jsx(Ac,{label:"Task Updates",description:"Get notified when a task you're involved in is updated",checked:s.taskUpdated,onChange:()=>c("taskUpdated"),currentTheme:e}),i.jsx(Ac,{label:"Task Due Soon",description:"Get notified when a task is due within 24 hours",checked:s.taskDue,onChange:()=>c("taskDue"),currentTheme:e}),i.jsx(Ac,{label:"Overdue Tasks",description:"Get notified about overdue tasks",checked:s.taskOverdue,onChange:()=>c("taskOverdue"),currentTheme:e}),i.jsx(Ac,{label:"New Comments",description:"Get notified when someone comments on your tasks",checked:s.newComment,onChange:()=>c("newComment"),currentTheme:e}),i.jsx(Ac,{label:"New Task Created",description:"Get notified when a new task is created (for admins/team leads)",checked:s.taskCreated,onChange:()=>c("taskCreated"),currentTheme:e})]})]}),t==="denied"&&i.jsxs("div",{className:"mt-4 p-3 sm:p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:[i.jsxs("p",{className:`text-xs sm:text-sm ${e.text}`,children:[i.jsx("strong",{children:"Notifications are blocked."})," To enable notifications, you need to update your browser settings:"]}),i.jsxs("ul",{className:`list-disc list-inside mt-2 text-xs sm:text-sm ${e.textSecondary} space-y-1`,children:[i.jsx("li",{children:"Click the lock/info icon in your browser's address bar"}),i.jsx("li",{children:"Find the Notifications setting"}),i.jsx("li",{children:'Change it to "Allow"'}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsxs("div",{className:"mt-4 p-3 sm:p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[i.jsx("p",{className:`text-xs sm:text-sm font-medium ${e.text} mb-2`,children:"ðŸ“± Mobile Device Tips"}),i.jsxs("ul",{className:`list-disc list-inside text-xs sm:text-sm ${e.textSecondary} space-y-1`,children:[i.jsxs("li",{children:[i.jsx("strong",{children:"iOS:"})," Add TaskFlow to Home Screen for notifications to work"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Android:"})," Ensure notifications are allowed in browser settings"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"All devices:"})," Check that Do Not Disturb mode is off"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"HTTPS required:"})," Notifications only work on secure connections"]})]})]}),i.jsx("div",{className:`mt-4 p-3 rounded-lg ${e.surfaceSecondary}`,children:i.jsxs("details",{children:[i.jsx("summary",{className:`text-xs sm:text-sm font-medium ${e.text} cursor-pointer`,children:"ðŸ”§ Technical Details (for debugging)"}),i.jsxs("div",{className:`mt-3 text-xs ${e.textSecondary} space-y-1 font-mono`,children:[i.jsxs("div",{children:["Browser: ",((u=navigator.userAgent.match(/Chrome|Safari|Firefox|Edge/))==null?void 0:u[0])||"Unknown"]}),i.jsxs("div",{children:["Mobile: ",/Android|webOS|iPhone|iPad|iPod/i.test(navigator.userAgent)?"Yes":"No"]}),i.jsxs("div",{children:["HTTPS: ",window.location.protocol==="https:"?"âœ… Yes":"âŒ No (required!)"]}),i.jsxs("div",{children:["Service Worker: ","serviceWorker"in navigator?"âœ… Supported":"âŒ Not supported"]}),i.jsxs("div",{children:["SW Active: ",(h=navigator.serviceWorker)!=null&&h.controller?"âœ… Yes":"âš ï¸ No"]}),i.jsxs("div",{children:["Permission API: ","permissions"in navigator?"âœ… Available":"âŒ Not available"]})]})]})})]}):i.jsxs("div",{className:`${e.surface} rounded-lg p-6 shadow-md`,children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx(jT,{className:`w-6 h-6 ${e.textSecondary}`}),i.jsx("h3",{className:`text-lg font-semibold ${e.text}`,children:"Notifications Not Supported"})]}),i.jsx("p",{className:`${e.textSecondary}`,children:"Your browser doesn't support notifications. Please use a modern browser like Chrome, Firefox, or Edge."})]})},Ac=({label:e,description:t,checked:r,onChange:n,currentTheme:a})=>i.jsxs("div",{className:`flex items-start space-x-3 p-3 rounded-lg ${a.surfaceSecondary}`,children:[i.jsx("button",{onClick:n,className:`flex-shrink-0 mt-0.5 w-10 h-6 sm:w-12 sm:h-7 rounded-full transition-colors ${r?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`,children:i.jsx("div",{className:`w-5 h-5 sm:w-6 sm:h-6 bg-white rounded-full shadow-md transform transition-transform ${r?"translate-x-4 sm:translate-x-5":"translate-x-0.5"}`,children:r&&i.jsx(E4,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 p-0.5"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`font-medium ${a.text} text-sm sm:text-base`,children:e}),i.jsx("p",{className:`text-xs sm:text-sm ${a.textSecondary} mt-0.5`,children:t})]})]}),FR=()=>{var F,ne,V;const e=Cs(),{user:t,updateUser:r,logout:n}=pn(),{theme:a}=Lr(),{toggleMobileSidebar:s}=Mn(),o=tl(),l=J.useRef(null),[c,d]=J.useState(!1),[u,h]=J.useState(!1),[m,f]=J.useState(!1),[x,g]=J.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[b,y]=J.useState({type:"",text:""}),[N,S]=J.useState(!1),[_,D]=J.useState(!1),[I,O]=J.useState({type:"",text:""}),R=async ee=>{var Oe;const me=(Oe=ee.target.files)==null?void 0:Oe[0];if(!me)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(me.type)){O({type:"error",text:"Please upload a valid image (JPEG, PNG, GIF, or WebP)"});return}if(me.size>2*1024*1024){O({type:"error",text:"Image too large. Maximum size is 2MB."});return}D(!0),O({type:"",text:""});try{const xe=new FileReader;xe.onloadend=async()=>{var w,A;try{const T=xe.result,L=await it.post("/users/me/profile-picture",{profile_picture:T});r({profile_picture:L.data.user.profile_picture}),O({type:"success",text:"Profile picture updated successfully!"})}catch(T){O({type:"error",text:((A=(w=T.response)==null?void 0:w.data)==null?void 0:A.message)||"Failed to upload profile picture"})}finally{D(!1)}},xe.onerror=()=>{O({type:"error",text:"Failed to read the image file"}),D(!1)},xe.readAsDataURL(me)}catch{O({type:"error",text:"Failed to process the image"}),D(!1)}l.current&&(l.current.value="")},E=async()=>{var ee,me;if(t!=null&&t.profile_picture){D(!0),O({type:"",text:""});try{await it.delete("/users/me/profile-picture"),r({profile_picture:null}),O({type:"success",text:"Profile picture removed successfully!"})}catch(ye){O({type:"error",text:((me=(ee=ye.response)==null?void 0:ee.data)==null?void 0:me.message)||"Failed to remove profile picture"})}finally{D(!1)}}},B=ee=>{if(!ee)return"U";const me=ee.trim().split(" ");return me.length>=2?(me[0][0]+me[me.length-1][0]).toUpperCase():ee.substring(0,2).toUpperCase()},C=ee=>{const me=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-cyan-500"];let ye=0;for(let Oe=0;Oe<(ee||"").length;Oe++)ye=ee.charCodeAt(Oe)+((ye<<5)-ye);return me[Math.abs(ye)%me.length]},M=async ee=>{var me,ye;if(ee.preventDefault(),y({type:"",text:""}),x.newPassword!==x.confirmPassword){y({type:"error",text:"New passwords do not match"});return}if(x.newPassword.length<6){y({type:"error",text:"Password must be at least 6 characters long"});return}S(!0);try{const Oe=await it.post("/users/me/change-password",{oldPassword:x.oldPassword,newPassword:x.newPassword});y({type:"success",text:Oe.data.message}),g({oldPassword:"",newPassword:"",confirmPassword:""})}catch(Oe){y({type:"error",text:((ye=(me=Oe.response)==null?void 0:me.data)==null?void 0:ye.message)||"Failed to change password"})}finally{S(!1)}},U=async()=>{var ee,me,ye,Oe,xe;console.log("ðŸ—‘ï¸ Delete workspace initiated");try{const w=await o.show({title:"Delete Workspace & Account",message:`Are you absolutely sure you want to delete your workspace "${(ee=t==null?void 0:t.workspace)==null?void 0:ee.name}"?

This will PERMANENTLY DELETE:
â€¢ Your account
â€¢ All users in this workspace
â€¢ All tasks and projects
â€¢ All teams
â€¢ All data and settings

This action cannot be undone!`,confirmText:"Yes, Delete Everything",variant:"danger"});if(console.log("First confirmation result:",w),!w){console.log("User cancelled first confirmation");return}const A=await o.show({title:"âš ï¸ FINAL WARNING",message:`Last chance to change your mind!

Clicking "Confirm Deletion" will PERMANENTLY and IRREVERSIBLY delete:

â€¢ Workspace: ${(me=t==null?void 0:t.workspace)==null?void 0:me.name}
â€¢ Your account: ${t==null?void 0:t.email}
â€¢ ${((ye=t==null?void 0:t.workspace)==null?void 0:ye.type)==="COMMUNITY"?"All community":"All"} data

There is NO way to recover this data!`,confirmText:"Confirm Deletion",variant:"danger"});if(console.log("Second confirmation result:",A),!A){console.log("User cancelled second confirmation");return}console.log("âœ… Both confirmations passed, deleting workspace...");const T=await it.delete("/workspaces/my-workspace/delete");console.log("Delete response:",T.data),await n(),e("/",{state:{message:"Your workspace and account have been permanently deleted."}})}catch(w){console.error("âŒ Delete workspace error:",w),alert(((xe=(Oe=w.response)==null?void 0:Oe.data)==null?void 0:xe.message)||"Failed to delete workspace. Please contact support.")}};return i.jsxs("div",{className:`flex h-screen w-full ${a==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${a==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsx("header",{className:`border-b ${a==="dark"?"border-[#282f39] bg-[#111418]":"border-gray-200 bg-white"} shrink-0`,children:i.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:s,className:`lg:hidden ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsx("h2",{className:`${a==="dark"?"text-white":"text-gray-900"} text-xl font-bold leading-tight`,children:"Settings"}),i.jsx("p",{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs mt-1`,children:"Customize your TaskFlow experience"})]})]})})}),i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx(ji,{className:"text-[#136dec]",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Profile"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-3`,children:"Profile Picture"}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"relative",children:[t!=null&&t.profile_picture?i.jsx("img",{src:t.profile_picture,alt:(t==null?void 0:t.full_name)||"User",className:"w-24 h-24 rounded-full object-cover border-4 border-[#136dec]"}):i.jsx("div",{className:`w-24 h-24 rounded-full ${C(t==null?void 0:t.full_name)} flex items-center justify-center text-white text-2xl font-bold border-4 border-[#136dec]`,children:B(t==null?void 0:t.full_name)}),_&&i.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:R,className:"hidden",id:"profile-picture-input"}),i.jsxs("button",{type:"button",onClick:()=>{var ee;return(ee=l.current)==null?void 0:ee.click()},disabled:_,className:"flex items-center gap-2 px-4 py-2 bg-[#136dec] text-white rounded hover:bg-[#1158c7] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(L4,{size:16}),i.jsx("span",{children:t!=null&&t.profile_picture?"Change Picture":"Upload Picture"})]}),(t==null?void 0:t.profile_picture)&&i.jsxs("button",{type:"button",onClick:E,disabled:_,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(ua,{size:16}),i.jsx("span",{children:"Remove"})]}),i.jsx("p",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-500"}`,children:"JPEG, PNG, GIF or WebP. Max 2MB."})]})]}),I.text&&i.jsx("div",{className:`mt-3 p-3 rounded border ${I.type==="success"?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:I.text})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Full Name"}),i.jsx("input",{type:"text",value:(t==null?void 0:t.full_name)||"",readOnly:!0,className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Email"}),i.jsx("input",{type:"email",value:(t==null?void 0:t.email)||"",readOnly:!0,className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Role"}),i.jsx("input",{type:"text",value:((F=t==null?void 0:t.role)==null?void 0:F.replace("_"," "))||"",readOnly:!0,className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded capitalize`})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Member Since"}),i.jsx("input",{type:"text",value:t!=null&&t.created_at?new Date(t.created_at).toLocaleDateString():"",readOnly:!0,className:`w-full px-3 py-2 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-gray-50 border-gray-300 text-gray-900"} border rounded`})]})]})]}),i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx(Gx,{className:"text-[#136dec]",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Security"})]}),i.jsxs("form",{onSubmit:M,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Current Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:c?"text":"password",value:x.oldPassword,onChange:ee=>g({...x,oldPassword:ee.target.value}),className:`w-full px-3 py-2 pr-10 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0}),i.jsx("button",{type:"button",onClick:()=>d(!c),className:`absolute right-2 top-1/2 -translate-y-1/2 ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:c?i.jsx(to,{size:20}):i.jsx(js,{size:20})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:u?"text":"password",value:x.newPassword,onChange:ee=>g({...x,newPassword:ee.target.value}),className:`w-full px-3 py-2 pr-10 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,minLength:6}),i.jsx("button",{type:"button",onClick:()=>h(!u),className:`absolute right-2 top-1/2 -translate-y-1/2 ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:u?i.jsx(to,{size:20}):i.jsx(js,{size:20})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-bold ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Confirm New Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:m?"text":"password",value:x.confirmPassword,onChange:ee=>g({...x,confirmPassword:ee.target.value}),className:`w-full px-3 py-2 pr-10 ${a==="dark"?"bg-[#111418] border-[#282f39] text-white":"bg-white border-gray-300 text-gray-900"} border rounded focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,required:!0,minLength:6}),i.jsx("button",{type:"button",onClick:()=>f(!m),className:`absolute right-2 top-1/2 -translate-y-1/2 ${a==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:m?i.jsx(to,{size:20}):i.jsx(js,{size:20})})]})]}),b.text&&i.jsx("div",{className:`p-3 rounded border ${b.type==="success"?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:b.text}),i.jsx("button",{type:"submit",disabled:N,className:"w-full bg-[#136dec] hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Changing Password...":"Change Password"})]})]}),i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx(P4,{className:"text-[#136dec]",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Appearance"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:`text-sm font-semibold ${a==="dark"?"text-white":"text-gray-900"} mb-4`,children:"Theme & Color Scheme"}),i.jsx("p",{className:`text-sm ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-4`,children:"Customize how TaskFlow looks and feels. Changes are saved automatically."}),i.jsx(PR,{})]}),i.jsx("div",{className:`border-t ${a==="dark"?"border-[#282f39]":"border-gray-200"} pt-6`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Wg,{className:`${a==="dark"?"text-[#9da8b9]":"text-gray-600"}`,size:20}),i.jsxs("div",{children:[i.jsx("h4",{className:`font-medium ${a==="dark"?"text-white":"text-gray-900"} text-sm`,children:"System Integration"}),i.jsx("p",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-1`,children:"Your theme preferences are automatically synced across devices and saved locally."})]})]})})]})]}),i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx(J0,{className:"text-[#136dec]",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Preferences"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:`font-medium ${a==="dark"?"text-white":"text-gray-900"} text-sm`,children:"Email Notifications"}),i.jsx("p",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-1`,children:"Receive email updates about your tasks"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),i.jsx("div",{className:`w-11 h-6 ${a==="dark"?"bg-[#282f39] border-[#3e454f]":"bg-gray-200 border-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all border peer-checked:bg-[#136dec]`})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:`font-medium ${a==="dark"?"text-white":"text-gray-900"} text-sm`,children:"Task Reminders"}),i.jsx("p",{className:`text-xs ${a==="dark"?"text-[#9da8b9]":"text-gray-600"} mt-1`,children:"Get reminded about upcoming due dates"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),i.jsx("div",{className:`w-11 h-6 ${a==="dark"?"bg-[#282f39] border-[#3e454f]":"bg-gray-200 border-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all border peer-checked:bg-[#136dec]`})]})]})]})]}),i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx(Jc,{className:"text-[#136dec]",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Notifications"})]}),i.jsx(LR,{})]}),(t==null?void 0:t.role)==="admin"&&i.jsxs("div",{className:`${a==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx(Ss,{className:"text-yellow-500",size:24}),i.jsx("h3",{className:`text-sm font-bold ${a==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Notification Debug (Admin Only)"})]}),i.jsxs("div",{className:"space-y-2 text-xs font-mono",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("span",{className:a==="dark"?"text-[#9da8b9]":"text-gray-600",children:"Browser Support:"}),i.jsx("span",{className:a==="dark"?"text-white":"text-gray-900",children:"Notification"in window?"âœ… Supported":"âŒ Not Supported"}),i.jsx("span",{className:a==="dark"?"text-[#9da8b9]":"text-gray-600",children:"Permission:"}),i.jsx("span",{className:a==="dark"?"text-white":"text-gray-900",children:typeof Notification<"u"?Notification.permission:"N/A"}),i.jsx("span",{className:a==="dark"?"text-[#9da8b9]":"text-gray-600",children:"Service Worker:"}),i.jsx("span",{className:a==="dark"?"text-white":"text-gray-900",children:"serviceWorker"in navigator?"âœ… Available":"âŒ Not Available"}),i.jsx("span",{className:a==="dark"?"text-[#9da8b9]":"text-gray-600",children:"SW Registered:"}),i.jsx("span",{className:a==="dark"?"text-white":"text-gray-900",children:(ne=navigator.serviceWorker)!=null&&ne.controller?"âœ… Yes":"âš ï¸ No"})]}),i.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded",children:i.jsxs("p",{className:"text-yellow-400 text-xs",children:[i.jsx("strong",{className:"font-bold",children:"Tip:"})," If notifications aren't working, try:",i.jsx("br",{}),"1. Check browser console for errors",i.jsx("br",{}),"2. Verify HTTPS connection (required)",i.jsx("br",{}),"3. Clear browser cache and reload",i.jsx("br",{}),"4. Check browser notification settings"]})})]})]}),(t==null?void 0:t.role)==="community_admin"&&i.jsxs("div",{className:`${a==="dark"?"bg-red-950/20 border-red-900/50":"bg-red-50 border-red-200"} rounded border p-6`,children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx(ku,{className:"text-red-500",size:24}),i.jsx("h3",{className:`text-lg font-bold ${a==="dark"?"text-red-400":"text-red-700"} uppercase tracking-wider`,children:"Danger Zone"})]}),i.jsx("div",{className:`${a==="dark"?"bg-red-950/40 border-red-900":"bg-white border-red-200"} border rounded-lg p-5`,children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(ua,{className:"text-red-500",size:28})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:`font-bold text-base ${a==="dark"?"text-white":"text-gray-900"} mb-2`,children:"Delete Workspace & Account"}),i.jsxs("p",{className:`text-sm ${a==="dark"?"text-gray-300":"text-gray-700"} mb-3 leading-relaxed`,children:['Permanently delete your workspace "',i.jsx("strong",{children:(V=t==null?void 0:t.workspace)==null?void 0:V.name}),'" and your account.']}),i.jsxs("div",{className:`${a==="dark"?"bg-red-950/60":"bg-red-50"} border ${a==="dark"?"border-red-900":"border-red-200"} rounded-lg p-4 mb-4`,children:[i.jsxs("p",{className:`font-semibold ${a==="dark"?"text-red-400":"text-red-700"} mb-2 flex items-center gap-2`,children:[i.jsx(ku,{size:16}),"This action will permanently delete:"]}),i.jsxs("ul",{className:`text-sm ${a==="dark"?"text-gray-300":"text-gray-700"} space-y-1.5 ml-6 list-disc`,children:[i.jsx("li",{children:"Your account and login credentials"}),i.jsx("li",{children:"All users in this workspace"}),i.jsx("li",{children:"All tasks and projects"}),i.jsx("li",{children:"All teams and team members"}),i.jsx("li",{children:"All files and attachments"}),i.jsx("li",{children:"All settings and configurations"}),i.jsx("li",{children:"All activity history and logs"})]}),i.jsx("p",{className:`text-sm ${a==="dark"?"text-red-400":"text-red-700"} mt-3 font-bold`,children:"âš ï¸ This action cannot be undone! All data will be lost forever."})]}),i.jsxs("button",{onClick:U,className:`
                          px-6 py-3 rounded-lg font-semibold text-sm
                          bg-red-600 hover:bg-red-700 text-white
                          transition-all duration-200
                          flex items-center gap-2
                          shadow-lg hover:shadow-xl
                          focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2
                          ${a==="dark"?"focus:ring-offset-[#111418]":"focus:ring-offset-white"}
                        `,children:[i.jsx(ua,{size:18}),"Delete My Workspace & Account"]})]})]})})]})]})})]}),i.jsx(rl,{...o})]})};function $R(e,t){if(Qt(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TN(e){var t=$R(e,"string");return Qt(t)=="symbol"?t:t+""}function Pl(e,t,r){return(t=TN(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(n){Pl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cm(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ai(e,t){if(e==null)return{};var r,n,a=cm(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TN(n.key),n)}}function On(e,t,r){return t&&sw(e.prototype,t),r&&sw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j0(e){return j0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j0(e)}function AN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AN=function(){return!!e})()}function RR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MR(e,t){if(t&&(Qt(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RR(e)}function pa(e,t,r){return t=j0(t),MR(e,AN()?Reflect.construct(t,r||[],j0(e).constructor):t.apply(e,r))}function T0(e,t){return T0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},T0(e,t)}function ga(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T0(e,t)}function EN(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=EN(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function rn(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=EN(e))&&(n&&(n+=" "),n+=t);return n}function en(){return en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},en.apply(null,arguments)}var IR=function(e,t,r,n,a,s,o,l){if(!e){var c;if(t===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,n,a,s,o,l],u=0;c=new Error(t.replace(/%s/g,function(){return d[u++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},BR=IR;const Fu=Ds(BR);var UR=function(){};function WR(e,t){var r={};return Object.keys(e).forEach(function(n){r[Vh(n)]=UR}),r}function iw(e,t){return e[t]!==void 0}function Vh(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function zR(e){return!!e&&(typeof e!="function"||e.prototype&&e.prototype.isReactComponent)}function HR(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,T0(e,t)}function CN(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function DN(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function ON(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}CN.__suppressDeprecationWarning=!0;DN.__suppressDeprecationWarning=!0;ON.__suppressDeprecationWarning=!0;function qR(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var s=e.displayName||e.name,o=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+o+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=CN,t.componentWillReceiveProps=DN),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=ON;var l=t.componentDidUpdate;t.componentDidUpdate=function(d,u,h){var m=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:h;l.call(this,d,u,m)}}return e}var YR="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function PN(e,t,r){r===void 0&&(r=[]);var n=e.displayName||e.name||"Component",a=zR(e),s=Object.keys(t),o=s.map(Vh);a||!r.length||Fu(!1);var l=function(d){HR(u,d);function u(){for(var m,f=arguments.length,x=new Array(f),g=0;g<f;g++)x[g]=arguments[g];m=d.call.apply(d,[this].concat(x))||this,m.handlers=Object.create(null),s.forEach(function(y){var N=t[y],S=function(D){if(m.props[N]){var I;m._notifying=!0;for(var O=arguments.length,R=new Array(O>1?O-1:0),E=1;E<O;E++)R[E-1]=arguments[E];(I=m.props)[N].apply(I,[D].concat(R)),m._notifying=!1}m.unmounted||m.setState(function(B){var C,M=B.values;return{values:en(Object.create(null),M,(C={},C[y]=D,C))}})};m.handlers[N]=S}),r.length&&(m.attachRef=function(y){m.inner=y});var b=Object.create(null);return s.forEach(function(y){b[y]=m.props[Vh(y)]}),m.state={values:b,prevProps:{}},m}var h=u.prototype;return h.shouldComponentUpdate=function(){return!this._notifying},u.getDerivedStateFromProps=function(f,x){var g=x.values,b=x.prevProps,y={values:en(Object.create(null),g),prevProps:{}};return s.forEach(function(N){y.prevProps[N]=f[N],!iw(f,N)&&iw(b,N)&&(y.values[N]=f[Vh(N)])}),y},h.componentWillUnmount=function(){this.unmounted=!0},h.render=function(){var f=this,x=this.props,g=x.innerRef,b=cm(x,["innerRef"]);o.forEach(function(N){delete b[N]});var y={};return s.forEach(function(N){var S=f.props[N];y[N]=S!==void 0?S:f.state.values[N]}),Ce.createElement(e,en({},b,y,this.handlers,{ref:g||this.attachRef}))},u}(Ce.Component);qR(l),l.displayName="Uncontrolled("+n+")",l.propTypes=en({innerRef:function(){}},WR(t)),r.forEach(function(d){l.prototype[d]=function(){var h;return(h=this.inner)[d].apply(h,arguments)}});var c=l;return Ce.forwardRef&&(c=Ce.forwardRef(function(d,u){return Ce.createElement(l,en({},d,{innerRef:u,__source:{fileName:YR,lineNumber:128},__self:this}))}),c.propTypes=l.propTypes),c.ControlledComponent=e,c.deferControlTo=function(d,u,h){return u===void 0&&(u={}),PN(d,en({},t,u),h)},c}var LN={exports:{}},VR="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",GR=VR,KR=GR;function FN(){}function $N(){}$N.resetWarningCache=FN;var XR=function(){function e(n,a,s,o,l,c){if(c!==KR){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:$N,resetWarningCache:FN};return r.PropTypes=r,r};LN.exports=XR();var JR=LN.exports;const ft=Ds(JR);var A0="milliseconds",$u="seconds",Ru="minutes",Mu="hours",Xl="day",td="week",Iu="month",Jl="year",Zl="decade",Ql="century",RN={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},ZR={month:1,year:12,decade:10*12,century:100*12};function QR(e){return[31,eM(e),31,30,31,30,31,31,30,31,30,31]}function eM(e){return e%4===0&&e%100!==0||e%400===0?29:28}function Qs(e,t,r){switch(e=new Date(e),r){case A0:case $u:case Ru:case Mu:case Xl:case td:return tM(e,t*RN[r]);case Iu:case Jl:case Zl:case Ql:return rM(e,t*ZR[r])}throw new TypeError('Invalid units: "'+r+'"')}function tM(e,t){var r=new Date(+e+t);return nM(e,r)}function rM(e,t){var r=e.getFullYear(),n=e.getMonth(),a=e.getDate(),s=r*12+n+t,o=Math.trunc(s/12),l=s%12,c=Math.min(a,QR(o)[l]),d=new Date(e);return d.setFullYear(o),d.setDate(1),d.setMonth(l),d.setDate(c),d}function nM(e,t){var r=e.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-r;return new Date(+t+a*RN.minutes)}function Bu(e,t,r){return Qs(e,-t,r)}function Jn(e,t,r){switch(e=new Date(e),t){case Ql:case Zl:case Jl:e=C0(e,0);case Iu:e=WN(e,1);case td:case Xl:e=zu(e,0);case Mu:e=rd(e,0);case Ru:e=Wu(e,0);case $u:e=Uu(e,0)}return t===Zl&&(e=Bu(e,ec(e)%10,"year")),t===Ql&&(e=Bu(e,ec(e)%100,"year")),t===td&&(e=zN(e,0,r)),e}function E0(e,t,r){switch(e=new Date(e),e=Jn(e,t,r),t){case Ql:case Zl:case Jl:case Iu:case td:e=Qs(e,1,t),e=Bu(e,1,Xl),e.setHours(23,59,59,999);break;case Xl:e.setHours(23,59,59,999);break;case Mu:case Ru:case $u:e=Qs(e,1,t),e=Bu(e,1,A0)}return e}var ff=gd(function(e,t){return e===t}),_1=gd(function(e,t){return e!==t}),dm=gd(function(e,t){return e>t}),hf=gd(function(e,t){return e>=t}),N1=gd(function(e,t){return e<t}),pd=gd(function(e,t){return e<=t});function MN(){return new Date(Math.min.apply(Math,arguments))}function IN(){return new Date(Math.max.apply(Math,arguments))}function BN(e,t,r,n){return n=n||"day",(!t||hf(e,t,n))&&(!r||pd(e,r,n))}var Uu=al("Milliseconds"),Wu=al("Seconds"),rd=al("Minutes"),zu=al("Hours"),UN=al("Day"),WN=al("Date"),C0=al("Month"),ec=al("FullYear");function aM(e,t){return t===void 0?ec(Jn(e,Zl)):Qs(e,t+10,Jl)}function sM(e,t){return t===void 0?ec(Jn(e,Ql)):Qs(e,t+100,Jl)}function zN(e,t,r){var n=(UN(e)+7-(r||0))%7;return t===void 0?n:Qs(e,t-n,Xl)}function iM(e,t,r,n){var a,s,o;switch(r){case A0:case $u:case Ru:case Mu:case Xl:case td:a=t.getTime()-e.getTime();break;case Iu:case Jl:case Zl:case Ql:a=(ec(t)-ec(e))*12+C0(t)-C0(e);break;default:throw new TypeError('Invalid units: "'+r+'"')}switch(r){case A0:s=1;break;case $u:s=1e3;break;case Ru:s=1e3*60;break;case Mu:s=1e3*60*60;break;case Xl:s=1e3*60*60*24;break;case td:s=1e3*60*60*24*7;break;case Iu:s=1;break;case Jl:s=12;break;case Zl:s=120;break;case Ql:s=1200;break;default:throw new TypeError('Invalid units: "'+r+'"')}return o=a/s,n?o:Math.round(o)}function al(e){var t=function(r){switch(r){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(e);return function(r,n){if(n===void 0)return r["get"+e]();var a=new Date(r);return a["set"+e](n),t&&a["get"+e]()!=n&&(e==="Hours"||n>=t&&a.getHours()-r.getHours()<Math.floor(n/t))&&a["set"+e](n+t),a}}function gd(e){return function(t,r,n){return e(+Jn(t,n),+Jn(r,n))}}const ow=Object.freeze(Object.defineProperty({__proto__:null,add:Qs,century:sM,date:WN,day:UN,decade:aM,diff:iM,endOf:E0,eq:ff,gt:dm,gte:hf,hours:zu,inRange:BN,lt:N1,lte:pd,max:IN,milliseconds:Uu,min:MN,minutes:rd,month:C0,neq:_1,seconds:Wu,startOf:Jn,subtract:Bu,weekday:zN,year:ec},Symbol.toStringTag,{value:"Module"}));function oM(e){if(Array.isArray(e))return Zg(e)}function HN(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gh(e){return oM(e)||HN(e)||b1(e)||lM()}function cM(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}var qN=cM;function dM(e,t){return e===t||e!==e&&t!==t}var mf=dM,uM=typeof Ns=="object"&&Ns&&Ns.Object===Object&&Ns,YN=uM,fM=YN,hM=typeof self=="object"&&self&&self.Object===Object&&self,mM=fM||hM||Function("return this")(),Di=mM,pM=Di,gM=pM.Symbol,xd=gM,lw=xd,VN=Object.prototype,xM=VN.hasOwnProperty,vM=VN.toString,au=lw?lw.toStringTag:void 0;function bM(e){var t=xM.call(e,au),r=e[au];try{e[au]=void 0;var n=!0}catch{}var a=vM.call(e);return n&&(t?e[au]=r:delete e[au]),a}var yM=bM,wM=Object.prototype,_M=wM.toString;function NM(e){return _M.call(e)}var kM=NM,cw=xd,SM=yM,jM=kM,TM="[object Null]",AM="[object Undefined]",dw=cw?cw.toStringTag:void 0;function EM(e){return e==null?e===void 0?AM:TM:dw&&dw in Object(e)?SM(e):jM(e)}var vd=EM;function CM(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var po=CM,DM=vd,OM=po,PM="[object AsyncFunction]",LM="[object Function]",FM="[object GeneratorFunction]",$M="[object Proxy]";function RM(e){if(!OM(e))return!1;var t=DM(e);return t==LM||t==FM||t==PM||t==$M}var k1=RM,MM=9007199254740991;function IM(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MM}var S1=IM,BM=k1,UM=S1;function WM(e){return e!=null&&UM(e.length)&&!BM(e)}var pf=WM,zM=9007199254740991,HM=/^(?:0|[1-9]\d*)$/;function qM(e,t){var r=typeof e;return t=t??zM,!!t&&(r=="number"||r!="symbol"&&HM.test(e))&&e>-1&&e%1==0&&e<t}var j1=qM,YM=mf,VM=pf,GM=j1,KM=po;function XM(e,t,r){if(!KM(r))return!1;var n=typeof t;return(n=="number"?VM(r)&&GM(t,r.length):n=="string"&&t in r)?YM(r[t],e):!1}var um=XM,JM=/\s/;function ZM(e){for(var t=e.length;t--&&JM.test(e.charAt(t)););return t}var QM=ZM,eI=QM,tI=/^\s+/;function rI(e){return e&&e.slice(0,eI(e)+1).replace(tI,"")}var nI=rI;function aI(e){return e!=null&&typeof e=="object"}var sl=aI,sI=vd,iI=sl,oI="[object Symbol]";function lI(e){return typeof e=="symbol"||iI(e)&&sI(e)==oI}var gf=lI,cI=nI,uw=po,dI=gf,fw=NaN,uI=/^[-+]0x[0-9a-f]+$/i,fI=/^0b[01]+$/i,hI=/^0o[0-7]+$/i,mI=parseInt;function pI(e){if(typeof e=="number")return e;if(dI(e))return fw;if(uw(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=uw(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=cI(e);var r=fI.test(e);return r||hI.test(e)?mI(e.slice(2),r?2:8):uI.test(e)?fw:+e}var gI=pI,xI=gI,hw=1/0,vI=17976931348623157e292;function bI(e){if(!e)return e===0?e:0;if(e=xI(e),e===hw||e===-hw){var t=e<0?-1:1;return t*vI}return e===e?e:0}var GN=bI,yI=GN;function wI(e){var t=yI(e),r=t%1;return t===t?r?t-r:t:0}var KN=wI,_I=qN,NI=um,kI=KN,SI=Math.ceil,jI=Math.max;function TI(e,t,r){(r?NI(e,t,r):t===void 0)?t=1:t=jI(kI(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var a=0,s=0,o=Array(SI(n/t));a<n;)o[s++]=_I(e,a,a+=t);return o}var AI=TI;const EI=Ds(AI);function xf(e){return e&&e.ownerDocument||document}function CI(e){var t=xf(e);return t&&t.defaultView||window}function DI(e,t){return CI(e).getComputedStyle(e,t)}var OI=/([A-Z])/g;function PI(e){return e.replace(OI,"-$1").toLowerCase()}var LI=/^ms-/;function kh(e){return PI(e).replace(LI,"-ms-")}var FI=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function $I(e){return!!(e&&FI.test(e))}function Pc(e,t){var r="",n="";if(typeof t=="string")return e.style.getPropertyValue(kh(t))||DI(e).getPropertyValue(kh(t));Object.keys(t).forEach(function(a){var s=t[a];!s&&s!==0?e.style.removeProperty(kh(a)):$I(a)?n+=a+"("+s+") ":r+=kh(a)+": "+s+";"}),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function Hu(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function RI(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function T1(e){return"window"in e&&e.window===e?e:RI(e)&&e.defaultView||!1}function XN(e){var t=e==="pageXOffset"?"scrollLeft":"scrollTop";function r(n,a){var s=T1(n);if(a===void 0)return s?s[e]:n[t];s?s.scrollTo(s[e],a):n[t]=a}return r}const JN=XN("pageXOffset"),ZN=XN("pageYOffset");function Il(e){var t=xf(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!Hu(n,e)||(e.getBoundingClientRect!==void 0&&(r=e.getBoundingClientRect()),r={top:r.top+ZN(n)-(n.clientTop||0),left:r.left+JN(n)-(n.clientLeft||0),width:r.width,height:r.height}),r}var MI=function(t){return!!t&&"offsetParent"in t};function II(e){for(var t=xf(e),r=e&&e.offsetParent;MI(r)&&r.nodeName!=="HTML"&&Pc(r,"position")==="static";)r=r.offsetParent;return r||t.documentElement}var BI=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function QN(e,t){var r={top:0,left:0},n;if(Pc(e,"position")==="fixed")n=e.getBoundingClientRect();else{var a=t||II(e);n=Il(e),BI(a)!=="html"&&(r=Il(a));var s=String(Pc(a,"borderTopWidth")||0);r.top+=parseInt(s,10)-ZN(a)||0;var o=String(Pc(a,"borderLeftWidth")||0);r.left+=parseInt(o,10)-JN(a)||0}var l=String(Pc(e,"marginTop")||0),c=String(Pc(e,"marginLeft")||0);return en({},n,{top:n.top-r.top-(parseInt(l,10)||0),left:n.left-r.left-(parseInt(c,10)||0)})}const A1=!!(typeof window<"u"&&window.document&&window.document.createElement);var mw=new Date().getTime();function UI(e){var t=new Date().getTime(),r=Math.max(0,16-(t-mw)),n=setTimeout(e,r);return mw=t,n}var WI=["","webkit","moz","o","ms"],dx="clearTimeout",ux=UI,pw=function(t,r){return t+(t?r[0].toUpperCase()+r.substr(1):r)+"AnimationFrame"};A1&&WI.some(function(e){var t=pw(e,"request");return t in window&&(dx=pw(e,"cancel"),ux=function(n){return window[t](n)}),!!ux});var gw=function(t){typeof window[dx]=="function"&&window[dx](t)},ek=ux,hg;function zI(e,t){if(!hg){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;hg=function(s,o){return n.call(s,o)}}return hg(e,t)}var HI=Function.prototype.bind.call(Function.prototype.call,[].slice);function qI(e,t){return HI(e.querySelectorAll(t))}var fx=!1,hx=!1;try{var mg={get passive(){return fx=!0},get once(){return hx=fx=!0}};A1&&(window.addEventListener("test",mg,mg),window.removeEventListener("test",mg,!0))}catch{}function YI(e,t,r,n){if(n&&typeof n!="boolean"&&!hx){var a=n.once,s=n.capture,o=r;!hx&&a&&(o=r.__once||function l(c){this.removeEventListener(t,l,s),r.call(this,c)},r.__once=o),e.addEventListener(t,o,fx?n:s)}e.addEventListener(t,r,n)}function VI(e){const t=J.useRef(e);return J.useEffect(()=>{t.current=e},[e]),t}function xw(e){const t=VI(e);return J.useCallback(function(...r){return t.current&&t.current(...r)},[t])}function vw(){return J.useState(null)}function GI(){const e=J.useRef(!0),t=J.useRef(()=>e.current);return J.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function KI(e){const t=GI();return[e[0],J.useCallback(r=>{if(t())return e[1](r)},[t,e[1]])]}var Fa="top",As="bottom",Es="right",$a="left",E1="auto",vf=[Fa,As,Es,$a],nd="start",qu="end",XI="clippingParents",tk="viewport",su="popper",JI="reference",bw=vf.reduce(function(e,t){return e.concat([t+"-"+nd,t+"-"+qu])},[]),C1=[].concat(vf,[E1]).reduce(function(e,t){return e.concat([t,t+"-"+nd,t+"-"+qu])},[]),ZI="beforeRead",QI="read",eB="afterRead",tB="beforeMain",rB="main",nB="afterMain",aB="beforeWrite",sB="write",iB="afterWrite",oB=[ZI,QI,eB,tB,rB,nB,aB,sB,iB];function _i(e){return e.split("-")[0]}function os(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function tc(e){var t=os(e).Element;return e instanceof t||e instanceof Element}function Ni(e){var t=os(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function D1(e){if(typeof ShadowRoot>"u")return!1;var t=os(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Bl=Math.max,D0=Math.min,ad=Math.round;function mx(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function rk(){return!/^((?!chrome|android).)*safari/i.test(mx())}function sd(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,s=1;t&&Ni(e)&&(a=e.offsetWidth>0&&ad(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&ad(n.height)/e.offsetHeight||1);var o=tc(e)?os(e):window,l=o.visualViewport,c=!rk()&&r,d=(n.left+(c&&l?l.offsetLeft:0))/a,u=(n.top+(c&&l?l.offsetTop:0))/s,h=n.width/a,m=n.height/s;return{width:h,height:m,top:u,right:d+h,bottom:u+m,left:d,x:d,y:u}}function O1(e){var t=sd(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function nk(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&D1(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Zo(e){return e?(e.nodeName||"").toLowerCase():null}function fo(e){return os(e).getComputedStyle(e)}function lB(e){return["table","td","th"].indexOf(Zo(e))>=0}function il(e){return((tc(e)?e.ownerDocument:e.document)||window.document).documentElement}function fm(e){return Zo(e)==="html"?e:e.assignedSlot||e.parentNode||(D1(e)?e.host:null)||il(e)}function yw(e){return!Ni(e)||fo(e).position==="fixed"?null:e.offsetParent}function cB(e){var t=/firefox/i.test(mx()),r=/Trident/i.test(mx());if(r&&Ni(e)){var n=fo(e);if(n.position==="fixed")return null}var a=fm(e);for(D1(a)&&(a=a.host);Ni(a)&&["html","body"].indexOf(Zo(a))<0;){var s=fo(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function bf(e){for(var t=os(e),r=yw(e);r&&lB(r)&&fo(r).position==="static";)r=yw(r);return r&&(Zo(r)==="html"||Zo(r)==="body"&&fo(r).position==="static")?t:r||cB(e)||t}function P1(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function wu(e,t,r){return Bl(e,D0(t,r))}function dB(e,t,r){var n=wu(e,t,r);return n>r?r:n}function ak(){return{top:0,right:0,bottom:0,left:0}}function sk(e){return Object.assign({},ak(),e)}function ik(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var uB=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,sk(typeof t!="number"?t:ik(t,vf))};function fB(e){var t,r=e.state,n=e.name,a=e.options,s=r.elements.arrow,o=r.modifiersData.popperOffsets,l=_i(r.placement),c=P1(l),d=[$a,Es].indexOf(l)>=0,u=d?"height":"width";if(!(!s||!o)){var h=uB(a.padding,r),m=O1(s),f=c==="y"?Fa:$a,x=c==="y"?As:Es,g=r.rects.reference[u]+r.rects.reference[c]-o[c]-r.rects.popper[u],b=o[c]-r.rects.reference[c],y=bf(s),N=y?c==="y"?y.clientHeight||0:y.clientWidth||0:0,S=g/2-b/2,_=h[f],D=N-m[u]-h[x],I=N/2-m[u]/2+S,O=wu(_,I,D),R=c;r.modifiersData[n]=(t={},t[R]=O,t.centerOffset=O-I,t)}}function hB(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||nk(t.elements.popper,a)&&(t.elements.arrow=a))}const mB={name:"arrow",enabled:!0,phase:"main",fn:fB,effect:hB,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function id(e){return e.split("-")[1]}var pB={top:"auto",right:"auto",bottom:"auto",left:"auto"};function gB(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:ad(r*a)/a||0,y:ad(n*a)/a||0}}function ww(e){var t,r=e.popper,n=e.popperRect,a=e.placement,s=e.variation,o=e.offsets,l=e.position,c=e.gpuAcceleration,d=e.adaptive,u=e.roundOffsets,h=e.isFixed,m=o.x,f=m===void 0?0:m,x=o.y,g=x===void 0?0:x,b=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=b.x,g=b.y;var y=o.hasOwnProperty("x"),N=o.hasOwnProperty("y"),S=$a,_=Fa,D=window;if(d){var I=bf(r),O="clientHeight",R="clientWidth";if(I===os(r)&&(I=il(r),fo(I).position!=="static"&&l==="absolute"&&(O="scrollHeight",R="scrollWidth")),I=I,a===Fa||(a===$a||a===Es)&&s===qu){_=As;var E=h&&I===D&&D.visualViewport?D.visualViewport.height:I[O];g-=E-n.height,g*=c?1:-1}if(a===$a||(a===Fa||a===As)&&s===qu){S=Es;var B=h&&I===D&&D.visualViewport?D.visualViewport.width:I[R];f-=B-n.width,f*=c?1:-1}}var C=Object.assign({position:l},d&&pB),M=u===!0?gB({x:f,y:g},os(r)):{x:f,y:g};if(f=M.x,g=M.y,c){var U;return Object.assign({},C,(U={},U[_]=N?"0":"",U[S]=y?"0":"",U.transform=(D.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",U))}return Object.assign({},C,(t={},t[_]=N?g+"px":"",t[S]=y?f+"px":"",t.transform="",t))}function xB(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,s=r.adaptive,o=s===void 0?!0:s,l=r.roundOffsets,c=l===void 0?!0:l,d={placement:_i(t.placement),variation:id(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,ww(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,ww(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const vB={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:xB,data:{}};var Sh={passive:!0};function bB(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,s=a===void 0?!0:a,o=n.resize,l=o===void 0?!0:o,c=os(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&d.forEach(function(u){u.addEventListener("scroll",r.update,Sh)}),l&&c.addEventListener("resize",r.update,Sh),function(){s&&d.forEach(function(u){u.removeEventListener("scroll",r.update,Sh)}),l&&c.removeEventListener("resize",r.update,Sh)}}const yB={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:bB,data:{}};var wB={left:"right",right:"left",bottom:"top",top:"bottom"};function Kh(e){return e.replace(/left|right|bottom|top/g,function(t){return wB[t]})}var _B={start:"end",end:"start"};function _w(e){return e.replace(/start|end/g,function(t){return _B[t]})}function L1(e){var t=os(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function F1(e){return sd(il(e)).left+L1(e).scrollLeft}function NB(e,t){var r=os(e),n=il(e),a=r.visualViewport,s=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){s=a.width,o=a.height;var d=rk();(d||!d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:s,height:o,x:l+F1(e),y:c}}function kB(e){var t,r=il(e),n=L1(e),a=(t=e.ownerDocument)==null?void 0:t.body,s=Bl(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=Bl(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+F1(e),c=-n.scrollTop;return fo(a||r).direction==="rtl"&&(l+=Bl(r.clientWidth,a?a.clientWidth:0)-s),{width:s,height:o,x:l,y:c}}function $1(e){var t=fo(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function ok(e){return["html","body","#document"].indexOf(Zo(e))>=0?e.ownerDocument.body:Ni(e)&&$1(e)?e:ok(fm(e))}function _u(e,t){var r;t===void 0&&(t=[]);var n=ok(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),s=os(n),o=a?[s].concat(s.visualViewport||[],$1(n)?n:[]):n,l=t.concat(o);return a?l:l.concat(_u(fm(o)))}function px(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function SB(e,t){var r=sd(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Nw(e,t,r){return t===tk?px(NB(e,r)):tc(t)?SB(t,r):px(kB(il(e)))}function jB(e){var t=_u(fm(e)),r=["absolute","fixed"].indexOf(fo(e).position)>=0,n=r&&Ni(e)?bf(e):e;return tc(n)?t.filter(function(a){return tc(a)&&nk(a,n)&&Zo(a)!=="body"}):[]}function TB(e,t,r,n){var a=t==="clippingParents"?jB(e):[].concat(t),s=[].concat(a,[r]),o=s[0],l=s.reduce(function(c,d){var u=Nw(e,d,n);return c.top=Bl(u.top,c.top),c.right=D0(u.right,c.right),c.bottom=D0(u.bottom,c.bottom),c.left=Bl(u.left,c.left),c},Nw(e,o,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function lk(e){var t=e.reference,r=e.element,n=e.placement,a=n?_i(n):null,s=n?id(n):null,o=t.x+t.width/2-r.width/2,l=t.y+t.height/2-r.height/2,c;switch(a){case Fa:c={x:o,y:t.y-r.height};break;case As:c={x:o,y:t.y+t.height};break;case Es:c={x:t.x+t.width,y:l};break;case $a:c={x:t.x-r.width,y:l};break;default:c={x:t.x,y:t.y}}var d=a?P1(a):null;if(d!=null){var u=d==="y"?"height":"width";switch(s){case nd:c[d]=c[d]-(t[u]/2-r[u]/2);break;case qu:c[d]=c[d]+(t[u]/2-r[u]/2);break}}return c}function Yu(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,s=r.strategy,o=s===void 0?e.strategy:s,l=r.boundary,c=l===void 0?XI:l,d=r.rootBoundary,u=d===void 0?tk:d,h=r.elementContext,m=h===void 0?su:h,f=r.altBoundary,x=f===void 0?!1:f,g=r.padding,b=g===void 0?0:g,y=sk(typeof b!="number"?b:ik(b,vf)),N=m===su?JI:su,S=e.rects.popper,_=e.elements[x?N:m],D=TB(tc(_)?_:_.contextElement||il(e.elements.popper),c,u,o),I=sd(e.elements.reference),O=lk({reference:I,element:S,placement:a}),R=px(Object.assign({},S,O)),E=m===su?R:I,B={top:D.top-E.top+y.top,bottom:E.bottom-D.bottom+y.bottom,left:D.left-E.left+y.left,right:E.right-D.right+y.right},C=e.modifiersData.offset;if(m===su&&C){var M=C[a];Object.keys(B).forEach(function(U){var F=[Es,As].indexOf(U)>=0?1:-1,ne=[Fa,As].indexOf(U)>=0?"y":"x";B[U]+=M[ne]*F})}return B}function AB(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,s=r.rootBoundary,o=r.padding,l=r.flipVariations,c=r.allowedAutoPlacements,d=c===void 0?C1:c,u=id(n),h=u?l?bw:bw.filter(function(x){return id(x)===u}):vf,m=h.filter(function(x){return d.indexOf(x)>=0});m.length===0&&(m=h);var f=m.reduce(function(x,g){return x[g]=Yu(e,{placement:g,boundary:a,rootBoundary:s,padding:o})[_i(g)],x},{});return Object.keys(f).sort(function(x,g){return f[x]-f[g]})}function EB(e){if(_i(e)===E1)return[];var t=Kh(e);return[_w(e),t,_w(t)]}function CB(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,s=a===void 0?!0:a,o=r.altAxis,l=o===void 0?!0:o,c=r.fallbackPlacements,d=r.padding,u=r.boundary,h=r.rootBoundary,m=r.altBoundary,f=r.flipVariations,x=f===void 0?!0:f,g=r.allowedAutoPlacements,b=t.options.placement,y=_i(b),N=y===b,S=c||(N||!x?[Kh(b)]:EB(b)),_=[b].concat(S).reduce(function(T,L){return T.concat(_i(L)===E1?AB(t,{placement:L,boundary:u,rootBoundary:h,padding:d,flipVariations:x,allowedAutoPlacements:g}):L)},[]),D=t.rects.reference,I=t.rects.popper,O=new Map,R=!0,E=_[0],B=0;B<_.length;B++){var C=_[B],M=_i(C),U=id(C)===nd,F=[Fa,As].indexOf(M)>=0,ne=F?"width":"height",V=Yu(t,{placement:C,boundary:u,rootBoundary:h,altBoundary:m,padding:d}),ee=F?U?Es:$a:U?As:Fa;D[ne]>I[ne]&&(ee=Kh(ee));var me=Kh(ee),ye=[];if(s&&ye.push(V[M]<=0),l&&ye.push(V[ee]<=0,V[me]<=0),ye.every(function(T){return T})){E=C,R=!1;break}O.set(C,ye)}if(R)for(var Oe=x?3:1,xe=function(L){var H=_.find(function(X){var re=O.get(X);if(re)return re.slice(0,L).every(function(ge){return ge})});if(H)return E=H,"break"},w=Oe;w>0;w--){var A=xe(w);if(A==="break")break}t.placement!==E&&(t.modifiersData[n]._skip=!0,t.placement=E,t.reset=!0)}}const DB={name:"flip",enabled:!0,phase:"main",fn:CB,requiresIfExists:["offset"],data:{_skip:!1}};function kw(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Sw(e){return[Fa,Es,As,$a].some(function(t){return e[t]>=0})}function OB(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,s=t.modifiersData.preventOverflow,o=Yu(t,{elementContext:"reference"}),l=Yu(t,{altBoundary:!0}),c=kw(o,n),d=kw(l,a,s),u=Sw(c),h=Sw(d);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const PB={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:OB};function LB(e,t,r){var n=_i(e),a=[$a,Fa].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,o=s[0],l=s[1];return o=o||0,l=(l||0)*a,[$a,Es].indexOf(n)>=0?{x:l,y:o}:{x:o,y:l}}function FB(e){var t=e.state,r=e.options,n=e.name,a=r.offset,s=a===void 0?[0,0]:a,o=C1.reduce(function(u,h){return u[h]=LB(h,t.rects,s),u},{}),l=o[t.placement],c=l.x,d=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=d),t.modifiersData[n]=o}const $B={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:FB};function RB(e){var t=e.state,r=e.name;t.modifiersData[r]=lk({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const MB={name:"popperOffsets",enabled:!0,phase:"read",fn:RB,data:{}};function IB(e){return e==="x"?"y":"x"}function BB(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,s=a===void 0?!0:a,o=r.altAxis,l=o===void 0?!1:o,c=r.boundary,d=r.rootBoundary,u=r.altBoundary,h=r.padding,m=r.tether,f=m===void 0?!0:m,x=r.tetherOffset,g=x===void 0?0:x,b=Yu(t,{boundary:c,rootBoundary:d,padding:h,altBoundary:u}),y=_i(t.placement),N=id(t.placement),S=!N,_=P1(y),D=IB(_),I=t.modifiersData.popperOffsets,O=t.rects.reference,R=t.rects.popper,E=typeof g=="function"?g(Object.assign({},t.rects,{placement:t.placement})):g,B=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),C=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,M={x:0,y:0};if(I){if(s){var U,F=_==="y"?Fa:$a,ne=_==="y"?As:Es,V=_==="y"?"height":"width",ee=I[_],me=ee+b[F],ye=ee-b[ne],Oe=f?-R[V]/2:0,xe=N===nd?O[V]:R[V],w=N===nd?-R[V]:-O[V],A=t.elements.arrow,T=f&&A?O1(A):{width:0,height:0},L=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:ak(),H=L[F],X=L[ne],re=wu(0,O[V],T[V]),ge=S?O[V]/2-Oe-re-H-B.mainAxis:xe-re-H-B.mainAxis,oe=S?-O[V]/2+Oe+re+X+B.mainAxis:w+re+X+B.mainAxis,je=t.elements.arrow&&bf(t.elements.arrow),Ie=je?_==="y"?je.clientTop||0:je.clientLeft||0:0,et=(U=C==null?void 0:C[_])!=null?U:0,Te=ee+ge-et-Ie,Y=ee+oe-et,We=wu(f?D0(me,Te):me,ee,f?Bl(ye,Y):ye);I[_]=We,M[_]=We-ee}if(l){var Q,ve=_==="x"?Fa:$a,we=_==="x"?As:Es,Re=I[D],He=D==="y"?"height":"width",vt=Re+b[ve],le=Re-b[we],Ae=[Fa,$a].indexOf(y)!==-1,Qe=(Q=C==null?void 0:C[D])!=null?Q:0,_e=Ae?vt:Re-O[He]-R[He]-Qe+B.altAxis,Ze=Ae?Re+O[He]+R[He]-Qe-B.altAxis:le,Ve=f&&Ae?dB(_e,Re,Ze):wu(f?_e:vt,Re,f?Ze:le);I[D]=Ve,M[D]=Ve-Re}t.modifiersData[n]=M}}const UB={name:"preventOverflow",enabled:!0,phase:"main",fn:BB,requiresIfExists:["offset"]};function WB(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function zB(e){return e===os(e)||!Ni(e)?L1(e):WB(e)}function HB(e){var t=e.getBoundingClientRect(),r=ad(t.width)/e.offsetWidth||1,n=ad(t.height)/e.offsetHeight||1;return r!==1||n!==1}function qB(e,t,r){r===void 0&&(r=!1);var n=Ni(t),a=Ni(t)&&HB(t),s=il(t),o=sd(e,a,r),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Zo(t)!=="body"||$1(s))&&(l=zB(t)),Ni(t)?(c=sd(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=F1(s))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function YB(e){var t=new Map,r=new Set,n=[];e.forEach(function(s){t.set(s.name,s)});function a(s){r.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(l){if(!r.has(l)){var c=t.get(l);c&&a(c)}}),n.push(s)}return e.forEach(function(s){r.has(s.name)||a(s)}),n}function VB(e){var t=YB(e);return oB.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function GB(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function KB(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var jw={placement:"bottom",modifiers:[],strategy:"absolute"};function Tw(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function XB(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,s=a===void 0?jw:a;return function(l,c,d){d===void 0&&(d=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},jw,s),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],m=!1,f={state:u,setOptions:function(y){var N=typeof y=="function"?y(u.options):y;g(),u.options=Object.assign({},s,u.options,N),u.scrollParents={reference:tc(l)?_u(l):l.contextElement?_u(l.contextElement):[],popper:_u(c)};var S=VB(KB([].concat(n,u.options.modifiers)));return u.orderedModifiers=S.filter(function(_){return _.enabled}),x(),f.update()},forceUpdate:function(){if(!m){var y=u.elements,N=y.reference,S=y.popper;if(Tw(N,S)){u.rects={reference:qB(N,bf(S),u.options.strategy==="fixed"),popper:O1(S)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(B){return u.modifiersData[B.name]=Object.assign({},B.data)});for(var _=0;_<u.orderedModifiers.length;_++){if(u.reset===!0){u.reset=!1,_=-1;continue}var D=u.orderedModifiers[_],I=D.fn,O=D.options,R=O===void 0?{}:O,E=D.name;typeof I=="function"&&(u=I({state:u,options:R,name:E,instance:f})||u)}}}},update:GB(function(){return new Promise(function(b){f.forceUpdate(),b(u)})}),destroy:function(){g(),m=!0}};if(!Tw(l,c))return f;f.setOptions(d).then(function(b){!m&&d.onFirstUpdate&&d.onFirstUpdate(b)});function x(){u.orderedModifiers.forEach(function(b){var y=b.name,N=b.options,S=N===void 0?{}:N,_=b.effect;if(typeof _=="function"){var D=_({state:u,name:y,instance:f,options:S}),I=function(){};h.push(D||I)}})}function g(){h.forEach(function(b){return b()}),h=[]}return f}}var JB=XB({defaultModifiers:[PB,MB,vB,yB,$B,DB,UB,mB]}),Aw=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},ZB={name:"applyStyles",enabled:!1},QB={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var r=t.state;return function(){var n=r.elements,a=n.reference,s=n.popper;if("removeAttribute"in a){var o=(a.getAttribute("aria-describedby")||"").split(",").filter(function(l){return l.trim()!==s.id});o.length?a.setAttribute("aria-describedby",o.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var r,n=t.state,a=n.elements,s=a.popper,o=a.reference,l=(r=s.getAttribute("role"))==null?void 0:r.toLowerCase();if(s.id&&l==="tooltip"&&"setAttribute"in o){var c=o.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(s.id)!==-1)return;o.setAttribute("aria-describedby",c?c+","+s.id:s.id)}}},eU=[];function tU(e,t,r){var n=r===void 0?{}:r,a=n.enabled,s=a===void 0?!0:a,o=n.placement,l=o===void 0?"bottom":o,c=n.strategy,d=c===void 0?"absolute":c,u=n.modifiers,h=u===void 0?eU:u,m=cm(n,["enabled","placement","strategy","modifiers"]),f=J.useRef(),x=J.useCallback(function(){var _;(_=f.current)==null||_.update()},[]),g=J.useCallback(function(){var _;(_=f.current)==null||_.forceUpdate()},[]),b=KI(J.useState({placement:l,update:x,forceUpdate:g,attributes:{},styles:{popper:Aw(d),arrow:{}}})),y=b[0],N=b[1],S=J.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(D){var I=D.state,O={},R={};Object.keys(I.elements).forEach(function(E){O[E]=I.styles[E],R[E]=I.attributes[E]}),N({state:I,styles:O,attributes:R,update:x,forceUpdate:g,placement:I.placement})}}},[x,g,N]);return J.useEffect(function(){!f.current||!s||f.current.setOptions({placement:l,strategy:d,modifiers:[].concat(h,[S,ZB])})},[d,l,S,s]),J.useEffect(function(){if(!(!s||e==null||t==null))return f.current=JB(e,t,en({},m,{placement:l,strategy:d,modifiers:[].concat(h,[QB,S])})),function(){f.current!=null&&(f.current.destroy(),f.current=void 0,N(function(_){return en({},_,{attributes:{},styles:{popper:Aw(d)}})}))}},[s,e,t]),y}function rU(e,t,r,n){var a=n&&typeof n!="boolean"?n.capture:n;e.removeEventListener(t,r,a),r.__once&&e.removeEventListener(t,r.__once,a)}function uu(e,t,r,n){return YI(e,t,r,n),function(){rU(e,t,r,n)}}var nU=function(){},aU=nU;const sU=Ds(aU);function iU(e){return e&&"setState"in e?R5.findDOMNode(e):e??null}const oU=function(e){return xf(iU(e))};var lU=27,Ew=function(){};function cU(e){return e.button===0}function dU(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var Cw=function(t){return t&&("current"in t?t.current:t)};function uU(e,t,r){var n=r===void 0?{}:r,a=n.disabled,s=n.clickTrigger,o=s===void 0?"click":s,l=J.useRef(!1),c=t||Ew,d=J.useCallback(function(m){var f,x=Cw(e);sU(!!x,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),l.current=!x||dU(m)||!cU(m)||!!Hu(x,(f=m.composedPath==null?void 0:m.composedPath()[0])!=null?f:m.target)},[e]),u=xw(function(m){l.current||c(m)}),h=xw(function(m){m.keyCode===lU&&c(m)});J.useEffect(function(){if(!(a||e==null)){var m=window.event,f=oU(Cw(e)),x=uu(f,o,d,!0),g=uu(f,o,function(N){if(N===m){m=void 0;return}u(N)}),b=uu(f,"keyup",function(N){if(N===m){m=void 0;return}h(N)}),y=[];return"ontouchstart"in f.documentElement&&(y=[].slice.call(f.body.children).map(function(N){return uu(N,"mousemove",Ew)})),function(){x(),g(),b(),y.forEach(function(N){return N()})}}},[e,a,o,d,u,h])}function fU(e){var t={};return Array.isArray(e)?(e==null||e.forEach(function(r){t[r.name]=r}),t):e||t}function hU(e){return e===void 0&&(e={}),Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t].name=t,e[t]})}function mU(e){var t,r,n,a,s=e.enabled,o=e.enableEvents,l=e.placement,c=e.flip,d=e.offset,u=e.fixed,h=e.containerPadding,m=e.arrowElement,f=e.popperConfig,x=f===void 0?{}:f,g=fU(x.modifiers);return en({},x,{placement:l,enabled:s,strategy:u?"fixed":x.strategy,modifiers:hU(en({},g,{eventListeners:{enabled:o},preventOverflow:en({},g.preventOverflow,{options:h?en({padding:h},(t=g.preventOverflow)==null?void 0:t.options):(r=g.preventOverflow)==null?void 0:r.options}),offset:{options:en({offset:d},(n=g.offset)==null?void 0:n.options)},arrow:en({},g.arrow,{enabled:!!m,options:en({},(a=g.arrow)==null?void 0:a.options,{element:m})}),flip:en({enabled:!!c},g.flip)}))})}function pU(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function gU(e,t){e.classList?e.classList.add(t):pU(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function Dw(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function xU(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=Dw(e.className,t):e.setAttribute("class",Dw(e.className&&e.className.baseVal||"",t))}var jh;function R1(e){if((!jh&&jh!==0||e)&&A1){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),jh=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return jh}var pg=function(t){var r;return typeof document>"u"?null:t==null?xf().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(r=t)!=null&&r.nodeType&&t||null)};function Ow(e,t){var r=J.useState(function(){return pg(e)}),n=r[0],a=r[1];if(!n){var s=pg(e);s&&a(s)}return J.useEffect(function(){},[t,n]),J.useEffect(function(){var o=pg(e);o!==n&&a(o)},[e,n]),n}const Pw=e=>!e||typeof e=="function"?e:t=>{e.current=t};function vU(e,t){const r=Pw(e),n=Pw(t);return a=>{r&&r(a),n&&n(a)}}function bU(e,t){return J.useMemo(()=>vU(e,t),[e,t])}var M1=Ce.forwardRef(function(e,t){var r=e.flip,n=e.offset,a=e.placement,s=e.containerPadding,o=s===void 0?5:s,l=e.popperConfig,c=l===void 0?{}:l,d=e.transition,u=vw(),h=u[0],m=u[1],f=vw(),x=f[0],g=f[1],b=bU(m,t),y=Ow(e.container),N=Ow(e.target),S=J.useState(!e.show),_=S[0],D=S[1],I=tU(N,h,mU({placement:a,enableEvents:!!e.show,containerPadding:o||5,flip:r,offset:n,arrowElement:x,popperConfig:c})),O=I.styles,R=I.attributes,E=cm(I,["styles","attributes"]);e.show?_&&D(!1):!e.transition&&!_&&D(!0);var B=function(){D(!0),e.onExited&&e.onExited.apply(e,arguments)},C=e.show||d&&!_;if(uU(h,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!C)return null;var M=e.children(en({},E,{show:!!e.show,props:en({},R.popper,{style:O.popper,ref:b}),arrowProps:en({},R.arrow,{style:O.arrow,ref:g})}));if(d){var U=e.onExit,F=e.onExiting,ne=e.onEnter,V=e.onEntering,ee=e.onEntered;M=Ce.createElement(d,{in:e.show,appear:!0,onExit:U,onExiting:F,onExited:B,onEnter:ne,onEntering:V,onEntered:ee},M)}return y?R5.createPortal(M,y):null});M1.displayName="Overlay";M1.propTypes={show:ft.bool,placement:ft.oneOf(C1),target:ft.any,container:ft.any,flip:ft.bool,children:ft.func.isRequired,containerPadding:ft.number,popperConfig:ft.object,rootClose:ft.bool,rootCloseEvent:ft.oneOf(["click","mousedown"]),rootCloseDisabled:ft.bool,onHide:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(t.rootClose){var s;return(s=ft.func).isRequired.apply(s,[t].concat(n))}return ft.func.apply(ft,[t].concat(n))},transition:ft.elementType,onEnter:ft.func,onEntering:ft.func,onEntered:ft.func,onExit:ft.func,onExiting:ft.func,onExited:ft.func};function yU(){this.__data__=[],this.size=0}var wU=yU,_U=mf;function NU(e,t){for(var r=e.length;r--;)if(_U(e[r][0],t))return r;return-1}var hm=NU,kU=hm,SU=Array.prototype,jU=SU.splice;function TU(e){var t=this.__data__,r=kU(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():jU.call(t,r,1),--this.size,!0}var AU=TU,EU=hm;function CU(e){var t=this.__data__,r=EU(t,e);return r<0?void 0:t[r][1]}var DU=CU,OU=hm;function PU(e){return OU(this.__data__,e)>-1}var LU=PU,FU=hm;function $U(e,t){var r=this.__data__,n=FU(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var RU=$U,MU=wU,IU=AU,BU=DU,UU=LU,WU=RU;function bd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}bd.prototype.clear=MU;bd.prototype.delete=IU;bd.prototype.get=BU;bd.prototype.has=UU;bd.prototype.set=WU;var mm=bd,zU=mm;function HU(){this.__data__=new zU,this.size=0}var qU=HU;function YU(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var VU=YU;function GU(e){return this.__data__.get(e)}var KU=GU;function XU(e){return this.__data__.has(e)}var JU=XU,ZU=Di,QU=ZU["__core-js_shared__"],eW=QU,gg=eW,Lw=function(){var e=/[^.]+$/.exec(gg&&gg.keys&&gg.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function tW(e){return!!Lw&&Lw in e}var rW=tW,nW=Function.prototype,aW=nW.toString;function sW(e){if(e!=null){try{return aW.call(e)}catch{}try{return e+""}catch{}}return""}var ck=sW,iW=k1,oW=rW,lW=po,cW=ck,dW=/[\\^$.*+?()[\]{}|]/g,uW=/^\[object .+?Constructor\]$/,fW=Function.prototype,hW=Object.prototype,mW=fW.toString,pW=hW.hasOwnProperty,gW=RegExp("^"+mW.call(pW).replace(dW,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xW(e){if(!lW(e)||oW(e))return!1;var t=iW(e)?gW:uW;return t.test(cW(e))}var vW=xW;function bW(e,t){return e==null?void 0:e[t]}var yW=bW,wW=vW,_W=yW;function NW(e,t){var r=_W(e,t);return wW(r)?r:void 0}var dc=NW,kW=dc,SW=Di,jW=kW(SW,"Map"),I1=jW,TW=dc,AW=TW(Object,"create"),pm=AW,Fw=pm;function EW(){this.__data__=Fw?Fw(null):{},this.size=0}var CW=EW;function DW(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var OW=DW,PW=pm,LW="__lodash_hash_undefined__",FW=Object.prototype,$W=FW.hasOwnProperty;function RW(e){var t=this.__data__;if(PW){var r=t[e];return r===LW?void 0:r}return $W.call(t,e)?t[e]:void 0}var MW=RW,IW=pm,BW=Object.prototype,UW=BW.hasOwnProperty;function WW(e){var t=this.__data__;return IW?t[e]!==void 0:UW.call(t,e)}var zW=WW,HW=pm,qW="__lodash_hash_undefined__";function YW(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=HW&&t===void 0?qW:t,this}var VW=YW,GW=CW,KW=OW,XW=MW,JW=zW,ZW=VW;function yd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}yd.prototype.clear=GW;yd.prototype.delete=KW;yd.prototype.get=XW;yd.prototype.has=JW;yd.prototype.set=ZW;var QW=yd,$w=QW,ez=mm,tz=I1;function rz(){this.size=0,this.__data__={hash:new $w,map:new(tz||ez),string:new $w}}var nz=rz;function az(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var sz=az,iz=sz;function oz(e,t){var r=e.__data__;return iz(t)?r[typeof t=="string"?"string":"hash"]:r.map}var gm=oz,lz=gm;function cz(e){var t=lz(this,e).delete(e);return this.size-=t?1:0,t}var dz=cz,uz=gm;function fz(e){return uz(this,e).get(e)}var hz=fz,mz=gm;function pz(e){return mz(this,e).has(e)}var gz=pz,xz=gm;function vz(e,t){var r=xz(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var bz=vz,yz=nz,wz=dz,_z=hz,Nz=gz,kz=bz;function wd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}wd.prototype.clear=yz;wd.prototype.delete=wz;wd.prototype.get=_z;wd.prototype.has=Nz;wd.prototype.set=kz;var B1=wd,Sz=mm,jz=I1,Tz=B1,Az=200;function Ez(e,t){var r=this.__data__;if(r instanceof Sz){var n=r.__data__;if(!jz||n.length<Az-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Tz(n)}return r.set(e,t),this.size=r.size,this}var Cz=Ez,Dz=mm,Oz=qU,Pz=VU,Lz=KU,Fz=JU,$z=Cz;function _d(e){var t=this.__data__=new Dz(e);this.size=t.size}_d.prototype.clear=Oz;_d.prototype.delete=Pz;_d.prototype.get=Lz;_d.prototype.has=Fz;_d.prototype.set=$z;var U1=_d,Rz="__lodash_hash_undefined__";function Mz(e){return this.__data__.set(e,Rz),this}var Iz=Mz;function Bz(e){return this.__data__.has(e)}var Uz=Bz,Wz=B1,zz=Iz,Hz=Uz;function O0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Wz;++t<r;)this.add(e[t])}O0.prototype.add=O0.prototype.push=zz;O0.prototype.has=Hz;var qz=O0;function Yz(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Vz=Yz;function Gz(e,t){return e.has(t)}var Kz=Gz,Xz=qz,Jz=Vz,Zz=Kz,Qz=1,eH=2;function tH(e,t,r,n,a,s){var o=r&Qz,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=s.get(e),u=s.get(t);if(d&&u)return d==t&&u==e;var h=-1,m=!0,f=r&eH?new Xz:void 0;for(s.set(e,t),s.set(t,e);++h<l;){var x=e[h],g=t[h];if(n)var b=o?n(g,x,h,t,e,s):n(x,g,h,e,t,s);if(b!==void 0){if(b)continue;m=!1;break}if(f){if(!Jz(t,function(y,N){if(!Zz(f,N)&&(x===y||a(x,y,r,n,s)))return f.push(N)})){m=!1;break}}else if(!(x===g||a(x,g,r,n,s))){m=!1;break}}return s.delete(e),s.delete(t),m}var dk=tH,rH=Di,nH=rH.Uint8Array,uk=nH;function aH(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var sH=aH;function iH(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var oH=iH,Rw=xd,Mw=uk,lH=mf,cH=dk,dH=sH,uH=oH,fH=1,hH=2,mH="[object Boolean]",pH="[object Date]",gH="[object Error]",xH="[object Map]",vH="[object Number]",bH="[object RegExp]",yH="[object Set]",wH="[object String]",_H="[object Symbol]",NH="[object ArrayBuffer]",kH="[object DataView]",Iw=Rw?Rw.prototype:void 0,xg=Iw?Iw.valueOf:void 0;function SH(e,t,r,n,a,s,o){switch(r){case kH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case NH:return!(e.byteLength!=t.byteLength||!s(new Mw(e),new Mw(t)));case mH:case pH:case vH:return lH(+e,+t);case gH:return e.name==t.name&&e.message==t.message;case bH:case wH:return e==t+"";case xH:var l=dH;case yH:var c=n&fH;if(l||(l=uH),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;n|=hH,o.set(e,t);var u=cH(l(e),l(t),n,a,s,o);return o.delete(e),u;case _H:if(xg)return xg.call(e)==xg.call(t)}return!1}var jH=SH;function TH(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var W1=TH,AH=Array.isArray,Ls=AH,EH=W1,CH=Ls;function DH(e,t,r){var n=t(e);return CH(e)?n:EH(n,r(e))}var fk=DH;function OH(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[a++]=o)}return s}var PH=OH;function LH(){return[]}var hk=LH,FH=PH,$H=hk,RH=Object.prototype,MH=RH.propertyIsEnumerable,Bw=Object.getOwnPropertySymbols,IH=Bw?function(e){return e==null?[]:(e=Object(e),FH(Bw(e),function(t){return MH.call(e,t)}))}:$H,z1=IH;function BH(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var UH=BH,WH=vd,zH=sl,HH="[object Arguments]";function qH(e){return zH(e)&&WH(e)==HH}var YH=qH,Uw=YH,VH=sl,mk=Object.prototype,GH=mk.hasOwnProperty,KH=mk.propertyIsEnumerable,XH=Uw(function(){return arguments}())?Uw:function(e){return VH(e)&&GH.call(e,"callee")&&!KH.call(e,"callee")},H1=XH,P0={exports:{}};function JH(){return!1}var ZH=JH;P0.exports;(function(e,t){var r=Di,n=ZH,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(P0,P0.exports);var xm=P0.exports,QH=vd,eq=S1,tq=sl,rq="[object Arguments]",nq="[object Array]",aq="[object Boolean]",sq="[object Date]",iq="[object Error]",oq="[object Function]",lq="[object Map]",cq="[object Number]",dq="[object Object]",uq="[object RegExp]",fq="[object Set]",hq="[object String]",mq="[object WeakMap]",pq="[object ArrayBuffer]",gq="[object DataView]",xq="[object Float32Array]",vq="[object Float64Array]",bq="[object Int8Array]",yq="[object Int16Array]",wq="[object Int32Array]",_q="[object Uint8Array]",Nq="[object Uint8ClampedArray]",kq="[object Uint16Array]",Sq="[object Uint32Array]",Mr={};Mr[xq]=Mr[vq]=Mr[bq]=Mr[yq]=Mr[wq]=Mr[_q]=Mr[Nq]=Mr[kq]=Mr[Sq]=!0;Mr[rq]=Mr[nq]=Mr[pq]=Mr[aq]=Mr[gq]=Mr[sq]=Mr[iq]=Mr[oq]=Mr[lq]=Mr[cq]=Mr[dq]=Mr[uq]=Mr[fq]=Mr[hq]=Mr[mq]=!1;function jq(e){return tq(e)&&eq(e.length)&&!!Mr[QH(e)]}var Tq=jq;function Aq(e){return function(t){return e(t)}}var vm=Aq,L0={exports:{}};L0.exports;(function(e,t){var r=YN,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,o=s&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(L0,L0.exports);var q1=L0.exports,Eq=Tq,Cq=vm,Ww=q1,zw=Ww&&Ww.isTypedArray,Dq=zw?Cq(zw):Eq,Y1=Dq,Oq=UH,Pq=H1,Lq=Ls,Fq=xm,$q=j1,Rq=Y1,Mq=Object.prototype,Iq=Mq.hasOwnProperty;function Bq(e,t){var r=Lq(e),n=!r&&Pq(e),a=!r&&!n&&Fq(e),s=!r&&!n&&!a&&Rq(e),o=r||n||a||s,l=o?Oq(e.length,String):[],c=l.length;for(var d in e)(t||Iq.call(e,d))&&!(o&&(d=="length"||a&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||$q(d,c)))&&l.push(d);return l}var pk=Bq,Uq=Object.prototype;function Wq(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Uq;return e===r}var V1=Wq;function zq(e,t){return function(r){return e(t(r))}}var gk=zq,Hq=gk,qq=Hq(Object.keys,Object),Yq=qq,Vq=V1,Gq=Yq,Kq=Object.prototype,Xq=Kq.hasOwnProperty;function Jq(e){if(!Vq(e))return Gq(e);var t=[];for(var r in Object(e))Xq.call(e,r)&&r!="constructor"&&t.push(r);return t}var Zq=Jq,Qq=pk,eY=Zq,tY=pf;function rY(e){return tY(e)?Qq(e):eY(e)}var yf=rY,nY=fk,aY=z1,sY=yf;function iY(e){return nY(e,sY,aY)}var xk=iY,Hw=xk,oY=1,lY=Object.prototype,cY=lY.hasOwnProperty;function dY(e,t,r,n,a,s){var o=r&oY,l=Hw(e),c=l.length,d=Hw(t),u=d.length;if(c!=u&&!o)return!1;for(var h=c;h--;){var m=l[h];if(!(o?m in t:cY.call(t,m)))return!1}var f=s.get(e),x=s.get(t);if(f&&x)return f==t&&x==e;var g=!0;s.set(e,t),s.set(t,e);for(var b=o;++h<c;){m=l[h];var y=e[m],N=t[m];if(n)var S=o?n(N,y,m,t,e,s):n(y,N,m,e,t,s);if(!(S===void 0?y===N||a(y,N,r,n,s):S)){g=!1;break}b||(b=m=="constructor")}if(g&&!b){var _=e.constructor,D=t.constructor;_!=D&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof D=="function"&&D instanceof D)&&(g=!1)}return s.delete(e),s.delete(t),g}var uY=dY,fY=dc,hY=Di,mY=fY(hY,"DataView"),pY=mY,gY=dc,xY=Di,vY=gY(xY,"Promise"),bY=vY,yY=dc,wY=Di,_Y=yY(wY,"Set"),NY=_Y,kY=dc,SY=Di,jY=kY(SY,"WeakMap"),TY=jY,gx=pY,xx=I1,vx=bY,bx=NY,yx=TY,vk=vd,Nd=ck,qw="[object Map]",AY="[object Object]",Yw="[object Promise]",Vw="[object Set]",Gw="[object WeakMap]",Kw="[object DataView]",EY=Nd(gx),CY=Nd(xx),DY=Nd(vx),OY=Nd(bx),PY=Nd(yx),Cl=vk;(gx&&Cl(new gx(new ArrayBuffer(1)))!=Kw||xx&&Cl(new xx)!=qw||vx&&Cl(vx.resolve())!=Yw||bx&&Cl(new bx)!=Vw||yx&&Cl(new yx)!=Gw)&&(Cl=function(e){var t=vk(e),r=t==AY?e.constructor:void 0,n=r?Nd(r):"";if(n)switch(n){case EY:return Kw;case CY:return qw;case DY:return Yw;case OY:return Vw;case PY:return Gw}return t});var bm=Cl,vg=U1,LY=dk,FY=jH,$Y=uY,Xw=bm,Jw=Ls,Zw=xm,RY=Y1,MY=1,Qw="[object Arguments]",e5="[object Array]",Th="[object Object]",IY=Object.prototype,t5=IY.hasOwnProperty;function BY(e,t,r,n,a,s){var o=Jw(e),l=Jw(t),c=o?e5:Xw(e),d=l?e5:Xw(t);c=c==Qw?Th:c,d=d==Qw?Th:d;var u=c==Th,h=d==Th,m=c==d;if(m&&Zw(e)){if(!Zw(t))return!1;o=!0,u=!1}if(m&&!u)return s||(s=new vg),o||RY(e)?LY(e,t,r,n,a,s):FY(e,t,c,r,n,a,s);if(!(r&MY)){var f=u&&t5.call(e,"__wrapped__"),x=h&&t5.call(t,"__wrapped__");if(f||x){var g=f?e.value():e,b=x?t.value():t;return s||(s=new vg),a(g,b,r,n,s)}}return m?(s||(s=new vg),$Y(e,t,r,n,a,s)):!1}var UY=BY,WY=UY,r5=sl;function bk(e,t,r,n,a){return e===t?!0:e==null||t==null||!r5(e)&&!r5(t)?e!==e&&t!==t:WY(e,t,r,n,bk,a)}var G1=bk,zY=G1;function HY(e,t){return zY(e,t)}var qY=HY;const YY=Ds(qY);function bg(e,t){var r=T1(e);return r?r.innerHeight:Il(e).height}function yk(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(zI(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}function VY(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}var GY=VY,KY=U1,XY=G1,JY=1,ZY=2;function QY(e,t,r,n){var a=r.length,s=a,o=!n;if(e==null)return!s;for(e=Object(e);a--;){var l=r[a];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<s;){l=r[a];var c=l[0],d=e[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var h=new KY;if(n)var m=n(d,u,c,e,t,h);if(!(m===void 0?XY(u,d,JY|ZY,n,h):m))return!1}}return!0}var eV=QY,tV=po;function rV(e){return e===e&&!tV(e)}var wk=rV,nV=wk,aV=yf;function sV(e){for(var t=aV(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,nV(a)]}return t}var iV=sV;function oV(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var _k=oV,lV=eV,cV=iV,dV=_k;function uV(e){var t=cV(e);return t.length==1&&t[0][2]?dV(t[0][0],t[0][1]):function(r){return r===e||lV(r,e,t)}}var fV=uV,hV=Ls,mV=gf,pV=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gV=/^\w*$/;function xV(e,t){if(hV(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||mV(e)?!0:gV.test(e)||!pV.test(e)||t!=null&&e in Object(t)}var K1=xV,Nk=B1,vV="Expected a function";function X1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(vV);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var o=e.apply(this,n);return r.cache=s.set(a,o)||s,o};return r.cache=new(X1.Cache||Nk),r}X1.Cache=Nk;var bV=X1,yV=bV,wV=500;function _V(e){var t=yV(e,function(n){return r.size===wV&&r.clear(),n}),r=t.cache;return t}var NV=_V,kV=NV,SV=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jV=/\\(\\)?/g,TV=kV(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(SV,function(r,n,a,s){t.push(a?s.replace(jV,"$1"):n||r)}),t}),AV=TV;function EV(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var J1=EV,n5=xd,CV=J1,DV=Ls,OV=gf,a5=n5?n5.prototype:void 0,s5=a5?a5.toString:void 0;function kk(e){if(typeof e=="string")return e;if(DV(e))return CV(e,kk)+"";if(OV(e))return s5?s5.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var PV=kk,LV=PV;function FV(e){return e==null?"":LV(e)}var $V=FV,RV=Ls,MV=K1,IV=AV,BV=$V;function UV(e,t){return RV(e)?e:MV(e,t)?[e]:IV(BV(e))}var ym=UV,WV=gf;function zV(e){if(typeof e=="string"||WV(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var wf=zV,HV=ym,qV=wf;function YV(e,t){t=HV(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[qV(t[r++])];return r&&r==n?e:void 0}var wm=YV,VV=wm;function GV(e,t,r){var n=e==null?void 0:VV(e,t);return n===void 0?r:n}var KV=GV;function XV(e,t){return e!=null&&t in Object(e)}var JV=XV,ZV=ym,QV=H1,eG=Ls,tG=j1,rG=S1,nG=wf;function aG(e,t,r){t=ZV(t,e);for(var n=-1,a=t.length,s=!1;++n<a;){var o=nG(t[n]);if(!(s=e!=null&&r(e,o)))break;e=e[o]}return s||++n!=a?s:(a=e==null?0:e.length,!!a&&rG(a)&&tG(o,a)&&(eG(e)||QV(e)))}var sG=aG,iG=JV,oG=sG;function lG(e,t){return e!=null&&oG(e,t,iG)}var cG=lG,dG=G1,uG=KV,fG=cG,hG=K1,mG=wk,pG=_k,gG=wf,xG=1,vG=2;function bG(e,t){return hG(e)&&mG(t)?pG(gG(e),t):function(r){var n=uG(r,e);return n===void 0&&n===t?fG(r,e):dG(t,n,xG|vG)}}var yG=bG;function wG(e){return e}var _m=wG;function _G(e){return function(t){return t==null?void 0:t[e]}}var NG=_G,kG=wm;function SG(e){return function(t){return kG(t,e)}}var jG=SG,TG=NG,AG=jG,EG=K1,CG=wf;function DG(e){return EG(e)?TG(CG(e)):AG(e)}var OG=DG,PG=fV,LG=yG,FG=_m,$G=Ls,RG=OG;function MG(e){return typeof e=="function"?e:e==null?FG:typeof e=="object"?$G(e)?LG(e[0],e[1]):PG(e):RG(e)}var Nm=MG,IG=GY,BG=Nm,UG=KN,WG=Math.max;function zG(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:UG(r);return a<0&&(a=WG(n+a,0)),IG(e,BG(t),a)}var HG=zG;const qG=Ds(HG);var YG=Math.ceil,VG=Math.max;function GG(e,t,r,n){for(var a=-1,s=VG(YG((t-e)/(r||1)),0),o=Array(s);s--;)o[n?s:++a]=e,e+=r;return o}var KG=GG,XG=KG,JG=um,yg=GN;function ZG(e){return function(t,r,n){return n&&typeof n!="number"&&JG(t,r,n)&&(r=n=void 0),t=yg(t),r===void 0?(r=t,t=0):r=yg(r),n=n===void 0?t<r?1:-1:yg(n),XG(t,r,n,e)}}var QG=ZG,eK=QG,tK=eK(),rK=tK;const nK=Ds(rK);var i5=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function aK(e,t){return!!(e===t||i5(e)&&i5(t))}function sK(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!aK(e[r],t[r]))return!1;return!0}function Sk(e,t){t===void 0&&(t=sK);var r=null;function n(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var o=e.apply(this,a);return r={lastResult:o,lastArgs:a,lastThis:this},o}return n.clear=function(){r=null},n}function wx(e,t){var r=T1(e);return r?r.innerWidth:Il(e).width}var o5=xd,iK=H1,oK=Ls,l5=o5?o5.isConcatSpreadable:void 0;function lK(e){return oK(e)||iK(e)||!!(l5&&e&&e[l5])}var cK=lK,dK=W1,uK=cK;function jk(e,t,r,n,a){var s=-1,o=e.length;for(r||(r=uK),a||(a=[]);++s<o;){var l=e[s];t>0&&r(l)?t>1?jk(l,t-1,r,n,a):dK(a,l):n||(a[a.length]=l)}return a}var Tk=jk;function fK(e){return function(t,r,n){for(var a=-1,s=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++a];if(r(s[c],c,s)===!1)break}return t}}var hK=fK,mK=hK,pK=mK(),gK=pK,xK=gK,vK=yf;function bK(e,t){return e&&xK(e,t,vK)}var Z1=bK,yK=pf;function wK(e,t){return function(r,n){if(r==null)return r;if(!yK(r))return e(r,n);for(var a=r.length,s=t?a:-1,o=Object(r);(t?s--:++s<a)&&n(o[s],s,o)!==!1;);return r}}var _K=wK,NK=Z1,kK=_K,SK=kK(NK),jK=SK,TK=jK,AK=pf;function EK(e,t){var r=-1,n=AK(e)?Array(e.length):[];return TK(e,function(a,s,o){n[++r]=t(a,s,o)}),n}var CK=EK;function DK(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var OK=DK,c5=gf;function PK(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,s=c5(e),o=t!==void 0,l=t===null,c=t===t,d=c5(t);if(!l&&!d&&!s&&e>t||s&&o&&c&&!l&&!d||n&&o&&c||!r&&c||!a)return 1;if(!n&&!s&&!d&&e<t||d&&r&&a&&!n&&!s||l&&r&&a||!o&&a||!c)return-1}return 0}var LK=PK,FK=LK;function $K(e,t,r){for(var n=-1,a=e.criteria,s=t.criteria,o=a.length,l=r.length;++n<o;){var c=FK(a[n],s[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var RK=$K,wg=J1,MK=wm,IK=Nm,BK=CK,UK=OK,WK=vm,zK=RK,HK=_m,qK=Ls;function YK(e,t,r){t.length?t=wg(t,function(s){return qK(s)?function(o){return MK(o,s.length===1?s[0]:s)}:s}):t=[HK];var n=-1;t=wg(t,WK(IK));var a=BK(e,function(s,o,l){var c=wg(t,function(d){return d(s)});return{criteria:c,index:++n,value:s}});return UK(a,function(s,o){return zK(s,o,r)})}var VK=YK;function GK(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var KK=GK,XK=KK,d5=Math.max;function JK(e,t,r){return t=d5(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=d5(n.length-t,0),o=Array(s);++a<s;)o[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(o),XK(e,this,l)}}var Ak=JK;function ZK(e){return function(){return e}}var QK=ZK,eX=dc,tX=function(){try{var e=eX(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ek=tX,rX=QK,u5=Ek,nX=_m,aX=u5?function(e,t){return u5(e,"toString",{configurable:!0,enumerable:!1,value:rX(t),writable:!0})}:nX,sX=aX,iX=800,oX=16,lX=Date.now;function cX(e){var t=0,r=0;return function(){var n=lX(),a=oX-(n-r);if(r=n,a>0){if(++t>=iX)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var dX=cX,uX=sX,fX=dX,hX=fX(uX),Ck=hX,mX=_m,pX=Ak,gX=Ck;function xX(e,t){return gX(pX(e,t,mX),e+"")}var Dk=xX,vX=Tk,bX=VK,yX=Dk,f5=um,wX=yX(function(e,t){if(e==null)return[];var r=t.length;return r>1&&f5(e,t[0],t[1])?t=[]:r>2&&f5(t[0],t[1],t[2])&&(t=[t[0]]),bX(e,vX(t,1),[])}),_X=wX;const NX=Ds(_X);function Ok(e){return _3(e)||HN(e)||b1(e)||N3()}function kX(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var SX=kX,jX=po,TX=V1,AX=SX,EX=Object.prototype,CX=EX.hasOwnProperty;function DX(e){if(!jX(e))return AX(e);var t=TX(e),r=[];for(var n in e)n=="constructor"&&(t||!CX.call(e,n))||r.push(n);return r}var OX=DX,PX=pk,LX=OX,FX=pf;function $X(e){return FX(e)?PX(e,!0):LX(e)}var km=$X,RX=Dk,MX=mf,IX=um,BX=km,Pk=Object.prototype,UX=Pk.hasOwnProperty,WX=RX(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&IX(t[0],t[1],a)&&(n=1);++r<n;)for(var s=t[r],o=BX(s),l=-1,c=o.length;++l<c;){var d=o[l],u=e[d];(u===void 0||MX(u,Pk[d])&&!UX.call(e,d))&&(e[d]=s[d])}return e}),zX=WX;const HX=Ds(zX);var h5=Ek;function qX(e,t,r){t=="__proto__"&&h5?h5(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Q1=qX,YX=Q1,VX=Z1,GX=Nm;function KX(e,t){var r={};return t=GX(t),VX(e,function(n,a,s){YX(r,a,t(n,a,s))}),r}var XX=KX;const JX=Ds(XX);function ZX(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var Lk=ZX,QX=Q1,eJ=mf,tJ=Object.prototype,rJ=tJ.hasOwnProperty;function nJ(e,t,r){var n=e[t];(!(rJ.call(e,t)&&eJ(n,r))||r===void 0&&!(t in e))&&QX(e,t,r)}var Fk=nJ,aJ=Fk,sJ=Q1;function iJ(e,t,r,n){var a=!r;r||(r={});for(var s=-1,o=t.length;++s<o;){var l=t[s],c=n?n(r[l],e[l],l,r,e):void 0;c===void 0&&(c=e[l]),a?sJ(r,l,c):aJ(r,l,c)}return r}var _f=iJ,oJ=_f,lJ=yf;function cJ(e,t){return e&&oJ(t,lJ(t),e)}var dJ=cJ,uJ=_f,fJ=km;function hJ(e,t){return e&&uJ(t,fJ(t),e)}var mJ=hJ,F0={exports:{}};F0.exports;(function(e,t){var r=Di,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,o=s?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var h=d.length,m=l?l(h):new d.constructor(h);return d.copy(m),m}e.exports=c})(F0,F0.exports);var pJ=F0.exports;function gJ(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var xJ=gJ,vJ=_f,bJ=z1;function yJ(e,t){return vJ(e,bJ(e),t)}var wJ=yJ,_J=gk,NJ=_J(Object.getPrototypeOf,Object),Sm=NJ,kJ=W1,SJ=Sm,jJ=z1,TJ=hk,AJ=Object.getOwnPropertySymbols,EJ=AJ?function(e){for(var t=[];e;)kJ(t,jJ(e)),e=SJ(e);return t}:TJ,$k=EJ,CJ=_f,DJ=$k;function OJ(e,t){return CJ(e,DJ(e),t)}var PJ=OJ,LJ=fk,FJ=$k,$J=km;function RJ(e){return LJ(e,$J,FJ)}var Rk=RJ,MJ=Object.prototype,IJ=MJ.hasOwnProperty;function BJ(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&IJ.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var UJ=BJ,m5=uk;function WJ(e){var t=new e.constructor(e.byteLength);return new m5(t).set(new m5(e)),t}var e2=WJ,zJ=e2;function HJ(e,t){var r=t?zJ(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var qJ=HJ,YJ=/\w*$/;function VJ(e){var t=new e.constructor(e.source,YJ.exec(e));return t.lastIndex=e.lastIndex,t}var GJ=VJ,p5=xd,g5=p5?p5.prototype:void 0,x5=g5?g5.valueOf:void 0;function KJ(e){return x5?Object(x5.call(e)):{}}var XJ=KJ,JJ=e2;function ZJ(e,t){var r=t?JJ(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var QJ=ZJ,eZ=e2,tZ=qJ,rZ=GJ,nZ=XJ,aZ=QJ,sZ="[object Boolean]",iZ="[object Date]",oZ="[object Map]",lZ="[object Number]",cZ="[object RegExp]",dZ="[object Set]",uZ="[object String]",fZ="[object Symbol]",hZ="[object ArrayBuffer]",mZ="[object DataView]",pZ="[object Float32Array]",gZ="[object Float64Array]",xZ="[object Int8Array]",vZ="[object Int16Array]",bZ="[object Int32Array]",yZ="[object Uint8Array]",wZ="[object Uint8ClampedArray]",_Z="[object Uint16Array]",NZ="[object Uint32Array]";function kZ(e,t,r){var n=e.constructor;switch(t){case hZ:return eZ(e);case sZ:case iZ:return new n(+e);case mZ:return tZ(e,r);case pZ:case gZ:case xZ:case vZ:case bZ:case yZ:case wZ:case _Z:case NZ:return aZ(e,r);case oZ:return new n;case lZ:case uZ:return new n(e);case cZ:return rZ(e);case dZ:return new n;case fZ:return nZ(e)}}var SZ=kZ,jZ=po,v5=Object.create,TZ=function(){function e(){}return function(t){if(!jZ(t))return{};if(v5)return v5(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Mk=TZ,AZ=Mk,EZ=Sm,CZ=V1;function DZ(e){return typeof e.constructor=="function"&&!CZ(e)?AZ(EZ(e)):{}}var OZ=DZ,PZ=bm,LZ=sl,FZ="[object Map]";function $Z(e){return LZ(e)&&PZ(e)==FZ}var RZ=$Z,MZ=RZ,IZ=vm,b5=q1,y5=b5&&b5.isMap,BZ=y5?IZ(y5):MZ,UZ=BZ,WZ=bm,zZ=sl,HZ="[object Set]";function qZ(e){return zZ(e)&&WZ(e)==HZ}var YZ=qZ,VZ=YZ,GZ=vm,w5=q1,_5=w5&&w5.isSet,KZ=_5?GZ(_5):VZ,XZ=KZ,JZ=U1,ZZ=Lk,QZ=Fk,eQ=dJ,tQ=mJ,rQ=pJ,nQ=xJ,aQ=wJ,sQ=PJ,iQ=xk,oQ=Rk,lQ=bm,cQ=UJ,dQ=SZ,uQ=OZ,fQ=Ls,hQ=xm,mQ=UZ,pQ=po,gQ=XZ,xQ=yf,vQ=km,bQ=1,yQ=2,wQ=4,Ik="[object Arguments]",_Q="[object Array]",NQ="[object Boolean]",kQ="[object Date]",SQ="[object Error]",Bk="[object Function]",jQ="[object GeneratorFunction]",TQ="[object Map]",AQ="[object Number]",Uk="[object Object]",EQ="[object RegExp]",CQ="[object Set]",DQ="[object String]",OQ="[object Symbol]",PQ="[object WeakMap]",LQ="[object ArrayBuffer]",FQ="[object DataView]",$Q="[object Float32Array]",RQ="[object Float64Array]",MQ="[object Int8Array]",IQ="[object Int16Array]",BQ="[object Int32Array]",UQ="[object Uint8Array]",WQ="[object Uint8ClampedArray]",zQ="[object Uint16Array]",HQ="[object Uint32Array]",Pr={};Pr[Ik]=Pr[_Q]=Pr[LQ]=Pr[FQ]=Pr[NQ]=Pr[kQ]=Pr[$Q]=Pr[RQ]=Pr[MQ]=Pr[IQ]=Pr[BQ]=Pr[TQ]=Pr[AQ]=Pr[Uk]=Pr[EQ]=Pr[CQ]=Pr[DQ]=Pr[OQ]=Pr[UQ]=Pr[WQ]=Pr[zQ]=Pr[HQ]=!0;Pr[SQ]=Pr[Bk]=Pr[PQ]=!1;function Xh(e,t,r,n,a,s){var o,l=t&bQ,c=t&yQ,d=t&wQ;if(r&&(o=a?r(e,n,a,s):r(e)),o!==void 0)return o;if(!pQ(e))return e;var u=fQ(e);if(u){if(o=cQ(e),!l)return nQ(e,o)}else{var h=lQ(e),m=h==Bk||h==jQ;if(hQ(e))return rQ(e,l);if(h==Uk||h==Ik||m&&!a){if(o=c||m?{}:uQ(e),!l)return c?sQ(e,tQ(o,e)):aQ(e,eQ(o,e))}else{if(!Pr[h])return a?e:{};o=dQ(e,h,l)}}s||(s=new JZ);var f=s.get(e);if(f)return f;s.set(e,o),gQ(e)?e.forEach(function(b){o.add(Xh(b,t,r,b,e,s))}):mQ(e)&&e.forEach(function(b,y){o.set(y,Xh(b,t,r,y,e,s))});var x=d?c?oQ:iQ:c?vQ:xQ,g=u?void 0:x(e);return ZZ(g||e,function(b,y){g&&(y=b,b=e[y]),QZ(o,y,Xh(b,t,r,y,e,s))}),o}var qQ=Xh;function YQ(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var VQ=YQ,GQ=wm,KQ=qN;function XQ(e,t){return t.length<2?e:GQ(e,KQ(t,0,-1))}var JQ=XQ,ZQ=ym,QQ=VQ,eee=JQ,tee=wf;function ree(e,t){return t=ZQ(t,e),e=eee(e,t),e==null||delete e[tee(QQ(t))]}var nee=ree,aee=vd,see=Sm,iee=sl,oee="[object Object]",lee=Function.prototype,cee=Object.prototype,Wk=lee.toString,dee=cee.hasOwnProperty,uee=Wk.call(Object);function fee(e){if(!iee(e)||aee(e)!=oee)return!1;var t=see(e);if(t===null)return!0;var r=dee.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Wk.call(r)==uee}var hee=fee,mee=hee;function pee(e){return mee(e)?void 0:e}var gee=pee,xee=Tk;function vee(e){var t=e==null?0:e.length;return t?xee(e,1):[]}var bee=vee,yee=bee,wee=Ak,_ee=Ck;function Nee(e){return _ee(wee(e,void 0,yee),e+"")}var kee=Nee,See=J1,jee=qQ,Tee=nee,Aee=ym,Eee=_f,Cee=gee,Dee=kee,Oee=Rk,Pee=1,Lee=2,Fee=4,$ee=Dee(function(e,t){var r={};if(e==null)return r;var n=!1;t=See(t,function(s){return s=Aee(s,e),n||(n=s.length>1),s}),Eee(e,Oee(e),r),n&&(r=jee(r,Pee|Lee|Fee,Cee));for(var a=t.length;a--;)Tee(r,t[a]);return r}),Ree=$ee;const Mee=Ds(Ree);var Iee=Lk,Bee=Mk,Uee=Z1,Wee=Nm,zee=Sm,Hee=Ls,qee=xm,Yee=k1,Vee=po,Gee=Y1;function Kee(e,t,r){var n=Hee(e),a=n||qee(e)||Gee(e);if(t=Wee(t),r==null){var s=e&&e.constructor;a?r=n?new s:[]:Vee(e)?r=Yee(s)?Bee(zee(e)):{}:r={}}return(a?Iee:Uee)(e,function(o,l,c){return t(r,o,l,c)}),r}var Xee=Kee;const Jee=Ds(Xee);var Zee={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n,a){n.prototype.isBetween=function(s,o,l,c){var d=a(s),u=a(o),h=(c=c||"()")[0]==="(",m=c[1]===")";return(h?this.isAfter(d,l):!this.isBefore(d,l))&&(m?this.isBefore(u,l):!this.isAfter(u,l))||(h?this.isBefore(d,l):!this.isAfter(d,l))&&(m?this.isAfter(u,l):!this.isBefore(u,l))}}})})(Zee);var Qee={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n){n.prototype.isSameOrAfter=function(a,s){return this.isSame(a,s)||this.isAfter(a,s)}}})})(Qee);var ete={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n){n.prototype.isSameOrBefore=function(a,s){return this.isSame(a,s)||this.isBefore(a,s)}}})})(ete);var tte={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n,a){var s=n.prototype,o=function(h){return h&&(h.indexOf?h:h.s)},l=function(h,m,f,x,g){var b=h.name?h:h.$locale(),y=o(b[m]),N=o(b[f]),S=y||N.map(function(D){return D.slice(0,x)});if(!g)return S;var _=b.weekStart;return S.map(function(D,I){return S[(I+(_||0))%7]})},c=function(){return a.Ls[a.locale()]},d=function(h,m){return h.formats[m]||function(f){return f.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,g,b){return g||b.slice(1)})}(h.formats[m.toUpperCase()])},u=function(){var h=this;return{months:function(m){return m?m.format("MMMM"):l(h,"months")},monthsShort:function(m){return m?m.format("MMM"):l(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(m){return m?m.format("dddd"):l(h,"weekdays")},weekdaysMin:function(m){return m?m.format("dd"):l(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(m){return m?m.format("ddd"):l(h,"weekdaysShort","weekdays",3)},longDateFormat:function(m){return d(h.$locale(),m)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return u.bind(this)()},a.localeData=function(){var h=c();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(m){return d(h,m)},meridiem:h.meridiem,ordinal:h.ordinal}},a.months=function(){return l(c(),"months")},a.monthsShort=function(){return l(c(),"monthsShort","months",3)},a.weekdays=function(h){return l(c(),"weekdays",null,null,h)},a.weekdaysShort=function(h){return l(c(),"weekdaysShort","weekdays",3,h)},a.weekdaysMin=function(h){return l(c(),"weekdaysMin","weekdays",2,h)}}})})(tte);var rte={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,s){var o=a.prototype,l=o.format;s.en.formats=r,o.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var d=this.$locale().formats,u=function(h,m){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(f,x,g){var b=g&&g.toUpperCase();return x||m[g]||r[g]||m[b].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(y,N,S){return N||S.slice(1)})})}(c,d===void 0?{}:d);return l.call(this,u)}}})})(rte);var nte={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n,a){var s=function(o,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var c;l.length===1&&l[0].length>0&&(l=l[0]),c=(l=l.filter(function(u){return u}))[0];for(var d=1;d<l.length;d+=1)l[d].isValid()&&!l[d][o](c)||(c=l[d]);return c};a.max=function(){var o=[].slice.call(arguments,0);return s("isAfter",o)},a.min=function(){var o=[].slice.call(arguments,0);return s("isBefore",o)}}})})(nte);var ate={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(s,o,l){var c=o.prototype;l.utc=function(g){var b={date:g,utc:!0,args:arguments};return new o(b)},c.utc=function(g){var b=l(this.toDate(),{locale:this.$L,utc:!0});return g?b.add(this.utcOffset(),r):b},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var d=c.parse;c.parse=function(g){g.utc&&(this.$u=!0),this.$utils().u(g.$offset)||(this.$offset=g.$offset),d.call(this,g)};var u=c.init;c.init=function(){if(this.$u){var g=this.$d;this.$y=g.getUTCFullYear(),this.$M=g.getUTCMonth(),this.$D=g.getUTCDate(),this.$W=g.getUTCDay(),this.$H=g.getUTCHours(),this.$m=g.getUTCMinutes(),this.$s=g.getUTCSeconds(),this.$ms=g.getUTCMilliseconds()}else u.call(this)};var h=c.utcOffset;c.utcOffset=function(g,b){var y=this.$utils().u;if(y(g))return this.$u?0:y(this.$offset)?h.call(this):this.$offset;if(typeof g=="string"&&(g=function(D){D===void 0&&(D="");var I=D.match(n);if(!I)return null;var O=(""+I[0]).match(a)||["-",0,0],R=O[0],E=60*+O[1]+ +O[2];return E===0?0:R==="+"?E:-E}(g),g===null))return this;var N=Math.abs(g)<=16?60*g:g;if(N===0)return this.utc(b);var S=this.clone();if(b)return S.$offset=N,S.$u=!1,S;var _=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(S=this.local().add(N+_,r)).$offset=N,S.$x.$localOffset=_,S};var m=c.format;c.format=function(g){var b=g||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return m.call(this,b)},c.valueOf=function(){var g=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*g},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var f=c.toDate;c.toDate=function(g){return g==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var x=c.diff;c.diff=function(g,b,y){if(g&&this.$u===g.$u)return x.call(this,g,b,y);var N=this.local(),S=l(g).local();return x.call(N,S,b,y)}}})})(ate);var ste={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Ns,function(){return function(r,n){n.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(ste);function gi(e){return e.children}var Ra={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},_a={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},N5=Object.keys(_a).map(function(e){return _a[e]});ft.oneOfType([ft.string,ft.func]);ft.any;ft.func;ft.oneOfType([ft.arrayOf(ft.oneOf(N5)),ft.objectOf(function(e,t){var r=N5.indexOf(t)!==-1&&typeof e[t]=="boolean";if(r)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return ft.elementType.apply(ft,[e,t].concat(a))})]);ft.oneOfType([ft.oneOf(["overlap","no-overlap"]),ft.func]);var k5={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function zk(e,t){var r=Jn(e,"month");return Jn(r,"week",t.startOfWeek())}function Hk(e,t){var r=E0(e,"month");return E0(r,"week",t.startOfWeek())}function ite(e,t){for(var r=zk(e,t),n=Hk(e,t),a=[];pd(r,n,"day");)a.push(r),r=Qs(r,1,"day");return a}function ote(e,t){var r=Jn(e,t);return ff(r,e)?r:Qs(r,1,t)}function lte(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=e,a=[];pd(n,t,r);)a.push(n),n=Qs(n,1,r);return a}function cte(e,t){return t==null&&e==null?null:(t==null&&(t=new Date),e==null&&(e=new Date),e=Jn(e,"day"),e=zu(e,zu(t)),e=rd(e,rd(t)),e=Wu(e,Wu(t)),Uu(e,Uu(t)))}function S5(e){return zu(e)===0&&rd(e)===0&&Wu(e)===0&&Uu(e)===0}function dte(e,t,r,n){return r==="day"&&(r="date"),Math.abs(ow[r](e,void 0,n)-ow[r](t,void 0,n))}function t2(e,t,r){return!r||r==="milliseconds"?Math.abs(+e-+t):Math.round(Math.abs(+Jn(e,r)/k5[r]-+Jn(t,r)/k5[r]))}var ute=ft.oneOfType([ft.string,ft.func]);function fte(e,t,r,n,a){var s=typeof n=="function"?n(r,a,e):t.call(e,r,n,a);return Fu(s==null||typeof s=="string","`localizer format(..)` must return a string, null, or undefined"),s}function hte(e,t,r){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,t+r,0,0)}function r2(e,t){return e.getTimezoneOffset()-t.getTimezoneOffset()}function mte(e,t){return t2(e,t,"minutes")+r2(e,t)}function pte(e){var t=Jn(e,"day");return t2(t,e,"minutes")+r2(t,e)}function gte(e,t){return N1(e,t,"day")}function xte(e,t,r){var n=ff(e,t,"minutes");return n?hf(t,r,"minutes"):dm(t,r,"minutes")}function _x(e,t){return dte(e,t,"day")}function vte(e){var t=e.evtA,r=t.start,n=t.end,a=t.allDay,s=e.evtB,o=s.start,l=s.end,c=s.allDay,d=+Jn(r,"day")-+Jn(o,"day"),u=_x(r,n),h=_x(o,l);return d||h-u||!!c-!!a||+r-+o||+n-+l}function bte(e){var t=e.event,r=t.start,n=t.end,a=e.range,s=a.start,o=a.end,l=Jn(r,"day"),c=pd(l,o,"day"),d=_1(l,n,"minutes"),u=d?dm(n,s,"minutes"):hf(n,s,"minutes");return c&&u}function yte(e,t){return ff(e,t,"day")}function wte(e,t){return S5(e)&&S5(t)}var _te=On(function e(t){var r=this;Dn(this,e),Fu(typeof t.format=="function","date localizer `format(..)` must be a function"),Fu(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||ute,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return fte.apply(void 0,[r,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||cte,this.inRange=t.inRange||BN,this.lt=t.lt||N1,this.lte=t.lte||pd,this.gt=t.gt||dm,this.gte=t.gte||hf,this.eq=t.eq||ff,this.neq=t.neq||_1,this.startOf=t.startOf||Jn,this.endOf=t.endOf||E0,this.add=t.add||Qs,this.range=t.range||lte,this.diff=t.diff||t2,this.ceil=t.ceil||ote,this.min=t.min||MN,this.max=t.max||IN,this.minutes=t.minutes||rd,this.daySpan=t.daySpan||_x,this.firstVisibleDay=t.firstVisibleDay||zk,this.lastVisibleDay=t.lastVisibleDay||Hk,this.visibleDays=t.visibleDays||ite,this.getSlotDate=t.getSlotDate||hte,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||r2,this.getTotalMin=t.getTotalMin||mte,this.getMinutesFromMidnight=t.getMinutesFromMidnight||pte,this.continuesPrior=t.continuesPrior||gte,this.continuesAfter=t.continuesAfter||xte,this.sortEvents=t.sortEvents||vte,this.inEventRange=t.inEventRange||bte,this.isSameDate=t.isSameDate||yte,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||wte,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function Nte(e,t,r,n){var a=Er(Er({},e.formats),r);return Er(Er({},e),{},{messages:n,startOfWeek:function(){return e.startOfWeek(t)},format:function(o,l){return e.format(o,a[l]||l,t)}})}var kte=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.navigate=function(o){r.props.onNavigate(o)},r.view=function(o){r.props.onView(o)},r}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,s=n.label;return Ce.createElement("div",{className:"rbc-toolbar"},Ce.createElement("span",{className:"rbc-btn-group"},Ce.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.TODAY)},a.today),Ce.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.PREVIOUS)},a.previous),Ce.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.NEXT)},a.next)),Ce.createElement("span",{className:"rbc-toolbar-label"},s),Ce.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,s=this.props.views,o=this.props.view;if(s.length>1)return s.map(function(l){return Ce.createElement("button",{type:"button",key:l,className:rn({"rbc-active":o===l}),onClick:a.view.bind(null,l)},n[l])})}}])}(Ce.Component);function Ir(e,t){e&&e.apply(null,[].concat(t))}var Ste={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function jte(e){return Er(Er({},Ste),e)}function Tte(e){var t=e.ref,r=e.callback;J.useEffect(function(){var n=function(s){t.current&&!t.current.contains(s.target)&&r()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,r])}var Ate=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],qk=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.style,s=n.className,o=n.event,l=n.selected,c=n.isAllDay,d=n.onSelect,u=n.onDoubleClick,h=n.onKeyPress,m=n.localizer,f=n.continuesPrior,x=n.continuesAfter,g=n.accessors,b=n.getters,y=n.children,N=n.components,S=N.event,_=N.eventWrapper,D=n.slotStart,I=n.slotEnd,O=Ai(n,Ate);delete O.resizable;var R=g.title(o),E=g.tooltip(o),B=g.end(o),C=g.start(o),M=g.allDay(o),U=c||M||m.diff(C,m.ceil(B,"day"),"day")>1,F=b.eventProp(o,C,B,l),ne=Ce.createElement("div",{className:"rbc-event-content",title:E||void 0},S?Ce.createElement(S,{event:o,continuesPrior:f,continuesAfter:x,title:R,isAllDay:M,localizer:m,slotStart:D,slotEnd:I}):R);return Ce.createElement(_,Object.assign({},this.props,{type:"date"}),Ce.createElement("div",Object.assign({},O,{style:Er(Er({},F.style),a),className:rn("rbc-event",s,F.className,{"rbc-selected":l,"rbc-event-allday":U,"rbc-event-continues-prior":f,"rbc-event-continues-after":x}),onClick:function(ee){return d&&d(o,ee)},onDoubleClick:function(ee){return u&&u(o,ee)},onKeyDown:function(ee){return h&&h(o,ee)}}),typeof y=="function"?y(ne):ne))}}])}(Ce.Component);function jm(e,t){return!e||t==null?!1:YY(e,t)}function Yk(e,t){var r=e.right-e.left,n=r/t;return n}function Vk(e,t,r,n){var a=Yk(e,n);return r?n-1-Math.floor((t-e.left)/a):Math.floor((t-e.left)/a)}function Ete(e,t){var r=t.x,n=t.y;return n>=e.top&&n<=e.bottom&&r>=e.left&&r<=e.right}function Cte(e,t,r,n,a){var s=-1,o=-1,l=n-1,c=Yk(t,n),d=Vk(t,r.x,a,n),u=t.top<r.y&&t.bottom>r.y,h=t.top<e.y&&t.bottom>e.y,m=e.y>t.bottom,f=t.top>e.y,x=r.top<t.top&&r.bottom>t.bottom;return x&&(s=0,o=l),u&&(f?(s=0,o=d):m&&(s=d,o=l)),h&&(s=o=a?l-Math.floor((e.x-t.left)/c):Math.floor((e.x-t.left)/c),u?d<s?s=d:o=d:e.y<r.y?o=l:s=0),{startIdx:s,endIdx:o}}function Dte(e){var t=e.target,r=e.offset,n=e.container,a=e.box,s=Il(t),o=s.top,l=s.left,c=s.width,d=s.height,u=Il(n),h=u.top,m=u.left,f=u.width,x=u.height,g=Il(a),b=g.width,y=g.height,N=h+x,S=m+f,_=o+y,D=l+b,I=r.x,O=r.y,R=_>N?o-y-O:o+O+d,E=D>S?l+I-b+c:l+I;return{topOffset:R,leftOffset:E}}function Ote(e){var t=e.containerRef,r=e.accessors,n=e.getters,a=e.selected,s=e.components,o=e.localizer,l=e.position,c=e.show,d=e.events,u=e.slotStart,h=e.slotEnd,m=e.onSelect,f=e.onDoubleClick,x=e.onKeyPress,g=e.handleDragStart,b=e.popperRef,y=e.target,N=e.offset;Tte({ref:b,callback:c}),J.useLayoutEffect(function(){var D=Dte({target:y,offset:N,container:t.current,box:b.current}),I=D.topOffset,O=D.leftOffset;b.current.style.top="".concat(I,"px"),b.current.style.left="".concat(O,"px")},[N.x,N.y,y]);var S=l.width,_={minWidth:S+S/2};return Ce.createElement("div",{style:_,className:"rbc-overlay",ref:b},Ce.createElement("div",{className:"rbc-overlay-header"},o.format(u,"dayHeaderFormat")),d.map(function(D,I){return Ce.createElement(qk,{key:I,type:"popup",localizer:o,event:D,getters:n,onSelect:m,accessors:r,components:s,onDoubleClick:f,onKeyPress:x,continuesPrior:o.lt(r.end(D),u,"day"),continuesAfter:o.gte(r.start(D),h,"day"),slotStart:u,slotEnd:h,selected:jm(D,a),draggable:!0,onDragStart:function(){return g(D)},onDragEnd:function(){return c()}})}))}var Gk=Ce.forwardRef(function(e,t){return Ce.createElement(Ote,Object.assign({},e,{popperRef:t}))});Gk.propTypes={accessors:ft.object.isRequired,getters:ft.object.isRequired,selected:ft.object,components:ft.object.isRequired,localizer:ft.object.isRequired,position:ft.object.isRequired,show:ft.func.isRequired,events:ft.array.isRequired,slotStart:ft.instanceOf(Date).isRequired,slotEnd:ft.instanceOf(Date),onSelect:ft.func,onDoubleClick:ft.func,onKeyPress:ft.func,handleDragStart:ft.func,style:ft.object,offset:ft.shape({x:ft.number,y:ft.number})};function Pte(e){var t=e.containerRef,r=e.popupOffset,n=r===void 0?5:r,a=e.overlay,s=e.accessors,o=e.localizer,l=e.components,c=e.getters,d=e.selected,u=e.handleSelectEvent,h=e.handleDoubleClickEvent,m=e.handleKeyPressEvent,f=e.handleDragStart,x=e.onHide,g=e.overlayDisplay,b=J.useRef(null);if(!a.position)return null;var y=n;isNaN(n)||(y={x:n,y:n});var N=a.position,S=a.events,_=a.date,D=a.end;return Ce.createElement(M1,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:x,target:a.target},function(I){var O=I.props;return Ce.createElement(Gk,Object.assign({},O,{containerRef:t,ref:b,target:a.target,offset:y,accessors:s,getters:c,selected:d,components:l,localizer:o,position:N,show:g,events:S,slotStart:_,slotEnd:D,onSelect:u,onDoubleClick:h,onKeyPress:m,handleDragStart:f}))})}var n2=Ce.forwardRef(function(e,t){return Ce.createElement(Pte,Object.assign({},e,{containerRef:t}))});n2.propTypes={popupOffset:ft.oneOfType([ft.number,ft.shape({x:ft.number,y:ft.number})]),overlay:ft.shape({position:ft.object,events:ft.array,date:ft.instanceOf(Date),end:ft.instanceOf(Date)}),accessors:ft.object.isRequired,localizer:ft.object.isRequired,components:ft.object.isRequired,getters:ft.object.isRequired,selected:ft.object,handleSelectEvent:ft.func,handleDoubleClickEvent:ft.func,handleKeyPressEvent:ft.func,handleDragStart:ft.func,onHide:ft.func,overlayDisplay:ft.func};function la(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return uu(r,e,t,{passive:!1})}function Lte(e,t,r){return!e||Hu(e,document.elementFromPoint(t,r))}function Fte(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return yk(a,".rbc-event",e)}function $te(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return yk(a,".rbc-show-more",e)}function $0(e,t){return!!Fte(e,t)}function Rte(e,t){return!!$te(e,t)}function iu(e){var t=e;return e.touches&&e.touches.length&&(t=e.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var j5=5,Mte=250,Kk=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.global,a=n===void 0?!1:n,s=r.longPressThreshold,o=s===void 0?250:s,l=r.validContainers,c=l===void 0?[]:l;Dn(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=o,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=la("touchmove",function(){},window),this._removeKeyDownListener=la("keydown",this._keyListener),this._removeKeyUpListener=la("keyup",this._keyListener),this._removeDropFromOutsideListener=la("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=la("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return On(e,[{key:"on",value:function(r,n){var a=this._listeners[r]||(this._listeners[r]=[]);return a.push(n),{remove:function(){var o=a.indexOf(n);o!==-1&&a.splice(o,1)}}}},{key:"emit",value:function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];var o,l=this._listeners[r]||[];return l.forEach(function(c){o===void 0&&(o=c.apply(void 0,a))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(r){var n=this._selectRect;return!n||!this.selecting?!1:T5(n,rc(r))}},{key:"filter",value:function(r){var n=this._selectRect;return!n||!this.selecting?[]:r.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(r,n){var a=this,s=null,o=null,l=null,c=function(m){s=setTimeout(function(){u(),r(m)},a.longPressThreshold),o=la("touchmove",function(){return u()}),l=la("touchend",function(){return u()})},d=la("touchstart",c),u=function(){s&&clearTimeout(s),o&&o(),l&&l(),s=null,o=null,l=null};return n&&c(n),function(){u(),d()}}},{key:"_addInitialEventListener",value:function(){var r=this,n=la("mousedown",function(s){r._removeInitialEventListener(),r._handleInitialEvent(s),r._removeInitialEventListener=la("mousedown",r._handleInitialEvent)}),a=la("touchstart",function(s){r._removeInitialEventListener(),r._removeInitialEventListener=r._addLongPressListener(r._handleInitialEvent,s)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(r){var n=iu(r),a=n.pageX,s=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:a,y:s,clientX:o,clientY:l}),r.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(r){var n=iu(r),a=n.pageX,s=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:a,y:s,clientX:o,clientY:l}),r.preventDefault()}},{key:"_handleInitialEvent",value:function(r){if(this._initialEvent=r,!this.isDetached){var n=iu(r),a=n.clientX,s=n.clientY,o=n.pageX,l=n.pageY,c=this.container(),d,u;if(!(r.which===3||r.button===2||!Lte(c,a,s))){if(!this.globalMouse&&c&&!Hu(c,r.target)){var h=Ite(0),m=h.top,f=h.left,x=h.bottom,g=h.right;if(u=rc(c),d=T5({top:u.top-m,left:u.left-f,bottom:u.bottom+x,right:u.right+g},{top:l,left:o}),!d)return}var b=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(r.type),x:o,y:l,clientX:a,clientY:s});if(b!==!1)switch(r.type){case"mousedown":this._removeEndListener=la("mouseup",this._handleTerminatingEvent),this._onEscListener=la("keydown",this._handleTerminatingEvent),this._removeMoveListener=la("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(r),this._removeEndListener=la("touchend",this._handleTerminatingEvent),this._removeMoveListener=la("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(r){var n=r.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(s){return!!n.closest(s)})}},{key:"_handleTerminatingEvent",value:function(r){var n=this.selecting,a=this._selectRect;if(!n&&r.type.includes("key")&&(r=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!r){var s=!this.container||Hu(this.container(),r.target),o=this._isWithinValidContainer(r);return r.key==="Escape"||!o?this.emit("reset"):!n&&s?this._handleClickEvent(r):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(r){var n=iu(r),a=n.pageX,s=n.pageY,o=n.clientX,l=n.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<Mte?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:s,clientX:o,clientY:l})):(this._lastClickData={timestamp:c},this.emit("click",{x:a,y:s,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(r){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,s=n.y,o=iu(r),l=o.pageX,c=o.pageY,d=Math.abs(a-l),u=Math.abs(s-c),h=Math.min(l,a),m=Math.min(c,s),f=this.selecting,x=this.isClick(l,c);x&&!f&&!(d||u)||(!f&&!x&&this.emit("selectStart",this._initialEventData),x||(this.selecting=!0,this._selectRect={top:m,left:h,x:l,y:c,right:h+d,bottom:m+u},this.emit("selecting",this._selectRect)),r.preventDefault())}}},{key:"_keyListener",value:function(r){this.ctrl=r.metaKey||r.ctrlKey}},{key:"isClick",value:function(r,n){var a=this._initialEventData,s=a.x,o=a.y,l=a.isTouch;return!l&&Math.abs(r-s)<=j5&&Math.abs(n-o)<=j5}}])}();function Ite(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Qt(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function T5(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=rc(e),a=n.top,s=n.left,o=n.right,l=o===void 0?s:o,c=n.bottom,d=c===void 0?a:c,u=rc(t),h=u.top,m=u.left,f=u.right,x=f===void 0?m:f,g=u.bottom,b=g===void 0?h:g;return!(d-r<h||a+r>b||l-r<m||s+r>x)}function rc(e){if(!e.getBoundingClientRect)return e;var t=e.getBoundingClientRect(),r=t.left+A5("left"),n=t.top+A5("top");return{top:n,left:r,right:(e.offsetWidth||0)+r,bottom:(e.offsetHeight||0)+n}}function A5(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}var Bte=function(e){function t(r,n){var a;return Dn(this,t),a=pa(this,t,[r,n]),a.state={selecting:!1},a.containerRef=J.createRef(),a}return ga(t,e),On(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,s=n.getNow,o=n.getters,l=n.date,c=n.components.dateCellWrapper,d=n.localizer,u=this.state,h=u.selecting,m=u.startIdx,f=u.endIdx,x=s();return Ce.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(g,b){var y=h&&b>=m&&b<=f,N=o.dayProp(g),S=N.className,_=N.style;return Ce.createElement(c,{key:b,value:g,range:a},Ce.createElement("div",{style:_,className:rn("rbc-day-bg",S,y&&"rbc-selected-cell",d.isSameDate(g,x)&&"rbc-today",l&&d.neq(l,g,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,s=this._selector=new Kk(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(c,d){if(!$0(a,c)&&!Rte(a,c)){var u=rc(a),h=n.props,m=h.range,f=h.rtl;if(Ete(u,c)){var x=Vk(u,c.x,f,m.length);n._selectSlot({startIdx:x,endIdx:x,action:d,box:c})}}n._initial={},n.setState({selecting:!1})};s.on("selecting",function(l){var c=n.props,d=c.range,u=c.rtl,h=-1,m=-1;if(n.state.selecting||(Ir(n.props.onSelectStart,[l]),n._initial={x:l.x,y:l.y}),s.isSelected(a)){var f=rc(a),x=Cte(n._initial,f,l,d.length,u);h=x.startIdx,m=x.endIdx}n.setState({selecting:!0,startIdx:h,endIdx:m})}),s.on("beforeSelect",function(l){if(n.props.selectable==="ignoreEvents")return!$0(n.containerRef.current,l)}),s.on("click",function(l){return o(l,"click")}),s.on("doubleClick",function(l){return o(l,"doubleClick")}),s.on("select",function(l){n._selectSlot(Er(Er({},n.state),{},{action:"select",bounds:l})),n._initial={},n.setState({selecting:!1}),Ir(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,s=n.startIdx,o=n.action,l=n.bounds,c=n.box;a!==-1&&s!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:s,end:a,action:o,bounds:l,box:c,resourceId:this.props.resourceId})}}])}(Ce.Component),ys={propTypes:{slotMetrics:ft.object.isRequired,selected:ft.object,isAllDay:ft.bool,accessors:ft.object.isRequired,localizer:ft.object.isRequired,components:ft.object.isRequired,getters:ft.object.isRequired,onSelect:ft.func,onDoubleClick:ft.func,onKeyPress:ft.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,r){var n=t.selected;t.isAllDay;var a=t.accessors,s=t.getters,o=t.onSelect,l=t.onDoubleClick,c=t.onKeyPress,d=t.localizer,u=t.slotMetrics,h=t.components,m=t.resizable,f=u.continuesPrior(r),x=u.continuesAfter(r);return Ce.createElement(qk,{event:r,getters:s,localizer:d,accessors:a,components:h,onSelect:o,onDoubleClick:l,onKeyPress:c,continuesPrior:f,continuesAfter:x,slotStart:u.first,slotEnd:u.last,selected:jm(r,n),resizable:m})},renderSpan:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",s=Math.abs(r)/t*100+"%";return Ce.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:s,flexBasis:s,maxWidth:s}},a)}},Xk=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this,a=this.props,s=a.segments,o=a.slotMetrics.slots,l=a.className,c=1;return Ce.createElement("div",{className:rn(l,"rbc-row")},s.reduce(function(d,u,h){var m=u.event,f=u.left,x=u.right,g=u.span,b="_lvl_"+h,y=f-c,N=ys.renderEvent(n.props,m);return y&&d.push(ys.renderSpan(o,y,"".concat(b,"_gap"))),d.push(ys.renderSpan(o,g,b,N)),c=x+1,d},[]))}}])}(Ce.Component);Xk.defaultProps=Er({},ys.defaultProps);function Jk(e){var t=e.dateRange,r=e.unit,n=r===void 0?"day":r,a=e.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function Ute(e,t,r,n){var a=Jk({dateRange:t,localizer:n}),s=a.first,o=a.last,l=n.diff(s,o,"day"),c=n.max(n.startOf(r.start(e),"day"),s),d=n.min(n.ceil(r.end(e),"day"),o),u=qG(t,function(m){return n.isSameDate(m,c)}),h=n.diff(c,d,"day");return h=Math.min(h,l),h=Math.max(h-n.segmentOffset,1),{event:e,span:h,left:u+1,right:Math.max(u+h,1)}}function Nx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r,n,a,s=[],o=[];for(r=0;r<e.length;r++){for(a=e[r],n=0;n<s.length&&Wte(a,s[n]);n++);n>=t?o.push(a):(s[n]||(s[n]=[])).push(a)}for(r=0;r<s.length;r++)s[r].sort(function(l,c){return l.left-c.left});return{levels:s,extra:o}}function Vu(e,t,r,n,a){var s={start:n.start(e),end:n.end(e)},o={start:t,end:r};return a.inEventRange({event:s,range:o})}function Wte(e,t){return t.some(function(r){return r.left<=e.right&&r.right>=e.left})}function zte(e,t,r){var n=Gh(e),a=[],s=[];n.forEach(function(c){var d=t.start(c),u=t.end(c);r.daySpan(d,u)>1?a.push(c):s.push(c)});var o=a.sort(function(c,d){return kx(c,d,t,r)}),l=s.sort(function(c,d){return kx(c,d,t,r)});return[].concat(Gh(o),Gh(l))}function kx(e,t,r,n){var a={start:r.start(e),end:r.end(e),allDay:r.allDay(e)},s={start:r.start(t),end:r.end(t),allDay:r.allDay(t)};return n.sortEvents({evtA:a,evtB:s})}var Sx=function(t,r){return t.left<=r&&t.right>=r},_g=function(t,r){return t.filter(function(n){return Sx(n,r)}).map(function(n){return n.event})},Zk=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,s=n.slotMetrics.slots,o=Nx(a).levels[0],l=1,c=1,d=[];l<=s;){var u="_lvl_"+l,h=o.filter(function(_){return Sx(_,l)})[0]||{},m=h.event,f=h.left,x=h.right,g=h.span;if(!m){var b=this.getHiddenEventsForSlot(a,l);if(b.length>0){var y=l-c;y&&d.push(ys.renderSpan(s,y,u+"_gap")),d.push(ys.renderSpan(s,1,u,this.renderShowMore(a,l))),c=l=l+1;continue}l++;continue}var N=Math.max(0,f-c);if(this.canRenderSlotEvent(f,g)){var S=ys.renderEvent(this.props,m);N&&d.push(ys.renderSpan(s,N,u+"_gap")),d.push(ys.renderSpan(s,g,u,S)),c=l=x+1}else N&&d.push(ys.renderSpan(s,N,u+"_gap")),d.push(ys.renderSpan(s,1,u,this.renderShowMore(a,l))),c=l=l+1}return Ce.createElement("div",{className:"rbc-row"},d)}},{key:"getHiddenEventsForSlot",value:function(n,a){var s=_g(n,a),o=Nx(n).levels[0],l=o.filter(function(c){return Sx(c,a)}).map(function(c){return c.event});return s.filter(function(c){return!l.some(function(d){return d===c})})}},{key:"canRenderSlotEvent",value:function(n,a){var s=this.props.segments;return nK(n,n+a).every(function(o){var l=_g(s,o).length;return l===1})}},{key:"renderShowMore",value:function(n,a){var s=this,o=this.props,l=o.localizer,c=o.slotMetrics,d=o.components,u=c.getEventsForSlot(a),h=_g(n,a),m=h.length;if(d!=null&&d.showMore){var f=d.showMore,x=c.getDateForSlot(a-1);return m?Ce.createElement(f,{localizer:l,slotDate:x,slot:a,count:m,events:u,remainingEvents:h}):!1}return m?Ce.createElement("button",{type:"button",key:"sm_"+a,className:rn("rbc-button-link","rbc-show-more"),onClick:function(b){return s.showMore(a,b)}},l.messages.showMore(m,h,u)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(Ce.Component);Zk.defaultProps=Er({},ys.defaultProps);var Hte=function(t){var r=t.children;return Ce.createElement("div",{className:"rbc-row-content-scroll-container"},r)},qte=function(t,r){return t.left<=r&&t.right>=r},Yte=function(t,r){return t[0].range===r[0].range&&t[0].events===r[0].events};function Qk(){return Sk(function(e){for(var t=e.range,r=e.events,n=e.maxRows,a=e.minRows,s=e.accessors,o=e.localizer,l=Jk({dateRange:t,localizer:o}),c=l.first,d=l.last,u=r.map(function(g){return Ute(g,t,s,o)}),h=Nx(u,Math.max(n-1,1)),m=h.levels,f=h.extra,x=f.length>0?a-1:a;m.length<x;)m.push([]);return{first:c,last:d,levels:m,extra:f,range:t,slots:t.length,clone:function(b){var y=Qk();return y(Er(Er({},e),b))},getDateForSlot:function(b){return t[b]},getSlotForDate:function(b){return t.find(function(y){return o.isSameDate(y,b)})},getEventsForSlot:function(b){return u.filter(function(y){return qte(y,b)}).map(function(y){return y.event})},continuesPrior:function(b){return o.continuesPrior(s.start(b),c)},continuesAfter:function(b){var y=s.start(b),N=s.end(b);return o.continuesAfter(y,N,d)}}},Yte)}var Gu=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.handleSelectSlot=function(o){var l=r.props,c=l.range,d=l.onSelectSlot;d(c.slice(o.start,o.end+1),o)},r.handleShowMore=function(o,l){var c=r.props,d=c.range,u=c.onShowMore,h=r.slotMetrics(r.props),m=qI(r.containerRef.current,".rbc-row-bg")[0],f;m&&(f=m.children[o-1]);var x=h.getEventsForSlot(o);u(x,d[o-1],f,o,l)},r.getContainer=function(){var o=r.props.container;return o?o():r.containerRef.current},r.renderHeadingCell=function(o,l){var c=r.props,d=c.renderHeader,u=c.getNow,h=c.localizer;return d({date:o,key:"header_".concat(l),className:rn("rbc-date-cell",h.isSameDate(o,u())&&"rbc-now")})},r.renderDummy=function(){var o=r.props,l=o.className,c=o.range,d=o.renderHeader,u=o.showAllEvents;return Ce.createElement("div",{className:l,ref:r.containerRef},Ce.createElement("div",{className:rn("rbc-row-content",u&&"rbc-row-content-scrollable")},d&&Ce.createElement("div",{className:"rbc-row",ref:r.headingRowRef},c.map(r.renderHeadingCell)),Ce.createElement("div",{className:"rbc-row",ref:r.eventRowRef},Ce.createElement("div",{className:"rbc-row-segment"},Ce.createElement("div",{className:"rbc-event"},Ce.createElement("div",{className:"rbc-event-content"},"Â "))))))},r.containerRef=J.createRef(),r.headingRowRef=J.createRef(),r.eventRowRef=J.createRef(),r.slotMetrics=Qk(),r}return ga(t,e),On(t,[{key:"getRowLimit",value:function(){var n,a=bg(this.eventRowRef.current),s=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?bg(this.headingRowRef.current):0,o=bg(this.containerRef.current)-s;return Math.max(Math.floor(o/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.rtl,o=n.range,l=n.className,c=n.selected,d=n.selectable,u=n.renderForMeasure,h=n.accessors,m=n.getters,f=n.components,x=n.getNow,g=n.renderHeader,b=n.onSelect,y=n.localizer,N=n.onSelectStart,S=n.onSelectEnd,_=n.onDoubleClick,D=n.onKeyPress,I=n.resourceId,O=n.longPressThreshold,R=n.isAllDay,E=n.resizable,B=n.showAllEvents;if(u)return this.renderDummy();var C=this.slotMetrics(this.props),M=C.levels,U=C.extra,F=B?Hte:gi,ne=f.weekWrapper,V={selected:c,accessors:h,getters:m,localizer:y,components:f,onSelect:b,onDoubleClick:_,onKeyPress:D,resourceId:I,slotMetrics:C,resizable:E};return Ce.createElement("div",{className:l,role:"rowgroup",ref:this.containerRef},Ce.createElement(Bte,{localizer:y,date:a,getNow:x,rtl:s,range:o,selectable:d,container:this.getContainer,getters:m,onSelectStart:N,onSelectEnd:S,onSelectSlot:this.handleSelectSlot,components:f,longPressThreshold:O,resourceId:I}),Ce.createElement("div",{className:rn("rbc-row-content",B&&"rbc-row-content-scrollable"),role:"row"},g&&Ce.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),Ce.createElement(F,null,Ce.createElement(ne,Object.assign({isAllDay:R},V,{rtl:this.props.rtl}),M.map(function(ee,me){return Ce.createElement(Xk,Object.assign({key:me,segments:ee},V))}),!!U.length&&Ce.createElement(Zk,Object.assign({segments:U,onShowMore:this.handleShowMore},V))))))}}])}(Ce.Component);Gu.defaultProps={minRows:0,maxRows:1/0};var a2=function(t){var r=t.label;return Ce.createElement("span",{role:"columnheader","aria-sort":"none"},r)},Vte=function(t){var r=t.label,n=t.drilldownView,a=t.onDrillDown;return n?Ce.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},r):Ce.createElement("span",null,r)},Gte=["date","className"],Kte=function(t,r,n,a,s){return t.filter(function(o){return Vu(o,r,n,a,s)})},Tm=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.getContainer=function(){return r.containerRef.current},r.renderWeek=function(o,l){var c=r.props,d=c.events,u=c.components,h=c.selectable,m=c.getNow,f=c.selected,x=c.date,g=c.localizer,b=c.longPressThreshold,y=c.accessors,N=c.getters,S=c.showAllEvents,_=r.state,D=_.needLimitMeasure,I=_.rowLimit,O=Kte(Gh(d),o[0],o[o.length-1],y,g),R=zte(O,y,g);return Ce.createElement(Gu,{key:l,ref:l===0?r.slotRowRef:void 0,container:r.getContainer,className:"rbc-month-row",getNow:m,date:x,range:o,events:R,maxRows:S?1/0:I,selected:f,selectable:h,components:u,accessors:y,getters:N,localizer:g,renderHeader:r.readerDateHeading,renderForMeasure:D,onShowMore:r.handleShowMore,onSelect:r.handleSelectEvent,onDoubleClick:r.handleDoubleClickEvent,onKeyPress:r.handleKeyPressEvent,onSelectSlot:r.handleSelectSlot,longPressThreshold:b,rtl:r.props.rtl,resizable:r.props.resizable,showAllEvents:S})},r.readerDateHeading=function(o){var l=o.date,c=o.className,d=Ai(o,Gte),u=r.props,h=u.date,m=u.getDrilldownView,f=u.localizer,x=f.neq(h,l,"month"),g=f.isSameDate(l,h),b=m(l),y=f.format(l,"dateFormat"),N=r.props.components.dateHeader||Vte;return Ce.createElement("div",Object.assign({},d,{className:rn(c,x&&"rbc-off-range",g&&"rbc-current"),role:"cell"}),Ce.createElement(N,{label:y,date:l,drilldownView:b,isOffRange:x,onDrillDown:function(_){return r.handleHeadingClick(l,b,_)}}))},r.handleSelectSlot=function(o,l){r._pendingSelection=r._pendingSelection.concat(o),clearTimeout(r._selectTimer),r._selectTimer=setTimeout(function(){return r.selectDates(l)})},r.handleHeadingClick=function(o,l,c){c.preventDefault(),r.clearSelection(),Ir(r.props.onDrillDown,[o,l])},r.handleSelectEvent=function(){r.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onSelectEvent,l)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onDoubleClickEvent,l)},r.handleKeyPressEvent=function(){r.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onKeyPressEvent,l)},r.handleShowMore=function(o,l,c,d,u){var h=r.props,m=h.popup,f=h.onDrillDown,x=h.onShowMore,g=h.getDrilldownView,b=h.doShowMoreDrillDown;if(r.clearSelection(),m){var y=QN(c,r.containerRef.current);r.setState({overlay:{date:l,events:o,position:y,target:u}})}else b&&Ir(f,[l,g(l)||_a.DAY]);Ir(x,[o,l,d])},r.overlayDisplay=function(){r.setState({overlay:null})},r.state={rowLimit:5,needLimitMeasure:!0,date:null},r.containerRef=J.createRef(),r.slotRowRef=J.createRef(),r._bgRows=[],r._pendingSelection=[],r}return ga(t,e),On(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||ek(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,o=n.className,l=s.visibleDays(a,s),c=EI(l,7);return this._weekCount=c.length,Ce.createElement("div",{className:rn("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},Ce.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(c[0])),c.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,s=a.localizer,o=a.components,l=n[0],c=n[n.length-1],d=o.header||a2;return s.range(l,c,"day").map(function(u,h){return Ce.createElement("div",{key:"header_"+h,className:"rbc-header"},Ce.createElement(d,{date:u,localizer:s,label:s.format(u,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,s=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,d=l.localizer,u=l.components,h=l.getters,m=l.selected,f=l.popupOffset,x=l.handleDragStart,g=function(){return s.setState({overlay:null})};return Ce.createElement(n2,{overlay:o,accessors:c,localizer:d,components:u,getters:h,selected:m,popupOffset:f,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:x,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:g})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(l,c){return+l-+c});var s=new Date(a[0]),o=new Date(a[a.length-1]);o.setDate(a[a.length-1].getDate()+1),Ir(this.props.onSelectSlot,{slots:a,start:s,end:o,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var s=n.date,o=n.localizer;return{date:s,needLimitMeasure:o.neq(s,a.date,"month")}}}])}(Ce.Component);Tm.range=function(e,t){var r=t.localizer,n=r.firstVisibleDay(e,r),a=r.lastVisibleDay(e,r);return{start:n,end:a}};Tm.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"month");case Ra.NEXT:return n.add(e,1,"month");default:return e}};Tm.title=function(e,t){var r=t.localizer;return r.format(e,"monthHeaderFormat")};var E5=function(t){var r=t.min,n=t.max,a=t.step,s=t.slots,o=t.localizer;return"".concat(+o.startOf(r,"minutes"))+"".concat(+o.startOf(n,"minutes"))+"".concat(a,"-").concat(s)};function s2(e){for(var t=e.min,r=e.max,n=e.step,a=e.timeslots,s=e.localizer,o=E5({step:n,localizer:s}),l=1+s.getTotalMin(t,r),c=s.getMinutesFromMidnight(t),d=Math.ceil((l-1)/(n*a)),u=d*a,h=new Array(d),m=new Array(u),f=0;f<d;f++){h[f]=new Array(a);for(var x=0;x<a;x++){var g=f*a+x,b=g*n;m[g]=h[f][x]=s.getSlotDate(t,c,b)}}var y=m.length*n;m.push(s.getSlotDate(t,c,y));function N(S){var _=s.diff(t,S,"minutes")+s.getDstOffset(t,S);return Math.min(_,l)}return{groups:h,update:function(_){return E5(_)!==o?s2(_):this},dateIsInGroup:function(_,D){var I=h[D+1];return s.inRange(_,h[D][0],I?I[0]:r,"minutes")},nextSlot:function(_){var D=m[Math.min(m.findIndex(function(I){return I===_||s.eq(I,_)})+1,m.length-1)];return s.eq(D,_)&&(D=s.add(_,n,"minutes")),D},closestSlotToPosition:function(_){var D=Math.min(m.length-1,Math.max(0,Math.floor(_*u)));return m[D]},closestSlotFromPoint:function(_,D){var I=Math.abs(D.top-D.bottom);return this.closestSlotToPosition((_.y-D.top)/I)},closestSlotFromDate:function(_){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(s.lt(_,t,"minutes"))return m[0];if(s.gt(_,r,"minutes"))return m[m.length-1];var I=s.diff(t,_,"minutes");return m[(I-I%n)/n+D]},startsBeforeDay:function(_){return s.lt(_,t,"day")},startsAfterDay:function(_){return s.gt(_,r,"day")},startsBefore:function(_){return s.lt(s.merge(t,_),t,"minutes")},startsAfter:function(_){return s.gt(s.merge(r,_),r,"minutes")},getRange:function(_,D,I,O){I||(_=s.min(r,s.max(t,_))),O||(D=s.min(r,s.max(t,D)));var R=N(_),E=N(D),B=E>n*u&&!s.eq(r,D)?(R-n)/(n*u)*100:R/(n*u)*100;return{top:B,height:E/(n*u)*100-B,start:N(_),startDate:_,end:N(D),endDate:D}},getCurrentTimePosition:function(_){var D=N(_),I=D/(n*u)*100;return I}}}var Xte=function(){function e(t,r){var n=r.accessors,a=r.slotMetrics;Dn(this,e);var s=a.getRange(n.start(t),n.end(t)),o=s.start,l=s.startDate,c=s.end,d=s.endDate,u=s.top,h=s.height;this.start=o,this.end=c,this.startMs=+l,this.endMs=+d,this.top=u,this.height=h,this.data=t}return On(e,[{key:"_width",get:function(){if(this.rows){var r=this.rows.reduce(function(a,s){return Math.max(a,s.leaves.length+1)},0)+1;return 100/r}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var r=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:r;var a=this.row.leaves,s=a.indexOf(this);return s===a.length-1?r:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var r=this.row,n=r.leaves,a=r.xOffset,s=r._width,o=n.indexOf(this)+1;return a+o*s}}])}();function Jte(e,t,r){return Math.abs(t.start-e.start)<r||t.start>e.start&&t.start<e.end}function Zte(e){for(var t=NX(e,["startMs",function(l){return-l.endMs}]),r=[];t.length>0;){var n=t.shift();r.push(n);for(var a=0;a<t.length;a++){var s=t[a];if(!(n.endMs>s.startMs)){if(a>0){var o=t.splice(a,1)[0];r.push(o)}break}}}return r}function eS(e){for(var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=t.map(function(u){return new Xte(u,{slotMetrics:n,accessors:a})}),o=Zte(s),l=[],c=function(){var h=o[d],m=l.find(function(g){return g.end>h.start||Math.abs(h.start-g.start)<r});if(!m)return h.rows=[],l.push(h),1;h.container=m;for(var f=null,x=m.rows.length-1;!f&&x>=0;x--)Jte(m.rows[x],h,r)&&(f=m.rows[x]);f?(f.leaves.push(h),h.row=f):(h.leaves=[],m.rows.push(h))},d=0;d<o.length;d++)c();return o.map(function(u){return{event:u.data,style:{top:u.top,height:u.height,width:u.width,xOffset:Math.max(0,u.xOffset)}}})}function tS(e,t,r){for(var n=0;n<e.friends.length;++n)if(!(r.indexOf(e.friends[n])>-1)){t=t>e.friends[n].idx?t:e.friends[n].idx,r.push(e.friends[n]);var a=tS(e.friends[n],t,r);t=t>a?t:a}return t}function Qte(e){var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=eS({events:t,minimumStartDifference:r,slotMetrics:n,accessors:a});s.sort(function(ne,V){return ne=ne.style,V=V.style,ne.top!==V.top?ne.top>V.top?1:-1:ne.height!==V.height?ne.top+ne.height<V.top+V.height?1:-1:0});for(var o=0;o<s.length;++o)s[o].friends=[],delete s[o].style.left,delete s[o].style.left,delete s[o].idx,delete s[o].size;for(var l=0;l<s.length-1;++l)for(var c=s[l],d=c.style.top,u=c.style.top+c.style.height,h=l+1;h<s.length;++h){var m=s[h],f=m.style.top,x=m.style.top+m.style.height;(f>=d&&x<=u||x>d&&x<=u||f>=d&&f<u)&&(c.friends.push(m),m.friends.push(c))}for(var g=0;g<s.length;++g){for(var b=s[g],y=[],N=0;N<100;++N)y.push(1);for(var S=0;S<b.friends.length;++S)b.friends[S].idx!==void 0&&(y[b.friends[S].idx]=0);b.idx=y.indexOf(1)}for(var _=0;_<s.length;++_){var D=0;if(!s[_].size){var I=[],O=tS(s[_],0,I);D=100/(O+1),s[_].size=D;for(var R=0;R<I.length;++R)I[R].size=D}}for(var E=0;E<s.length;++E){var B=s[E];B.style.left=B.idx*B.size;for(var C=0,M=0;M<B.friends.length;++M){var U=B.friends[M].idx;C=C>U?C:U}C<=B.idx&&(B.size=100-B.idx*B.size);var F=B.idx===0?0:3;B.style.width="calc(".concat(B.size,"% - ").concat(F,"px)"),B.style.height="calc(".concat(B.style.height,"% - 2px)"),B.style.xOffset="calc(".concat(B.style.left,"% + ").concat(F,"px)")}return s}var C5={overlap:eS,"no-overlap":Qte};function ere(e){return!!(e&&e.constructor&&e.call&&e.apply)}function tre(e){e.events,e.minimumStartDifference,e.slotMetrics,e.accessors;var t=e.dayLayoutAlgorithm,r=t;return t in C5&&(r=C5[t]),ere(r)?r.apply(this,arguments):[]}var rS=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,s=n.resource,o=n.group,l=n.getters,c=n.components,d=c===void 0?{}:c,u=d.timeSlotWrapper,h=u===void 0?gi:u,m=l?l.slotGroupProp(o):{};return Ce.createElement("div",Object.assign({className:"rbc-timeslot-group"},m),o.map(function(f,x){var g=l?l.slotProp(f,s):{};return Ce.createElement(h,{key:x,value:f,resource:s},Ce.createElement("div",Object.assign({},g,{className:rn("rbc-time-slot",g.className)}),a&&a(f,x)))}))}}])}(J.Component);function Ah(e){return typeof e=="string"?e:e+"%"}function rre(e){var t=e.style,r=e.className,n=e.event,a=e.accessors,s=e.rtl,o=e.selected,l=e.label,c=e.continuesPrior,d=e.continuesAfter,u=e.getters,h=e.onClick,m=e.onDoubleClick,f=e.isBackgroundEvent,x=e.onKeyPress,g=e.components,b=g.event,y=g.eventWrapper,N=a.title(n),S=a.tooltip(n),_=a.end(n),D=a.start(n),I=u.eventProp(n,D,_,o),O=[Ce.createElement("div",{key:"1",className:"rbc-event-label"},l),Ce.createElement("div",{key:"2",className:"rbc-event-content"},b?Ce.createElement(b,{event:n,title:N}):N)],R=t.height,E=t.top,B=t.width,C=t.xOffset,M=Er(Er({},I.style),{},Pl({top:Ah(E),height:Ah(R),width:Ah(B)},s?"right":"left",Ah(C)));return Ce.createElement(y,Object.assign({type:"time"},e),Ce.createElement("div",{role:"button",tabIndex:0,onClick:h,onDoubleClick:m,style:M,onKeyDown:x,title:S?(typeof l=="string"?l+": ":"")+S:void 0,className:rn(f?"rbc-background-event":"rbc-event",r,I.className,{"rbc-selected":o,"rbc-event-continues-earlier":c,"rbc-event-continues-later":d})},O))}var nre=function(t){var r=t.children,n=t.className,a=t.style,s=t.innerRef;return Ce.createElement("div",{className:n,style:a,ref:s},r)},are=Ce.forwardRef(function(e,t){return Ce.createElement(nre,Object.assign({},e,{innerRef:t}))}),sre=["dayProp"],ire=["eventContainerWrapper","timeIndicatorWrapper"],nS=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.state={selecting:!1,timeIndicatorPosition:null},r.intervalTriggered=!1,r.renderEvents=function(o){var l=o.events,c=o.isBackgroundEvent,d=r.props,u=d.rtl,h=d.selected,m=d.accessors,f=d.localizer,x=d.getters,g=d.components,b=d.step,y=d.timeslots,N=d.dayLayoutAlgorithm,S=d.resizable,_=r,D=_.slotMetrics,I=f.messages,O=tre({events:l,accessors:m,slotMetrics:D,minimumStartDifference:Math.ceil(b*y/2),dayLayoutAlgorithm:N});return O.map(function(R,E){var B,C=R.event,M=R.style,U=m.end(C),F=m.start(C),ne=(B=m.eventId(C))!==null&&B!==void 0?B:"evt_"+E,V="eventTimeRangeFormat",ee,me=D.startsBeforeDay(F),ye=D.startsAfterDay(U);me?V="eventTimeRangeEndFormat":ye&&(V="eventTimeRangeStartFormat"),me&&ye?ee=I.allDay:ee=f.format({start:F,end:U},V);var Oe=me||D.startsBefore(F),xe=ye||D.startsAfter(U);return Ce.createElement(rre,{style:M,event:C,label:ee,key:ne,getters:x,rtl:u,components:g,continuesPrior:Oe,continuesAfter:xe,accessors:m,resource:r.props.resource,selected:jm(C,h),onClick:function(A){return r._select(Er(Er(Er({},C),r.props.resource&&{sourceResource:r.props.resource}),c&&{isBackgroundEvent:!0}),A)},onDoubleClick:function(A){return r._doubleClick(C,A)},isBackgroundEvent:c,onKeyPress:function(A){return r._keyPress(C,A)},resizable:S})})},r._selectable=function(){var o=r.containerRef.current,l=r.props,c=l.longPressThreshold,d=l.localizer,u=r._selector=new Kk(function(){return o},{longPressThreshold:c}),h=function(g){var b=r.props.onSelecting,y=r.state||{},N=m(g),S=N.startDate,_=N.endDate;b&&(d.eq(y.startDate,S,"minutes")&&d.eq(y.endDate,_,"minutes")||b({start:S,end:_,resourceId:r.props.resource})===!1)||(r.state.start!==N.start||r.state.end!==N.end||r.state.selecting!==N.selecting)&&r.setState(N)},m=function(g){var b=r.slotMetrics.closestSlotFromPoint(g,rc(o));r.state.selecting||(r._initialSlot=b);var y=r._initialSlot;d.lte(y,b)?b=r.slotMetrics.nextSlot(b):d.gt(y,b)&&(y=r.slotMetrics.nextSlot(y));var N=r.slotMetrics.getRange(d.min(y,b),d.max(y,b));return Er(Er({},N),{},{selecting:!0,top:"".concat(N.top,"%"),height:"".concat(N.height,"%")})},f=function(g,b){if(!$0(r.containerRef.current,g)){var y=m(g),N=y.startDate,S=y.endDate;r._selectSlot({startDate:N,endDate:S,action:b,box:g})}r.setState({selecting:!1})};u.on("selecting",h),u.on("selectStart",h),u.on("beforeSelect",function(x){if(r.props.selectable==="ignoreEvents")return!$0(r.containerRef.current,x)}),u.on("click",function(x){return f(x,"click")}),u.on("doubleClick",function(x){return f(x,"doubleClick")}),u.on("select",function(x){r.state.selecting&&(r._selectSlot(Er(Er({},r.state),{},{action:"select",bounds:x})),r.setState({selecting:!1}))}),u.on("reset",function(){r.state.selecting&&r.setState({selecting:!1})})},r._teardownSelectable=function(){r._selector&&(r._selector.teardown(),r._selector=null)},r._selectSlot=function(o){for(var l=o.startDate,c=o.endDate,d=o.action,u=o.bounds,h=o.box,m=l,f=[];r.props.localizer.lte(m,c);)f.push(m),m=new Date(+m+r.props.step*60*1e3);Ir(r.props.onSelectSlot,{slots:f,start:l,end:c,resourceId:r.props.resource,action:d,bounds:u,box:h})},r._select=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onSelectEvent,l)},r._doubleClick=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onDoubleClickEvent,l)},r._keyPress=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onKeyPressEvent,l)},r.slotMetrics=s2(r.props),r.containerRef=J.createRef(),r}return ga(t,e),On(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var s=this.props,o=s.getNow,l=s.isNow,c=s.localizer,d=s.date,u=s.min,h=s.max,m=c.neq(n.getNow(),o(),"minutes");if(n.isNow!==l||m){if(this.clearTimeIndicatorInterval(),l){var f=!m&&c.eq(n.date,d,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(f)}}else l&&(c.neq(n.min,u,"minutes")||c.neq(n.max,h,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,s=n.max,o=n.getNow,l=o();if(l>=a&&l<=s){var c=this.slotMetrics.getCurrentTimePosition(l);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:c})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.max,o=n.rtl,l=n.isNow,c=n.resource,d=n.accessors,u=n.localizer,h=n.getters,m=h.dayProp,f=Ai(h,sre),x=n.components,g=x.eventContainerWrapper,b=x.timeIndicatorWrapper,y=Ai(x,ire);this.slotMetrics=this.slotMetrics.update(this.props);var N=this.slotMetrics,S=this.state,_=S.selecting,D=S.top,I=S.height,O=S.startDate,R=S.endDate,E={start:O,end:R},B=m(s,c),C=B.className,M=B.style,U={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},F=y.dayColumnWrapper||are;return Ce.createElement(F,{ref:this.containerRef,date:a,style:M,className:rn(C,"rbc-day-slot","rbc-time-column",l&&"rbc-now",l&&"rbc-today",_&&"rbc-slot-selecting"),slotMetrics:N,resource:c},N.groups.map(function(ne,V){return Ce.createElement(rS,{key:V,group:ne,resource:c,getters:f,components:y})}),Ce.createElement(g,{localizer:u,resource:c,accessors:d,getters:f,components:y,slotMetrics:N},Ce.createElement("div",{className:rn("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),_&&Ce.createElement("div",{className:"rbc-slot-selection",style:{top:D,height:I}},Ce.createElement("span",null,u.format(E,"selectRangeFormat"))),l&&this.intervalTriggered&&Ce.createElement(b,U,Ce.createElement("div",U)))}}])}(Ce.Component);nS.defaultProps={dragThroughEvents:!0,timeslots:2};var aS=function(t){var r=t.label;return Ce.createElement(Ce.Fragment,null,r)},ore=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.handleHeaderClick=function(o,l,c){c.preventDefault(),Ir(r.props.onDrillDown,[o,l])},r.renderRow=function(o){var l=r.props,c=l.events,d=l.rtl,u=l.selectable,h=l.getNow,m=l.range,f=l.getters,x=l.localizer,g=l.accessors,b=l.components,y=l.resizable,N=g.resourceId(o),S=o?c.filter(function(_){return g.resource(_)===N}):c;return Ce.createElement(Gu,{isAllDay:!0,rtl:d,getNow:h,minRows:2,maxRows:r.props.allDayMaxRows+1,range:m,events:S,resourceId:N,className:"rbc-allday-cell",selectable:u,selected:r.props.selected,components:b,accessors:g,getters:f,localizer:x,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyPress:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:y})},r}return ga(t,e),On(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,o=s.localizer,l=s.getDrilldownView,c=s.getNow,d=s.getters.dayProp,u=s.components.header,h=u===void 0?a2:u,m=c();return n.map(function(f,x){var g=l(f),b=o.format(f,"dayFormat"),y=d(f),N=y.className,S=y.style,_=Ce.createElement(h,{date:f,label:b,localizer:o});return Ce.createElement("div",{key:x,style:S,className:rn("rbc-header",N,o.isSameDate(f,m)&&"rbc-today")},g?Ce.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(I){return a.handleHeaderClick(f,g,I)}},_):Ce.createElement("span",null,_))})}},{key:"render",value:function(){var n=this,a=this.props,s=a.width,o=a.rtl,l=a.resources,c=a.range,d=a.events,u=a.getNow,h=a.accessors,m=a.selectable,f=a.components,x=a.getters,g=a.scrollRef,b=a.localizer,y=a.isOverflowing,N=a.components,S=N.timeGutterHeader,_=N.resourceHeader,D=_===void 0?aS:_,I=a.resizable,O={};y&&(O[o?"marginLeft":"marginRight"]="".concat(R1()-1,"px"));var R=l.groupEvents(d);return Ce.createElement("div",{style:O,ref:g,className:rn("rbc-time-header",y&&"rbc-overflowing")},Ce.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:s,minWidth:s,maxWidth:s}},S&&Ce.createElement(S,null)),l.map(function(E,B){var C=Da(E,2),M=C[0],U=C[1];return Ce.createElement("div",{className:"rbc-time-header-content",key:M||B},U&&Ce.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(B)},Ce.createElement("div",{className:"rbc-header"},Ce.createElement(D,{index:B,label:h.resourceTitle(U),resource:U}))),Ce.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(c.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(c)),Ce.createElement(Gu,{isAllDay:!0,rtl:o,getNow:u,minRows:2,maxRows:n.props.allDayMaxRows+1,range:c,events:R.get(M)||[],resourceId:U&&M,className:"rbc-allday-cell",selectable:m,selected:n.props.selected,components:f,accessors:h,getters:x,localizer:b,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:I}))}))}}])}(Ce.Component),lre=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.handleHeaderClick=function(o,l,c){c.preventDefault(),Ir(r.props.onDrillDown,[o,l])},r}return ga(t,e),On(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,o=s.localizer,l=s.getDrilldownView,c=s.getNow,d=s.getters.dayProp,u=s.components,h=u.header,m=h===void 0?a2:h,f=u.resourceHeader,x=f===void 0?aS:f,g=s.resources,b=s.accessors,y=s.events,N=s.rtl,S=s.selectable,_=s.components,D=s.getters,I=s.resizable,O=c(),R=g.groupEvents(y);return n.map(function(E,B){var C=l(E),M=o.format(E,"dayFormat"),U=d(E),F=U.className,ne=U.style,V=Ce.createElement(m,{date:E,label:M,localizer:o});return Ce.createElement("div",{key:B,className:"rbc-time-header-content rbc-resource-grouping"},Ce.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},Ce.createElement("div",{style:ne,className:rn("rbc-header",F,o.isSameDate(E,O)&&"rbc-today")},C?Ce.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(me){return a.handleHeaderClick(E,C,me)}},V):Ce.createElement("span",null,V))),Ce.createElement("div",{className:"rbc-row"},g.map(function(ee,me){var ye=Da(ee,2),Oe=ye[0],xe=ye[1];return Ce.createElement("div",{key:"resource_".concat(Oe,"_").concat(me),className:rn("rbc-header",F,o.isSameDate(E,O)&&"rbc-today")},Ce.createElement(x,{index:me,label:b.resourceTitle(xe),resource:xe}))})),Ce.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},g.map(function(ee,me){var ye=Da(ee,2),Oe=ye[0],xe=ye[1],w=(R.get(Oe)||[]).filter(function(A){return o.isSameDate(A.start,E)||o.isSameDate(A.end,E)});return Ce.createElement(Gu,{key:"resource_".concat(Oe,"_").concat(me),isAllDay:!0,rtl:N,getNow:c,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[E],events:w,resourceId:xe&&Oe,className:"rbc-allday-cell",selectable:S,selected:a.props.selected,components:_,accessors:b,getters:D,localizer:o,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:I})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,s=n.rtl,o=n.range,l=n.scrollRef,c=n.isOverflowing,d=n.components.timeGutterHeader,u={};return c&&(u[s?"marginLeft":"marginRight"]="".concat(R1()-1,"px")),Ce.createElement("div",{style:u,ref:l,className:rn("rbc-time-header",c&&"rbc-overflowing")},Ce.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},d&&Ce.createElement(d,null)),this.renderHeaderCells(o))}}])}(Ce.Component);function cre(e){var t=e.min,r=e.max,n=e.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(r)?{start:n.add(t,-1,"day"),end:n.add(r,-1,"day")}:{start:t,end:r}}var dre=function(t){var r=t.min,n=t.max,a=t.timeslots,s=t.step,o=t.localizer,l=t.getNow,c=t.resource,d=t.components,u=t.getters,h=t.gutterRef,m=d.timeGutterWrapper,f=J.useMemo(function(){return cre({min:r,max:n,localizer:o})},[r==null?void 0:r.toISOString(),n==null?void 0:n.toISOString(),o]),x=f.start,g=f.end,b=J.useState(s2({min:x,max:g,timeslots:a,step:s,localizer:o})),y=Da(b,2),N=y[0],S=y[1];J.useEffect(function(){N&&S(N.update({min:x,max:g,timeslots:a,step:s,localizer:o}))},[x==null?void 0:x.toISOString(),g==null?void 0:g.toISOString(),a,s]);var _=J.useCallback(function(D,I){if(I)return null;var O=N.dateIsInGroup(l(),I);return Ce.createElement("span",{className:rn("rbc-label",O&&"rbc-now")},o.format(D,"timeGutterFormat"))},[N,o,l]);return Ce.createElement(m,{slotMetrics:N},Ce.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:h},N.groups.map(function(D,I){return Ce.createElement(rS,{key:I,group:D,resource:c,components:d,renderSlot:_,getters:u})})))},ure=Ce.forwardRef(function(e,t){return Ce.createElement(dre,Object.assign({gutterRef:t},e))}),Ng={};function fre(e,t){return{map:function(n){return e?e.map(function(a,s){return n([t.resourceId(a),a],s)}):[n([Ng,null],0)]},groupEvents:function(n){var a=new Map;return e?(n.forEach(function(s){var o=t.resource(s)||Ng;if(Array.isArray(o))o.forEach(function(c){var d=a.get(c)||[];d.push(s),a.set(c,d)});else{var l=a.get(o)||[];l.push(s),a.set(o,l)}}),a):(a.set(Ng,n),a)}}}var kd=function(e){function t(r){var n;return Dn(this,t),n=pa(this,t,[r]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){gw(n.rafHandle),n.rafHandle=ek(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];Ir(n.props.onKeyPressEvent,s)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];Ir(n.props.onSelectEvent,s)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];Ir(n.props.onDoubleClickEvent,s)},n.handleShowMore=function(a,s,o,l,c){var d=n.props,u=d.popup,h=d.onDrillDown,m=d.onShowMore,f=d.getDrilldownView,x=d.doShowMoreDrillDown;if(n.clearSelection(),u){var g=QN(o,n.containerRef.current);n.setState({overlay:{date:s,events:a,position:Er(Er({},g),{},{width:"200px"}),target:c}})}else x&&Ir(h,[s,f(s)||_a.DAY]);Ir(m,[a,s,l])},n.handleSelectAllDaySlot=function(a,s){var o=n.props.onSelectSlot,l=new Date(a[0]),c=new Date(a[a.length-1]);c.setDate(a[a.length-1].getDate()+1),Ir(o,{slots:a,start:l,end:c,action:s.action,resourceId:s.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var s=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==s&&(n._updatingOverflow=!0,n.setState({isOverflowing:s},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=Sk(function(a,s){return fre(a,s)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=Ce.createRef(),n.contentRef=Ce.createRef(),n.containerRef=Ce.createRef(),n._scrollRatio=null,n.gutterRef=J.createRef(),n}return ga(t,e),On(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),gw(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,s,o,l,c,d,u,h,m){var f=this.props,x=f.min,g=f.max,b=(o.get(a)||[]).filter(function(N){return c.inRange(n,d.start(N),d.end(N),"day")}),y=(l.get(a)||[]).filter(function(N){return c.inRange(n,d.start(N),d.end(N),"day")});return Ce.createElement(nS,Object.assign({},this.props,{localizer:c,min:c.merge(n,x),max:c.merge(n,g),resource:s&&a,components:u,isNow:c.isSameDate(n,m),key:"".concat(a,"-").concat(n),date:n,events:b,backgroundEvents:y,dayLayoutAlgorithm:h}))}},{key:"renderResourcesFirst",value:function(n,a,s,o,l,c,d,u,h){var m=this;return a.map(function(f){var x=Da(f,2),g=x[0],b=x[1];return n.map(function(y){return m.renderDayColumn(y,g,b,s,o,l,c,u,h,d)})})}},{key:"renderRangeFirst",value:function(n,a,s,o,l,c,d,u,h){var m=this;return n.map(function(f){return Ce.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:f},a.map(function(x){var g=Da(x,2),b=g[0],y=g[1];return Ce.createElement("div",{style:{flex:1},key:c.resourceId(y)},m.renderDayColumn(f,b,y,s,o,l,c,u,h,d))}))})}},{key:"renderEvents",value:function(n,a,s,o){var l=this.props,c=l.accessors,d=l.localizer,u=l.resourceGroupingLayout,h=l.components,m=l.dayLayoutAlgorithm,f=this.memoizedResources(this.props.resources,c),x=f.groupEvents(a),g=f.groupEvents(s);return u?this.renderRangeFirst(n,f,x,g,d,c,o,h,m):this.renderResourcesFirst(n,f,x,g,d,c,o,h,m)}},{key:"render",value:function(){var n,a=this.props,s=a.events,o=a.backgroundEvents,l=a.range,c=a.width,d=a.rtl,u=a.selected,h=a.getNow,m=a.resources,f=a.components,x=a.accessors,g=a.getters,b=a.localizer,y=a.min,N=a.max,S=a.showMultiDayTimes,_=a.longPressThreshold,D=a.resizable,I=a.resourceGroupingLayout;c=c||this.state.gutterWidth;var O=l[0],R=l[l.length-1];this.slots=l.length;var E=[],B=[],C=[];s.forEach(function(U){if(Vu(U,O,R,x,b)){var F=x.start(U),ne=x.end(U);x.allDay(U)||b.startAndEndAreDateOnly(F,ne)||!S&&!b.isSameDate(F,ne)?E.push(U):B.push(U)}}),o.forEach(function(U){Vu(U,O,R,x,b)&&C.push(U)}),E.sort(function(U,F){return kx(U,F,x,b)});var M={range:l,events:E,width:c,rtl:d,getNow:h,localizer:b,selected:u,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(m,x),selectable:this.props.selectable,accessors:x,getters:g,components:f,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:_,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:D};return Ce.createElement("div",{className:rn("rbc-time-view",m&&"rbc-time-view-resources"),ref:this.containerRef},m&&m.length>1&&I?Ce.createElement(lre,M):Ce.createElement(ore,M),this.props.popup&&this.renderOverlay(),Ce.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},Ce.createElement(ure,{date:O,ref:this.gutterRef,localizer:b,min:b.merge(O,y),max:b.merge(O,N),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:f,className:"rbc-time-gutter",getters:g}),this.renderEvents(l,B,C,h())))}},{key:"renderOverlay",value:function(){var n,a,s=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,d=l.localizer,u=l.components,h=l.getters,m=l.selected,f=l.popupOffset,x=l.handleDragStart,g=function(){return s.setState({overlay:null})};return Ce.createElement(n2,{overlay:o,accessors:c,localizer:d,components:u,getters:h,selected:m,popupOffset:f,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:x,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:g})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,s=(a=n.gutterRef)!==null&&a!==void 0&&a.current?wx(n.gutterRef.current):void 0;s&&n.state.gutterWidth!==s&&n.setState({gutterWidth:s})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,s=n.max,o=n.scrollToTime,l=n.localizer,c=l.diff(l.merge(o,a),o,"milliseconds"),d=l.diff(a,s,"milliseconds");this._scrollRatio=c/d}}])}(J.Component);kd.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var hre=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Am=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,o=n.min,l=o===void 0?s.startOf(new Date,"day"):o,c=n.max,d=c===void 0?s.endOf(new Date,"day"):c,u=n.scrollToTime,h=u===void 0?s.startOf(new Date,"day"):u,m=n.enableAutoScroll,f=m===void 0?!0:m,x=Ai(n,hre),g=t.range(a,{localizer:s});return Ce.createElement(kd,Object.assign({},x,{range:g,eventOffset:10,localizer:s,min:l,max:d,scrollToTime:h,enableAutoScroll:f}))}}])}(Ce.Component);Am.range=function(e,t){var r=t.localizer;return[r.startOf(e,"day")]};Am.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"day");case Ra.NEXT:return n.add(e,1,"day");default:return e}};Am.title=function(e,t){var r=t.localizer;return r.format(e,"dayHeaderFormat")};var mre=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Qo=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,o=n.min,l=o===void 0?s.startOf(new Date,"day"):o,c=n.max,d=c===void 0?s.endOf(new Date,"day"):c,u=n.scrollToTime,h=u===void 0?s.startOf(new Date,"day"):u,m=n.enableAutoScroll,f=m===void 0?!0:m,x=Ai(n,mre),g=t.range(a,this.props);return Ce.createElement(kd,Object.assign({},x,{range:g,eventOffset:15,localizer:s,min:l,max:d,scrollToTime:h,enableAutoScroll:f}))}}])}(Ce.Component);Qo.defaultProps=kd.defaultProps;Qo.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"week");case Ra.NEXT:return n.add(e,1,"week");default:return e}};Qo.range=function(e,t){var r=t.localizer,n=r.startOfWeek(),a=r.startOf(e,"week",n),s=r.endOf(e,"week",n);return r.range(a,s)};Qo.title=function(e,t){var r=t.localizer,n=Qo.range(e,{localizer:r}),a=Ok(n),s=a[0],o=a.slice(1);return r.format({start:s,end:o.pop()},"dayRangeHeaderFormat")};var pre=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function i2(e,t){return Qo.range(e,t).filter(function(r){return[6,0].indexOf(r.getDay())===-1})}var Nf=function(e){function t(){return Dn(this,t),pa(this,t,arguments)}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,o=n.min,l=o===void 0?s.startOf(new Date,"day"):o,c=n.max,d=c===void 0?s.endOf(new Date,"day"):c,u=n.scrollToTime,h=u===void 0?s.startOf(new Date,"day"):u,m=n.enableAutoScroll,f=m===void 0?!0:m,x=Ai(n,pre),g=i2(a,this.props);return Ce.createElement(kd,Object.assign({},x,{range:g,eventOffset:15,localizer:s,min:l,max:d,scrollToTime:h,enableAutoScroll:f}))}}])}(Ce.Component);Nf.defaultProps=kd.defaultProps;Nf.range=i2;Nf.navigate=Qo.navigate;Nf.title=function(e,t){var r=t.localizer,n=i2(e,{localizer:r}),a=Ok(n),s=a[0],o=a.slice(1);return r.format({start:s,end:o.pop()},"dayRangeHeaderFormat")};var Em=30;function Cm(e){var t=e.accessors,r=e.components,n=e.date,a=e.events,s=e.getters,o=e.length,l=o===void 0?Em:o,c=e.localizer,d=e.onDoubleClickEvent,u=e.onSelectEvent,h=e.selected,m=J.useRef(null),f=J.useRef(null),x=J.useRef(null),g=J.useRef(null),b=J.useRef(null);J.useEffect(function(){S()});var y=function(R,E,B){var C=r.event,M=r.date;return E=E.filter(function(U){return Vu(U,c.startOf(R,"day"),c.endOf(R,"day"),t,c)}),E.map(function(U,F){var ne=t.title(U),V=t.end(U),ee=t.start(U),me=s.eventProp(U,ee,V,jm(U,h)),ye=F===0&&c.format(R,"agendaDateFormat"),Oe=F===0?Ce.createElement("td",{rowSpan:E.length,className:"rbc-agenda-date-cell"},M?Ce.createElement(M,{day:R,label:ye}):ye):!1;return Ce.createElement("tr",{key:B+"_"+F,className:me.className,style:me.style},Oe,Ce.createElement("td",{className:"rbc-agenda-time-cell"},N(R,U)),Ce.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(w){return u&&u(U,w)},onDoubleClick:function(w){return d&&d(U,w)}},C?Ce.createElement(C,{event:U,title:ne}):ne))},[])},N=function(R,E){var B="",C=r.time,M=c.messages.allDay,U=t.end(E),F=t.start(E);return t.allDay(E)||(c.eq(F,U)?M=c.format(F,"agendaTimeFormat"):c.isSameDate(F,U)?M=c.format({start:F,end:U},"agendaTimeRangeFormat"):c.isSameDate(R,F)?M=c.format(F,"agendaTimeFormat"):c.isSameDate(R,U)&&(M=c.format(U,"agendaTimeFormat"))),c.gt(R,F,"day")&&(B="rbc-continues-prior"),c.lt(R,U,"day")&&(B+=" rbc-continues-after"),Ce.createElement("span",{className:B.trim()},C?Ce.createElement(C,{event:E,day:R,label:M}):M)},S=function(){if(b.current){var R=m.current,E=b.current.firstChild;if(E){var B=g.current.scrollHeight>g.current.clientHeight,C=[],M=C;C=[wx(E.children[0]),wx(E.children[1])],(M[0]!==C[0]||M[1]!==C[1])&&(f.current.style.width=C[0]+"px",x.current.style.width=C[1]+"px"),B?(gU(R,"rbc-header-overflowing"),R.style.marginRight=R1()+"px"):xU(R,"rbc-header-overflowing")}}},_=c.messages,D=c.add(n,l,"day"),I=c.range(n,D,"day");return a=a.filter(function(O){return Vu(O,c.startOf(n,"day"),c.endOf(D,"day"),t,c)}),a.sort(function(O,R){return+t.start(O)-+t.start(R)}),Ce.createElement("div",{className:"rbc-agenda-view"},a.length!==0?Ce.createElement(Ce.Fragment,null,Ce.createElement("table",{ref:m,className:"rbc-agenda-table"},Ce.createElement("thead",null,Ce.createElement("tr",null,Ce.createElement("th",{className:"rbc-header",ref:f},_.date),Ce.createElement("th",{className:"rbc-header",ref:x},_.time),Ce.createElement("th",{className:"rbc-header"},_.event)))),Ce.createElement("div",{className:"rbc-agenda-content",ref:g},Ce.createElement("table",{className:"rbc-agenda-table"},Ce.createElement("tbody",{ref:b},I.map(function(O,R){return y(O,a,R)}))))):Ce.createElement("span",{className:"rbc-agenda-empty"},_.noEventsInRange))}Cm.range=function(e,t){var r=t.length,n=r===void 0?Em:r,a=t.localizer,s=a.add(e,n,"day");return{start:e,end:s}};Cm.navigate=function(e,t,r){var n=r.length,a=n===void 0?Em:n,s=r.localizer;switch(t){case Ra.PREVIOUS:return s.add(e,-a,"day");case Ra.NEXT:return s.add(e,a,"day");default:return e}};Cm.title=function(e,t){var r=t.length,n=r===void 0?Em:r,a=t.localizer,s=a.add(e,n,"day");return a.format({start:e,end:s},"agendaHeaderFormat")};var Jh=Pl(Pl(Pl(Pl(Pl({},_a.MONTH,Tm),_a.WEEK,Qo),_a.WORK_WEEK,Nf),_a.DAY,Am),_a.AGENDA,Cm),gre=["action","date","today"];function xre(e,t){var r=t.action,n=t.date,a=t.today,s=Ai(t,gre);switch(e=typeof e=="string"?Jh[e]:e,r){case Ra.TODAY:n=a||new Date;break;case Ra.DATE:break;default:Fu(e&&typeof e.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=e.navigate(n,r,s)}return n}function vre(e,t){var r=null;return typeof t=="function"?r=t(e):typeof t=="string"&&Qt(e)==="object"&&e!=null&&t in e&&(r=e[t]),r}var Vi=function(t){return function(r){return vre(r,t)}},bre=["view","date","getNow","onNavigate"],yre=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function sS(e){if(Array.isArray(e))return e;for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var a=Da(n[r],2),s=a[0],o=a[1];o&&t.push(s)}return t}function wre(e,t){var r=t.views,n=sS(r);return n.indexOf(e)!==-1}var iS=function(e){function t(){var r;Dn(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=pa(this,t,[].concat(a)),r.getViews=function(){var o=r.props.views;return Array.isArray(o)?Jee(o,function(l,c){return l[c]=Jh[c]},{}):Qt(o)==="object"?JX(o,function(l,c){return l===!0?Jh[c]:l}):Jh},r.getView=function(){var o=r.getViews();return o[r.props.view]},r.getDrilldownView=function(o){var l=r.props,c=l.view,d=l.drilldownView,u=l.getDrilldownView;return u?u(o,c,Object.keys(r.getViews())):d},r.handleRangeChange=function(o,l,c){var d=r.props,u=d.onRangeChange,h=d.localizer;u&&l.range&&u(l.range(o,{localizer:h}),c)},r.handleNavigate=function(o,l){var c=r.props,d=c.view,u=c.date,h=c.getNow,m=c.onNavigate,f=Ai(c,bre),x=r.getView(),g=h();u=xre(x,Er(Er({},f),{},{action:o,date:l||u||g,today:g})),m(u,d,o),r.handleRangeChange(u,x)},r.handleViewChange=function(o){o!==r.props.view&&wre(o,r.props)&&r.props.onView(o);var l=r.getViews();r.handleRangeChange(r.props.date||r.props.getNow(),l[o],o)},r.handleSelectEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onSelectEvent,l)},r.handleDoubleClickEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onDoubleClickEvent,l)},r.handleKeyPressEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];Ir(r.props.onKeyPressEvent,l)},r.handleSelectSlot=function(o){Ir(r.props.onSelectSlot,o)},r.handleDrillDown=function(o,l){var c=r.props.onDrillDown;if(c){c(o,l,r.drilldownView);return}l&&r.handleViewChange(l),r.handleNavigate(Ra.DATE,o)},r.state={context:t.getContext(r.props)},r}return ga(t,e),On(t,[{key:"render",value:function(){var n=this.props,a=n.view,s=n.toolbar,o=n.events,l=n.backgroundEvents,c=n.resourceGroupingLayout,d=n.style,u=n.className,h=n.elementProps,m=n.date,f=n.getNow,x=n.length,g=n.showMultiDayTimes,b=n.onShowMore,y=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var N=Ai(n,yre);m=m||f();var S=this.getView(),_=this.state.context,D=_.accessors,I=_.components,O=_.getters,R=_.localizer,E=_.viewNames,B=I.toolbar||kte,C=S.title(m,{localizer:R,length:x});return Ce.createElement("div",Object.assign({},h,{className:rn(u,"rbc-calendar",N.rtl&&"rbc-rtl"),style:d}),s&&Ce.createElement(B,{date:m,view:a,views:E,label:C,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:R}),Ce.createElement(S,Object.assign({},N,{events:o,backgroundEvents:l,date:m,getNow:f,length:x,localizer:R,getters:O,components:I,accessors:D,showMultiDayTimes:g,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:b,doShowMoreDrillDown:y,resourceGroupingLayout:c})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,s=n.endAccessor,o=n.allDayAccessor,l=n.tooltipAccessor,c=n.titleAccessor,d=n.resourceAccessor,u=n.resourceIdAccessor,h=n.resourceTitleAccessor,m=n.eventIdAccessor,f=n.eventPropGetter,x=n.backgroundEventPropGetter,g=n.slotPropGetter,b=n.slotGroupPropGetter,y=n.dayPropGetter,N=n.view,S=n.views,_=n.localizer,D=n.culture,I=n.messages,O=I===void 0?{}:I,R=n.components,E=R===void 0?{}:R,B=n.formats,C=B===void 0?{}:B,M=sS(S),U=jte(O);return{viewNames:M,localizer:Nte(_,D,C,U),getters:{eventProp:function(){return f&&f.apply(void 0,arguments)||{}},backgroundEventProp:function(){return x&&x.apply(void 0,arguments)||{}},slotProp:function(){return g&&g.apply(void 0,arguments)||{}},slotGroupProp:function(){return b&&b.apply(void 0,arguments)||{}},dayProp:function(){return y&&y.apply(void 0,arguments)||{}}},components:HX(E[N]||{},Mee(E,M),{eventWrapper:gi,backgroundEventWrapper:gi,eventContainerWrapper:gi,dateCellWrapper:gi,weekWrapper:gi,timeSlotWrapper:gi,timeGutterWrapper:gi,timeIndicatorWrapper:gi}),accessors:{start:Vi(a),end:Vi(s),allDay:Vi(o),tooltip:Vi(l),title:Vi(c),resource:Vi(d),resourceId:Vi(u),resourceTitle:Vi(h),eventId:Vi(m)}}}}])}(Ce.Component);iS.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:_a.MONTH,views:[_a.MONTH,_a.WEEK,_a.DAY,_a.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:_a.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var oS=PN(iS,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),_re=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"MMMM DD",r)+" â€“ "+n.format(s,n.eq(a,s,"month")?"DD":"MMMM DD",r)},Nre=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"L",r)+" â€“ "+n.format(s,"L",r)},kg=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"LT",r)+" â€“ "+n.format(s,"LT",r)},kre=function(t,r,n){var a=t.start;return n.format(a,"LT",r)+" â€“ "},Sre=function(t,r,n){var a=t.end;return" â€“ "+n.format(a,"LT",r)},jre={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:kg,eventTimeRangeFormat:kg,eventTimeRangeStartFormat:kre,eventTimeRangeEndFormat:Sre,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:_re,agendaHeaderFormat:Nre,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:kg};function Io(e){var t=e&&e.toLowerCase();return t==="FullYear"?t="year":t||(t=void 0),t}function lS(e){var t=function(w,A){return A?w.locale(A):w};function r(xe){return e(xe).toDate().getTimezoneOffset()}function n(xe,w){var A,T,L=e(xe).local(),H=e(w).local();if(!e.tz)return L.toDate().getTimezoneOffset()-H.toDate().getTimezoneOffset();var X=(A=L==null||(T=L._z)===null||T===void 0?void 0:T.name)!==null&&A!==void 0?A:e.tz.guess(),re=e.tz.zone(X).utcOffset(+L),ge=e.tz.zone(X).utcOffset(+H);return re-ge}function a(xe){var w=e(xe).startOf("day");return n(w,xe)}function s(xe,w,A){var T=Io(A),L=T?e(xe).startOf(T):e(xe),H=T?e(w).startOf(T):e(w);return[L,H,T]}function o(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,w=arguments.length>1?arguments[1]:void 0,A=Io(w);return A?e(xe).startOf(A).toDate():e(xe).toDate()}function l(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,w=arguments.length>1?arguments[1]:void 0,A=Io(w);return A?e(xe).endOf(A).toDate():e(xe).toDate()}function c(xe,w,A){var T=s(xe,w,A),L=Da(T,3),H=L[0],X=L[1],re=L[2];return H.isSame(X,re)}function d(xe,w,A){return!c(xe,w,A)}function u(xe,w,A){var T=s(xe,w,A),L=Da(T,3),H=L[0],X=L[1],re=L[2];return H.isAfter(X,re)}function h(xe,w,A){var T=s(xe,w,A),L=Da(T,3),H=L[0],X=L[1],re=L[2];return H.isBefore(X,re)}function m(xe,w,A){var T=s(xe,w,A),L=Da(T,3),H=L[0],X=L[1],re=L[2];return H.isSameOrBefore(X,re)}function f(xe,w,A){var T=s(xe,w,A),L=Da(T,3),H=L[0],X=L[1],re=L[2];return H.isSameOrBefore(X,re)}function x(xe,w,A){var T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",L=Io(T),H=e(xe),X=e(w),re=e(A);return H.isBetween(X,re,L,"[]")}function g(xe,w){var A=e(xe),T=e(w),L=e.min(A,T);return L.toDate()}function b(xe,w){var A=e(xe),T=e(w),L=e.max(A,T);return L.toDate()}function y(xe,w){if(!xe&&!w)return null;var A=e(w).format("HH:mm:ss"),T=e(xe).startOf("day").format("MM/DD/YYYY");return e("".concat(T," ").concat(A),"MM/DD/YYYY HH:mm:ss").toDate()}function N(xe,w,A){var T=Io(A);return e(xe).add(w,T).toDate()}function S(xe,w){for(var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",T=Io(A),L=e(xe).toDate(),H=[];f(L,w);)H.push(L),L=N(L,1,T);return H}function _(xe,w){var A=Io(w),T=o(xe,A);return c(T,xe)?T:N(T,1,A)}function D(xe,w){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",T=Io(A),L=e(xe),H=e(w);return H.diff(L,T)}function I(xe){var w=e(xe);return w.minutes()}function O(xe){var w=xe?e.localeData(xe):e.localeData();return w?w.firstDayOfWeek():0}function R(xe){return e(xe).startOf("month").startOf("week").toDate()}function E(xe){return e(xe).endOf("month").endOf("week").toDate()}function B(xe){for(var w=R(xe),A=E(xe),T=[];f(w,A);)T.push(w),w=N(w,1,"d");return T}function C(xe,w,A){return e(xe).startOf("day").minute(w+A).toDate()}function M(xe,w){return D(xe,w,"minutes")}function U(xe){var w=e(xe).startOf("day"),A=e(xe);return A.diff(w,"minutes")+a(xe)}function F(xe,w){var A=e(xe),T=e(w);return A.isBefore(T,"day")}function ne(xe,w,A){var T=e(w),L=e(A);return T.isSameOrAfter(L,"minutes")}function V(xe,w){var A=e(xe),T=e(w),L=e.duration(T.diff(A));return L.days()}function ee(xe){var w=xe.evtA,A=w.start,T=w.end,L=w.allDay,H=xe.evtB,X=H.start,re=H.end,ge=H.allDay,oe=+o(A,"day")-+o(X,"day"),je=V(A,T),Ie=V(X,re);return oe||Ie-je||!!ge-!!L||+A-+X||+T-+re}function me(xe){var w=xe.event,A=w.start,T=w.end,L=xe.range,H=L.start,X=L.end,re=e(A).startOf("day"),ge=e(T),oe=e(H),je=e(X),Ie=re.isSameOrBefore(je,"day"),et=!re.isSame(ge,"minutes"),Te=et?ge.isAfter(oe,"minutes"):ge.isSameOrAfter(oe,"minutes");return Ie&&Te}function ye(xe,w){var A=e(xe),T=e(w);return A.isSame(T,"day")}function Oe(){var xe=new Date,w=/-/.test(xe.toString())?"-":"",A=xe.getTimezoneOffset(),T=Number("".concat(w).concat(Math.abs(A))),L=e().utcOffset();return L>T?1:0}return new _te({formats:jre,firstOfWeek:O,firstVisibleDay:R,lastVisibleDay:E,visibleDays:B,format:function(w,A,T){return t(e(w),T).format(A)},lt:h,lte:f,gt:u,gte:m,eq:c,neq:d,merge:y,inRange:x,startOf:o,endOf:l,range:S,add:N,diff:D,ceil:_,min:g,max:b,minutes:I,getSlotDate:C,getTimezoneOffset:r,getDstOffset:n,getTotalMin:M,getMinutesFromMidnight:U,continuesPrior:F,continuesAfter:ne,sortEvents:ee,inEventRange:me,isSameDate:ye,daySpan:V,browserTZOffset:Oe})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var cS;function bt(){return cS.apply(null,arguments)}function Tre(e){cS=e}function ei(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ul(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function cr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o2(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(cr(e,t))return!1;return!0}function Ca(e){return e===void 0}function ho(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function kf(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function dS(e,t){var r=[],n,a=e.length;for(n=0;n<a;++n)r.push(t(e[n],n));return r}function zo(e,t){for(var r in t)cr(t,r)&&(e[r]=t[r]);return cr(t,"toString")&&(e.toString=t.toString),cr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Oi(e,t,r,n){return PS(e,t,r,n,!0).utc()}function Are(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Kt(e){return e._pf==null&&(e._pf=Are()),e._pf}var jx;Array.prototype.some?jx=Array.prototype.some:jx=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function l2(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=Kt(e),r=jx.call(t.parsedDateParts,function(a){return a!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function Dm(e){var t=Oi(NaN);return e!=null?zo(Kt(t),e):Kt(t).userInvalidated=!0,t}var D5=bt.momentProperties=[],Sg=!1;function c2(e,t){var r,n,a,s=D5.length;if(Ca(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ca(t._i)||(e._i=t._i),Ca(t._f)||(e._f=t._f),Ca(t._l)||(e._l=t._l),Ca(t._strict)||(e._strict=t._strict),Ca(t._tzm)||(e._tzm=t._tzm),Ca(t._isUTC)||(e._isUTC=t._isUTC),Ca(t._offset)||(e._offset=t._offset),Ca(t._pf)||(e._pf=Kt(t)),Ca(t._locale)||(e._locale=t._locale),s>0)for(r=0;r<s;r++)n=D5[r],a=t[n],Ca(a)||(e[n]=a);return e}function Sf(e){c2(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Sg===!1&&(Sg=!0,bt.updateOffset(this),Sg=!1)}function ti(e){return e instanceof Sf||e!=null&&e._isAMomentObject!=null}function uS(e){bt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Fs(e,t){var r=!0;return zo(function(){if(bt.deprecationHandler!=null&&bt.deprecationHandler(null,e),r){var n=[],a,s,o,l=arguments.length;for(s=0;s<l;s++){if(a="",typeof arguments[s]=="object"){a+=`
[`+s+"] ";for(o in arguments[0])cr(arguments[0],o)&&(a+=o+": "+arguments[0][o]+", ");a=a.slice(0,-2)}else a=arguments[s];n.push(a)}uS(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var O5={};function fS(e,t){bt.deprecationHandler!=null&&bt.deprecationHandler(e,t),O5[e]||(uS(t),O5[e]=!0)}bt.suppressDeprecationWarnings=!1;bt.deprecationHandler=null;function Pi(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Ere(e){var t,r;for(r in e)cr(e,r)&&(t=e[r],Pi(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Tx(e,t){var r=zo({},e),n;for(n in t)cr(t,n)&&(Ul(e[n])&&Ul(t[n])?(r[n]={},zo(r[n],e[n]),zo(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)cr(e,n)&&!cr(t,n)&&Ul(e[n])&&(r[n]=zo({},r[n]));return r}function d2(e){e!=null&&this.set(e)}var Ax;Object.keys?Ax=Object.keys:Ax=function(e){var t,r=[];for(t in e)cr(e,t)&&r.push(t);return r};var Cre={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Dre(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Pi(n)?n.call(t,r):n}function Ei(e,t,r){var n=""+Math.abs(e),a=t-n.length,s=e>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var u2=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Eh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,jg={},Vc={};function Pt(e,t,r,n){var a=n;typeof n=="string"&&(a=function(){return this[n]()}),e&&(Vc[e]=a),t&&(Vc[t[0]]=function(){return Ei(a.apply(this,arguments),t[1],t[2])}),r&&(Vc[r]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function Ore(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Pre(e){var t=e.match(u2),r,n;for(r=0,n=t.length;r<n;r++)Vc[t[r]]?t[r]=Vc[t[r]]:t[r]=Ore(t[r]);return function(a){var s="",o;for(o=0;o<n;o++)s+=Pi(t[o])?t[o].call(a,e):t[o];return s}}function Zh(e,t){return e.isValid()?(t=hS(t,e.localeData()),jg[t]=jg[t]||Pre(t),jg[t](e)):e.localeData().invalidDate()}function hS(e,t){var r=5;function n(a){return t.longDateFormat(a)||a}for(Eh.lastIndex=0;r>=0&&Eh.test(e);)e=e.replace(Eh,n),Eh.lastIndex=0,r-=1;return e}var Lre={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Fre(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(u2).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var $re="Invalid date";function Rre(){return this._invalidDate}var Mre="%d",Ire=/\d{1,2}/;function Bre(e){return this._ordinal.replace("%d",e)}var Ure={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Wre(e,t,r,n){var a=this._relativeTime[r];return Pi(a)?a(e,t,r,n):a.replace(/%d/i,e)}function zre(e,t){var r=this._relativeTime[e>0?"future":"past"];return Pi(r)?r(t):r.replace(/%s/i,t)}var P5={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function $s(e){return typeof e=="string"?P5[e]||P5[e.toLowerCase()]:void 0}function f2(e){var t={},r,n;for(n in e)cr(e,n)&&(r=$s(n),r&&(t[r]=e[n]));return t}var Hre={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function qre(e){var t=[],r;for(r in e)cr(e,r)&&t.push({unit:r,priority:Hre[r]});return t.sort(function(n,a){return n.priority-a.priority}),t}var mS=/\d/,ls=/\d\d/,pS=/\d{3}/,h2=/\d{4}/,Om=/[+-]?\d{6}/,zr=/\d\d?/,gS=/\d\d\d\d?/,xS=/\d\d\d\d\d\d?/,Pm=/\d{1,3}/,m2=/\d{1,4}/,Lm=/[+-]?\d{1,6}/,Sd=/\d+/,Fm=/[+-]?\d+/,Yre=/Z|[+-]\d\d:?\d\d/gi,$m=/Z|[+-]\d\d(?::?\d\d)?/gi,Vre=/[+-]?\d+(\.\d{1,3})?/,jf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,jd=/^[1-9]\d?/,p2=/^([1-9]\d|\d)/,R0;R0={};function wt(e,t,r){R0[e]=Pi(t)?t:function(n,a){return n&&r?r:t}}function Gre(e,t){return cr(R0,e)?R0[e](t._strict,t._locale):new RegExp(Kre(e))}function Kre(e){return so(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,a,s){return r||n||a||s}))}function so(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function _s(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function er(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=_s(t)),r}var Ex={};function Sr(e,t){var r,n=t,a;for(typeof e=="string"&&(e=[e]),ho(t)&&(n=function(s,o){o[t]=er(s)}),a=e.length,r=0;r<a;r++)Ex[e[r]]=n}function Tf(e,t){Sr(e,function(r,n,a,s){a._w=a._w||{},t(r,a._w,a,s)})}function Xre(e,t,r){t!=null&&cr(Ex,e)&&Ex[e](t,r._a,r,e)}function Rm(e){return e%4===0&&e%100!==0||e%400===0}var ma=0,Qi=1,xi=2,En=3,Xs=4,eo=5,Fl=6,Jre=7,Zre=8;Pt("Y",0,0,function(){var e=this.year();return e<=9999?Ei(e,4):"+"+e});Pt(0,["YY",2],0,function(){return this.year()%100});Pt(0,["YYYY",4],0,"year");Pt(0,["YYYYY",5],0,"year");Pt(0,["YYYYYY",6,!0],0,"year");wt("Y",Fm);wt("YY",zr,ls);wt("YYYY",m2,h2);wt("YYYYY",Lm,Om);wt("YYYYYY",Lm,Om);Sr(["YYYYY","YYYYYY"],ma);Sr("YYYY",function(e,t){t[ma]=e.length===2?bt.parseTwoDigitYear(e):er(e)});Sr("YY",function(e,t){t[ma]=bt.parseTwoDigitYear(e)});Sr("Y",function(e,t){t[ma]=parseInt(e,10)});function Nu(e){return Rm(e)?366:365}bt.parseTwoDigitYear=function(e){return er(e)+(er(e)>68?1900:2e3)};var vS=Td("FullYear",!0);function Qre(){return Rm(this.year())}function Td(e,t){return function(r){return r!=null?(bS(this,e,r),bt.updateOffset(this,t),this):Ku(this,e)}}function Ku(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function bS(e,t,r){var n,a,s,o,l;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,a=e._isUTC,t){case"Milliseconds":return void(a?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(a?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(a?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(a?n.setUTCHours(r):n.setHours(r));case"Date":return void(a?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=e.month(),l=e.date(),l=l===29&&o===1&&!Rm(s)?28:l,a?n.setUTCFullYear(s,o,l):n.setFullYear(s,o,l)}}function ene(e){return e=$s(e),Pi(this[e])?this[e]():this}function tne(e,t){if(typeof e=="object"){e=f2(e);var r=qre(e),n,a=r.length;for(n=0;n<a;n++)this[r[n].unit](e[r[n].unit])}else if(e=$s(e),Pi(this[e]))return this[e](t);return this}function rne(e,t){return(e%t+t)%t}var un;Array.prototype.indexOf?un=Array.prototype.indexOf:un=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function g2(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=rne(t,12);return e+=(t-r)/12,r===1?Rm(e)?29:28:31-r%7%2}Pt("M",["MM",2],"Mo",function(){return this.month()+1});Pt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pt("MMMM",0,0,function(e){return this.localeData().months(this,e)});wt("M",zr,jd);wt("MM",zr,ls);wt("MMM",function(e,t){return t.monthsShortRegex(e)});wt("MMMM",function(e,t){return t.monthsRegex(e)});Sr(["M","MM"],function(e,t){t[Qi]=er(e)-1});Sr(["MMM","MMMM"],function(e,t,r,n){var a=r._locale.monthsParse(e,n,r._strict);a!=null?t[Qi]=a:Kt(r).invalidMonth=e});var nne="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yS="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),wS=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ane=jf,sne=jf;function ine(e,t){return e?ei(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||wS).test(t)?"format":"standalone"][e.month()]:ei(this._months)?this._months:this._months.standalone}function one(e,t){return e?ei(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[wS.test(t)?"format":"standalone"][e.month()]:ei(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function lne(e,t,r){var n,a,s,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Oi([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?t==="MMM"?(a=un.call(this._shortMonthsParse,o),a!==-1?a:null):(a=un.call(this._longMonthsParse,o),a!==-1?a:null):t==="MMM"?(a=un.call(this._shortMonthsParse,o),a!==-1?a:(a=un.call(this._longMonthsParse,o),a!==-1?a:null)):(a=un.call(this._longMonthsParse,o),a!==-1?a:(a=un.call(this._shortMonthsParse,o),a!==-1?a:null))}function cne(e,t,r){var n,a,s;if(this._monthsParseExact)return lne.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=Oi([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function _S(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=er(t);else if(t=e.localeData().monthsParse(t),!ho(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,g2(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function NS(e){return e!=null?(_S(this,e),bt.updateOffset(this,!0),this):Ku(this,"Month")}function dne(){return g2(this.year(),this.month())}function une(e){return this._monthsParseExact?(cr(this,"_monthsRegex")||kS.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(cr(this,"_monthsShortRegex")||(this._monthsShortRegex=ane),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function fne(e){return this._monthsParseExact?(cr(this,"_monthsRegex")||kS.call(this),e?this._monthsStrictRegex:this._monthsRegex):(cr(this,"_monthsRegex")||(this._monthsRegex=sne),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function kS(){function e(c,d){return d.length-c.length}var t=[],r=[],n=[],a,s,o,l;for(a=0;a<12;a++)s=Oi([2e3,a]),o=so(this.monthsShort(s,"")),l=so(this.months(s,"")),t.push(o),r.push(l),n.push(l),n.push(o);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function hne(e,t,r,n,a,s,o){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,a,s,o),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,a,s,o),l}function Xu(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function M0(e,t,r){var n=7+t-r,a=(7+Xu(e,0,n).getUTCDay()-t)%7;return-a+n-1}function SS(e,t,r,n,a){var s=(7+r-n)%7,o=M0(e,n,a),l=1+7*(t-1)+s+o,c,d;return l<=0?(c=e-1,d=Nu(c)+l):l>Nu(e)?(c=e+1,d=l-Nu(e)):(c=e,d=l),{year:c,dayOfYear:d}}function Ju(e,t,r){var n=M0(e.year(),t,r),a=Math.floor((e.dayOfYear()-n-1)/7)+1,s,o;return a<1?(o=e.year()-1,s=a+io(o,t,r)):a>io(e.year(),t,r)?(s=a-io(e.year(),t,r),o=e.year()+1):(o=e.year(),s=a),{week:s,year:o}}function io(e,t,r){var n=M0(e,t,r),a=M0(e+1,t,r);return(Nu(e)-n+a)/7}Pt("w",["ww",2],"wo","week");Pt("W",["WW",2],"Wo","isoWeek");wt("w",zr,jd);wt("ww",zr,ls);wt("W",zr,jd);wt("WW",zr,ls);Tf(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=er(e)});function mne(e){return Ju(e,this._week.dow,this._week.doy).week}var pne={dow:0,doy:6};function gne(){return this._week.dow}function xne(){return this._week.doy}function vne(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function bne(e){var t=Ju(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pt("d",0,"do","day");Pt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pt("e",0,0,"weekday");Pt("E",0,0,"isoWeekday");wt("d",zr);wt("e",zr);wt("E",zr);wt("dd",function(e,t){return t.weekdaysMinRegex(e)});wt("ddd",function(e,t){return t.weekdaysShortRegex(e)});wt("dddd",function(e,t){return t.weekdaysRegex(e)});Tf(["dd","ddd","dddd"],function(e,t,r,n){var a=r._locale.weekdaysParse(e,n,r._strict);a!=null?t.d=a:Kt(r).invalidWeekday=e});Tf(["d","e","E"],function(e,t,r,n){t[n]=er(e)});function yne(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function wne(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function x2(e,t){return e.slice(t,7).concat(e.slice(0,t))}var _ne="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),jS="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Nne="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),kne=jf,Sne=jf,jne=jf;function Tne(e,t){var r=ei(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?x2(r,this._week.dow):e?r[e.day()]:r}function Ane(e){return e===!0?x2(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ene(e){return e===!0?x2(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Cne(e,t,r){var n,a,s,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Oi([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?t==="dddd"?(a=un.call(this._weekdaysParse,o),a!==-1?a:null):t==="ddd"?(a=un.call(this._shortWeekdaysParse,o),a!==-1?a:null):(a=un.call(this._minWeekdaysParse,o),a!==-1?a:null):t==="dddd"?(a=un.call(this._weekdaysParse,o),a!==-1||(a=un.call(this._shortWeekdaysParse,o),a!==-1)?a:(a=un.call(this._minWeekdaysParse,o),a!==-1?a:null)):t==="ddd"?(a=un.call(this._shortWeekdaysParse,o),a!==-1||(a=un.call(this._weekdaysParse,o),a!==-1)?a:(a=un.call(this._minWeekdaysParse,o),a!==-1?a:null)):(a=un.call(this._minWeekdaysParse,o),a!==-1||(a=un.call(this._weekdaysParse,o),a!==-1)?a:(a=un.call(this._shortWeekdaysParse,o),a!==-1?a:null))}function Dne(e,t,r){var n,a,s;if(this._weekdaysParseExact)return Cne.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=Oi([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function One(e){if(!this.isValid())return e!=null?this:NaN;var t=Ku(this,"Day");return e!=null?(e=yne(e,this.localeData()),this.add(e-t,"d")):t}function Pne(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Lne(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=wne(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Fne(e){return this._weekdaysParseExact?(cr(this,"_weekdaysRegex")||v2.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(cr(this,"_weekdaysRegex")||(this._weekdaysRegex=kne),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function $ne(e){return this._weekdaysParseExact?(cr(this,"_weekdaysRegex")||v2.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(cr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Sne),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Rne(e){return this._weekdaysParseExact?(cr(this,"_weekdaysRegex")||v2.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(cr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=jne),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function v2(){function e(u,h){return h.length-u.length}var t=[],r=[],n=[],a=[],s,o,l,c,d;for(s=0;s<7;s++)o=Oi([2e3,1]).day(s),l=so(this.weekdaysMin(o,"")),c=so(this.weekdaysShort(o,"")),d=so(this.weekdays(o,"")),t.push(l),r.push(c),n.push(d),a.push(l),a.push(c),a.push(d);t.sort(e),r.sort(e),n.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function b2(){return this.hours()%12||12}function Mne(){return this.hours()||24}Pt("H",["HH",2],0,"hour");Pt("h",["hh",2],0,b2);Pt("k",["kk",2],0,Mne);Pt("hmm",0,0,function(){return""+b2.apply(this)+Ei(this.minutes(),2)});Pt("hmmss",0,0,function(){return""+b2.apply(this)+Ei(this.minutes(),2)+Ei(this.seconds(),2)});Pt("Hmm",0,0,function(){return""+this.hours()+Ei(this.minutes(),2)});Pt("Hmmss",0,0,function(){return""+this.hours()+Ei(this.minutes(),2)+Ei(this.seconds(),2)});function TS(e,t){Pt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}TS("a",!0);TS("A",!1);function AS(e,t){return t._meridiemParse}wt("a",AS);wt("A",AS);wt("H",zr,p2);wt("h",zr,jd);wt("k",zr,jd);wt("HH",zr,ls);wt("hh",zr,ls);wt("kk",zr,ls);wt("hmm",gS);wt("hmmss",xS);wt("Hmm",gS);wt("Hmmss",xS);Sr(["H","HH"],En);Sr(["k","kk"],function(e,t,r){var n=er(e);t[En]=n===24?0:n});Sr(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});Sr(["h","hh"],function(e,t,r){t[En]=er(e),Kt(r).bigHour=!0});Sr("hmm",function(e,t,r){var n=e.length-2;t[En]=er(e.substr(0,n)),t[Xs]=er(e.substr(n)),Kt(r).bigHour=!0});Sr("hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[En]=er(e.substr(0,n)),t[Xs]=er(e.substr(n,2)),t[eo]=er(e.substr(a)),Kt(r).bigHour=!0});Sr("Hmm",function(e,t,r){var n=e.length-2;t[En]=er(e.substr(0,n)),t[Xs]=er(e.substr(n))});Sr("Hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[En]=er(e.substr(0,n)),t[Xs]=er(e.substr(n,2)),t[eo]=er(e.substr(a))});function Ine(e){return(e+"").toLowerCase().charAt(0)==="p"}var Bne=/[ap]\.?m?\.?/i,Une=Td("Hours",!0);function Wne(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var ES={calendar:Cre,longDateFormat:Lre,invalidDate:$re,ordinal:Mre,dayOfMonthOrdinalParse:Ire,relativeTime:Ure,months:nne,monthsShort:yS,week:pne,weekdays:_ne,weekdaysMin:Nne,weekdaysShort:jS,meridiemParse:Bne},Yr={},ou={},Zu;function zne(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function L5(e){return e&&e.toLowerCase().replace("_","-")}function Hne(e){for(var t=0,r,n,a,s;t<e.length;){for(s=L5(e[t]).split("-"),r=s.length,n=L5(e[t+1]),n=n?n.split("-"):null;r>0;){if(a=Mm(s.slice(0,r).join("-")),a)return a;if(n&&n.length>=r&&zne(s,n)>=r-1)break;r--}t++}return Zu}function qne(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Mm(e){var t=null,r;if(Yr[e]===void 0&&typeof module<"u"&&module&&module.exports&&qne(e))try{t=Zu._abbr,r=require,r("./locale/"+e),Vo(t)}catch{Yr[e]=null}return Yr[e]}function Vo(e,t){var r;return e&&(Ca(t)?r=go(e):r=y2(e,t),r?Zu=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Zu._abbr}function y2(e,t){if(t!==null){var r,n=ES;if(t.abbr=e,Yr[e]!=null)fS("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Yr[e]._config;else if(t.parentLocale!=null)if(Yr[t.parentLocale]!=null)n=Yr[t.parentLocale]._config;else if(r=Mm(t.parentLocale),r!=null)n=r._config;else return ou[t.parentLocale]||(ou[t.parentLocale]=[]),ou[t.parentLocale].push({name:e,config:t}),null;return Yr[e]=new d2(Tx(n,t)),ou[e]&&ou[e].forEach(function(a){y2(a.name,a.config)}),Vo(e),Yr[e]}else return delete Yr[e],null}function Yne(e,t){if(t!=null){var r,n,a=ES;Yr[e]!=null&&Yr[e].parentLocale!=null?Yr[e].set(Tx(Yr[e]._config,t)):(n=Mm(e),n!=null&&(a=n._config),t=Tx(a,t),n==null&&(t.abbr=e),r=new d2(t),r.parentLocale=Yr[e],Yr[e]=r),Vo(e)}else Yr[e]!=null&&(Yr[e].parentLocale!=null?(Yr[e]=Yr[e].parentLocale,e===Vo()&&Vo(e)):Yr[e]!=null&&delete Yr[e]);return Yr[e]}function go(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Zu;if(!ei(e)){if(t=Mm(e),t)return t;e=[e]}return Hne(e)}function Vne(){return Ax(Yr)}function w2(e){var t,r=e._a;return r&&Kt(e).overflow===-2&&(t=r[Qi]<0||r[Qi]>11?Qi:r[xi]<1||r[xi]>g2(r[ma],r[Qi])?xi:r[En]<0||r[En]>24||r[En]===24&&(r[Xs]!==0||r[eo]!==0||r[Fl]!==0)?En:r[Xs]<0||r[Xs]>59?Xs:r[eo]<0||r[eo]>59?eo:r[Fl]<0||r[Fl]>999?Fl:-1,Kt(e)._overflowDayOfYear&&(t<ma||t>xi)&&(t=xi),Kt(e)._overflowWeeks&&t===-1&&(t=Jre),Kt(e)._overflowWeekday&&t===-1&&(t=Zre),Kt(e).overflow=t),e}var Gne=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Kne=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Xne=/Z|[+-]\d\d(?::?\d\d)?/,Ch=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Tg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Jne=/^\/?Date\((-?\d+)/i,Zne=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Qne={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function CS(e){var t,r,n=e._i,a=Gne.exec(n)||Kne.exec(n),s,o,l,c,d=Ch.length,u=Tg.length;if(a){for(Kt(e).iso=!0,t=0,r=d;t<r;t++)if(Ch[t][1].exec(a[1])){o=Ch[t][0],s=Ch[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(a[3]){for(t=0,r=u;t<r;t++)if(Tg[t][1].exec(a[3])){l=(a[2]||" ")+Tg[t][0];break}if(l==null){e._isValid=!1;return}}if(!s&&l!=null){e._isValid=!1;return}if(a[4])if(Xne.exec(a[4]))c="Z";else{e._isValid=!1;return}e._f=o+(l||"")+(c||""),N2(e)}else e._isValid=!1}function eae(e,t,r,n,a,s){var o=[tae(e),yS.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(a,10)];return s&&o.push(parseInt(s,10)),o}function tae(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function rae(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function nae(e,t,r){if(e){var n=jS.indexOf(e),a=new Date(t[0],t[1],t[2]).getDay();if(n!==a)return Kt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function aae(e,t,r){if(e)return Qne[e];if(t)return 0;var n=parseInt(r,10),a=n%100,s=(n-a)/100;return s*60+a}function DS(e){var t=Zne.exec(rae(e._i)),r;if(t){if(r=eae(t[4],t[3],t[2],t[5],t[6],t[7]),!nae(t[1],r,e))return;e._a=r,e._tzm=aae(t[8],t[9],t[10]),e._d=Xu.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Kt(e).rfc2822=!0}else e._isValid=!1}function sae(e){var t=Jne.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(CS(e),e._isValid===!1)delete e._isValid;else return;if(DS(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:bt.createFromInputFallback(e)}bt.createFromInputFallback=Fs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Lc(e,t,r){return e??t??r}function iae(e){var t=new Date(bt.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function _2(e){var t,r,n=[],a,s,o;if(!e._d){for(a=iae(e),e._w&&e._a[xi]==null&&e._a[Qi]==null&&oae(e),e._dayOfYear!=null&&(o=Lc(e._a[ma],a[ma]),(e._dayOfYear>Nu(o)||e._dayOfYear===0)&&(Kt(e)._overflowDayOfYear=!0),r=Xu(o,0,e._dayOfYear),e._a[Qi]=r.getUTCMonth(),e._a[xi]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=a[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[En]===24&&e._a[Xs]===0&&e._a[eo]===0&&e._a[Fl]===0&&(e._nextDay=!0,e._a[En]=0),e._d=(e._useUTC?Xu:hne).apply(null,n),s=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[En]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==s&&(Kt(e).weekdayMismatch=!0)}}function oae(e){var t,r,n,a,s,o,l,c,d;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(s=1,o=4,r=Lc(t.GG,e._a[ma],Ju(Wr(),1,4).year),n=Lc(t.W,1),a=Lc(t.E,1),(a<1||a>7)&&(c=!0)):(s=e._locale._week.dow,o=e._locale._week.doy,d=Ju(Wr(),s,o),r=Lc(t.gg,e._a[ma],d.year),n=Lc(t.w,d.week),t.d!=null?(a=t.d,(a<0||a>6)&&(c=!0)):t.e!=null?(a=t.e+s,(t.e<0||t.e>6)&&(c=!0)):a=s),n<1||n>io(r,s,o)?Kt(e)._overflowWeeks=!0:c!=null?Kt(e)._overflowWeekday=!0:(l=SS(r,n,a,s,o),e._a[ma]=l.year,e._dayOfYear=l.dayOfYear)}bt.ISO_8601=function(){};bt.RFC_2822=function(){};function N2(e){if(e._f===bt.ISO_8601){CS(e);return}if(e._f===bt.RFC_2822){DS(e);return}e._a=[],Kt(e).empty=!0;var t=""+e._i,r,n,a,s,o,l=t.length,c=0,d,u;for(a=hS(e._f,e._locale).match(u2)||[],u=a.length,r=0;r<u;r++)s=a[r],n=(t.match(Gre(s,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&Kt(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),c+=n.length),Vc[s]?(n?Kt(e).empty=!1:Kt(e).unusedTokens.push(s),Xre(s,n,e)):e._strict&&!n&&Kt(e).unusedTokens.push(s);Kt(e).charsLeftOver=l-c,t.length>0&&Kt(e).unusedInput.push(t),e._a[En]<=12&&Kt(e).bigHour===!0&&e._a[En]>0&&(Kt(e).bigHour=void 0),Kt(e).parsedDateParts=e._a.slice(0),Kt(e).meridiem=e._meridiem,e._a[En]=lae(e._locale,e._a[En],e._meridiem),d=Kt(e).era,d!==null&&(e._a[ma]=e._locale.erasConvertYear(d,e._a[ma])),_2(e),w2(e)}function lae(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function cae(e){var t,r,n,a,s,o,l=!1,c=e._f.length;if(c===0){Kt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<c;a++)s=0,o=!1,t=c2({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[a],N2(t),l2(t)&&(o=!0),s+=Kt(t).charsLeftOver,s+=Kt(t).unusedTokens.length*10,Kt(t).score=s,l?s<n&&(n=s,r=t):(n==null||s<n||o)&&(n=s,r=t,o&&(l=!0));zo(e,r||t)}function dae(e){if(!e._d){var t=f2(e._i),r=t.day===void 0?t.date:t.day;e._a=dS([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),_2(e)}}function uae(e){var t=new Sf(w2(OS(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function OS(e){var t=e._i,r=e._f;return e._locale=e._locale||go(e._l),t===null||r===void 0&&t===""?Dm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),ti(t)?new Sf(w2(t)):(kf(t)?e._d=t:ei(r)?cae(e):r?N2(e):fae(e),l2(e)||(e._d=null),e))}function fae(e){var t=e._i;Ca(t)?e._d=new Date(bt.now()):kf(t)?e._d=new Date(t.valueOf()):typeof t=="string"?sae(e):ei(t)?(e._a=dS(t.slice(0),function(r){return parseInt(r,10)}),_2(e)):Ul(t)?dae(e):ho(t)?e._d=new Date(t):bt.createFromInputFallback(e)}function PS(e,t,r,n,a){var s={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ul(e)&&o2(e)||ei(e)&&e.length===0)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=r,s._i=e,s._f=t,s._strict=n,uae(s)}function Wr(e,t,r,n){return PS(e,t,r,n,!1)}var hae=Fs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Wr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Dm()}),mae=Fs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Wr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Dm()});function LS(e,t){var r,n;if(t.length===1&&ei(t[0])&&(t=t[0]),!t.length)return Wr();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function pae(){var e=[].slice.call(arguments,0);return LS("isBefore",e)}function gae(){var e=[].slice.call(arguments,0);return LS("isAfter",e)}var xae=function(){return Date.now?Date.now():+new Date},lu=["year","quarter","month","week","day","hour","minute","second","millisecond"];function vae(e){var t,r=!1,n,a=lu.length;for(t in e)if(cr(e,t)&&!(un.call(lu,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<a;++n)if(e[lu[n]]){if(r)return!1;parseFloat(e[lu[n]])!==er(e[lu[n]])&&(r=!0)}return!0}function bae(){return this._isValid}function yae(){return si(NaN)}function Im(e){var t=f2(e),r=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||t.isoWeek||0,o=t.day||0,l=t.hour||0,c=t.minute||0,d=t.second||0,u=t.millisecond||0;this._isValid=vae(t),this._milliseconds=+u+d*1e3+c*6e4+l*1e3*60*60,this._days=+o+s*7,this._months=+a+n*3+r*12,this._data={},this._locale=go(),this._bubble()}function Qh(e){return e instanceof Im}function Cx(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function wae(e,t,r){var n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0,o;for(o=0;o<n;o++)er(e[o])!==er(t[o])&&s++;return s+a}function FS(e,t){Pt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ei(~~(r/60),2)+t+Ei(~~r%60,2)})}FS("Z",":");FS("ZZ","");wt("Z",$m);wt("ZZ",$m);Sr(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=k2($m,e)});var _ae=/([\+\-]|\d\d)/gi;function k2(e,t){var r=(t||"").match(e),n,a,s;return r===null?null:(n=r[r.length-1]||[],a=(n+"").match(_ae)||["-",0,0],s=+(a[1]*60)+er(a[2]),s===0?0:a[0]==="+"?s:-s)}function S2(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(ti(e)||kf(e)?e.valueOf():Wr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),bt.updateOffset(r,!1),r):Wr(e).local()}function Dx(e){return-Math.round(e._d.getTimezoneOffset())}bt.updateOffset=function(){};function Nae(e,t,r){var n=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=k2($m,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(a=Dx(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),n!==e&&(!t||this._changeInProgress?MS(this,si(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,bt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Dx(this)}function kae(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Sae(e){return this.utcOffset(0,e)}function jae(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Dx(this),"m")),this}function Tae(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=k2(Yre,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Aae(e){return this.isValid()?(e=e?Wr(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Eae(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Cae(){if(!Ca(this._isDSTShifted))return this._isDSTShifted;var e={},t;return c2(e,this),e=OS(e),e._a?(t=e._isUTC?Oi(e._a):Wr(e._a),this._isDSTShifted=this.isValid()&&wae(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Dae(){return this.isValid()?!this._isUTC:!1}function Oae(){return this.isValid()?this._isUTC:!1}function $S(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Pae=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Lae=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function si(e,t){var r=e,n=null,a,s,o;return Qh(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:ho(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Pae.exec(e))?(a=n[1]==="-"?-1:1,r={y:0,d:er(n[xi])*a,h:er(n[En])*a,m:er(n[Xs])*a,s:er(n[eo])*a,ms:er(Cx(n[Fl]*1e3))*a}):(n=Lae.exec(e))?(a=n[1]==="-"?-1:1,r={y:Al(n[2],a),M:Al(n[3],a),w:Al(n[4],a),d:Al(n[5],a),h:Al(n[6],a),m:Al(n[7],a),s:Al(n[8],a)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=Fae(Wr(r.from),Wr(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new Im(r),Qh(e)&&cr(e,"_locale")&&(s._locale=e._locale),Qh(e)&&cr(e,"_isValid")&&(s._isValid=e._isValid),s}si.fn=Im.prototype;si.invalid=yae;function Al(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function F5(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Fae(e,t){var r;return e.isValid()&&t.isValid()?(t=S2(t,e),e.isBefore(t)?r=F5(e,t):(r=F5(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function RS(e,t){return function(r,n){var a,s;return n!==null&&!isNaN(+n)&&(fS(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),a=si(r,n),MS(this,a,e),this}}function MS(e,t,r,n){var a=t._milliseconds,s=Cx(t._days),o=Cx(t._months);e.isValid()&&(n=n??!0,o&&_S(e,Ku(e,"Month")+o*r),s&&bS(e,"Date",Ku(e,"Date")+s*r),a&&e._d.setTime(e._d.valueOf()+a*r),n&&bt.updateOffset(e,s||o))}var $ae=RS(1,"add"),Rae=RS(-1,"subtract");function IS(e){return typeof e=="string"||e instanceof String}function Mae(e){return ti(e)||kf(e)||IS(e)||ho(e)||Bae(e)||Iae(e)||e===null||e===void 0}function Iae(e){var t=Ul(e)&&!o2(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,s,o=n.length;for(a=0;a<o;a+=1)s=n[a],r=r||cr(e,s);return t&&r}function Bae(e){var t=ei(e),r=!1;return t&&(r=e.filter(function(n){return!ho(n)&&IS(e)}).length===0),t&&r}function Uae(e){var t=Ul(e)&&!o2(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,s;for(a=0;a<n.length;a+=1)s=n[a],r=r||cr(e,s);return t&&r}function Wae(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function zae(e,t){arguments.length===1&&(arguments[0]?Mae(arguments[0])?(e=arguments[0],t=void 0):Uae(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Wr(),n=S2(r,this).startOf("day"),a=bt.calendarFormat(this,n)||"sameElse",s=t&&(Pi(t[a])?t[a].call(this,r):t[a]);return this.format(s||this.localeData().calendar(a,this,Wr(r)))}function Hae(){return new Sf(this)}function qae(e,t){var r=ti(e)?e:Wr(e);return this.isValid()&&r.isValid()?(t=$s(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function Yae(e,t){var r=ti(e)?e:Wr(e);return this.isValid()&&r.isValid()?(t=$s(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Vae(e,t,r,n){var a=ti(e)?e:Wr(e),s=ti(t)?t:Wr(t);return this.isValid()&&a.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(a,r):!this.isBefore(a,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function Gae(e,t){var r=ti(e)?e:Wr(e),n;return this.isValid()&&r.isValid()?(t=$s(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Kae(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Xae(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Jae(e,t,r){var n,a,s;if(!this.isValid())return NaN;if(n=S2(e,this),!n.isValid())return NaN;switch(a=(n.utcOffset()-this.utcOffset())*6e4,t=$s(t),t){case"year":s=e0(this,n)/12;break;case"month":s=e0(this,n);break;case"quarter":s=e0(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-a)/864e5;break;case"week":s=(this-n-a)/6048e5;break;default:s=this-n}return r?s:_s(s)}function e0(e,t){if(e.date()<t.date())return-e0(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),a,s;return t-n<0?(a=e.clone().add(r-1,"months"),s=(t-n)/(n-a)):(a=e.clone().add(r+1,"months"),s=(t-n)/(a-n)),-(r+s)||0}bt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";bt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Zae(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Qae(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Zh(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Pi(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Zh(r,"Z")):Zh(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ese(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,a,s;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]',this.format(r+n+a+s)}function tse(e){e||(e=this.isUtc()?bt.defaultFormatUtc:bt.defaultFormat);var t=Zh(this,e);return this.localeData().postformat(t)}function rse(e,t){return this.isValid()&&(ti(e)&&e.isValid()||Wr(e).isValid())?si({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function nse(e){return this.from(Wr(),e)}function ase(e,t){return this.isValid()&&(ti(e)&&e.isValid()||Wr(e).isValid())?si({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function sse(e){return this.to(Wr(),e)}function BS(e){var t;return e===void 0?this._locale._abbr:(t=go(e),t!=null&&(this._locale=t),this)}var US=Fs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function WS(){return this._locale}var I0=1e3,Gc=60*I0,B0=60*Gc,zS=(365*400+97)*24*B0;function Kc(e,t){return(e%t+t)%t}function HS(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-zS:new Date(e,t,r).valueOf()}function qS(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-zS:Date.UTC(e,t,r)}function ise(e){var t,r;if(e=$s(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qS:HS,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Kc(t+(this._isUTC?0:this.utcOffset()*Gc),B0);break;case"minute":t=this._d.valueOf(),t-=Kc(t,Gc);break;case"second":t=this._d.valueOf(),t-=Kc(t,I0);break}return this._d.setTime(t),bt.updateOffset(this,!0),this}function ose(e){var t,r;if(e=$s(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qS:HS,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=B0-Kc(t+(this._isUTC?0:this.utcOffset()*Gc),B0)-1;break;case"minute":t=this._d.valueOf(),t+=Gc-Kc(t,Gc)-1;break;case"second":t=this._d.valueOf(),t+=I0-Kc(t,I0)-1;break}return this._d.setTime(t),bt.updateOffset(this,!0),this}function lse(){return this._d.valueOf()-(this._offset||0)*6e4}function cse(){return Math.floor(this.valueOf()/1e3)}function dse(){return new Date(this.valueOf())}function use(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function fse(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function hse(){return this.isValid()?this.toISOString():null}function mse(){return l2(this)}function pse(){return zo({},Kt(this))}function gse(){return Kt(this).overflow}function xse(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pt("N",0,0,"eraAbbr");Pt("NN",0,0,"eraAbbr");Pt("NNN",0,0,"eraAbbr");Pt("NNNN",0,0,"eraName");Pt("NNNNN",0,0,"eraNarrow");Pt("y",["y",1],"yo","eraYear");Pt("y",["yy",2],0,"eraYear");Pt("y",["yyy",3],0,"eraYear");Pt("y",["yyyy",4],0,"eraYear");wt("N",j2);wt("NN",j2);wt("NNN",j2);wt("NNNN",Ase);wt("NNNNN",Ese);Sr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var a=r._locale.erasParse(e,n,r._strict);a?Kt(r).era=a:Kt(r).invalidEra=e});wt("y",Sd);wt("yy",Sd);wt("yyy",Sd);wt("yyyy",Sd);wt("yo",Cse);Sr(["y","yy","yyy","yyyy"],ma);Sr(["yo"],function(e,t,r,n){var a;r._locale._eraYearOrdinalRegex&&(a=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ma]=r._locale.eraYearOrdinalParse(e,a):t[ma]=parseInt(e,10)});function vse(e,t){var r,n,a,s=this._eras||go("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":a=bt(s[r].since).startOf("day"),s[r].since=a.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":a=bt(s[r].until).startOf("day").valueOf(),s[r].until=a.valueOf();break}}return s}function bse(e,t,r){var n,a,s=this.eras(),o,l,c;for(e=e.toUpperCase(),n=0,a=s.length;n<a;++n)if(o=s[n].name.toUpperCase(),l=s[n].abbr.toUpperCase(),c=s[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return s[n];break;case"NNNN":if(o===e)return s[n];break;case"NNNNN":if(c===e)return s[n];break}else if([o,l,c].indexOf(e)>=0)return s[n]}function yse(e,t){var r=e.since<=e.until?1:-1;return t===void 0?bt(e.since).year():bt(e.since).year()+(t-e.offset)*r}function wse(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function _se(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function Nse(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function kse(){var e,t,r,n,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,n=this.clone().startOf("day").valueOf(),a[e].since<=n&&n<=a[e].until||a[e].until<=n&&n<=a[e].since)return(this.year()-bt(a[e].since).year())*r+a[e].offset;return this.year()}function Sse(e){return cr(this,"_erasNameRegex")||T2.call(this),e?this._erasNameRegex:this._erasRegex}function jse(e){return cr(this,"_erasAbbrRegex")||T2.call(this),e?this._erasAbbrRegex:this._erasRegex}function Tse(e){return cr(this,"_erasNarrowRegex")||T2.call(this),e?this._erasNarrowRegex:this._erasRegex}function j2(e,t){return t.erasAbbrRegex(e)}function Ase(e,t){return t.erasNameRegex(e)}function Ese(e,t){return t.erasNarrowRegex(e)}function Cse(e,t){return t._eraYearOrdinalRegex||Sd}function T2(){var e=[],t=[],r=[],n=[],a,s,o,l,c,d=this.eras();for(a=0,s=d.length;a<s;++a)o=so(d[a].name),l=so(d[a].abbr),c=so(d[a].narrow),t.push(o),e.push(l),r.push(c),n.push(o),n.push(l),n.push(c);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pt(0,["gg",2],0,function(){return this.weekYear()%100});Pt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Bm(e,t){Pt(0,[e,e.length],0,t)}Bm("gggg","weekYear");Bm("ggggg","weekYear");Bm("GGGG","isoWeekYear");Bm("GGGGG","isoWeekYear");wt("G",Fm);wt("g",Fm);wt("GG",zr,ls);wt("gg",zr,ls);wt("GGGG",m2,h2);wt("gggg",m2,h2);wt("GGGGG",Lm,Om);wt("ggggg",Lm,Om);Tf(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=er(e)});Tf(["gg","GG"],function(e,t,r,n){t[n]=bt.parseTwoDigitYear(e)});function Dse(e){return YS.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Ose(e){return YS.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Pse(){return io(this.year(),1,4)}function Lse(){return io(this.isoWeekYear(),1,4)}function Fse(){var e=this.localeData()._week;return io(this.year(),e.dow,e.doy)}function $se(){var e=this.localeData()._week;return io(this.weekYear(),e.dow,e.doy)}function YS(e,t,r,n,a){var s;return e==null?Ju(this,n,a).year:(s=io(e,n,a),t>s&&(t=s),Rse.call(this,e,t,r,n,a))}function Rse(e,t,r,n,a){var s=SS(e,t,r,n,a),o=Xu(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Pt("Q",0,"Qo","quarter");wt("Q",mS);Sr("Q",function(e,t){t[Qi]=(er(e)-1)*3});function Mse(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pt("D",["DD",2],"Do","date");wt("D",zr,jd);wt("DD",zr,ls);wt("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Sr(["D","DD"],xi);Sr("Do",function(e,t){t[xi]=er(e.match(zr)[0])});var VS=Td("Date",!0);Pt("DDD",["DDDD",3],"DDDo","dayOfYear");wt("DDD",Pm);wt("DDDD",pS);Sr(["DDD","DDDD"],function(e,t,r){r._dayOfYear=er(e)});function Ise(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pt("m",["mm",2],0,"minute");wt("m",zr,p2);wt("mm",zr,ls);Sr(["m","mm"],Xs);var Bse=Td("Minutes",!1);Pt("s",["ss",2],0,"second");wt("s",zr,p2);wt("ss",zr,ls);Sr(["s","ss"],eo);var Use=Td("Seconds",!1);Pt("S",0,0,function(){return~~(this.millisecond()/100)});Pt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pt(0,["SSS",3],0,"millisecond");Pt(0,["SSSS",4],0,function(){return this.millisecond()*10});Pt(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});wt("S",Pm,mS);wt("SS",Pm,ls);wt("SSS",Pm,pS);var Ho,GS;for(Ho="SSSS";Ho.length<=9;Ho+="S")wt(Ho,Sd);function Wse(e,t){t[Fl]=er(("0."+e)*1e3)}for(Ho="S";Ho.length<=9;Ho+="S")Sr(Ho,Wse);GS=Td("Milliseconds",!1);Pt("z",0,0,"zoneAbbr");Pt("zz",0,0,"zoneName");function zse(){return this._isUTC?"UTC":""}function Hse(){return this._isUTC?"Coordinated Universal Time":""}var dt=Sf.prototype;dt.add=$ae;dt.calendar=zae;dt.clone=Hae;dt.diff=Jae;dt.endOf=ose;dt.format=tse;dt.from=rse;dt.fromNow=nse;dt.to=ase;dt.toNow=sse;dt.get=ene;dt.invalidAt=gse;dt.isAfter=qae;dt.isBefore=Yae;dt.isBetween=Vae;dt.isSame=Gae;dt.isSameOrAfter=Kae;dt.isSameOrBefore=Xae;dt.isValid=mse;dt.lang=US;dt.locale=BS;dt.localeData=WS;dt.max=mae;dt.min=hae;dt.parsingFlags=pse;dt.set=tne;dt.startOf=ise;dt.subtract=Rae;dt.toArray=use;dt.toObject=fse;dt.toDate=dse;dt.toISOString=Qae;dt.inspect=ese;typeof Symbol<"u"&&Symbol.for!=null&&(dt[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});dt.toJSON=hse;dt.toString=Zae;dt.unix=cse;dt.valueOf=lse;dt.creationData=xse;dt.eraName=wse;dt.eraNarrow=_se;dt.eraAbbr=Nse;dt.eraYear=kse;dt.year=vS;dt.isLeapYear=Qre;dt.weekYear=Dse;dt.isoWeekYear=Ose;dt.quarter=dt.quarters=Mse;dt.month=NS;dt.daysInMonth=dne;dt.week=dt.weeks=vne;dt.isoWeek=dt.isoWeeks=bne;dt.weeksInYear=Fse;dt.weeksInWeekYear=$se;dt.isoWeeksInYear=Pse;dt.isoWeeksInISOWeekYear=Lse;dt.date=VS;dt.day=dt.days=One;dt.weekday=Pne;dt.isoWeekday=Lne;dt.dayOfYear=Ise;dt.hour=dt.hours=Une;dt.minute=dt.minutes=Bse;dt.second=dt.seconds=Use;dt.millisecond=dt.milliseconds=GS;dt.utcOffset=Nae;dt.utc=Sae;dt.local=jae;dt.parseZone=Tae;dt.hasAlignedHourOffset=Aae;dt.isDST=Eae;dt.isLocal=Dae;dt.isUtcOffset=Oae;dt.isUtc=$S;dt.isUTC=$S;dt.zoneAbbr=zse;dt.zoneName=Hse;dt.dates=Fs("dates accessor is deprecated. Use date instead.",VS);dt.months=Fs("months accessor is deprecated. Use month instead",NS);dt.years=Fs("years accessor is deprecated. Use year instead",vS);dt.zone=Fs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kae);dt.isDSTShifted=Fs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Cae);function qse(e){return Wr(e*1e3)}function Yse(){return Wr.apply(null,arguments).parseZone()}function KS(e){return e}var dr=d2.prototype;dr.calendar=Dre;dr.longDateFormat=Fre;dr.invalidDate=Rre;dr.ordinal=Bre;dr.preparse=KS;dr.postformat=KS;dr.relativeTime=Wre;dr.pastFuture=zre;dr.set=Ere;dr.eras=vse;dr.erasParse=bse;dr.erasConvertYear=yse;dr.erasAbbrRegex=jse;dr.erasNameRegex=Sse;dr.erasNarrowRegex=Tse;dr.months=ine;dr.monthsShort=one;dr.monthsParse=cne;dr.monthsRegex=fne;dr.monthsShortRegex=une;dr.week=mne;dr.firstDayOfYear=xne;dr.firstDayOfWeek=gne;dr.weekdays=Tne;dr.weekdaysMin=Ene;dr.weekdaysShort=Ane;dr.weekdaysParse=Dne;dr.weekdaysRegex=Fne;dr.weekdaysShortRegex=$ne;dr.weekdaysMinRegex=Rne;dr.isPM=Ine;dr.meridiem=Wne;function U0(e,t,r,n){var a=go(),s=Oi().set(n,t);return a[r](s,e)}function XS(e,t,r){if(ho(e)&&(t=e,e=void 0),e=e||"",t!=null)return U0(e,t,r,"month");var n,a=[];for(n=0;n<12;n++)a[n]=U0(e,n,r,"month");return a}function A2(e,t,r,n){typeof e=="boolean"?(ho(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,ho(t)&&(r=t,t=void 0),t=t||"");var a=go(),s=e?a._week.dow:0,o,l=[];if(r!=null)return U0(t,(r+s)%7,n,"day");for(o=0;o<7;o++)l[o]=U0(t,(o+s)%7,n,"day");return l}function Vse(e,t){return XS(e,t,"months")}function Gse(e,t){return XS(e,t,"monthsShort")}function Kse(e,t,r){return A2(e,t,r,"weekdays")}function Xse(e,t,r){return A2(e,t,r,"weekdaysShort")}function Jse(e,t,r){return A2(e,t,r,"weekdaysMin")}Vo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=er(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});bt.lang=Fs("moment.lang is deprecated. Use moment.locale instead.",Vo);bt.langData=Fs("moment.langData is deprecated. Use moment.localeData instead.",go);var Gi=Math.abs;function Zse(){var e=this._data;return this._milliseconds=Gi(this._milliseconds),this._days=Gi(this._days),this._months=Gi(this._months),e.milliseconds=Gi(e.milliseconds),e.seconds=Gi(e.seconds),e.minutes=Gi(e.minutes),e.hours=Gi(e.hours),e.months=Gi(e.months),e.years=Gi(e.years),this}function JS(e,t,r,n){var a=si(t,r);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function Qse(e,t){return JS(this,e,t,1)}function eie(e,t){return JS(this,e,t,-1)}function $5(e){return e<0?Math.floor(e):Math.ceil(e)}function tie(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,a,s,o,l,c;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=$5(Ox(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,a=_s(e/1e3),n.seconds=a%60,s=_s(a/60),n.minutes=s%60,o=_s(s/60),n.hours=o%24,t+=_s(o/24),c=_s(ZS(t)),r+=c,t-=$5(Ox(c)),l=_s(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function ZS(e){return e*4800/146097}function Ox(e){return e*146097/4800}function rie(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=$s(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+ZS(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Ox(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function xo(e){return function(){return this.as(e)}}var QS=xo("ms"),nie=xo("s"),aie=xo("m"),sie=xo("h"),iie=xo("d"),oie=xo("w"),lie=xo("M"),cie=xo("Q"),die=xo("y"),uie=QS;function fie(){return si(this)}function hie(e){return e=$s(e),this.isValid()?this[e+"s"]():NaN}function uc(e){return function(){return this.isValid()?this._data[e]:NaN}}var mie=uc("milliseconds"),pie=uc("seconds"),gie=uc("minutes"),xie=uc("hours"),vie=uc("days"),bie=uc("months"),yie=uc("years");function wie(){return _s(this.days()/7)}var Xi=Math.round,Rc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function _ie(e,t,r,n,a){return a.relativeTime(t||1,!!r,e,n)}function Nie(e,t,r,n){var a=si(e).abs(),s=Xi(a.as("s")),o=Xi(a.as("m")),l=Xi(a.as("h")),c=Xi(a.as("d")),d=Xi(a.as("M")),u=Xi(a.as("w")),h=Xi(a.as("y")),m=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||l<=1&&["h"]||l<r.h&&["hh",l]||c<=1&&["d"]||c<r.d&&["dd",c];return r.w!=null&&(m=m||u<=1&&["w"]||u<r.w&&["ww",u]),m=m||d<=1&&["M"]||d<r.M&&["MM",d]||h<=1&&["y"]||["yy",h],m[2]=t,m[3]=+e>0,m[4]=n,_ie.apply(null,m)}function kie(e){return e===void 0?Xi:typeof e=="function"?(Xi=e,!0):!1}function Sie(e,t){return Rc[e]===void 0?!1:t===void 0?Rc[e]:(Rc[e]=t,e==="s"&&(Rc.ss=t-1),!0)}function jie(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Rc,a,s;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Rc,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),a=this.localeData(),s=Nie(this,!r,n,a),r&&(s=a.pastFuture(+this,s)),a.postformat(s)}var Ag=Math.abs;function Ec(e){return(e>0)-(e<0)||+e}function Um(){if(!this.isValid())return this.localeData().invalidDate();var e=Ag(this._milliseconds)/1e3,t=Ag(this._days),r=Ag(this._months),n,a,s,o,l=this.asSeconds(),c,d,u,h;return l?(n=_s(e/60),a=_s(n/60),e%=60,n%=60,s=_s(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",c=l<0?"-":"",d=Ec(this._months)!==Ec(l)?"-":"",u=Ec(this._days)!==Ec(l)?"-":"",h=Ec(this._milliseconds)!==Ec(l)?"-":"",c+"P"+(s?d+s+"Y":"")+(r?d+r+"M":"")+(t?u+t+"D":"")+(a||n||e?"T":"")+(a?h+a+"H":"")+(n?h+n+"M":"")+(e?h+o+"S":"")):"P0D"}var sr=Im.prototype;sr.isValid=bae;sr.abs=Zse;sr.add=Qse;sr.subtract=eie;sr.as=rie;sr.asMilliseconds=QS;sr.asSeconds=nie;sr.asMinutes=aie;sr.asHours=sie;sr.asDays=iie;sr.asWeeks=oie;sr.asMonths=lie;sr.asQuarters=cie;sr.asYears=die;sr.valueOf=uie;sr._bubble=tie;sr.clone=fie;sr.get=hie;sr.milliseconds=mie;sr.seconds=pie;sr.minutes=gie;sr.hours=xie;sr.days=vie;sr.weeks=wie;sr.months=bie;sr.years=yie;sr.humanize=jie;sr.toISOString=Um;sr.toString=Um;sr.toJSON=Um;sr.locale=BS;sr.localeData=WS;sr.toIsoString=Fs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Um);sr.lang=US;Pt("X",0,0,"unix");Pt("x",0,0,"valueOf");wt("x",Fm);wt("X",Vre);Sr("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});Sr("x",function(e,t,r){r._d=new Date(er(e))});//! moment.js
bt.version="2.30.1";Tre(Wr);bt.fn=dt;bt.min=pae;bt.max=gae;bt.now=xae;bt.utc=Oi;bt.unix=qse;bt.months=Vse;bt.isDate=kf;bt.locale=Vo;bt.invalid=Dm;bt.duration=si;bt.isMoment=ti;bt.weekdays=Kse;bt.parseZone=Yse;bt.localeData=go;bt.isDuration=Qh;bt.monthsShort=Gse;bt.weekdaysMin=Jse;bt.defineLocale=y2;bt.updateLocale=Yne;bt.locales=Vne;bt.weekdaysShort=Xse;bt.normalizeUnits=$s;bt.relativeTimeRounding=kie;bt.relativeTimeThreshold=Sie;bt.calendarFormat=Wae;bt.prototype=dt;bt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Tie=lS(bt),Aie=()=>{const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),[n,a]=J.useState([]),[s,o]=J.useState([]),[l,c]=J.useState(null),[d,u]=J.useState(!1),[h,m]=J.useState({status:"",priority:"",showMyTasksOnly:!1}),[f,x]=J.useState(!0);J.useEffect(()=>{g()},[]),J.useEffect(()=>{b()},[n,h]),el({onTaskCreated:()=>g(),onTaskUpdated:()=>g(),onTaskDeleted:()=>g()});const g=async()=>{try{const I=await it.get("/tasks");a(I.data.tasks)}catch(I){console.error("Error fetching tasks:",I)}},b=()=>{let I=[...n];h.status&&(I=I.filter(R=>R.status===h.status)),h.priority&&(I=I.filter(R=>R.priority===h.priority)),h.showMyTasksOnly&&(I=I.filter(R=>R.assigned_to?(Array.isArray(R.assigned_to)?R.assigned_to.map(B=>typeof B=="object"?B._id:B):[typeof R.assigned_to=="object"?R.assigned_to._id:R.assigned_to]).includes(e==null?void 0:e.id):!1));const O=I.filter(R=>R.due_date).map(R=>({id:R._id,title:R.title,start:new Date(R.due_date),end:new Date(R.due_date),resource:R,allDay:!0}));o(O)},y=I=>{const O={todo:"#6b7280",in_progress:"#136dec",review:"#eab308",done:"#22c55e",archived:"#ef4444"};return O[I]||O.todo},N=I=>{const O={low:"#10b981",medium:"#f59e0b",high:"#f97316",urgent:"#dc2626"};return O[I]||O.medium},S=I=>{const O=I.resource,R=y(O.status),E=N(O.priority);return{style:{backgroundColor:R,borderRadius:"0.125rem",opacity:.95,color:"white",border:`2px solid ${E}`,borderLeft:`4px solid ${E}`,display:"block",fontWeight:"600",fontSize:"0.75rem",padding:"2px 6px",boxShadow:"0 1px 3px rgba(0,0,0,0.3)"}}},_=I=>{c(I.resource),u(!0)},D=I=>{window.location.href=`/tasks?create=true&date=${I.start.toISOString()}`};return i.jsxs("div",{className:`flex h-screen w-full ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${t==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsxs("header",{className:`border-b ${t==="dark"?"border-[#282f39]":"border-gray-200"} ${t==="dark"?"bg-[#111418]":"bg-gray-50"} shrink-0`,children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:r,className:`lg:hidden ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsx("h2",{className:`${t==="dark"?"text-white":"text-gray-900"} text-xl font-bold leading-tight`,children:"Calendar View"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs mt-1`,children:"Visualize tasks by due date"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>x(!f),className:`flex items-center justify-center rounded h-9 px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} ${t==="dark"?"hover:border-[#5a6472]":"hover:border-gray-300"} transition-colors`,title:"Toggle Legend",children:i.jsx(J0,{size:20})}),i.jsxs("button",{onClick:()=>window.location.href="/tasks?create=true",className:"flex items-center justify-center rounded h-9 px-4 bg-[#136dec] text-white gap-2 text-sm font-bold hover:bg-blue-600 transition-colors shadow-sm shadow-blue-900/20",children:[i.jsx(Si,{size:20}),i.jsx("span",{children:"Create Task"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-4 px-6 pb-4 overflow-x-auto",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-fit",children:[i.jsx(zl,{size:16,className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"} font-medium`,children:"Filters:"})]}),i.jsxs("select",{value:h.status,onChange:I=>m({...h,status:I.target.value}),className:`h-9 px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Statuses"}),i.jsx("option",{value:"todo",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"review",children:"Review"}),i.jsx("option",{value:"done",children:"Done"})]}),i.jsxs("select",{value:h.priority,onChange:I=>m({...h,priority:I.target.value}),className:`h-9 px-3 ${t==="dark"?"bg-[#282f39]":"bg-white"} border ${t==="dark"?"border-[#3e454f]":"border-gray-200"} rounded text-sm ${t==="dark"?"text-white":"text-gray-900"} focus:ring-2 focus:ring-[#136dec] focus:border-transparent`,children:[i.jsx("option",{value:"",children:"All Priorities"}),i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]}),i.jsx("button",{onClick:()=>m({...h,showMyTasksOnly:!h.showMyTasksOnly}),className:`h-9 px-4 rounded text-sm font-medium transition-colors ${h.showMyTasksOnly?"bg-[#136dec] text-white border-[#136dec]":`${t==="dark"?"bg-[#282f39]":"bg-white"} ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"border-[#3e454f]":"border-gray-200"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"}`} border`,children:h.showMyTasksOnly?"My Tasks Only":"All Tasks"}),i.jsxs("div",{className:`ml-auto text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:[i.jsx("span",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:s.length})," task",s.length!==1?"s":""," with due dates"]})]})]}),i.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[f&&i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-4 mb-6`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:`text-sm font-bold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Legend"}),i.jsx("button",{onClick:()=>x(!1),className:`${t==="dark"?"text-[#6b7280]":"text-gray-600"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:18})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Status (Background)"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 bg-[#6b7280] rounded"}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"To Do"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 bg-[#136dec] rounded"}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"In Progress"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 bg-[#eab308] rounded"}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Review"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-4 h-4 bg-[#22c55e] rounded"}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Done"})]})]})]}),i.jsxs("div",{children:[i.jsx("p",{className:`text-[10px] font-bold ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} uppercase tracking-wider mb-2`,children:"Priority (Border)"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} rounded border-2 border-[#10b981]`}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Low"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} rounded border-2 border-[#f59e0b]`}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Medium"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} rounded border-2 border-[#f97316]`}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"High"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-4 h-4 ${t==="dark"?"bg-[#282f39]":"bg-gray-100"} rounded border-2 border-[#dc2626]`}),i.jsx("span",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Urgent"})]})]})]})]})]}),i.jsx("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded border ${t==="dark"?"border-[#282f39]":"border-gray-200"} p-4 calendar-container`,children:i.jsx(oS,{localizer:Tie,events:s,startAccessor:"start",endAccessor:"end",style:{height:700,minHeight:500},eventPropGetter:S,onSelectEvent:_,onSelectSlot:D,selectable:!0,views:["month","week","day","agenda"],defaultView:"month",popup:!0,tooltipAccessor:I=>`${I.title} - ${I.resource.priority}`})})]})]}),d&&l&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border ${t==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:l.title}),i.jsx("button",{onClick:()=>u(!1),className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} ${t==="dark"?"hover:text-white":"hover:text-gray-900"}`,children:i.jsx(kr,{size:24})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx("p",{className:`${t==="dark"?"text-[#d1d5db]":"text-gray-700"}`,children:l.description||"No description"})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("span",{className:`inline-block px-3 py-1 rounded text-xs font-semibold uppercase ${l.status==="todo"?"bg-slate-500/20 text-slate-300":l.status==="in_progress"?"bg-blue-500/20 text-blue-400":l.status==="review"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:l.status.replace("_"," ")}),i.jsx("span",{className:`inline-block px-3 py-1 rounded text-xs font-semibold uppercase ${l.priority==="low"?"bg-green-500/20 text-green-400":l.priority==="medium"?"bg-yellow-500/20 text-yellow-400":l.priority==="high"?"bg-orange-500/20 text-orange-400":"bg-red-500/20 text-red-400"}`,children:l.priority})]}),i.jsxs("div",{className:`space-y-3 border-t ${t==="dark"?"border-[#282f39]":"border-gray-200"} pt-4`,children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-1`,children:i.jsx("span",{className:"font-medium",children:"Due Date:"})}),i.jsxs("p",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"} flex items-center gap-2`,children:[i.jsx(Gn,{size:14}),new Date(l.due_date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]}),l.created_by&&i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-1`,children:i.jsx("span",{className:"font-medium",children:"Created by:"})}),i.jsx("p",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:l.created_by.full_name||"Unknown"})]})]}),l.assigned_to&&l.assigned_to.length>0&&i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-2`,children:i.jsx("span",{className:"font-medium",children:"Assigned to:"})}),i.jsx("div",{className:"flex flex-wrap gap-2",children:l.assigned_to.map(I=>i.jsx("span",{className:"inline-block bg-blue-500/10 text-blue-400 text-xs px-2 py-1 rounded border border-blue-500/20",children:I.full_name},I._id))})]}),l.team_id&&i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mb-1`,children:i.jsx("span",{className:"font-medium",children:"Team:"})}),i.jsx("p",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:l.team_id.name})]})]}),i.jsx("button",{onClick:()=>window.location.href="/tasks",className:"w-full px-6 py-2 bg-[#136dec] text-white rounded hover:bg-blue-600 transition-colors font-semibold",children:"View in Tasks"})]})]})}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .calendar-container .rbc-calendar {
          font-family: 'Inter', sans-serif;
          color: ${t==="dark"?"#fff":"#111827"};
        }
        .calendar-container .rbc-header {
          padding: 12px;
          font-weight: 600;
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          background: ${t==="dark"?"#1c2027":"#f9fafb"};
          color: ${t==="dark"?"#9da8b9":"#6b7280"};
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-today {
          background-color: ${t==="dark"?"#136dec20":"#136dec10"};
        }
        .calendar-container .rbc-off-range-bg {
          background: ${t==="dark"?"#0e1217":"#f9fafb"};
        }
        .calendar-container .rbc-date-cell {
          color: ${t==="dark"?"#d1d5db":"#374151"};
          padding: 4px;
        }
        .calendar-container .rbc-off-range {
          color: ${t==="dark"?"#4b5563":"#9ca3af"};
        }
        .calendar-container .rbc-month-view {
          background: ${t==="dark"?"#1c2027":"#ffffff"};
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-day-bg {
          background: ${t==="dark"?"#1c2027":"#ffffff"};
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-event {
          transition: all 0.2s ease;
        }
        .calendar-container .rbc-event:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        .calendar-container .rbc-toolbar {
          color: ${t==="dark"?"#fff":"#111827"};
          margin-bottom: 20px;
          padding: 12px;
          background: ${t==="dark"?"#111418":"#f9fafb"};
          border-radius: 0.125rem;
        }
        .calendar-container .rbc-toolbar button {
          color: ${t==="dark"?"#9da8b9":"#6b7280"};
          background: ${t==="dark"?"#282f39":"#ffffff"};
          border: 1px solid ${t==="dark"?"#3e454f":"#d1d5db"};
          border-radius: 0.125rem;
          padding: 6px 12px;
          font-size: 0.875rem;
          font-weight: 500;
        }
        .calendar-container .rbc-toolbar button:hover {
          background: ${t==="dark"?"#3a4454":"#f3f4f6"};
          color: ${t==="dark"?"#fff":"#111827"};
        }
        .calendar-container .rbc-toolbar button.rbc-active {
          background: #136dec;
          color: white;
          border-color: #136dec;
        }
        .calendar-container .rbc-agenda-view {
          background: ${t==="dark"?"#1c2027":"#ffffff"};
        }
        .calendar-container .rbc-agenda-view table {
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-agenda-table tbody > tr > td {
          color: ${t==="dark"?"#d1d5db":"#374151"};
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-agenda-date-cell,
        .calendar-container .rbc-agenda-time-cell {
          color: ${t==="dark"?"#9da8b9":"#6b7280"};
        }
        .calendar-container .rbc-time-view {
          background: ${t==="dark"?"#1c2027":"#ffffff"};
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-time-header-content {
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-time-content {
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-time-slot {
          border-color: ${t==="dark"?"#282f39":"#e5e7eb"};
        }
        .calendar-container .rbc-current-time-indicator {
          background-color: #136dec;
        }
      `}})]})},Eie=()=>{const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),n=Cs(),a=tl(),[s,o]=J.useState([]),[l,c]=J.useState(null),[d,u]=J.useState(!0),[h,m]=J.useState(null),[f,x]=J.useState(1),[g,b]=J.useState(1),[y,N]=J.useState(0),[S,_]=J.useState({event_type:"",target_type:"",search:"",start_date:"",end_date:"",limit:50}),[D,I]=J.useState(!1),[O,R]=J.useState([]),[E,B]=J.useState(!1);J.useEffect(()=>{if(e&&e.role!=="admin"){n("/dashboard");return}e&&(C(),M(),U())},[f,S,e]);const C=async()=>{var w,A,T,L,H;try{u(!0),m(null);const X=new URLSearchParams({page:f.toString(),...S}),re=await it.get(`/changelog?${X}`);o(re.data.logs||[]),b(re.data.totalPages||1),N(re.data.total||0)}catch(X){console.error("Error fetching change logs:",X),((w=X.response)==null?void 0:w.status)===401?m("Authentication required. Please log in again."):((A=X.response)==null?void 0:A.status)===403?(m("Access denied. Admin privileges required."),setTimeout(()=>n("/dashboard"),2e3)):((T=X.response)==null?void 0:T.status)===404?m("âš ï¸ Changelog routes not found. Please restart the backend server! See RESTART_BACKEND.md for instructions."):(H=(L=X.response)==null?void 0:L.data)!=null&&H.message?m(`Error: ${X.response.data.message}`):m(`Failed to fetch change logs: ${X.message||"Unknown error"}`)}finally{u(!1)}},M=async()=>{try{const w=new URLSearchParams;S.start_date&&w.append("start_date",S.start_date),S.end_date&&w.append("end_date",S.end_date);const A=await it.get(`/changelog/stats?${w}`);c(A.data)}catch(w){console.error("Error fetching stats:",w),c({total:0,by_event_type:[],top_users:[]})}},U=async()=>{try{const w=await it.get("/changelog/event-types");R(w.data||[])}catch(w){console.error("Error fetching event types:",w),R(["user_login","user_logout","user_created","user_updated","user_deleted","task_created","task_updated","task_deleted","team_created","team_updated","team_deleted"])}},F=(w,A)=>{_(T=>({...T,[w]:A})),x(1)},ne=async()=>{try{B(!0);const w=new URLSearchParams(S),A=await it.get(`/changelog/export?${w}`,{responseType:"blob"}),T=window.URL.createObjectURL(new Blob([A.data])),L=document.createElement("a");L.href=T,L.setAttribute("download",`changelog-${Date.now()}.csv`),document.body.appendChild(L),L.click(),L.remove()}catch(w){console.error("Error exporting logs:",w),alert("Failed to export logs")}finally{B(!1)}},V=()=>{a.show({title:"Clear Old Logs",message:"Are you sure you want to delete all audit logs older than 90 days? This action cannot be undone and may affect historical reporting.",confirmText:"Delete Old Logs",cancelText:"Cancel",variant:"warning",onConfirm:async()=>{try{const w=await it.delete("/changelog/clear?days=90");alert(w.data.message),C(),M()}catch(w){console.error("Error clearing logs:",w),alert("Failed to clear logs")}}})},ee=w=>w.includes("login")||w.includes("logout")?"ðŸ”":w.includes("task")?"âœ…":w.includes("user")?"ðŸ‘¤":w.includes("team")?"ðŸ‘¥":w.includes("report")?"ðŸ“Š":w.includes("automation")?"ðŸ¤–":w.includes("notification")?"ðŸ””":w.includes("comment")?"ðŸ’¬":w.includes("bulk")?"ðŸ“¦":"âš™ï¸",me=w=>w.includes("login")?"bg-blue-500/10 text-blue-400 border-2 border-blue-500/30":w.includes("logout")?"bg-gray-500/10 text-gray-400 border-2 border-gray-500/30":w.includes("created")?"bg-green-500/10 text-green-400 border-2 border-green-500/30":w.includes("updated")?"bg-yellow-500/10 text-yellow-400 border-2 border-yellow-500/30":w.includes("deleted")?"bg-red-500/10 text-red-400 border-2 border-red-500/30":w.includes("automation")?"bg-purple-500/10 text-purple-400 border-2 border-purple-500/30":w.includes("report")?"bg-indigo-500/10 text-indigo-400 border-2 border-indigo-500/30":w.includes("task")?"bg-teal-500/10 text-teal-400 border-2 border-teal-500/30":w.includes("team")?"bg-orange-500/10 text-orange-400 border-2 border-orange-500/30":w.includes("notification")?"bg-pink-500/10 text-pink-400 border-2 border-pink-500/30":w.includes("comment")?"bg-cyan-500/10 text-cyan-400 border-2 border-cyan-500/30":"bg-gray-500/10 text-gray-400 border-2 border-gray-500/30",ye=w=>{switch(w==null?void 0:w.toLowerCase()){case"task":return"bg-teal-500/10 text-teal-400 border border-teal-500/30";case"user":return"bg-blue-500/10 text-blue-400 border border-blue-500/30";case"team":return"bg-orange-500/10 text-orange-400 border border-orange-500/30";case"report":return"bg-indigo-500/10 text-indigo-400 border border-indigo-500/30";case"comment":return"bg-cyan-500/10 text-cyan-400 border border-cyan-500/30";case"notification":return"bg-pink-500/10 text-pink-400 border border-pink-500/30";case"automation":return"bg-purple-500/10 text-purple-400 border border-purple-500/30";default:return"bg-gray-500/10 text-gray-400 border border-gray-500/30"}},Oe=w=>{switch(w==null?void 0:w.toLowerCase()){case"task":return"âœ…";case"user":return"ðŸ‘¤";case"team":return"ðŸ‘¥";case"report":return"ðŸ“Š";case"comment":return"ðŸ’¬";case"notification":return"ðŸ””";case"automation":return"âš™ï¸";default:return"ðŸ“Œ"}},xe=w=>new Date(w).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return i.jsxs("div",{className:`flex h-screen ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsx("div",{className:`flex-1 overflow-auto ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[h&&i.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-[0.125rem] flex items-start space-x-3",children:[i.jsx(Ss,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-sm font-semibold text-red-300 mb-1",children:"Error"}),i.jsx("p",{className:"text-sm text-red-400",children:h})]}),i.jsx("button",{onClick:()=>m(null),className:"text-red-400 hover:text-red-300",children:"Ã—"})]}),i.jsxs("div",{className:"mb-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:r,className:`lg:hidden ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsx(Ap,{className:"w-8 h-8 text-[#136dec]"}),i.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Change Log"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("button",{onClick:C,className:`flex items-center space-x-2 px-4 py-2 rounded-[0.125rem] transition-colors ${t==="dark"?"bg-[#1c2027] hover:bg-[#282f39] text-white":"bg-white hover:bg-gray-100 text-gray-900"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx(Ih,{className:"w-4 h-4"}),i.jsx("span",{children:"Refresh"})]}),i.jsxs("button",{onClick:ne,disabled:E,className:"flex items-center space-x-2 px-4 py-2 rounded-[0.125rem] bg-[#136dec] hover:bg-[#136dec]/90 text-white transition-colors disabled:opacity-50",children:[i.jsx(Yx,{className:"w-4 h-4"}),i.jsx("span",{children:E?"Exporting...":"Export CSV"})]}),i.jsxs("button",{onClick:()=>I(!D),className:`flex items-center space-x-2 px-4 py-2 rounded-[0.125rem] transition-colors ${t==="dark"?"bg-[#1c2027] hover:bg-[#282f39] text-white":"bg-white hover:bg-gray-100 text-gray-900"} border ${t==="dark"?"border-[#282f39]":"border-gray-200"}`,children:[i.jsx(zl,{className:"w-4 h-4"}),i.jsx("span",{children:"Filters"})]})]})]}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Track all system events, user activities, and changes across the platform"})]}),l&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[i.jsx("div",{className:`rounded-[0.125rem] p-6 border shadow-sm ${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm mb-1 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Total Events"}),i.jsx("p",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:l.total.toLocaleString()})]}),i.jsx(Qc,{className:"w-10 h-10 text-[#136dec] opacity-50"})]})}),i.jsx("div",{className:`rounded-[0.125rem] p-6 border shadow-sm ${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm mb-1 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Event Types"}),i.jsx("p",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:l.by_event_type.length})]}),i.jsx(Uv,{className:"w-10 h-10 text-[#136dec] opacity-50"})]})}),i.jsx("div",{className:`rounded-[0.125rem] p-6 border shadow-sm ${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm mb-1 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Active Users"}),i.jsx("p",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:l.top_users.length})]}),i.jsx(ji,{className:"w-10 h-10 text-[#136dec] opacity-50"})]})})]}),D&&i.jsxs("div",{className:`rounded-[0.125rem] p-6 mb-6 border-2 shadow-lg ${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:`text-lg font-semibold flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(zl,{className:"w-5 h-5 text-blue-500"}),i.jsx("span",{children:"Advanced Filters"})]}),(S.event_type||S.target_type||S.search||S.start_date||S.end_date)&&i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-400 rounded-full text-sm font-medium",children:"Filters Active"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(Ap,{className:"w-4 h-4 text-purple-500"}),i.jsx("span",{children:"Event Type"})]}),i.jsxs("select",{value:S.event_type,onChange:w=>F("event_type",w.target.value),className:`w-full px-4 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-purple-500 focus:outline-none ${S.event_type?"border-purple-500/30 bg-purple-500/10":t==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx("option",{value:"",children:"ðŸŒ All Events"}),O.map(w=>{const A=w.includes("created")?"âœ¨":w.includes("updated")?"ðŸ“":w.includes("deleted")?"ðŸ—‘ï¸":w.includes("login")?"ðŸ”“":w.includes("logout")?"ðŸ”’":"ðŸ“Œ";return i.jsxs("option",{value:w,children:[A," ",w.replace(/_/g," ").toUpperCase()]},w)})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(Uv,{className:"w-4 h-4 text-orange-500"}),i.jsx("span",{children:"Target Type"})]}),i.jsxs("select",{value:S.target_type,onChange:w=>F("target_type",w.target.value),className:`w-full px-4 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-orange-500 focus:outline-none ${S.target_type?"border-orange-500/30 bg-orange-500/10":t==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx("option",{value:"",children:"ðŸŽ¯ All Types"}),i.jsx("option",{value:"task",children:"âœ… Task"}),i.jsx("option",{value:"user",children:"ðŸ‘¤ User"}),i.jsx("option",{value:"team",children:"ðŸ‘¥ Team"}),i.jsx("option",{value:"report",children:"ðŸ“Š Report"}),i.jsx("option",{value:"comment",children:"ðŸ’¬ Comment"}),i.jsx("option",{value:"notification",children:"ðŸ”” Notification"}),i.jsx("option",{value:"automation",children:"âš™ï¸ Automation"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(oo,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{children:"Search"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(oo,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 ${S.search?"text-blue-500":t==="dark"?"text-[#9da8b9]":"text-gray-600"}`}),i.jsx("input",{type:"text",value:S.search,onChange:w=>F("search",w.target.value),placeholder:"Search logs...",className:`w-full pl-10 pr-3 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-blue-500 focus:outline-none ${S.search?"border-blue-500/30 bg-blue-500/10":t==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} ${t==="dark"?"text-white":"text-gray-900"}`})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(Gn,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{children:"Start Date"})]}),i.jsx("input",{type:"date",value:S.start_date,onChange:w=>F("start_date",w.target.value),className:`w-full px-4 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-green-500 focus:outline-none ${S.start_date?"border-green-500/30 bg-green-500/10":t==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} ${t==="dark"?"text-white":"text-gray-900"}`})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(Gn,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{children:"End Date"})]}),i.jsx("input",{type:"date",value:S.end_date,onChange:w=>F("end_date",w.target.value),className:`w-full px-4 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-red-500 focus:outline-none ${S.end_date?"border-red-500/30 bg-red-500/10":t==="dark"?"border-[#282f39] bg-[#1c2027]":"border-gray-200 bg-white"} ${t==="dark"?"text-white":"text-gray-900"}`})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`block text-sm font-semibold mb-2 flex items-center space-x-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[i.jsx(Qc,{className:"w-4 h-4 text-indigo-500"}),i.jsx("span",{children:"Items per page"})]}),i.jsxs("select",{value:S.limit,onChange:w=>F("limit",w.target.value),className:`w-full px-4 py-2.5 border-2 rounded-[0.125rem] font-medium transition-all focus:ring-2 focus:ring-indigo-500 focus:outline-none ${t==="dark"?"border-[#282f39] bg-[#1c2027] text-white":"border-gray-200 bg-white text-gray-900"}`,children:[i.jsx("option",{value:"25",children:"ðŸ“„ 25 items"}),i.jsx("option",{value:"50",children:"ðŸ“‹ 50 items"}),i.jsx("option",{value:"100",children:"ðŸ“š 100 items"}),i.jsx("option",{value:"200",children:"ðŸ“¦ 200 items"})]})]})]}),i.jsxs("div",{className:"mt-6 flex justify-between items-center pt-4 border-t border-[#282f39]",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[S.event_type&&i.jsxs("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-400 rounded-full text-xs font-medium",children:["Event: ",S.event_type.replace(/_/g," ")]}),S.target_type&&i.jsxs("span",{className:"px-3 py-1 bg-orange-500/10 text-orange-400 rounded-full text-xs font-medium",children:["Type: ",S.target_type]}),S.search&&i.jsxs("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-400 rounded-full text-xs font-medium",children:['Search: "',S.search,'"']}),(S.start_date||S.end_date)&&i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-400 rounded-full text-xs font-medium",children:"ðŸ“… Date Range"})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsxs("button",{onClick:()=>{_({event_type:"",target_type:"",search:"",start_date:"",end_date:"",limit:50}),x(1)},className:`flex items-center space-x-2 px-5 py-2.5 rounded-[0.125rem] border-2 ${t==="dark"?"border-[#282f39] bg-[#1c2027] hover:bg-[#282f39] text-white":"border-gray-200 bg-white hover:bg-gray-100 text-gray-900"} font-semibold transition-all`,children:[i.jsx(Ih,{className:"w-4 h-4"}),i.jsx("span",{children:"Clear Filters"})]}),i.jsxs("button",{onClick:V,className:"flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-[0.125rem] font-semibold transition-all hover:opacity-90",children:[i.jsx(ua,{className:"w-4 h-4"}),i.jsx("span",{children:"Clear Old Logs (90+ days)"})]})]})]})]}),i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027]":"bg-white"} rounded-[0.125rem] border ${t==="dark"?"border-[#282f39]":"border-gray-200"} shadow-sm overflow-hidden`,children:[i.jsx("div",{className:"overflow-x-auto",children:d?i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(Ih,{className:"w-8 h-8 text-[#136dec] animate-spin mx-auto mb-4"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Loading change logs..."})]}):s.length===0?i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(Ap,{className:`w-12 h-12 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} mx-auto mb-4`}),i.jsx("p",{className:`text-lg ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"No logs found"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:"Try adjusting your filters"})]}):i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:`border-b ${t==="dark"?"bg-[#111418] border-[#282f39]":"bg-gray-50 border-gray-200"}`,children:i.jsxs("tr",{children:[i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider ${t==="dark"?"text-white":"text-gray-900"}`,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Zc,{className:"w-4 h-4"}),i.jsx("span",{children:"Timestamp"})]})}),i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Event Type"}),i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ji,{className:"w-4 h-4"}),i.jsx("span",{children:"User"})]})}),i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Description"}),i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"Target"}),i.jsx("th",{className:`px-6 py-4 text-left text-xs font-semibold ${t==="dark"?"text-white":"text-gray-900"} uppercase tracking-wider`,children:"IP Address"})]})}),i.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-[#282f39]":"divide-gray-200"}`,children:s.map(w=>i.jsxs("tr",{className:`${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-50"} transition-colors`,children:[i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:xe(w.created_at)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:`inline-flex items-center space-x-2 px-3 py-1.5 rounded-full text-xs font-bold ${me(w.event_type)} shadow-sm`,children:[i.jsx("span",{className:"text-base",children:ee(w.event_type)}),i.jsx("span",{className:"uppercase tracking-wide",children:w.event_type.replace(/_/g," ")})]})}),i.jsx("td",{className:`px-6 py-4 text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:w.user_name||"System"}),i.jsx("div",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:w.user_email||"N/A"}),w.user_role&&i.jsxs("span",{className:`inline-block mt-1.5 px-2.5 py-0.5 text-xs font-semibold rounded-full ${w.user_role==="admin"?"bg-red-500/10 text-red-400 border border-red-500/30":w.user_role==="manager"?"bg-blue-500/10 text-blue-400 border border-blue-500/30":"bg-green-500/10 text-green-400 border border-green-500/30"}`,children:[w.user_role==="admin"?"ðŸ‘‘":w.user_role==="manager"?"â­":"ðŸ‘¤"," ",w.user_role.toUpperCase()]})]})}),i.jsxs("td",{className:`px-6 py-4 text-sm ${t==="dark"?"text-white":"text-gray-900"} max-w-md`,children:[w.description,w.changes&&Object.keys(w.changes).length>0&&i.jsx("div",{className:`mt-2 p-2 rounded text-xs font-mono border ${t==="dark"?"bg-[#111418] border-[#282f39]":"bg-gray-100 border-gray-200"}`,children:Object.entries(w.changes).map(([A,T])=>i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("span",{className:`font-semibold capitalize ${t==="dark"?"text-[#9da8b9]":"text-gray-500"}`,children:[A.replace("_"," "),":"]}),i.jsx("span",{className:t==="dark"?"text-red-400":"text-red-600",children:T.old!==void 0?String(T.old):"null"}),i.jsx("span",{className:t==="dark"?"text-[#9da8b9]":"text-gray-400",children:"â†’"}),i.jsx("span",{className:t==="dark"?"text-green-400":"text-green-600",children:T.new!==void 0?String(T.new):"null"})]},A))})]}),i.jsx("td",{className:`px-6 py-4 text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:w.target_type?i.jsxs("div",{className:"space-y-1",children:[i.jsxs("span",{className:`inline-flex items-center space-x-1.5 px-2.5 py-1 rounded-[0.125rem] text-xs font-semibold ${ye(w.target_type)}`,children:[i.jsx("span",{children:Oe(w.target_type)}),i.jsx("span",{className:"uppercase",children:w.target_type})]}),i.jsx("div",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} font-mono`,children:w.target_name||w.target_id||"N/A"})]}):i.jsx("span",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs`,children:"N/A"})}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"} font-mono`,children:w.user_ip||"N/A"})]},w._id))})]})}),g>1&&i.jsxs("div",{className:`px-6 py-4 border-t ${t==="dark"?"border-[#282f39]":"border-gray-200"} flex items-center justify-between`,children:[i.jsxs("div",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:["Showing page ",f," of ",g," (",y.toLocaleString()," total events)"]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>x(w=>Math.max(1,w-1)),disabled:f===1,className:`p-2 rounded-[0.125rem] ${t==="dark"?"bg-[#1c2027] hover:bg-[#282f39] text-white":"bg-white hover:bg-gray-100 text-gray-900 border border-gray-200"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:i.jsx(Hx,{className:"w-5 h-5"})}),i.jsxs("span",{className:`px-4 py-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:[f," / ",g]}),i.jsx("button",{onClick:()=>x(w=>Math.min(g,w+1)),disabled:f===g,className:`p-2 rounded-[0.125rem] ${t==="dark"?"bg-[#1c2027] hover:bg-[#282f39] text-white":"bg-white hover:bg-gray-100 text-gray-900 border border-gray-200"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:i.jsx(qx,{className:"w-5 h-5"})})]})]})]})]})}),i.jsx(rl,{isOpen:a.isOpen,onClose:a.onClose,onConfirm:a.onConfirm,title:a.title,message:a.message,confirmText:a.confirmText,cancelText:a.cancelText,variant:a.variant,isLoading:a.isLoading})]})},Cie=()=>{const{user:e}=pn(),{theme:t}=Lr(),{toggleMobileSidebar:r}=Mn(),[n,a]=J.useState([]),[s,o]=J.useState(!0),[l,c]=J.useState("all"),[d,u]=J.useState(0);J.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0);const _=await it.get("/notifications");console.log("Notifications received:",_.data.notifications),a(_.data.notifications||[]),u(_.data.unreadCount||0),o(!1)}catch(_){console.error("Error fetching notifications:",_),o(!1)}},m=async _=>{try{await it.patch("/notifications/mark-read",{notificationIds:_}),await h()}catch(D){console.error("Error marking notifications as read:",D)}},f=async()=>{try{await it.patch("/notifications/mark-read",{}),await h()}catch(_){console.error("Error marking all as read:",_)}},x=async _=>{try{await m([_])}catch(D){console.error("Error deleting notification:",D)}},g=()=>{switch(l){case"unread":return n.filter(_=>!_.read_at);case"read":return n.filter(_=>_.read_at);default:return n}},b=_=>{if(_.message)return _.message;const D=_.payload||{};switch(_.type){case"task_assigned":return`You were assigned to task: "${D.task_title||"Untitled Task"}"`;case"task_updated":return`Task "${D.task_title||"Untitled Task"}" was updated`;case"task_completed":return`Task "${D.task_title||"Untitled Task"}" was completed`;case"task_overdue":return`Task "${D.task_title||"Untitled Task"}" is overdue`;case"status_changed":return`Task status changed from ${D.old_status||"unknown"} to ${D.new_status||"unknown"}`;case"comment_added":return`New comment on task "${D.task_title||"Untitled Task"}"`;default:return"You have a new notification"}},y=_=>{switch(_){case"task_assigned":return i.jsx(ji,{className:"w-5 h-5 text-blue-500"});case"task_updated":return i.jsx(Ss,{className:"w-5 h-5 text-yellow-500"});case"task_completed":return i.jsx($v,{className:"w-5 h-5 text-green-500"});case"task_overdue":return i.jsx(Gn,{className:"w-5 h-5 text-red-500"});default:return i.jsx(Jc,{className:"w-5 h-5 text-gray-500"})}},N=_=>{const D=new Date(_),O=new Date-D,R=Math.floor(O/(1e3*60)),E=Math.floor(O/(1e3*60*60)),B=Math.floor(O/(1e3*60*60*24));return R<1?"Just now":R<60?`${R}m ago`:E<24?`${E}h ago`:B<7?`${B}d ago`:D.toLocaleDateString("en-US",{month:"short",day:"numeric"})},S=g();return s?i.jsxs("div",{className:`flex h-screen w-full ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsx("div",{className:"flex-1 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#136dec] mx-auto mb-4"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} font-medium`,children:"Loading notifications..."})]})})]}):i.jsxs("div",{className:`flex h-screen w-full ${t==="dark"?"bg-[#111418]":"bg-gray-50"}`,children:[i.jsx(Cn,{}),i.jsxs("main",{className:`flex-1 flex flex-col h-full w-full min-w-0 ${t==="dark"?"bg-[#111418]":"bg-gray-50"} overflow-hidden`,children:[i.jsxs("header",{className:`border-b ${t==="dark"?"border-[#282f39] bg-[#111418]":"border-gray-200 bg-white"} shrink-0`,children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:r,className:`lg:hidden ${t==="dark"?"text-[#9da8b9] hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,"aria-label":"Toggle menu",children:i.jsx(Os,{size:24})}),i.jsxs("div",{children:[i.jsx("h2",{className:`${t==="dark"?"text-white":"text-gray-900"} text-xl font-bold leading-tight`,children:"Notifications"}),i.jsx("p",{className:`${t==="dark"?"text-[#9da8b9]":"text-gray-600"} text-xs mt-1`,children:d>0?`${d} unread notification${d!==1?"s":""}`:"All caught up!"})]})]}),d>0&&i.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-[#136dec] hover:bg-[#1258c4] text-white text-sm font-medium px-4 py-2 rounded transition-colors",children:[i.jsx($v,{size:16}),"Mark All Read"]})]}),i.jsxs("div",{className:"flex items-center gap-1 px-6 pb-3",children:[i.jsxs("button",{onClick:()=>c("all"),className:`px-4 py-2 text-sm font-medium rounded transition-colors ${l==="all"?"bg-[#136dec] text-white":`${t==="dark"?"text-[#9da8b9] hover:text-white hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`}`,children:["All (",n.length,")"]}),i.jsxs("button",{onClick:()=>c("unread"),className:`px-4 py-2 text-sm font-medium rounded transition-colors ${l==="unread"?"bg-[#136dec] text-white":`${t==="dark"?"text-[#9da8b9] hover:text-white hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`}`,children:["Unread (",d,")"]}),i.jsxs("button",{onClick:()=>c("read"),className:`px-4 py-2 text-sm font-medium rounded transition-colors ${l==="read"?"bg-[#136dec] text-white":`${t==="dark"?"text-[#9da8b9] hover:text-white hover:bg-[#1c2027]":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`}`,children:["Read (",n.length-d,")"]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:S.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[i.jsx(Jc,{className:`w-16 h-16 ${t==="dark"?"text-[#282f39]":"text-gray-300"} mb-4`}),i.jsx("h3",{className:`text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:l==="unread"?"No unread notifications":l==="read"?"No read notifications":"No notifications yet"}),i.jsx("p",{className:`text-sm ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:l==="all"?"You'll see notifications here when something happens":"Try changing the filter"})]}):i.jsx("div",{className:"max-w-4xl mx-auto space-y-2",children:S.map(_=>i.jsxs("div",{className:`${t==="dark"?"bg-[#1c2027] border-[#282f39]":"bg-white border-gray-200"} border rounded-lg p-4 transition-all ${_.read_at?"":"border-l-4 border-l-[#136dec]"} hover:shadow-md`,children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:`flex-shrink-0 p-2 rounded-full ${t==="dark"?"bg-[#282f39]":"bg-gray-100"}`,children:y(_.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"} font-medium mb-1`,children:b(_)}),i.jsx("p",{className:`text-xs ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`,children:N(_.created_at)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!_.read_at&&i.jsx("button",{onClick:()=>m([_._id]),className:`p-2 rounded transition-colors ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"}`,title:"Mark as read",children:i.jsx(E4,{className:`w-4 h-4 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`})}),i.jsx("button",{onClick:()=>x(_._id),className:`p-2 rounded transition-colors ${t==="dark"?"hover:bg-[#282f39]":"hover:bg-gray-100"}`,title:"Delete",children:i.jsx(ua,{className:`w-4 h-4 ${t==="dark"?"text-[#9da8b9]":"text-gray-600"}`})})]})]}),_.task_id&&i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:i.jsx("a",{href:"/tasks",className:"text-xs text-[#136dec] hover:text-blue-400 font-medium",children:"View Task â†’"})})]},_._id))})})]})]})},Die=()=>{const[e,t]=J.useState(0),r=Cs();return J.useEffect(()=>{const n=()=>t(window.scrollY);return window.addEventListener("scroll",n,{passive:!0}),()=>window.removeEventListener("scroll",n)},[]),i.jsxs("div",{className:"relative bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-white overflow-hidden",children:[i.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${e>50?"bg-slate-950/80 backdrop-blur-xl border-b border-white/10":"bg-transparent"}`,children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("img",{src:"/logo.png",alt:"TaskFlow",className:"w-8 h-8"}),i.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"TaskFlow"})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("button",{onClick:()=>r("/login"),className:"px-4 py-2 text-sm font-medium text-white/90 hover:text-white transition-colors",children:"Sign In"}),i.jsx("button",{onClick:()=>r("/register"),className:"px-4 py-2 text-sm font-medium bg-gradient-to-r from-blue-600 to-cyan-600 rounded-lg hover:from-blue-500 hover:to-cyan-500 transition-all shadow-lg shadow-blue-500/25",children:"Get Started"})]})]})})}),i.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden pt-16",children:[i.jsxs("div",{className:"absolute inset-0",children:[i.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#0f172a_1px,transparent_1px),linear-gradient(to_bottom,#0f172a_1px,transparent_1px)] bg-[size:4rem_4rem] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_50%,#000_70%,transparent_110%)] opacity-20"}),i.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/20 rounded-full blur-[120px] animate-pulse"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-cyan-500/20 rounded-full blur-[120px] animate-pulse",style:{animationDelay:"1s"}})]}),i.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center",children:i.jsxs("div",{className:"animate-fade-in-up",children:[i.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-blue-500/10 border border-blue-500/20 text-blue-400 text-sm font-medium mb-8",children:[i.jsx(zT,{className:"w-4 h-4 mr-2"}),"Invitation-Only Access"]}),i.jsxs("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-bold mb-6 leading-tight",children:["Professional Task Management",i.jsx("br",{}),i.jsx("span",{className:"bg-gradient-to-r from-blue-400 via-cyan-400 to-blue-400 bg-clip-text text-transparent animate-gradient",children:"For Your Organization"})]}),i.jsx("p",{className:"text-xl text-slate-400 max-w-3xl mx-auto mb-12",children:"A powerful, enterprise-grade task management platform. Streamline workflows, enhance collaboration, and boost productivity across your teams."}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-16",children:[i.jsxs("button",{onClick:()=>r("/register"),className:"group px-8 py-4 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl font-semibold hover:from-blue-500 hover:to-cyan-500 transition-all shadow-xl shadow-blue-500/25 hover:shadow-blue-500/40 hover:scale-105",children:["Request Access",i.jsx(Fv,{className:"inline-block ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),i.jsx("button",{onClick:()=>r("/login"),className:"px-8 py-4 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl font-semibold hover:bg-white/10 transition-all",children:"Sign In"})]}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-4xl mx-auto",children:[{icon:ks,label:"Organizations",value:"50+"},{icon:Qc,label:"Active Projects",value:"1000+"},{icon:ST,label:"Teams Managed",value:"200+"},{icon:Bv,label:"Uptime",value:"99.9%"}].map((n,a)=>i.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10 backdrop-blur-sm",children:[i.jsx(n.icon,{className:"w-6 h-6 text-blue-400 mx-auto mb-2"}),i.jsx("div",{className:"text-2xl font-bold mb-1",children:n.value}),i.jsx("div",{className:"text-sm text-slate-400",children:n.label})]},a))})]})}),i.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce",children:i.jsx(wi,{className:"w-6 h-6 text-slate-400"})})]}),i.jsx("section",{id:"features",className:"relative py-24 bg-gradient-to-b from-slate-950 to-slate-900",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[i.jsxs("div",{className:"text-center mb-16",children:[i.jsxs("h2",{className:"text-4xl lg:text-5xl font-bold mb-4",children:["Enterprise-Grade ",i.jsx("span",{className:"text-blue-400",children:"Capabilities"})]}),i.jsx("p",{className:"text-xl text-slate-400 max-w-2xl mx-auto",children:"Comprehensive tools designed for professional teams and organizations"})]}),i.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{icon:FT,title:"Kanban Boards",description:"Visualize your workflow with drag-and-drop Kanban boards",color:"from-blue-500 to-cyan-500"},{icon:Gn,title:"Calendar View",description:"Track deadlines and milestones in an intuitive calendar",color:"from-cyan-500 to-teal-500"},{icon:Jc,title:"Real-time Notifications",description:"Stay updated with instant notifications and alerts",color:"from-teal-500 to-emerald-500"},{icon:zx,title:"Analytics Dashboard",description:"Gain insights with comprehensive analytics and reports",color:"from-emerald-500 to-green-500"},{icon:Bv,title:"Role-Based Access",description:"Secure your data with granular permission controls",color:"from-purple-500 to-pink-500"},{icon:DT,title:"Multi-Workspace",description:"Manage multiple projects and teams in one place",color:"from-pink-500 to-rose-500"}].map((n,a)=>i.jsxs("div",{className:"group p-6 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-sm hover:bg-white/10 hover:border-white/20 transition-all hover:scale-105 hover:shadow-xl",children:[i.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-r ${n.color} p-2.5 mb-4 group-hover:scale-110 transition-transform`,children:i.jsx(n.icon,{className:"w-full h-full text-white"})}),i.jsx("h3",{className:"text-xl font-semibold mb-2",children:n.title}),i.jsx("p",{className:"text-slate-400",children:n.description})]},a))})]})}),i.jsx("section",{className:"relative py-24 bg-gradient-to-b from-slate-900 to-slate-950",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-4xl lg:text-5xl font-bold mb-6",children:["Built for ",i.jsx("span",{className:"text-cyan-400",children:"Organizations"})]}),i.jsx("div",{className:"space-y-6",children:["Centralized project and task management","Real-time collaboration across teams","Comprehensive analytics and reporting","Role-based access control and security","Scalable infrastructure for growth","Dedicated support and training"].map((n,a)=>i.jsxs("div",{className:"flex items-start space-x-3",children:[i.jsx(ET,{className:"w-6 h-6 text-green-400 flex-shrink-0 mt-1"}),i.jsx("span",{className:"text-lg text-slate-300",children:n})]},a))})]}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-3xl blur-3xl"}),i.jsx("div",{className:"relative bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-3xl p-8",children:i.jsx("img",{src:"/logo.png",alt:"Dashboard Preview",className:"w-full rounded-xl shadow-2xl"})})]})]})})}),i.jsx("section",{className:"relative py-24",children:i.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/20 via-cyan-500/20 to-blue-500/20 rounded-3xl blur-3xl"}),i.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600/10 to-cyan-600/10 border border-white/10 rounded-3xl p-12 backdrop-blur-sm",children:[i.jsx("h2",{className:"text-4xl lg:text-5xl font-bold mb-4",children:"Ready to Join?"}),i.jsx("p",{className:"text-xl text-slate-400 mb-8",children:"Request access to TaskFlow for your organization"}),i.jsxs("button",{onClick:()=>r("/register"),className:"px-8 py-4 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl font-semibold hover:from-blue-500 hover:to-cyan-500 transition-all shadow-xl shadow-blue-500/25 hover:shadow-blue-500/40 hover:scale-105 text-lg",children:["Request Access",i.jsx(Fv,{className:"inline-block ml-2 w-5 h-5"})]}),i.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"Access is granted on a case-by-case basis"})]})]})})}),i.jsx("footer",{className:"relative border-t border-white/10 py-12",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-4 md:mb-0",children:[i.jsx("img",{src:"/logo.png",alt:"TaskFlow",className:"w-8 h-8"}),i.jsx("span",{className:"text-xl font-bold",children:"TaskFlow"})]}),i.jsx("div",{className:"text-slate-400 text-sm",children:"Â© 2025 TaskFlow. All rights reserved."})]})})}),i.jsx("style",{jsx:!0,children:`
        @keyframes gradient {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }
        .animate-gradient {
          background-size: 200% auto;
          animation: gradient 3s ease infinite;
        }
        @keyframes fade-in-up {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.6s ease-out;
        }
      `})]})},It=[{_id:"1",full_name:"Sarah Chen",email:"sarah.chen@taskflow.io",role:"admin",avatar:"ðŸ‘©â€ðŸ’¼"},{_id:"2",full_name:"Marcus Johnson",email:"marcus.j@taskflow.io",role:"hr",avatar:"ðŸ‘¨â€ðŸ’»"},{_id:"3",full_name:"Emma Rodriguez",email:"emma.r@taskflow.io",role:"team_lead",avatar:"ðŸ‘©â€ðŸŽ¨"},{_id:"4",full_name:"James Kim",email:"james.kim@taskflow.io",role:"member",avatar:"ðŸ‘¨â€ðŸ”¬"},{_id:"5",full_name:"Olivia Patel",email:"olivia.p@taskflow.io",role:"member",avatar:"ðŸ‘©â€ðŸš€"},{_id:"6",full_name:"David Martinez",email:"david.m@taskflow.io",role:"team_lead",avatar:"ðŸ‘¨â€ðŸŽ“"},{_id:"7",full_name:"Sophia Anderson",email:"sophia.a@taskflow.io",role:"member",avatar:"ðŸ‘©â€ðŸ”§"},{_id:"8",full_name:"Michael Brown",email:"michael.b@taskflow.io",role:"member",avatar:"ðŸ‘¨â€ðŸŽ¤"}],Qa=[{_id:"team1",name:"Product Engineering",description:"Building the future of task management",lead_id:It[2],hr_id:It[1],members:[It[2],It[4],It[7]],priority:1,pinned:!0},{_id:"team2",name:"Design & UX",description:"Crafting delightful user experiences",lead_id:It[5],hr_id:It[1],members:[It[5],It[6]],priority:2,pinned:!1},{_id:"team3",name:"Marketing & Growth",description:"Accelerating our market presence",lead_id:It[3],hr_id:It[1],members:[It[3]],priority:3,pinned:!1}],Oie=()=>{const e=new Date;return[{_id:"task1",title:"Implement real-time collaboration features",description:"Add WebSocket support for live cursor tracking and presence indicators",status:"in_progress",priority:"high",created_by:It[0],assigned_to:[It[4],It[7]],team_id:Qa[0],due_date:new Date(e.getTime()+2*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-3*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-1*60*60*1e3).toISOString()},{_id:"task2",title:"Design mobile app navigation",description:"Create intuitive bottom navigation for iOS and Android",status:"todo",priority:"urgent",created_by:It[2],assigned_to:[It[5],It[6]],team_id:Qa[1],due_date:new Date(e.getTime()+1*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-2*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-30*60*1e3).toISOString()},{_id:"task3",title:"Optimize database queries",description:"Reduce API response time by implementing proper indexing",status:"done",priority:"high",created_by:It[0],assigned_to:[It[4]],team_id:Qa[0],due_date:new Date(e.getTime()-1*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-7*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-1*24*60*60*1e3).toISOString()},{_id:"task4",title:"Launch Q1 marketing campaign",description:"Coordinate social media, email, and content marketing initiatives",status:"in_progress",priority:"medium",created_by:It[1],assigned_to:[It[3]],team_id:Qa[2],due_date:new Date(e.getTime()+7*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-5*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-2*60*60*1e3).toISOString()},{_id:"task5",title:"User research for dashboard redesign",description:"Conduct interviews with 15 users to gather feedback",status:"in_progress",priority:"medium",created_by:It[2],assigned_to:[It[5]],team_id:Qa[1],due_date:new Date(e.getTime()+4*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-4*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-3*60*60*1e3).toISOString()},{_id:"task6",title:"Fix critical authentication bug",description:"Session timeout causing unexpected logouts",status:"done",priority:"urgent",created_by:It[0],assigned_to:[It[4],It[7]],team_id:Qa[0],due_date:new Date(e.getTime()-2*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-8*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-2*24*60*60*1e3).toISOString()},{_id:"task7",title:"Write API documentation",description:"Document all REST endpoints with examples",status:"todo",priority:"low",created_by:It[0],assigned_to:[It[4]],team_id:Qa[0],due_date:new Date(e.getTime()+10*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-1*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-1*24*60*60*1e3).toISOString()},{_id:"task8",title:"Prepare investor pitch deck",description:"Update slides with latest metrics and product screenshots",status:"in_review",priority:"high",created_by:It[1],assigned_to:[It[3],It[5]],team_id:Qa[2],due_date:new Date(e.getTime()+3*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-6*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-4*60*60*1e3).toISOString()},{_id:"task9",title:"Implement dark mode",description:"Add theme toggle and persist user preference",status:"done",priority:"medium",created_by:It[2],assigned_to:[It[6]],team_id:Qa[1],due_date:new Date(e.getTime()-3*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-10*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-3*24*60*60*1e3).toISOString()},{_id:"task10",title:"Setup CI/CD pipeline",description:"Configure GitHub Actions for automated testing and deployment",status:"todo",priority:"high",created_by:It[0],assigned_to:[It[4]],team_id:Qa[0],due_date:new Date(e.getTime()+5*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-2*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-2*24*60*60*1e3).toISOString()},{_id:"task11",title:"Create onboarding tutorial",description:"Interactive walkthrough for new users",status:"in_progress",priority:"medium",created_by:It[2],assigned_to:[It[5],It[6]],team_id:Qa[1],due_date:new Date(e.getTime()+6*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-5*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-1*60*60*1e3).toISOString()},{_id:"task12",title:"Email notification preferences",description:"Allow users to customize notification frequency",status:"todo",priority:"low",created_by:It[0],assigned_to:[It[7]],team_id:Qa[0],due_date:new Date(e.getTime()+14*24*60*60*1e3).toISOString(),created_at:new Date(e.getTime()-1*24*60*60*1e3).toISOString(),updated_at:new Date(e.getTime()-1*24*60*60*1e3).toISOString()}]},Pie=()=>{const e=new Date;return[{_id:"notif1",type:"task_assigned",message:'Sarah Chen assigned you to "Implement real-time collaboration features"',read:!1,created_at:new Date(e.getTime()-30*60*1e3).toISOString(),task_id:"task1"},{_id:"notif2",type:"task_due_soon",message:'Task "Design mobile app navigation" is due tomorrow',read:!1,created_at:new Date(e.getTime()-2*60*60*1e3).toISOString(),task_id:"task2"},{_id:"notif3",type:"task_completed",message:'Olivia Patel completed "Optimize database queries"',read:!0,created_at:new Date(e.getTime()-24*60*60*1e3).toISOString(),task_id:"task3"},{_id:"notif4",type:"comment",message:'James Kim commented on "Launch Q1 marketing campaign"',read:!0,created_at:new Date(e.getTime()-3*24*60*60*1e3).toISOString(),task_id:"task4"}]},Lie=()=>{const e=new Date;return[{_id:"comment1",task_id:"task1",user_id:It[4],text:"Working on the WebSocket integration. Should have a prototype ready by EOD.",created_at:new Date(e.getTime()-2*60*60*1e3).toISOString()},{_id:"comment2",task_id:"task1",user_id:It[0],text:"Great! Make sure to test with multiple concurrent connections.",created_at:new Date(e.getTime()-1*60*60*1e3).toISOString()},{_id:"comment3",task_id:"task2",user_id:It[5],text:"Initial wireframes are ready for review. Focusing on thumb-friendly navigation.",created_at:new Date(e.getTime()-4*60*60*1e3).toISOString()},{_id:"comment4",task_id:"task4",user_id:It[3],text:"Scheduled social media posts for the next 2 weeks. Email campaign draft is in progress.",created_at:new Date(e.getTime()-6*60*60*1e3).toISOString()}]},Fie=()=>({totalTasks:12,completedTasks:3,inProgressTasks:5,overdueTasks:1,statusDistribution:{todo:3,in_progress:5,in_review:1,done:3},priorityDistribution:{low:2,medium:4,high:4,urgent:2},teamDistribution:{"Product Engineering":6,"Design & UX":4,"Marketing & Growth":2},completionTrend:[{date:"2025-12-23",completed:1},{date:"2025-12-24",completed:0},{date:"2025-12-25",completed:1},{date:"2025-12-26",completed:0},{date:"2025-12-27",completed:0},{date:"2025-12-28",completed:1},{date:"2025-12-29",completed:0},{date:"2025-12-30",completed:0}]}),$ie=()=>({users:It,teams:Qa,tasks:Oie(),notifications:Pie(),comments:Lie(),analytics:Fie()}),Rie=()=>{const[e,t]=J.useState("dashboard"),[r,n]=J.useState(!1),[a,s]=J.useState(null);return J.useEffect(()=>{const o=$ie();s(o)},[]),a?i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-blue-950/20",children:[!r&&i.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-slate-900/95 backdrop-blur-sm border border-white/10 rounded-xl p-4 shadow-2xl max-w-sm",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[i.jsx(AT,{className:"w-5 h-5 text-blue-400"}),i.jsx("h3",{className:"text-white font-semibold",children:"Screenshot Helper"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"View Type"}),i.jsxs("select",{value:e,onChange:o=>t(o.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"dashboard",children:"ðŸ“Š Dashboard"}),i.jsx("option",{value:"kanban",children:"ðŸ“‹ Kanban Board"}),i.jsx("option",{value:"tasks",children:"âœ“ Task List"}),i.jsx("option",{value:"analytics",children:"ðŸ“ˆ Analytics"}),i.jsx("option",{value:"calendar",children:"ðŸ“… Calendar"}),i.jsx("option",{value:"teams",children:"ðŸ‘¥ Teams"})]})]}),i.jsxs("button",{onClick:()=>n(!0),className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2",children:[i.jsx(to,{className:"w-4 h-4"}),i.jsx("span",{children:"Hide Controls (Take Screenshot)"})]}),i.jsx("div",{className:"pt-3 border-t border-slate-700",children:i.jsxs("div",{className:"flex items-start space-x-2 text-xs text-slate-400",children:[i.jsx(C4,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{className:"mb-2",children:"To capture:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-500",children:[i.jsx("li",{children:"Chrome: Use GoFullPage extension"}),i.jsx("li",{children:'Firefox: Shift+F2, type "screenshot"'}),i.jsx("li",{children:'DevTools: Cmd/Ctrl+Shift+P â†’ "Capture screenshot"'})]})]})]})})]})]}),r&&i.jsx("button",{onClick:()=>n(!1),className:"fixed top-4 right-4 z-50 p-3 bg-blue-600 hover:bg-blue-500 text-white rounded-full shadow-2xl transition-colors",title:"Show controls",children:i.jsx(js,{className:"w-5 h-5"})}),i.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e==="dashboard"&&i.jsx(Mie,{data:a}),e==="kanban"&&i.jsx(Iie,{data:a}),e==="tasks"&&i.jsx(Bie,{data:a}),e==="analytics"&&i.jsx(Uie,{data:a}),e==="calendar"&&i.jsx(Wie,{data:a}),e==="teams"&&i.jsx(zie,{data:a})]})]}):i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950",children:i.jsx("div",{className:"text-white",children:"Loading mock data..."})})},Mie=({data:e})=>{const t={todo:e.tasks.filter(r=>r.status==="todo").length,in_progress:e.tasks.filter(r=>r.status==="in_progress").length,done:e.tasks.filter(r=>r.status==="done").length};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Dashboard"}),i.jsxs("p",{className:"text-slate-400",children:["Welcome back, ",e.users[0].full_name]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Total Tasks"}),i.jsx("div",{className:"text-3xl font-bold text-white",children:e.tasks.length}),i.jsx("div",{className:"text-xs text-green-400 mt-1",children:"â†‘ 12% from last week"})]}),i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"In Progress"}),i.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.in_progress}),i.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[e.users.length," team members"]})]}),i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Completed"}),i.jsx("div",{className:"text-3xl font-bold text-green-400",children:t.done}),i.jsx("div",{className:"text-xs text-green-400 mt-1",children:"â†‘ 25% completion rate"})]}),i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Teams"}),i.jsx("div",{className:"text-3xl font-bold text-purple-400",children:e.teams.length}),i.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Active workspaces"})]})]}),i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Recent Tasks"}),i.jsx("div",{className:"space-y-3",children:e.tasks.slice(0,5).map(r=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800/50 rounded-lg hover:bg-slate-800 transition-colors",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-white font-medium mb-1",children:r.title}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.status==="done"?"bg-green-500/20 text-green-400":r.status==="in_progress"?"bg-blue-500/20 text-blue-400":"bg-slate-500/20 text-slate-400"}`,children:r.status.replace("_"," ")}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.priority==="urgent"?"bg-red-500/20 text-red-400":r.priority==="high"?"bg-orange-500/20 text-orange-400":r.priority==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-slate-500/20 text-slate-400"}`,children:r.priority}),i.jsx("span",{className:"text-slate-500",children:r.team_id.name})]})]}),i.jsx("div",{className:"flex -space-x-2",children:r.assigned_to.slice(0,3).map((n,a)=>i.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-medium border-2 border-slate-900",children:n.full_name.charAt(0)},a))})]},r._id))})]})]})},Iie=({data:e})=>{const t=[{id:"todo",title:"To Do",color:"slate"},{id:"in_progress",title:"In Progress",color:"blue"},{id:"in_review",title:"In Review",color:"yellow"},{id:"done",title:"Done",color:"green"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Kanban Board"}),i.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.map(r=>i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between px-3",children:[i.jsx("h3",{className:"text-white font-semibold",children:r.title}),i.jsx("span",{className:"text-sm text-slate-400",children:e.tasks.filter(n=>n.status===r.id).length})]}),i.jsx("div",{className:"space-y-3",children:e.tasks.filter(n=>n.status===r.id).map(n=>i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-lg p-4 hover:border-white/20 transition-colors cursor-pointer",children:[i.jsx("h4",{className:"text-white font-medium mb-2",children:n.title}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:`px-2 py-1 rounded text-xs ${n.priority==="urgent"?"bg-red-500/20 text-red-400":n.priority==="high"?"bg-orange-500/20 text-orange-400":"bg-slate-500/20 text-slate-400"}`,children:n.priority}),i.jsx("div",{className:"flex -space-x-1",children:n.assigned_to.slice(0,2).map((a,s)=>i.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs border-2 border-slate-900",children:a.full_name.charAt(0)},s))})]})]},n._id))})]},r.id))})]})},Bie=({data:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Tasks"}),i.jsx("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl overflow-hidden",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-slate-800/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Task"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Priority"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Team"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Assigned"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-800",children:e.tasks.map(t=>i.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 text-white font-medium",children:t.title}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="done"?"bg-green-500/20 text-green-400":t.status==="in_progress"?"bg-blue-500/20 text-blue-400":"bg-slate-500/20 text-slate-400"}`,children:t.status.replace("_"," ")})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.priority==="urgent"?"bg-red-500/20 text-red-400":t.priority==="high"?"bg-orange-500/20 text-orange-400":"bg-slate-500/20 text-slate-400"}`,children:t.priority})}),i.jsx("td",{className:"px-6 py-4 text-slate-300",children:t.team_id.name}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex -space-x-1",children:t.assigned_to.slice(0,2).map((r,n)=>i.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs border-2 border-slate-900",children:r.full_name.charAt(0)},n))})})]},t._id))})]})})]}),Uie=({data:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Analytics"}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("h3",{className:"text-white font-semibold mb-4",children:"Status Distribution"}),i.jsx("div",{className:"space-y-3",children:Object.entries(e.analytics.statusDistribution).map(([t,r])=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[i.jsx("span",{className:"text-slate-400 capitalize",children:t.replace("_"," ")}),i.jsx("span",{className:"text-white font-medium",children:r})]}),i.jsx("div",{className:"h-2 bg-slate-800 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500",style:{width:`${r/e.tasks.length*100}%`}})})]},t))})]}),i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("h3",{className:"text-white font-semibold mb-4",children:"Priority Distribution"}),i.jsx("div",{className:"space-y-3",children:Object.entries(e.analytics.priorityDistribution).map(([t,r])=>i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[i.jsx("span",{className:"text-slate-400 capitalize",children:t}),i.jsx("span",{className:"text-white font-medium",children:r})]}),i.jsx("div",{className:"h-2 bg-slate-800 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full ${t==="urgent"?"bg-red-500":t==="high"?"bg-orange-500":t==="medium"?"bg-yellow-500":"bg-slate-500"}`,style:{width:`${r/e.tasks.length*100}%`}})})]},t))})]})]})]}),Wie=({data:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Calendar"}),i.jsx("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:i.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>i.jsx("div",{className:"text-center text-slate-400 text-sm font-medium py-2",children:t},t)),Array.from({length:35}).map((t,r)=>i.jsxs("div",{className:"aspect-square bg-slate-800/30 rounded-lg p-2 hover:bg-slate-800/50 transition-colors",children:[i.jsx("div",{className:"text-slate-300 text-sm",children:r+1}),r%5===0&&i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1"})]},r))]})})]}),zie=({data:e})=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Teams"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.teams.map(t=>i.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:t.name}),i.jsx("p",{className:"text-slate-400 text-sm mb-4",children:t.description}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-xs text-slate-500",children:"Team Lead"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-sm",children:t.lead_id.full_name.charAt(0)}),i.jsx("span",{className:"text-white text-sm",children:t.lead_id.full_name})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-800",children:[i.jsxs("div",{className:"text-xs text-slate-500 mb-2",children:[t.members.length," Members"]}),i.jsx("div",{className:"flex -space-x-2",children:t.members.map((r,n)=>i.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center text-white text-xs border-2 border-slate-900",children:r.full_name.charAt(0)},n))})]})]},t._id))})]});function Hie(){const{user:e}=pn(),{theme:t,currentTheme:r,currentColorScheme:n}=Lr(),{toggleMobileSidebar:a}=Mn(),[s,o]=J.useState([]),[l,c]=J.useState(null),[d,u]=J.useState(!0),[h,m]=J.useState(!1),[f,x]=J.useState(new Date().getMonth()+1),[g,b]=J.useState(new Date().getFullYear()),[y,N]=J.useState(null),[S,_]=J.useState({}),D=e&&(e.role==="admin"||e.role==="hr");J.useEffect(()=>{I(),O(),R()},[f,g]);const I=async()=>{try{u(!0);const F=await it.get("/hr/attendance",{params:{month:f,year:g}});o(F.data.records)}catch(F){console.error("Error fetching attendance:",F)}finally{u(!1)}},O=async()=>{try{const F=await it.get("/hr/attendance/summary",{params:{month:f,year:g}});c(F.data.summary)}catch(F){console.error("Error fetching summary:",F)}},R=async()=>{try{const F=new Date,V=(await it.get("/hr/attendance",{params:{month:F.getMonth()+1,year:F.getFullYear()}})).data.records.find(ee=>new Date(ee.date).toDateString()===F.toDateString()&&ee.userId._id===e._id);m(V&&V.checkIn&&!V.checkOut)}catch(F){console.error("Error checking today attendance:",F)}},E=async()=>{var F,ne;try{await it.post("/hr/attendance/checkin"),m(!0),I(),O(),alert("Checked in successfully!")}catch(V){alert(((ne=(F=V.response)==null?void 0:F.data)==null?void 0:ne.message)||"Failed to check in")}},B=async()=>{var F,ne;try{await it.post("/hr/attendance/checkout"),m(!1),I(),O(),alert("Checked out successfully!")}catch(V){alert(((ne=(F=V.response)==null?void 0:F.data)==null?void 0:ne.message)||"Failed to check out")}},C=async F=>{var ne,V;try{await it.put(`/hr/attendance/${F}`,S),N(null),_({}),I(),alert("Attendance updated successfully!")}catch(ee){alert(((V=(ne=ee.response)==null?void 0:ne.data)==null?void 0:V.message)||"Failed to update attendance")}},M=F=>({present:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",absent:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",half_day:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",leave:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",holiday:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"})[F]||"bg-gray-100 text-gray-800",U=F=>({present:i.jsx(da,{className:"w-4 h-4"}),absent:i.jsx(Yo,{className:"w-4 h-4"}),half_day:i.jsx(Ss,{className:"w-4 h-4"}),leave:i.jsx(Gn,{className:"w-4 h-4"}),holiday:i.jsx(Gn,{className:"w-4 h-4"})})[F]||null;return i.jsxs(uf,{title:"Attendance Tracking",actions:!D&&(h?i.jsxs("button",{onClick:B,className:`px-4 py-2 ${r.primary} text-white ${r.primaryHover} flex items-center gap-2`,children:[i.jsx(Yo,{className:"w-5 h-5"}),"Check Out"]}):i.jsxs("button",{onClick:E,className:`px-4 py-2 ${r.primary} text-white ${r.primaryHover} flex items-center gap-2`,children:[i.jsx(da,{className:"w-5 h-5"}),"Check In"]})),children:[l&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[i.jsx("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${r.textSecondary}`,children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:l.present})]}),i.jsx(da,{className:"w-8 h-8 text-green-600 dark:text-green-400"})]})}),i.jsx("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${r.textSecondary}`,children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:l.absent})]}),i.jsx(Yo,{className:"w-8 h-8 text-red-600 dark:text-red-400"})]})}),i.jsx("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${r.textSecondary}`,children:"Half Day"}),i.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:l.halfDay})]}),i.jsx(Ss,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"})]})}),i.jsx("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${r.textSecondary}`,children:"Leave"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:l.leave})]}),i.jsx(Gn,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})]})}),i.jsx("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${r.textSecondary}`,children:"Total Hours"}),i.jsx("p",{className:"text-2xl font-bold text-purple-600",children:l.totalHours.toFixed(1)})]}),i.jsx(Zc,{className:"w-8 h-8 text-purple-600"})]})})]}),i.jsx("div",{className:`${r.surface} rounded-lg p-4 mb-6 border ${r.border}`,children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("label",{className:`text-sm font-medium ${r.text}`,children:"Month:"}),i.jsx("select",{value:f,onChange:F=>x(parseInt(F.target.value)),className:`px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,children:Array.from({length:12},(F,ne)=>ne+1).map(F=>i.jsx("option",{value:F,children:new Date(2e3,F-1).toLocaleDateString("en-US",{month:"long"})},F))}),i.jsx("label",{className:`text-sm font-medium ${r.text}`,children:"Year:"}),i.jsx("select",{value:g,onChange:F=>b(parseInt(F.target.value)),className:`px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,children:Array.from({length:5},(F,ne)=>new Date().getFullYear()-2+ne).map(F=>i.jsx("option",{value:F,children:F},F))})]})}),i.jsx("div",{className:`${r.surface} rounded-lg border ${r.border} overflow-hidden`,children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:`${r.surfaceSecondary}`,children:i.jsxs("tr",{children:[i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Date"}),D&&i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Employee"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Check In"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Check Out"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Hours"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Status"}),D&&i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y ${r.border}`,children:d?i.jsx("tr",{children:i.jsx("td",{colSpan:D?7:6,className:`px-6 py-4 text-center ${r.textSecondary}`,children:"Loading..."})}):s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:D?7:6,className:`px-6 py-4 text-center ${r.textSecondary}`,children:"No attendance records found"})}):s.map(F=>{var ne;return i.jsxs("tr",{className:`${r.hover}`,children:[i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:new Date(F.date).toLocaleDateString()}),D&&i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:(ne=F.userId)==null?void 0:ne.full_name}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:F.checkIn?new Date(F.checkIn).toLocaleTimeString():"-"}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:F.checkOut?new Date(F.checkOut).toLocaleTimeString():"-"}),i.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:[F.workingHours.toFixed(2),"h"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full items-center gap-1 ${M(F.status)}`,children:[U(F.status),F.status.replace("_"," ").toUpperCase()]})}),D&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:y===F._id?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>C(F._id),className:"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300",children:i.jsx(BT,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>N(null),className:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300",children:i.jsx(kr,{className:"w-4 h-4"})})]}):i.jsx("button",{onClick:()=>{N(F._id),_({status:F.status,checkIn:F.checkIn,checkOut:F.checkOut,notes:F.notes||""})},className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",children:i.jsx(Hl,{className:"w-4 h-4"})})})]},F._id)})})]})})})]})}const qie=lS(bt);function e6({embedded:e=!1}){const{user:t}=pn(),{theme:r,currentTheme:n}=Lr(),{toggleMobileSidebar:a}=Mn(),[s,o]=J.useState([]),[l,c]=J.useState(!0),[d,u]=J.useState({}),[h,m]=J.useState(null),[f,x]=J.useState("month");J.useEffect(()=>{g()},[]);const g=async()=>{try{c(!0);const D=new Date,I=D.getMonth()+1,O=D.getFullYear(),[R,E]=await Promise.all([it.get("/hr/calendar",{params:{month:I,year:O}}),it.get("/hr/attendance")]),B={};E.data.records.forEach(C=>{const M=C.date;B[M]||(B[M]={present:0,absent:0,half_day:0,leave:0,holiday:0}),B[M][C.status]++}),u(B),b(B,R.data.events)}catch(D){console.error("Error fetching calendar data:",D)}finally{c(!1)}},b=(D,I)=>{const O=[];Object.entries(D).forEach(([R,E])=>{const B=new Date(R);E.present>0&&O.push({id:`present-${R}`,title:`Present: ${E.present}`,start:B,end:B,resource:{type:"present",data:{count:E.present,total:E}},allDay:!0}),E.absent>0&&O.push({id:`absent-${R}`,title:`Absent: ${E.absent}`,start:B,end:B,resource:{type:"absent",data:{count:E.absent,total:E}},allDay:!0}),E.half_day>0&&O.push({id:`half_day-${R}`,title:`Half Day: ${E.half_day}`,start:B,end:B,resource:{type:"half_day",data:{count:E.half_day,total:E}},allDay:!0}),E.leave>0&&O.push({id:`leave-${R}`,title:`Leave: ${E.leave}`,start:B,end:B,resource:{type:"leave",data:{count:E.leave,total:E}},allDay:!0})}),I.forEach(R=>{R.type==="holiday"&&O.push({id:`holiday-${R.date}`,title:R.name||"Holiday",start:new Date(R.date),end:new Date(R.date),resource:{type:"holiday",data:R},allDay:!0})}),o(O)},y=D=>{if(D.resource.type==="holiday")return"#9333ea";switch(D.resource.type){case"present":return"#22c55e";case"absent":return"#dc2626";case"half_day":return"#eab308";case"leave":return"#3b82f6";default:return"#6b7280"}},N=D=>({style:{backgroundColor:y(D),borderRadius:"0.125rem",opacity:.95,color:"white",border:"none",display:"block",fontWeight:"600",fontSize:"0.75rem",padding:"2px 6px",boxShadow:"0 1px 3px rgba(0,0,0,0.3)"}}),S=D=>{m(D)},_=i.jsxs(i.Fragment,{children:[l?i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx("div",{className:"flex gap-3",children:[0,1,2,3].map(D=>i.jsx("div",{className:"w-4 h-12 bg-blue-600 rounded-full animate-pulse",style:{animationDelay:`${D*.15}s`}},D))}),i.jsx("p",{className:`ml-4 ${n.textSecondary} font-medium`,children:"Loading calendar..."})]}):i.jsx("div",{className:`${n.surface} rounded-lg border ${n.border} p-4`,children:i.jsx(oS,{localizer:qie,events:s,startAccessor:"start",endAccessor:"end",style:{height:e?500:700,minHeight:e?400:500},eventPropGetter:N,onSelectEvent:S,views:["month"],defaultView:"month",popup:!1,tooltipAccessor:D=>D.title})}),h&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${n.surface} rounded-lg p-8 max-w-md w-full max-h-[90vh] overflow-y-auto border ${n.border}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:`text-2xl font-bold ${n.text}`,children:h.title}),i.jsx("button",{onClick:()=>m(null),className:`${n.textSecondary} hover:${n.text}`,children:i.jsx(kr,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary} mb-1`,children:"Date:"}),i.jsxs("p",{className:`text-sm ${n.text} flex items-center gap-2`,children:[i.jsx(Gn,{size:14}),h.start.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),(h.resource.type==="present"||h.resource.type==="absent"||h.resource.type==="half_day"||h.resource.type==="leave")&&i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary} mb-2`,children:"Attendance Details:"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[h.resource.type==="present"&&i.jsx(da,{className:"w-4 h-4 text-green-500"}),h.resource.type==="absent"&&i.jsx(Yo,{className:"w-4 h-4 text-red-500"}),h.resource.type==="half_day"&&i.jsx(Ss,{className:"w-4 h-4 text-yellow-500"}),h.resource.type==="leave"&&i.jsx(Gn,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:`text-sm ${n.text}`,children:[h.resource.type==="present"&&`Present: ${h.resource.data.count}`,h.resource.type==="absent"&&`Absent: ${h.resource.data.count}`,h.resource.type==="half_day"&&`Half Day: ${h.resource.data.count}`,h.resource.type==="leave"&&`Leave: ${h.resource.data.count}`]})]}),i.jsxs("div",{className:`text-xs ${n.textSecondary} mt-2`,children:[i.jsx("p",{children:"Total attendance for this day:"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[h.resource.data.total.present>0&&i.jsxs("span",{children:["Present: ",h.resource.data.total.present]}),h.resource.data.total.absent>0&&i.jsxs("span",{children:["Absent: ",h.resource.data.total.absent]}),h.resource.data.total.half_day>0&&i.jsxs("span",{children:["Half Day: ",h.resource.data.total.half_day]}),h.resource.data.total.leave>0&&i.jsxs("span",{children:["Leave: ",h.resource.data.total.leave]})]})]})]})]}),h.resource.type==="holiday"&&i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary} mb-1`,children:"Holiday:"}),i.jsx("p",{className:`text-sm ${n.text}`,children:h.resource.data.name||"Holiday"})]})]})]})}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .calendar-container .rbc-calendar {
          font-family: 'Inter', sans-serif;
          color: ${r==="dark"?"#ffffff":"#111827"};
        }
        .calendar-container .rbc-header {
          padding: 12px;
          font-weight: 600;
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          background: ${r==="dark"?"#1c2027":"#f9fafb"};
          color: ${r==="dark"?"#d1d5db":"#374151"};
          border-color: ${r==="dark"?"#374151":"#d1d5db"};
        }
        .calendar-container .rbc-today {
          background-color: ${r==="dark"?"#1e293b":"#dbeafe"};
        }
        .calendar-container .rbc-off-range-bg {
          background: ${r==="dark"?"#0f172a":"#f8fafc"};
        }
        .calendar-container .rbc-date-cell {
          color: ${r==="dark"?"#e2e8f0":"#1e293b"};
          padding: 4px;
        }
        .calendar-container .rbc-off-range {
          color: ${r==="dark"?"#64748b":"#94a3b8"};
        }
        .calendar-container .rbc-month-view {
          background: ${r==="dark"?"#1e293b":"#ffffff"};
          border-color: ${r==="dark"?"#334155":"#e2e8f0"};
        }
        .calendar-container .rbc-day-bg {
          background: ${r==="dark"?"#1e293b":"#ffffff"};
          border-color: ${r==="dark"?"#334155":"#e2e8f0"};
        }
        .calendar-container .rbc-event {
          transition: all 0.2s ease;
          border-radius: 4px;
          font-weight: 500;
        }
        .calendar-container .rbc-event:hover {
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .calendar-container .rbc-toolbar {
          color: ${r==="dark"?"#f1f5f9":"#1e293b"};
          margin-bottom: 20px;
          padding: 12px;
          background: ${r==="dark"?"#0f172a":"#f8fafc"};
          border-radius: 0.375rem;
          border: 1px solid ${r==="dark"?"#334155":"#e2e8f0"};
        }
        .calendar-container .rbc-toolbar button {
          color: ${r==="dark"?"#cbd5e1":"#475569"};
          background: ${r==="dark"?"#1e293b":"#ffffff"};
          border: 1px solid ${r==="dark"?"#475569":"#cbd5e1"};
          border-radius: 0.25rem;
          padding: 6px 12px;
          font-size: 0.875rem;
          font-weight: 500;
        }
        .calendar-container .rbc-toolbar button:hover {
          background: ${r==="dark"?"#334155":"#f1f5f9"};
          color: ${r==="dark"?"#f1f5f9":"#1e293b"};
        }
        .calendar-container .rbc-toolbar button.rbc-active {
          background: ${r==="dark"?"#3b82f6":"#2563eb"};
          color: white;
          border-color: ${r==="dark"?"#3b82f6":"#2563eb"};
        }
      `}})]});return e?_:i.jsx(uf,{title:"HR Calendar",subtitle:"View attendance and holiday information",children:_})}function Yie(){const{user:e}=pn(),{theme:t,currentTheme:r,currentColorScheme:n}=Lr(),{toggleMobileSidebar:a}=Mn(),[s,o]=J.useState([]),[l,c]=J.useState([]),[d,u]=J.useState([]),[h,m]=J.useState(!0),[f,x]=J.useState(!1),[g,b]=J.useState(!1),[y,N]=J.useState(null),[S,_]=J.useState(""),[D,I]=J.useState({leaveTypeId:"",startDate:"",endDate:"",days:1,reason:""}),O=e&&(e.role==="admin"||e.role==="hr"),R=async(F,ne,V="")=>{try{(await it.patch(`/hr/leaves/${F}/status`,{status:ne,rejectionReason:V})).data.success&&B()}catch(ee){console.error("Error updating leave status:",ee),alert("Failed to update leave status")}},E=()=>{S.trim()&&(R(y,"rejected",S),b(!1),N(null),_(""))};J.useEffect(()=>{B()},[]);const B=async()=>{try{m(!0);const F=O?"/hr/leaves/balances":"/hr/leaves/balance",[ne,V,ee]=await Promise.all([it.get("/hr/leaves"),it.get(F),it.get("/hr/leave-types")]);o(ne.data.requests),c(V.data.balances),u(ee.data.leaveTypes)}catch(F){console.error("Error fetching data:",F)}finally{m(!1)}},C=(F,ne)=>{const V=new Date(F),ee=new Date(ne),me=Math.abs(ee-V);return Math.ceil(me/(1e3*60*60*24))+1},M=async F=>{var ne,V;F.preventDefault();try{const ee=C(D.startDate,D.endDate);await it.post("/hr/leaves",{...D,days:ee}),x(!1),I({leaveTypeId:"",startDate:"",endDate:"",days:1,reason:""}),B(),alert("Leave request submitted successfully!")}catch(ee){alert(((V=(ne=ee.response)==null?void 0:ne.data)==null?void 0:V.message)||"Failed to submit leave request")}},U=F=>({pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",approved:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",rejected:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"})[F]||"bg-gray-100 text-gray-800";return i.jsxs("div",{children:[i.jsxs(uf,{title:"Leave Management",actions:O?null:i.jsxs("button",{onClick:()=>x(!0),className:`px-4 py-2 ${r.primary} text-white ${r.primaryHover} flex items-center gap-2`,children:[i.jsx(Si,{className:"w-5 h-5"}),"Apply Leave"]}),children:[i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:l.map(F=>{var ne,V;return i.jsxs("div",{className:`${r.surface} rounded-lg p-4 border ${r.border}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:`text-sm font-semibold ${r.text}`,children:(ne=F.leaveTypeId)==null?void 0:ne.name}),i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:(V=F.leaveTypeId)==null?void 0:V.color}})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:`${r.textSecondary}`,children:"Total:"}),i.jsx("span",{className:`font-semibold ${r.text}`,children:F.totalQuota})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:`${r.textSecondary}`,children:"Used:"}),i.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:F.used})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:`${r.textSecondary}`,children:"Pending:"}),i.jsx("span",{className:"font-semibold text-yellow-600 dark:text-yellow-400",children:F.pending})]}),i.jsxs("div",{className:`flex justify-between text-sm pt-2 border-t ${r.border}`,children:[i.jsx("span",{className:`${r.textSecondary}`,children:"Available:"}),i.jsx("span",{className:"font-bold text-green-600 dark:text-green-400",children:F.available})]})]})]},F._id)})}),i.jsxs("div",{className:`${r.surface} rounded-lg border ${r.border} overflow-hidden`,children:[i.jsx("div",{className:`px-6 py-4 border-b ${r.border}`,children:i.jsx("h2",{className:`text-lg font-semibold ${r.text}`,children:O?"All Leave Requests":"My Leave Requests"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:`${r.surfaceSecondary}`,children:i.jsxs("tr",{children:[O&&i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Employee"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Leave Type"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Start Date"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"End Date"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Days"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Status"}),i.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${r.textSecondary} uppercase tracking-wider`,children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y ${r.border}`,children:h?i.jsx("tr",{children:i.jsx("td",{colSpan:O?7:6,className:`px-6 py-4 text-center ${r.textSecondary}`,children:"Loading..."})}):s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:O?7:6,className:`px-6 py-4 text-center ${r.textSecondary}`,children:"No leave requests found"})}):s.map(F=>{var ne,V,ee;return i.jsxs("tr",{className:`${r.hover}`,children:[O&&i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:(ne=F.userId)==null?void 0:ne.full_name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:(V=F.leaveTypeId)==null?void 0:V.color}}),i.jsx("span",{className:`text-sm ${r.text}`,children:(ee=F.leaveTypeId)==null?void 0:ee.name})]})}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:new Date(F.startDate).toLocaleDateString()}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:new Date(F.endDate).toLocaleDateString()}),i.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${r.text}`,children:F.days}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${U(F.status)}`,children:F.status.toUpperCase()})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:O&&F.status==="pending"?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>R(F._id,"approved"),className:"px-3 py-1 bg-green-600 dark:bg-green-500 text-white text-xs rounded hover:bg-green-700 dark:hover:bg-green-600 transition-colors",children:"Approve"}),i.jsx("button",{onClick:()=>{N(F._id),_(""),b(!0)},className:"px-3 py-1 bg-red-600 dark:bg-red-500 text-white text-xs rounded hover:bg-red-700 dark:hover:bg-red-600 transition-colors",children:"Reject"})]}):i.jsx("span",{className:"text-gray-400",children:"-"})})]},F._id)})})]})})]})]}),f&&i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[i.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>x(!1)}),i.jsxs("div",{className:`relative ${r.surface} rounded-lg max-w-md w-full p-6`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:`text-lg font-semibold ${r.text}`,children:"Apply for Leave"}),i.jsx("button",{onClick:()=>x(!1),className:`${r.textSecondary} hover:${r.text}`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:M,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r.text} mb-1`,children:"Leave Type"}),i.jsxs("select",{value:D.leaveTypeId,onChange:F=>I({...D,leaveTypeId:F.target.value}),className:`w-full px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,required:!0,children:[i.jsx("option",{value:"",children:"Select leave type"}),d.map(F=>i.jsx("option",{value:F._id,children:F.name},F._id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r.text} mb-1`,children:"Start Date"}),i.jsx("input",{type:"date",value:D.startDate,onChange:F=>I({...D,startDate:F.target.value}),className:`w-full px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r.text} mb-1`,children:"End Date"}),i.jsx("input",{type:"date",value:D.endDate,onChange:F=>I({...D,endDate:F.target.value}),className:`w-full px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r.text} mb-1`,children:"Reason"}),i.jsx("textarea",{value:D.reason,onChange:F=>I({...D,reason:F.target.value}),className:`w-full px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,rows:"3",required:!0})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{type:"button",onClick:()=>x(!1),className:`px-4 py-2 border ${r.border} rounded-lg ${r.textSecondary} ${r.hover}`,children:"Cancel"}),i.jsx("button",{type:"submit",className:`px-4 py-2 ${r.primary} text-white ${r.primaryHover} rounded-lg`,children:"Submit Request"})]})]})]})]})}),g&&i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[i.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>b(!1)}),i.jsxs("div",{className:`relative ${r.surface} rounded-lg max-w-md w-full p-6`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:`text-lg font-semibold ${r.text}`,children:"Reject Leave Request"}),i.jsx("button",{onClick:()=>b(!1),className:`${r.textSecondary} hover:${r.text}`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${r.text} mb-1`,children:"Rejection Reason *"}),i.jsx("textarea",{value:S,onChange:F=>_(F.target.value),className:`w-full px-3 py-2 border ${r.border} rounded-lg ${r.surface} ${r.text}`,rows:"3",placeholder:"Please provide a reason for rejection...",required:!0})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{type:"button",onClick:()=>b(!1),className:`px-4 py-2 border ${r.border} rounded-lg ${r.textSecondary} ${r.hover}`,children:"Cancel"}),i.jsx("button",{onClick:E,disabled:!S.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject Request"})]})]})]})]})})]})}function Vie(){const{user:e}=pn(),{theme:t,colorScheme:r,currentTheme:n,currentColorScheme:a}=Lr(),{toggleMobileSidebar:s}=Mn(),[o,l]=J.useState(!0),[c,d]=J.useState("overview"),[u,h]=J.useState(new Date),[m,f]=J.useState([]),[x,g]=J.useState([]),[b,y]=J.useState([]),[N,S]=J.useState(null),[_,D]=J.useState([]),[I,O]=J.useState([]),[R,E]=J.useState([]),[B,C]=J.useState([]),[M,U]=J.useState([]),[F,ne]=J.useState([]),[V,ee]=J.useState(!1),[me,ye]=J.useState(!1),[Oe,xe]=J.useState(null),[w,A]=J.useState("present"),[T,L]=J.useState(null),[H,X]=J.useState([]),[re,ge]=J.useState(null),[oe,je]=J.useState([]),[Ie,et]=J.useState({subject:"",htmlContent:"",variables:{}}),[Te,Y]=J.useState(!1),[We,Q]=J.useState(!1),[ve,we]=J.useState({recipients:"all",subject:"",content:""}),[Re,He]=J.useState(null),[vt,le]=J.useState([]),[Ae,Qe]=J.useState(null),[_e,Ze]=J.useState(new Date().getMonth()+1),[Ve,ot]=J.useState(new Date().getFullYear()),[pt,yt]=J.useState(!1),[ir,ct]=J.useState(!1),[ut,Ot]=J.useState(null),[zt,Dt]=J.useState(null);e&&(e.role==="admin"||e.role),J.useEffect(()=>{Xt()},[u]);const Xt=async()=>{l(!0);try{await Promise.all([$t(),_r(),Fr(),ur(),Ft(),nr(),Rs(),Pn(),Qn()])}catch(G){console.error("Error fetching HR data:",G)}finally{l(!1)}},$t=async()=>{try{const G=await it.get("/users");f(G.data.users||[])}catch(G){console.error("Error fetching users:",G)}},_r=async()=>{try{const G=new Date,Be=(await it.get("/hr/attendance",{params:{month:G.getMonth()+1,year:G.getFullYear()}})).data.records.filter(tt=>new Date(tt.date).toDateString()===G.toDateString());y(Be)}catch(G){console.error("Error fetching today attendance:",G)}},Fr=async()=>{try{const G=await it.get("/hr/attendance/summary",{params:{month:u.getMonth()+1,year:u.getFullYear()}});S(G.data.summary)}catch(G){console.error("Error fetching summary:",G)}},ur=async()=>{try{const G=await it.get("/hr/attendance",{params:{month:u.getMonth()+1,year:u.getFullYear()}});D(G.data.records)}catch(G){console.error("Error fetching monthly attendance:",G)}},Ft=async()=>{try{const G=await it.get("/hr/leaves");O(G.data.requests||[])}catch(G){console.error("Error fetching leave requests:",G)}},nr=async()=>{try{const G=await it.get("/hr/leave-types");C(G.data.leaveTypes||[])}catch(G){console.error("Error fetching leave types:",G)}},Rs=async()=>{var G;try{const ke=await it.get("/hr/calendar",{params:{month:u.getMonth()+1,year:u.getFullYear()}});ne(ke.data.events||[]),U(((G=ke.data.events)==null?void 0:G.filter(Be=>Be.type==="holiday"))||[])}catch(ke){console.error("Error fetching calendar:",ke)}},an=G=>{const ke=b.find(Be=>{var tt;return((tt=Be.userId)==null?void 0:tt._id)===G||Be.userId===G});return ke?ke.status==="present"?{status:"Present",icon:da,color:"text-green-600 dark:text-green-400",record:ke}:ke.status==="absent"?{status:"Absent",icon:Yo,color:"text-red-600 dark:text-red-400",record:ke}:ke.status==="half_day"?{status:"Half Day",icon:Ss,color:"text-yellow-600 dark:text-yellow-400",record:ke}:ke.status==="leave"?{status:"Leave",icon:Gn,color:"text-blue-600 dark:text-blue-400",record:ke}:{status:"Not Marked",icon:Ss,color:"text-gray-400"}:{status:"not-marked",icon:Ss,color:"text-gray-400"}},Zn=async(G,ke)=>{var Be,tt;try{await it.post("/hr/attendance/mark",{userId:G,date:new Date().toISOString().split("T")[0],status:ke}),_r(),Fr(),alert("Attendance marked successfully!")}catch(Xe){alert(((tt=(Be=Xe.response)==null?void 0:Be.data)==null?void 0:tt.message)||"Failed to mark attendance")}},ka=async()=>{if(x.length===0){alert("Please select at least one user");return}try{const G=x.map(ke=>it.post("/hr/attendance/mark",{userId:ke,date:new Date().toISOString().split("T")[0],status:w}));await Promise.all(G),g([]),_r(),Fr(),alert(`Mass attendance marked as ${w} for ${x.length} users!`)}catch{alert("Failed to mark mass attendance")}},Lt=G=>{g(ke=>ke.includes(G)?ke.filter(Be=>Be!==G):[...ke,G])},Ua=()=>{x.length===m.length?g([]):g(m.map(G=>G._id))},Wa=()=>{try{let G="HR Report - "+new Date().toLocaleDateString()+`

`;G+=`ATTENDANCE SUMMARY
`,G+=`Month,Present,Absent,Half Day,Leave,Holidays
`,N&&(G+=`${u.toLocaleDateString("en-US",{month:"long",year:"numeric"})},${N.present||0},${N.absent||0},${N.half_day||0},${N.leave||0},${N.holidays||0}
`),G+=`
`,G+=`LEAVE REQUESTS
`,G+=`Employee,Type,Start Date,End Date,Days,Status
`,I.forEach(Xe=>{var rt,Nt;G+=`${((rt=Xe.userId)==null?void 0:rt.full_name)||"Unknown"},${((Nt=Xe.leaveTypeId)==null?void 0:Nt.name)||"Unknown"},${Xe.startDate},${Xe.endDate},${Xe.days},${Xe.status}
`}),G+=`
`,G+=`TODAY'S ATTENDANCE
`,G+=`Employee,Status,Check In,Check Out
`,b.forEach(Xe=>{var rt;G+=`${((rt=Xe.userId)==null?void 0:rt.full_name)||"Unknown"},${Xe.status},${Xe.checkIn||""},${Xe.checkOut||""}
`});const ke=new Blob([G],{type:"text/csv;charset=utf-8;"}),Be=document.createElement("a"),tt=URL.createObjectURL(ke);Be.setAttribute("href",tt),Be.setAttribute("download",`hr-report-${new Date().toISOString().split("T")[0]}.csv`),Be.style.visibility="hidden",document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),alert("HR Report exported successfully!")}catch(G){console.error("Export error:",G),alert("Failed to export report")}},Pn=async()=>{try{const G=await it.get("/hr/email-templates/config");L(G.data.config)}catch(G){console.error("Error fetching email config:",G)}},Qn=async()=>{try{console.log("Fetching email templates...");const G=await it.get("/hr/email-templates");console.log("Templates response:",G.data),X(G.data.templates||[]),console.log("Templates set:",G.data.templates||[])}catch(G){console.error("Error fetching email templates:",G)}},Cr=async()=>{var G,ke;if(!ve.subject||!ve.content){alert("Please enter subject and content");return}try{const Be=await it.post("/hr/email-templates/send",{recipients:ve.recipients,subject:ve.subject,htmlContent:ve.content});alert(Be.data.message),we({recipients:"all",subject:"",content:""})}catch(Be){alert(((ke=(G=Be.response)==null?void 0:G.data)==null?void 0:ke.message)||"Failed to send emails")}},Gr=G=>{ge(G);const ke={};G.variables&&G.variables.forEach(Be=>{switch(Be.name){case"workspaceName":ke[Be.name]="TaskFlow";break;case"appUrl":ke[Be.name]=window.location.origin;break;case"currentDate":ke[Be.name]=new Date().toLocaleDateString();break;default:ke[Be.name]=Be.example||""}}),et({subject:G.subject,htmlContent:G.htmlContent,variables:ke})},q=G=>{je(ke=>ke.includes(G)?ke.filter(Be=>Be!==G):[...ke,G])},ce=async()=>{var G,ke;if(!re){alert("Please select a template");return}if(oe.length===0){alert("Please select at least one recipient");return}if(!Ie.subject.trim()){alert("Please enter a subject");return}try{let Be=0,tt=0;for(const Xe of oe){const rt=m.find(Ht=>Ht._id===Xe);if(!(rt!=null&&rt.email)){console.warn(`Skipping user ${Xe}: no email address`),tt++;continue}let Nt=Ie.htmlContent,Zt=Ie.subject;Object.entries(Ie.variables).forEach(([Ht,$r])=>{const za=new RegExp(`{{${Ht}}}`,"g");Nt=Nt.replace(za,$r),Zt=Zt.replace(za,$r)}),Nt=Nt.replace(/{{fullName}}/g,rt.full_name),Nt=Nt.replace(/{{email}}/g,rt.email),Zt=Zt.replace(/{{fullName}}/g,rt.full_name),Zt=Zt.replace(/{{email}}/g,rt.email);try{const Ht=await it.post("/hr/email-templates/send",{recipients:[rt.email],subject:Zt,htmlContent:Nt,templateId:re._id});Be++,console.log(`Email sent to ${rt.email}`)}catch(Ht){console.error(`Failed to send email to ${rt.email}:`,Ht),tt++}}Be>0?alert(`Emails sent successfully! ${Be} sent, ${tt} failed.`):alert("Failed to send any emails. Please check the console for details."),Be>0&&(je([]),ge(null),et({subject:"",htmlContent:"",variables:{}}))}catch(Be){alert(((ke=(G=Be.response)==null?void 0:G.data)==null?void 0:ke.message)||"Failed to send emails")}},ae=()=>{var ke;if(!((ke=re==null?void 0:re.variables)!=null&&ke.length))return null;const G=["workspaceName","appUrl","currentDate"];return i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:`text-sm font-medium ${n.text} mb-2`,children:"Template Variables"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:re.variables.map((Be,tt)=>{const Xe=G.includes(Be.name),rt=["fullName","email"].includes(Be.name);return i.jsxs("div",{children:[i.jsxs("label",{className:`block text-xs font-medium ${n.textSecondary} mb-1`,children:[Be.name,Be.description&&i.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",Be.description,")"]}),Xe&&i.jsx("span",{className:"inline-block ml-2 px-1.5 py-0.5 text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded",children:"Auto-filled"}),rt&&i.jsx("span",{className:"inline-block ml-2 px-1.5 py-0.5 text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded",children:"Per Recipient"})]}),i.jsx("input",{type:"text",placeholder:Be.example||`Enter ${Be.name}`,value:Ie.variables[Be.name]||"",onChange:Nt=>et(Zt=>({...Zt,variables:{...Zt.variables,[Be.name]:Nt.target.value}})),disabled:Xe,className:`w-full px-3 py-2 text-sm ${n.surfaceSecondary} rounded border ${n.border} ${n.text} focus:ring-2 ${n.focus} ${Xe?"bg-gray-100 dark:bg-gray-800 cursor-not-allowed opacity-75":""}`}),rt&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Will be personalized for each recipient"})]},tt)})})]})},ie=()=>{let G=Ie.htmlContent,ke=Ie.subject;if(Object.entries(Ie.variables).forEach(([Be,tt])=>{if(tt){const Xe=new RegExp(`{{${Be}}}`,"g");G=G.replace(Xe,tt),ke=ke.replace(Xe,tt)}}),oe.length>0){const Be=m.find(tt=>tt._id===oe[0]);Be&&(G=G.replace(/{{fullName}}/g,Be.full_name),G=G.replace(/{{email}}/g,Be.email),ke=ke.replace(/{{fullName}}/g,Be.full_name),ke=ke.replace(/{{email}}/g,Be.email))}return{html:G,subject:ke}},de=()=>We?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`${n.surface} rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden`,children:[i.jsxs("div",{className:`px-6 py-4 border-b ${n.border} flex items-center justify-between`,children:[i.jsxs("h3",{className:`text-lg font-semibold ${n.text} flex items-center gap-2`,children:[i.jsx(js,{className:"w-5 h-5"}),"Email Preview"]}),i.jsx("button",{onClick:()=>Q(!1),className:`p-2 ${n.surfaceSecondary} rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),i.jsx("div",{className:`px-3 py-2 ${n.surfaceSecondary} rounded border ${n.border} ${n.text}`,children:ie().subject||"No subject set"})]}),i.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-2 border-b",children:i.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email Content Preview"})}),i.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:i.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:ie().html}})})]})]}),i.jsxs("div",{className:`px-6 py-4 border-t ${n.border} flex justify-end gap-3`,children:[i.jsx("button",{onClick:()=>Q(!1),className:`px-4 py-2 ${n.surfaceSecondary} ${n.text} rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700`,children:"Close Preview"}),i.jsxs("button",{onClick:()=>{Q(!1),ce()},className:`px-6 py-2 ${a.primary} text-white ${a.primaryHover} rounded-lg flex items-center gap-2`,children:[i.jsx(Cp,{className:"w-4 h-4"}),"Send Email"]})]})]})}):null,pe=async G=>{if(G)try{const ke=await it.get("/hr/attendance",{params:{userId:G,month:_e,year:Ve}});le(ke.data.records||[]);const Be=ke.data.records||[],tt={totalDays:Be.length,present:Be.filter(rt=>rt.status==="present").length,absent:Be.filter(rt=>rt.status==="absent").length,halfDay:Be.filter(rt=>rt.status==="half_day").length,leave:Be.filter(rt=>rt.status==="leave").length,attendanceRate:0},Xe=tt.present+tt.halfDay+tt.leave;tt.attendanceRate=tt.totalDays>0?Math.round(Xe/tt.totalDays*100):0,Qe(tt)}catch(ke){console.error("Error fetching user attendance:",ke),le([]),Qe(null)}},Pe=G=>{He(G),pe(G._id)},ze=G=>({present:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",absent:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",half_day:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",leave:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",holiday:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",approved:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",rejected:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",ACTIVE:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",INACTIVE:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",ON_NOTICE:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",EXITED:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"})[G]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",Le=(G,ke)=>{Dt(G),Ot(ke),ct(!0)},Fe=async()=>{try{console.log(`${ut} employee:`,zt.full_name),ct(!1),Dt(null),Ot(null),$t()}catch(G){console.error("Employee action error:",G)}};return o?i.jsx("div",{className:`min-h-screen ${n.background} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center",children:[i.jsx(Zc,{className:"w-16 h-16 text-blue-600 dark:text-blue-400 animate-spin mx-auto mb-4"}),i.jsx("p",{className:n.textSecondary,children:"Loading HR Dashboard..."})]})}):i.jsxs(i.Fragment,{children:[i.jsxs(uf,{title:"HR Dashboard",subtitle:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),actions:i.jsxs("button",{onClick:Wa,className:`px-4 py-2 ${a.primary} text-white rounded-lg ${a.primaryHover} flex items-center gap-2`,children:[i.jsx(Yx,{className:"w-5 h-5"}),"Export Report"]}),children:[i.jsx("div",{className:"flex gap-4 mb-6 overflow-x-auto",children:["overview","attendance","calendar","users","email"].map(G=>i.jsx("button",{onClick:()=>d(G),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap ${c===G?`${a.primary} text-white`:`${n.textSecondary} ${n.hover}`}`,children:G.charAt(0).toUpperCase()+G.slice(1)},G))}),i.jsxs("div",{children:[c==="overview"&&i.jsxs("div",{className:"space-y-6",children:[N&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Total Users"}),i.jsx("p",{className:`text-3xl font-bold ${n.text}`,children:m.length})]}),i.jsx(ks,{className:`w-10 h-10 ${a.primaryText}`})]})}),i.jsx("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Present Today"}),i.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:N.present||0})]}),i.jsx(da,{className:"w-10 h-10 text-green-600 dark:text-green-400"})]})}),i.jsx("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Absent Today"}),i.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:N.absent||0})]}),i.jsx(Yo,{className:"w-10 h-10 text-red-600 dark:text-red-400"})]})}),i.jsx("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"On Leave"}),i.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:N.leave||0})]}),i.jsx(Gn,{className:"w-10 h-10 text-blue-600 dark:text-blue-400"})]})})]}),i.jsxs("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:[i.jsx("h2",{className:`text-xl font-bold ${n.text} mb-4`,children:"Quick Actions"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("button",{onClick:()=>d("attendance"),className:`p-4 ${n.surfaceSecondary} rounded-lg ${n.hover} transition-colors border ${n.border}`,children:[i.jsx(Wv,{className:`w-8 h-8 ${a.success.replace("bg-","text-").replace("-500","-600")} mb-2`}),i.jsx("p",{className:`font-medium ${n.text}`,children:"Mark Attendance"}),i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Mark today's attendance"})]}),i.jsxs("button",{onClick:()=>d("calendar"),className:`p-4 ${n.surfaceSecondary} rounded-lg ${n.hover} transition-colors border ${n.border}`,children:[i.jsx(TT,{className:"w-8 h-8 text-purple-600 mb-2"}),i.jsx("p",{className:`font-medium ${n.text}`,children:"View Calendar"}),i.jsxs("p",{className:`text-sm ${n.textSecondary}`,children:[M.length," upcoming holidays"]})]}),i.jsxs("button",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg hover:bg-orange-100 dark:hover:bg-orange-900/30 transition-colors",children:[i.jsx(Qc,{className:"w-8 h-8 text-orange-600 mb-2"}),i.jsx("p",{className:`font-medium ${n.text}`,children:"Generate Report"}),i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Export attendance data"})]})]})]}),i.jsxs("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:`text-xl font-bold ${n.text}`,children:"User Directory"}),i.jsx("button",{onClick:()=>d("attendance"),className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 text-sm font-medium",children:"View Attendance"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.slice(0,9).map(G=>{var Be,tt;const ke=an(G._id);return i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:(Be=G.full_name)==null?void 0:Be.charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("h3",{className:`font-semibold ${n.text} text-sm`,children:G.full_name}),i.jsx("p",{className:`text-xs ${n.textSecondary}`,children:G.email})]})]}),i.jsx(ke.icon,{className:`w-5 h-5 ${ke.color}`})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${ze(((tt=ke.record)==null?void 0:tt.status)||"not-marked")}`,children:ke.status}),i.jsx("button",{onClick:()=>window.open(`mailto:${G.email}`,"_blank"),className:`p-1.5 ${a.primaryText} hover:opacity-80 ${n.hover} rounded`,title:"Send Email",children:i.jsx(a0,{className:"w-4 h-4"})})]})]},G._id)})}),m.length>9&&i.jsx("div",{className:"text-center mt-4",children:i.jsxs("button",{onClick:()=>d("attendance"),className:`text-sm ${n.textSecondary} hover:${n.text} underline`,children:["View all ",m.length," users"]})})]})]}),c==="attendance"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:`text-xl font-bold ${n.text}`,children:"Mass Attendance"}),i.jsxs("p",{className:`text-sm ${n.textSecondary}`,children:[x.length," user(s) selected"]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:Ua,className:`px-4 py-2 ${n.surfaceSecondary} ${n.text} rounded-lg ${n.hover}`,children:x.length===m.length?"Deselect All":"Select All"}),i.jsxs("select",{value:w,onChange:G=>A(G.target.value),className:`px-4 py-2 border ${n.border} rounded-lg ${n.surface} ${n.text}`,children:[i.jsx("option",{value:"present",children:"Present"}),i.jsx("option",{value:"absent",children:"Absent"}),i.jsx("option",{value:"half_day",children:"Half Day"}),i.jsx("option",{value:"leave",children:"Leave"})]}),i.jsxs("button",{onClick:ka,disabled:x.length===0,className:`px-6 py-2 ${a.primary} text-white rounded-lg ${a.primaryHover} disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2`,children:[i.jsx(da,{className:"w-5 h-5"}),"Mark Selected"]})]})]})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:m.map(G=>{var Xe,rt,Nt;const ke=an(G._id),Be=x.includes(G._id),tt=ke.icon;return i.jsx("div",{className:`${n.surface} rounded-lg border-2 transition-all ${Be?"border-blue-500 shadow-lg":`${n.border} hover:border-blue-300 dark:hover:border-blue-700`}`,children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:Be,onChange:()=>Lt(G._id),className:`w-5 h-5 ${a.primaryText} rounded focus:ring-2 ${n.focus}`}),i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:(Xe=G.full_name)==null?void 0:Xe.charAt(0).toUpperCase()})]}),i.jsx(tt,{className:`w-6 h-6 ${ke.color}`})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:`font-semibold ${n.text} text-lg mb-1`,children:G.full_name}),i.jsx("p",{className:`text-sm ${n.textSecondary} mb-1`,children:G.email}),i.jsx("p",{className:`text-xs ${n.textMuted}`,children:(rt=G.role)==null?void 0:rt.toUpperCase()})]}),i.jsx("div",{className:`mb-4 p-3 rounded-lg text-center font-medium ${ze(((Nt=ke.record)==null?void 0:Nt.status)||"not-marked")}`,children:ke.status}),ke.record&&i.jsxs("div",{className:"mb-4 text-sm space-y-1",children:[ke.record.checkIn&&i.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[i.jsx("span",{children:"Check In:"}),i.jsx("span",{className:"font-medium",children:new Date(ke.record.checkIn).toLocaleTimeString()})]}),ke.record.checkOut&&i.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[i.jsx("span",{children:"Check Out:"}),i.jsx("span",{className:"font-medium",children:new Date(ke.record.checkOut).toLocaleTimeString()})]}),ke.record.workingHours>0&&i.jsxs("div",{className:"flex justify-between text-gray-600 dark:text-gray-400",children:[i.jsx("span",{children:"Hours:"}),i.jsxs("span",{className:"font-medium",children:[ke.record.workingHours.toFixed(2),"h"]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{onClick:()=>Zn(G._id,"present"),className:"px-3 py-2 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-lg hover:bg-green-200 dark:hover:bg-green-800 text-sm font-medium",children:"Present"}),i.jsx("button",{onClick:()=>Zn(G._id,"absent"),className:"px-3 py-2 bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 rounded-lg hover:bg-red-200 dark:hover:bg-red-800 text-sm font-medium",children:"Absent"}),i.jsx("button",{onClick:()=>Zn(G._id,"half_day"),className:"px-3 py-2 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-lg hover:bg-yellow-200 dark:hover:bg-yellow-800 text-sm font-medium",children:"Half Day"}),i.jsx("button",{onClick:()=>Zn(G._id,"leave"),className:"px-3 py-2 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800 text-sm font-medium",children:"Leave"})]})]})},G._id)})})]}),c==="calendar"&&i.jsx(e6,{embedded:!0}),c==="users"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:[i.jsx("h2",{className:`text-xl font-bold ${n.text} mb-4`,children:"Individual User Attendance Tracking"}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:"Select User"}),i.jsx("button",{onClick:()=>yt(!pt),className:`flex items-center gap-2 px-3 py-2 ${n.surfaceSecondary} rounded-lg ${n.hover} transition-colors`,children:pt?i.jsxs(i.Fragment,{children:[i.jsx(qx,{className:"w-4 h-4"}),i.jsxs("span",{className:"text-sm",children:["Show Users (",m.length,")"]})]}):i.jsxs(i.Fragment,{children:[i.jsx(Hx,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm",children:"Hide Users"})]})})]}),!pt&&i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(G=>i.jsx("div",{onClick:()=>Pe(G),className:`p-4 ${n.surfaceSecondary} rounded-lg border cursor-pointer transition-all ${(Re==null?void 0:Re._id)===G._id?`border-blue-500 ${a.primaryLight} dark:bg-blue-900/20`:`${n.border} ${n.hover}`}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-10 h-10 rounded-full ${n.surface} flex items-center justify-center border ${n.border}`,children:i.jsx(ji,{className:`w-6 h-6 ${a.primaryText}`})}),i.jsxs("div",{children:[i.jsx("p",{className:`font-medium ${n.text}`,children:G.full_name}),i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:G.email})]})]})},G._id))})]}),Re&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:`text-lg font-semibold ${n.text}`,children:["Attendance Overview - ",Re.full_name]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("select",{value:_e,onChange:G=>{Ze(parseInt(G.target.value)),setTimeout(()=>pe(Re._id),100)},className:`px-3 py-2 ${n.surfaceSecondary} rounded-lg border ${n.border} ${n.text} focus:ring-2 ${n.focus}`,children:Array.from({length:12},(G,ke)=>i.jsx("option",{value:ke+1,children:new Date(2024,ke).toLocaleDateString("en-US",{month:"long"})},ke+1))}),i.jsx("select",{value:Ve,onChange:G=>{ot(parseInt(G.target.value)),setTimeout(()=>pe(Re._id),100)},className:`px-3 py-2 ${n.surfaceSecondary} rounded-lg border ${n.border} ${n.text} focus:ring-2 ${n.focus}`,children:[2024,2025,2026].map(G=>i.jsx("option",{value:G,children:G},G))})]})]}),Ae&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Total Days"}),i.jsx("p",{className:`text-2xl font-bold ${n.text}`,children:Ae.totalDays})]}),i.jsx(Gn,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})]})}),i.jsx("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:Ae.present})]}),i.jsx(da,{className:"w-8 h-8 text-green-600 dark:text-green-400"})]})}),i.jsx("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:Ae.absent})]}),i.jsx(Yo,{className:"w-8 h-8 text-red-600 dark:text-red-400"})]})}),i.jsx("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Attendance Rate"}),i.jsxs("p",{className:`text-2xl font-bold ${Ae.attendanceRate>=80?"text-green-600 dark:text-green-400":Ae.attendanceRate>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[Ae.attendanceRate,"%"]})]}),i.jsx(Qc,{className:`w-8 h-8 ${Ae.attendanceRate>=80?"text-green-600 dark:text-green-400":Ae.attendanceRate>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`})]})})]}),i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg border ${n.border}`,children:[i.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:i.jsx("h4",{className:`font-semibold ${n.text}`,children:"Daily Attendance History"})}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:vt.length>0?i.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:vt.map(G=>i.jsxs("div",{className:"p-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${G.status==="present"?"bg-green-600 dark:bg-green-400":G.status==="absent"?"bg-red-600 dark:bg-red-400":G.status==="half_day"?"bg-yellow-600 dark:bg-yellow-400":G.status==="leave"?"bg-blue-600 dark:bg-blue-400":"bg-gray-600 dark:bg-gray-400"}`}),i.jsxs("div",{children:[i.jsx("p",{className:`font-medium ${n.text}`,children:new Date(G.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),i.jsxs("p",{className:`text-sm ${n.textSecondary}`,children:["Status: ",G.status.replace("_"," ").toUpperCase()]})]})]}),i.jsxs("div",{className:"text-right",children:[G.checkIn&&i.jsxs("p",{className:`text-sm ${n.textSecondary}`,children:["Check-in: ",new Date(G.checkIn).toLocaleTimeString()]}),G.checkOut&&i.jsxs("p",{className:`text-sm ${n.textSecondary}`,children:["Check-out: ",new Date(G.checkOut).toLocaleTimeString()]}),G.workingHours&&i.jsxs("p",{className:`text-sm font-medium ${n.text}`,children:[G.workingHours," hours"]})]})]},G._id))}):i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("p",{className:`text-lg ${n.textSecondary}`,children:"No attendance records found"}),i.jsxs("p",{className:`text-sm ${n.textSecondary} mt-2`,children:["No attendance data available for ",Re.full_name," in ",new Date(Ve,_e-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]})})]})]})})]})}),c==="email"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:`${n.surface} rounded-lg p-6 border ${n.border}`,children:[i.jsx("h2",{className:`text-xl font-bold ${n.text} mb-4`,children:"Email Management"}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:`text-lg font-semibold ${n.text} mb-3`,children:"Brevo Configuration"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-2`,children:"API Key Status"}),i.jsx("div",{className:`px-3 py-2 ${n.surfaceSecondary} rounded-lg border ${n.border}`,children:i.jsx("span",{className:`text-sm ${T!=null&&T.brevoConfigured?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:T!=null&&T.brevoConfigured?"âœ“ Configured":"âœ— Not Configured"})})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-2`,children:"Sender Email"}),i.jsx("div",{className:`px-3 py-2 ${n.surfaceSecondary} rounded-lg border ${n.border}`,children:i.jsx("span",{className:"text-sm",children:(T==null?void 0:T.senderEmail)||"Loading..."})})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg border ${n.border} p-4`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:`text-sm font-medium ${n.text}`,children:"Email Campaign Progress"}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Step ",re?oe.length>0?"3":"2":"1"," of 3"]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:`flex-1 h-2 rounded-full ${re?"bg-blue-500":"bg-gray-200 dark:bg-gray-700"}`}),i.jsx("div",{className:`flex-1 h-2 rounded-full ${oe.length>0?"bg-blue-500":"bg-gray-200 dark:bg-gray-700"}`}),i.jsx("div",{className:`flex-1 h-2 rounded-full ${re&&oe.length>0?"bg-blue-500":"bg-gray-200 dark:bg-gray-700"}`})]}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[i.jsx("span",{className:re?"text-blue-600":"",children:"Template"}),i.jsx("span",{className:oe.length>0?"text-blue-600":"",children:"Recipients"}),i.jsx("span",{className:re&&oe.length>0?"text-blue-600":"",children:"Send"})]})]}),i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg border ${n.border} p-6`,children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:`w-8 h-8 ${a.primary} text-white rounded-full flex items-center justify-center text-sm font-bold mr-3`,children:"1"}),i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:"Choose Email Template"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(G=>i.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md ${(re==null?void 0:re._id)===G._id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":`${n.border} ${n.surface} hover:border-gray-300`}`,onClick:()=>Gr(G),children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${G.category==="leave"?"bg-blue-100 text-blue-600":G.category==="attendance"?"bg-orange-100 text-orange-600":G.category==="system"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:G.category==="leave"?i.jsx(Gn,{className:"w-4 h-4"}):G.category==="attendance"?i.jsx(Zc,{className:"w-4 h-4"}):G.category==="system"?i.jsx(ji,{className:"w-4 h-4"}):i.jsx(Su,{className:"w-4 h-4"})}),i.jsxs("div",{children:[i.jsx("h4",{className:`font-medium ${n.text} mb-1`,children:G.name}),i.jsx("p",{className:`text-xs ${n.textSecondary} capitalize`,children:G.category})]})]}),(re==null?void 0:re._id)===G._id&&i.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:i.jsx(da,{className:"w-3 h-3 text-white"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[G.isPredefined&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-full",children:[i.jsx(n0,{className:"w-3 h-3"}),"Predefined"]}),G.variables&&G.variables.length>0&&i.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-gray-500",children:[i.jsx(Hl,{className:"w-3 h-3"}),G.variables.length," fields"]})]})]},G._id))})]}),re&&i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg border ${n.border} p-6`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`w-8 h-8 ${a.primary} text-white rounded-full flex items-center justify-center text-sm font-bold mr-3`,children:"2"}),i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:"Select Recipients"})]}),i.jsxs("div",{className:`px-3 py-1 ${a.primary} text-white rounded-full text-sm`,children:[oe.length," selected"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[i.jsxs("button",{onClick:()=>je(m.map(G=>G._id)),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg text-sm transition-colors",children:[i.jsx(n0,{className:"w-4 h-4"}),"Select All"]}),i.jsxs("button",{onClick:()=>je([]),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg text-sm transition-colors",children:[i.jsx(kr,{className:"w-4 h-4"}),"Clear All"]}),i.jsxs("button",{onClick:()=>je(m.filter(G=>G.employmentStatus==="ACTIVE").map(G=>G._id)),className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 hover:bg-green-200 dark:bg-green-900/30 dark:hover:bg-green-900/50 text-green-700 dark:text-green-300 rounded-lg text-sm transition-colors",children:[i.jsx(Wv,{className:"w-4 h-4"}),"Active Only"]})]}),i.jsx("div",{className:`max-h-80 overflow-y-auto ${n.surface} rounded-lg border ${n.border} p-4`,children:i.jsx("div",{className:"space-y-3",children:m.map(G=>{var ke;return i.jsxs("label",{className:`flex items-center p-3 rounded-lg cursor-pointer transition-colors ${oe.includes(G._id)?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[i.jsx("input",{type:"checkbox",checked:oe.includes(G._id),onChange:()=>q(G._id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 mr-3"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:`font-medium ${n.text} truncate`,children:G.full_name}),i.jsx("div",{className:`text-sm ${n.textSecondary} truncate`,children:G.email})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${G.employmentStatus==="ACTIVE"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:G.employmentStatus||"ACTIVE"}),i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${G.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":G.role==="hr"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:((ke=G.role)==null?void 0:ke.toUpperCase())||"USER"})]})]},G._id)})})})]}),re&&oe.length>0&&i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg border ${n.border} p-6`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:`w-8 h-8 ${a.primary} text-white rounded-full flex items-center justify-center text-sm font-bold mr-3`,children:"3"}),i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:"Customize & Send"})]}),i.jsxs("div",{className:"space-y-6",children:[ae(),i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium ${n.textSecondary} mb-2`,children:"Email Subject"}),i.jsx("input",{type:"text",value:Ie.subject,onChange:G=>et(ke=>({...ke,subject:G.target.value})),className:`w-full px-4 py-3 ${n.surface} rounded-lg border ${n.border} ${n.text} focus:ring-2 ${n.focus} text-sm`,placeholder:"Enter email subject..."})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("label",{className:`block text-sm font-medium ${n.textSecondary}`,children:"Email Content"}),i.jsx("div",{className:"flex gap-2",children:i.jsx("button",{onClick:()=>Y(!Te),className:`px-3 py-1 text-sm rounded ${Te?`${a.primary} text-white`:"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300"} transition-colors`,children:Te?"Rich Text":"HTML"})})]}),Te?i.jsx("textarea",{rows:"15",value:Ie.htmlContent,onChange:G=>et(ke=>({...ke,htmlContent:G.target.value})),className:`w-full px-4 py-3 font-mono text-sm ${n.surface} rounded-lg border ${n.border} ${n.text} focus:ring-2 ${n.focus}`,placeholder:"<html>Enter your HTML content here...</html>"}):i.jsx("div",{contentEditable:!0,dangerouslySetInnerHTML:{__html:Ie.htmlContent},onInput:G=>et(ke=>({...ke,htmlContent:G.target.innerHTML})),className:`w-full px-4 py-3 min-h-[300px] ${n.surface} rounded-lg border ${n.border} ${n.text} focus:ring-2 ${n.focus} prose prose-sm max-w-none overflow-y-auto`,style:{whiteSpace:"pre-wrap"}})]}),i.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[i.jsx(js,{className:"w-4 h-4"}),"Campaign Summary"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Su,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Template:"}),i.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:re==null?void 0:re.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ks,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Recipients:"}),i.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:oe.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Cp,{className:"w-4 h-4 text-purple-500"}),i.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subject:"}),i.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:ie().subject||"Not set"})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ready to send email campaign"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>Q(!0),className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg flex items-center gap-2 font-medium transition-all",children:[i.jsx(js,{className:"w-5 h-5"}),"Preview"]}),i.jsxs("button",{onClick:ce,className:`px-8 py-3 ${a.primary} text-white ${a.primaryHover} rounded-lg flex items-center gap-2 font-medium shadow-lg hover:shadow-xl transition-all`,children:[i.jsx(Cp,{className:"w-5 h-5"}),"Send Email Campaign"]})]})]})]})]})]}),i.jsxs("div",{className:"border-t pt-6 mt-8",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:"Quick Send"}),i.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:"Legacy"})]}),i.jsxs("div",{className:`p-4 ${n.surfaceSecondary} rounded-lg border ${n.border}`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs font-medium ${n.textSecondary} mb-1`,children:"Recipients"}),i.jsxs("select",{value:ve.recipients,onChange:G=>we({...ve,recipients:G.target.value}),className:`w-full px-3 py-2 text-sm ${n.surface} rounded border ${n.border} ${n.text} focus:ring-2 ${n.focus}`,children:[i.jsx("option",{value:"all",children:"All Users"}),i.jsx("option",{value:"active",children:"Active Users"}),i.jsx("option",{value:"hr",children:"HR Team"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:`block text-xs font-medium ${n.textSecondary} mb-1`,children:"Subject"}),i.jsx("input",{type:"text",placeholder:"Quick email subject",value:ve.subject,onChange:G=>we({...ve,subject:G.target.value}),className:`w-full px-3 py-2 text-sm ${n.surface} rounded border ${n.border} ${n.text} focus:ring-2 ${n.focus}`})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:`block text-xs font-medium ${n.textSecondary} mb-1`,children:"Message"}),i.jsx("textarea",{rows:"3",placeholder:"Quick email content",value:ve.content,onChange:G=>we({...ve,content:G.target.value}),className:`w-full px-3 py-2 text-sm ${n.surface} rounded border ${n.border} ${n.text} focus:ring-2 ${n.focus}`})]}),i.jsxs("button",{onClick:Cr,className:`px-4 py-2 ${a.primary} text-white ${a.primaryHover} rounded-lg text-sm flex items-center gap-2`,children:[i.jsx(a0,{className:"w-4 h-4"}),"Send Quick Email"]})]})]})]})}),c==="users"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:`${n.surface} rounded-lg border ${n.border} overflow-hidden`,children:[i.jsxs("div",{className:`px-6 py-4 border-b ${n.border}`,children:[i.jsx("h2",{className:`text-lg font-semibold ${n.text}`,children:"Employee Management"}),i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:"Manage employee employment status and lifecycle"})]}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(G=>i.jsxs("div",{className:`${n.surfaceSecondary} rounded-lg p-4 border ${n.border}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:`font-medium ${n.text}`,children:G.full_name}),i.jsx("p",{className:`text-sm ${n.textSecondary}`,children:G.email})]}),i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ze(G.employmentStatus||"ACTIVE")}`,children:G.employmentStatus||"ACTIVE"})]}),i.jsxs("div",{className:"flex gap-2",children:[G.employmentStatus!=="ACTIVE"&&i.jsx("button",{onClick:()=>Le(G,"activate"),className:"flex-1 px-3 py-2 bg-green-600 text-white text-xs rounded hover:bg-green-700 transition-colors",children:"Activate"}),G.employmentStatus==="ACTIVE"&&i.jsx("button",{onClick:()=>Le(G,"deactivate"),className:"flex-1 px-3 py-2 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors",children:"Deactivate"})]})]},G._id))})})]})})]})]}),ir&&i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[i.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>ct(!1)}),i.jsxs("div",{className:`relative ${n.surface} rounded-lg max-w-md w-full p-6`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:`text-lg font-semibold ${n.text}`,children:ut==="activate"?"Activate Employee":"Deactivate Employee"}),i.jsx("button",{onClick:()=>ct(!1),className:`${n.textSecondary} hover:${n.text}`,children:i.jsx(kr,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:n.text,children:["Are you sure you want to ",ut," ",i.jsx("strong",{children:zt==null?void 0:zt.full_name}),"?"]}),ut==="deactivate"&&i.jsx("p",{className:"text-red-600 dark:text-red-400 mt-2",children:"This action cannot be undone and will prevent the employee from receiving emails."}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>ct(!1),className:`px-4 py-2 border ${n.border} rounded-lg ${n.textSecondary} ${n.hover}`,children:"Cancel"}),i.jsx("button",{onClick:Fe,className:`px-4 py-2 ${ut==="activate"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} text-white rounded-lg`,children:ut==="activate"?"Activate":"Deactivate"})]})]})]})]})}),i.jsx(de,{})]})}function Gie(){return _T(),i.jsxs(W6,{children:[i.jsx(Hr,{path:"/",element:i.jsx(Die,{})}),i.jsx(Hr,{path:"/login",element:i.jsx(HT,{})}),i.jsx(Hr,{path:"/register",element:i.jsx(Hv,{})}),i.jsx(Hr,{path:"/register-community",element:i.jsx(Hv,{})}),i.jsx(Hr,{path:"/verify-email",element:i.jsx(qT,{})}),i.jsx(Hr,{path:"/forgot-password",element:i.jsx(YT,{})}),i.jsx(Hr,{path:"/reset-password",element:i.jsx(VT,{})}),i.jsx(Hr,{path:"/dashboard",element:i.jsx(na,{children:i.jsx(NR,{})})}),i.jsx(Hr,{path:"/tasks",element:i.jsx(na,{children:i.jsx(jR,{})})}),i.jsx(Hr,{path:"/kanban",element:i.jsx(na,{children:i.jsx(TR,{})})}),i.jsx(Hr,{path:"/teams",element:i.jsx(na,{allowedRoles:["admin","hr","team_lead","community_admin"],children:i.jsx(AR,{})})}),i.jsx(Hr,{path:"/hr/dashboard",element:i.jsx(na,{allowedRoles:["admin","hr"],children:i.jsx(Vie,{})})}),i.jsx(Hr,{path:"/hr/attendance",element:i.jsx(na,{allowedRoles:["admin","hr","team_lead","member"],children:i.jsx(Hie,{})})}),i.jsx(Hr,{path:"/hr/calendar",element:i.jsx(na,{allowedRoles:["admin","hr","team_lead","member"],children:i.jsx(e6,{})})}),i.jsx(Hr,{path:"/hr/leaves",element:i.jsx(na,{allowedRoles:["admin","hr","team_lead","member"],children:i.jsx(Yie,{})})}),i.jsx(Hr,{path:"/users",element:i.jsx(na,{allowedRoles:["admin","hr"],children:i.jsx(ER,{})})}),i.jsx(Hr,{path:"/community-users",element:i.jsx(na,{allowedRoles:["community_admin"],children:i.jsx(CR,{})})}),i.jsx(Hr,{path:"/workspaces",element:i.jsx(na,{allowedRoles:["admin"],children:i.jsx(DR,{})})}),i.jsx(Hr,{path:"/analytics",element:i.jsx(na,{children:i.jsx(OR,{})})}),i.jsx(Hr,{path:"/settings",element:i.jsx(na,{children:i.jsx(FR,{})})}),i.jsx(Hr,{path:"/calendar",element:i.jsx(na,{children:i.jsx(Aie,{})})}),i.jsx(Hr,{path:"/notifications",element:i.jsx(na,{children:i.jsx(Cie,{})})}),i.jsx(Hr,{path:"/changelog",element:i.jsx(na,{allowedRoles:["admin"],children:i.jsx(Eie,{})})}),i.jsx(Hr,{path:"/screenshot-demo",element:i.jsx(Rie,{})})]})}function Kie(){return i.jsx(yT,{children:i.jsx(bT,{children:i.jsx(wT,{children:i.jsx(U6,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:i.jsx(Gie,{})})})})})}function Xie(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:a,onRegisteredSW:s,onRegisterError:o}=e;let l,c;const d=async(h=!0)=>{await c};async function u(){if("serviceWorker"in navigator){if(l=await Bh(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!l)return;l.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),l.addEventListener("installed",h=>{h.isUpdate||n==null||n()}),l.register({immediate:t}).then(h=>{s?s("/sw.js",h):a==null||a(h)}).catch(h=>{o==null||o(h)})}}return c=u(),d}const Jie=Xie({onNeedRefresh(){confirm("New content available. Reload to update?")&&Jie(!0)},onOfflineReady(){}});Eg.createRoot(document.getElementById("root")).render(i.jsx(Ce.StrictMode,{children:i.jsx(Kie,{})}));export{Pl as _};
